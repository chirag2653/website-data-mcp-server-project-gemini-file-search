(()=>{var a={};a.id=974,a.ids=[974],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},682:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{StaticGenBailoutError:function(){return d},isStaticGenBailoutError:function(){return e}});let c="NEXT_STATIC_GEN_BAILOUT";class d extends Error{constructor(...a){super(...a),this.code=c}}function e(a){return"object"==typeof a&&null!==a&&"code"in a&&a.code===c}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},858:(a,b,c)=>{var d=c(63815).Buffer,e=c(6263),f=c(76024),g=c(27910),h=c(52506),i=c(28354),j=/^[a-zA-Z0-9\-_]+?\.[a-zA-Z0-9\-_]+?\.([a-zA-Z0-9\-_]+)?$/;function k(a){var b=a.split(".",1)[0],c=d.from(b,"base64").toString("binary");if("[object Object]"===Object.prototype.toString.call(c))return c;try{return JSON.parse(c)}catch(a){return}}function l(a){return a.split(".")[2]}function m(a){return j.test(a)&&!!k(a)}function o(a,b,c){if(!b){var d=Error("Missing algorithm parameter for jws.verify");throw d.code="MISSING_ALGORITHM",d}var e=l(a=h(a)),g=a.split(".",2).join(".");return f(b).verify(g,e,c)}function p(a,b){if(b=b||{},!m(a=h(a)))return null;var c,e,f=k(a);if(!f)return null;var g=(c=c||"utf8",e=a.split(".")[1],d.from(e,"base64").toString(c));return("JWT"===f.typ||b.json)&&(g=JSON.parse(g,b.encoding)),{header:f,payload:g,signature:l(a)}}function q(a){var b=(a=a||{}).secret;if(b=null==(b=null==b?a.publicKey:b)?a.key:b,!0===/^hs/i.test(a.algorithm)&&null==b)throw TypeError("secret must be a string or buffer or a KeyObject");var c=new e(b);this.readable=!0,this.algorithm=a.algorithm,this.encoding=a.encoding,this.secret=this.publicKey=this.key=c,this.signature=new e(a.signature),this.secret.once("close",(function(){!this.signature.writable&&this.readable&&this.verify()}).bind(this)),this.signature.once("close",(function(){!this.secret.writable&&this.readable&&this.verify()}).bind(this))}i.inherits(q,g),q.prototype.verify=function(){try{var a=o(this.signature.buffer,this.algorithm,this.key.buffer),b=p(this.signature.buffer,this.encoding);return this.emit("done",a,b),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},q.decode=p,q.isValid=m,q.verify=o,a.exports=q},1590:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{DynamicServerError:function(){return d},isDynamicServerError:function(){return e}});let c="DYNAMIC_SERVER_USAGE";class d extends Error{constructor(a){super("Dynamic server usage: "+a),this.description=a,this.digest=c}}function e(a){return"object"==typeof a&&null!==a&&"digest"in a&&"string"==typeof a.digest&&a.digest===c}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},1708:a=>{"use strict";a.exports=require("node:process")},1773:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"DetachedPromise",{enumerable:!0,get:function(){return c}});class c{constructor(){let a,b;this.promise=new Promise((c,d)=>{a=c,b=d}),this.resolve=a,this.reject=b}}},2585:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.FileSubjectTokenSupplier=void 0;let d=c(28354),e=c(29021),f=(0,d.promisify)(e.readFile??(()=>{})),g=(0,d.promisify)(e.realpath??(()=>{})),h=(0,d.promisify)(e.lstat??(()=>{}));class i{filePath;formatType;subjectTokenFieldName;constructor(a){this.filePath=a.filePath,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName}async getSubjectToken(){let a,b=this.filePath;try{if(b=await g(b),!(await h(b)).isFile())throw Error()}catch(a){throw a instanceof Error&&(a.message=`The file at ${b} does not exist, or it is not a file. ${a.message}`),a}let c=await f(b,{encoding:"utf8"});if("text"===this.formatType?a=c:"json"===this.formatType&&this.subjectTokenFieldName&&(a=JSON.parse(c)[this.subjectTokenFieldName]),!a)throw Error("Unable to parse the subject_token from the credential_source file");return a}}b.FileSubjectTokenSupplier=i},2832:(a,b,c)=>{"use strict";let d,e=c(53053),f=c(68777),{mapHttpRequest:g,mapHttpResponse:h}=c(87826),i=c(11095),j=c(3608),{lsCacheSym:k,chindingsSym:l,writeSym:m,serializersSym:o,formatOptsSym:p,endSym:q,stringifiersSym:r,stringifySym:s,stringifySafeSym:t,wildcardFirstSym:u,nestedKeySym:v,formattersSym:w,messageKeySym:x,errorKeySym:y,nestedKeyStrSym:z,msgPrefixSym:A}=c(22782),{isMainThread:B}=c(73566),C=c(24482);function D(){}function E(a){let b="",c=0,d=!1,e=255,f=a.length;if(f>100)return JSON.stringify(a);for(var g=0;g<f&&e>=32;g++)(34===(e=a.charCodeAt(g))||92===e)&&(b+=a.slice(c,g)+"\\",c=g,d=!0);return d?b+=a.slice(c):b=a,e<32?JSON.stringify(a):'"'+b+'"'}function F(a,b,c,d){let e,f=this[s],g=this[t],h=this[r],i=this[q],j=this[l],m=this[o],p=this[w],A=this[x],B=this[y],C=this[k][c]+d;C+=j,p.log&&(a=p.log(a));let D=h[u],F="";for(let b in a)if(e=a[b],Object.prototype.hasOwnProperty.call(a,b)&&void 0!==e){m[b]?e=m[b](e):b===B&&m.err&&(e=m.err(e));let a=h[b]||D;switch(typeof e){case"undefined":case"function":continue;case"number":!1===Number.isFinite(e)&&(e=null);case"boolean":a&&(e=a(e));break;case"string":e=(a||E)(e);break;default:e=(a||f)(e,g)}if(void 0===e)continue;F+=","+E(b)+":"+e}let G="";if(void 0!==b){e=m[A]?m[A](b):b;let a=h[A]||D;switch(typeof e){case"function":break;case"number":!1===Number.isFinite(e)&&(e=null);case"boolean":a&&(e=a(e)),G=',"'+A+'":'+e;break;case"string":G=',"'+A+'":'+(e=(a||E)(e));break;default:G=',"'+A+'":'+(e=(a||f)(e,g))}}return this[v]&&F?C+this[z]+F.slice(1)+"}"+G+i:C+F+G+i}function G(a){let b=new i(a);return b.on("error",function a(c){if("EPIPE"===c.code){b.write=D,b.end=D,b.flushSync=D,b.destroy=D;return}b.removeListener("error",a),b.emit("error",c)}),!a.sync&&B&&(j.register(b,H),b.on("close",function(){j.unregister(b)})),b}function H(a,b){a.destroyed||("beforeExit"===b?(a.flush(),a.on("drain",function(){a.end()})):a.flushSync())}d="function"==typeof e.tracingChannel?e.tracingChannel("pino_asJson"):{hasSubscribers:!1,traceSync:(a,b,c,...d)=>a.call(c,...d)},a.exports={noop:D,buildSafeSonicBoom:G,asChindings:function(a,b){let c,d=a[l],e=a[s],f=a[t],g=a[r],h=g[u],i=a[o];for(let j in b=(0,a[w].bindings)(b))if(c=b[j],!0===((j.length<5||"level"!==j&&"serializers"!==j&&"formatters"!==j&&"customLevels"!==j)&&b.hasOwnProperty(j)&&void 0!==c)){if(c=i[j]?i[j](c):c,void 0===(c=(g[j]||h||e)(c,f)))continue;d+=',"'+j+'":'+c}return d},asJson:function(a,b,c,e){return!1===d.hasSubscribers?F.call(this,a,b,c,e):d.traceSync(F,{instance:this,arguments},this,a,b,c,e)},genLog:function(a,b){if(!b)return c;return function(...d){b.call(this,d,c,a)};function c(b,...d){if("object"==typeof b){let c,e=b;null!==b&&(b.method&&b.headers&&b.socket?b=g(b):"function"==typeof b.setHeader&&(b=h(b))),null===e&&0===d.length?c=[null]:(e=d.shift(),c=d),"string"==typeof this[A]&&null!=e&&(e=this[A]+e),this[m](b,f(e,c,this[p]),a)}else{let c=void 0===b?d.shift():b;"string"==typeof this[A]&&null!=c&&(c=this[A]+c),this[m](null,f(c,d,this[p]),a)}}},createArgsNormalizer:function(a){return function(b,c,d={},e){if("string"==typeof d)e=G({dest:d}),d={};else if("string"==typeof e){if(d&&d.transport)throw Error("only one of option.transport or stream can be specified");e=G({dest:e})}else if(d instanceof i||d.writable||d._writableState)e=d,d={};else if(d.transport){let a;if(d.transport instanceof i||d.transport.writable||d.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(d.transport.targets&&d.transport.targets.length&&d.formatters&&"function"==typeof d.formatters.level)throw Error("option.transport.targets do not allow custom level formatters");d.customLevels&&(a=d.useOnlyCustomLevels?d.customLevels:Object.assign({},d.levels,d.customLevels)),e=C({caller:c,...d.transport,levels:a})}if((d=Object.assign({},a,d)).serializers=Object.assign({},a.serializers,d.serializers),d.formatters=Object.assign({},a.formatters,d.formatters),d.prettyPrint)throw Error("prettyPrint option is no longer supported, see the pino-pretty package (https://github.com/pinojs/pino-pretty)");let{enabled:f,onChild:g}=d;if(!1===f&&(d.level="silent"),g||(d.onChild=D),!e){var h;e=(h=process.stdout).write!==h.constructor.prototype.write?process.stdout:G({fd:process.stdout.fd||1})}return{opts:d,stream:e}}},stringify:function(a,b){try{return JSON.stringify(a)}catch(c){try{return(b||this[t])(a)}catch(a){return'"[unable to serialize, circular reference is too complex to analyze]"'}}},buildFormatters:function(a,b,c){return{level:a,bindings:b,log:c}},normalizeDestFileDescriptor:function(a){let b=Number(a);return"string"==typeof a&&Number.isFinite(b)?b:void 0===a?1:a}}},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3608:a=>{"use strict";let b,c={exit:[],beforeExit:[]},d={exit:function(){f("exit")},beforeExit:function(){f("beforeExit")}};function e(a){c[a].length>0||(process.removeListener(a,d[a]),0===c.exit.length&&0===c.beforeExit.length&&(b=void 0))}function f(a){for(let b of c[a]){let c=b.deref(),d=b.fn;void 0!==c&&d(c,a)}c[a]=[]}function g(a){for(let b of["exit","beforeExit"]){let d=c[b].indexOf(a);c[b].splice(d,d+1),e(b)}}function h(a,e,f){if(void 0===e)throw Error("the object can't be undefined");c[a].length>0||process.on(a,d[a]);let h=new WeakRef(e);h.fn=f,void 0===b&&(b=new FinalizationRegistry(g)),b.register(e,h),c[a].push(h)}a.exports={register:function(a,b){h("exit",a,b)},registerBeforeExit:function(a,b){h("beforeExit",a,b)},unregister:function(a){if(void 0!==b)for(let d of(b.unregister(a),["exit","beforeExit"]))c[d]=c[d].filter(b=>{let c=b.deref();return c&&c!==a}),e(d)}}},3870:()=>{},4410:(a,b,c)=>{Promise.resolve().then(c.bind(c,69039))},4573:a=>{"use strict";a.exports=require("node:buffer")},4801:a=>{"use strict";a.exports={WRITE_INDEX:4,READ_INDEX:8}},6148:(a,b,c)=>{"use strict";var d;let e;Object.defineProperty(b,"__esModule",{value:!0}),b.GCPEnv=void 0,b.clear=function(){e=void 0},b.getEnv=g;let f=c(15400);async function g(){return e||(e=h())}async function h(){d.NONE;return process.env.GAE_SERVICE||process.env.GAE_MODULE_NAME?d.APP_ENGINE:process.env.FUNCTION_NAME||process.env.FUNCTION_TARGET?d.CLOUD_FUNCTIONS:await j()?await i()?d.KUBERNETES_ENGINE:process.env.K_CONFIGURATION?d.CLOUD_RUN:process.env.CLOUD_RUN_JOB?d.CLOUD_RUN_JOBS:d.COMPUTE_ENGINE:d.NONE}async function i(){try{return await f.instance("attributes/cluster-name"),!0}catch(a){return!1}}async function j(){return f.isAvailable()}!function(a){a.APP_ENGINE="APP_ENGINE",a.KUBERNETES_ENGINE="KUBERNETES_ENGINE",a.CLOUD_FUNCTIONS="CLOUD_FUNCTIONS",a.COMPUTE_ENGINE="COMPUTE_ENGINE",a.CLOUD_RUN="CLOUD_RUN",a.CLOUD_RUN_JOBS="CLOUD_RUN_JOBS",a.NONE="NONE"}(d||(b.GCPEnv=d={}))},6263:(a,b,c)=>{var d=c(63815).Buffer,e=c(27910);function f(a){if(this.buffer=null,this.writable=!0,this.readable=!0,!a)return this.buffer=d.alloc(0),this;if("function"==typeof a.pipe)return this.buffer=d.alloc(0),a.pipe(this),this;if(a.length||"object"==typeof a)return this.buffer=a,this.writable=!1,process.nextTick((function(){this.emit("end",a),this.readable=!1,this.emit("close")}).bind(this)),this;throw TypeError("Unexpected data type ("+typeof a+")")}c(28354).inherits(f,e),f.prototype.write=function(a){this.buffer=d.concat([this.buffer,d.from(a)]),this.emit("data",a)},f.prototype.end=function(a){a&&this.write(a),this.emit("end",a),this.emit("close"),this.writable=!1,this.readable=!1},a.exports=f},7775:(a,b,c)=>{"use strict";let d,e=c(74075),f=c(65158),g=c(43921),{kStatusCode:h}=c(40826),i=Buffer[Symbol.species],j=Buffer.from([0,0,255,255]),k=Symbol("permessage-deflate"),l=Symbol("total-length"),m=Symbol("callback"),o=Symbol("buffers"),p=Symbol("error");class q{constructor(a,b,c){this._maxPayload=0|c,this._options=a||{},this._threshold=void 0!==this._options.threshold?this._options.threshold:1024,this._isServer=!!b,this._deflate=null,this._inflate=null,this.params=null,d||(d=new g(void 0!==this._options.concurrencyLimit?this._options.concurrencyLimit:10))}static get extensionName(){return"permessage-deflate"}offer(){let a={};return this._options.serverNoContextTakeover&&(a.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(a.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(a.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?a.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(a.client_max_window_bits=!0),a}accept(a){return a=this.normalizeParams(a),this.params=this._isServer?this.acceptAsServer(a):this.acceptAsClient(a),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let a=this._deflate[m];this._deflate.close(),this._deflate=null,a&&a(Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(a){let b=this._options,c=a.find(a=>(!1!==b.serverNoContextTakeover||!a.server_no_context_takeover)&&(!a.server_max_window_bits||!1!==b.serverMaxWindowBits&&("number"!=typeof b.serverMaxWindowBits||!(b.serverMaxWindowBits>a.server_max_window_bits)))&&("number"!=typeof b.clientMaxWindowBits||!!a.client_max_window_bits));if(!c)throw Error("None of the extension offers can be accepted");return b.serverNoContextTakeover&&(c.server_no_context_takeover=!0),b.clientNoContextTakeover&&(c.client_no_context_takeover=!0),"number"==typeof b.serverMaxWindowBits&&(c.server_max_window_bits=b.serverMaxWindowBits),"number"==typeof b.clientMaxWindowBits?c.client_max_window_bits=b.clientMaxWindowBits:(!0===c.client_max_window_bits||!1===b.clientMaxWindowBits)&&delete c.client_max_window_bits,c}acceptAsClient(a){let b=a[0];if(!1===this._options.clientNoContextTakeover&&b.client_no_context_takeover)throw Error('Unexpected parameter "client_no_context_takeover"');if(b.client_max_window_bits){if(!1===this._options.clientMaxWindowBits||"number"==typeof this._options.clientMaxWindowBits&&b.client_max_window_bits>this._options.clientMaxWindowBits)throw Error('Unexpected or invalid parameter "client_max_window_bits"')}else"number"==typeof this._options.clientMaxWindowBits&&(b.client_max_window_bits=this._options.clientMaxWindowBits);return b}normalizeParams(a){return a.forEach(a=>{Object.keys(a).forEach(b=>{let c=a[b];if(c.length>1)throw Error(`Parameter "${b}" must have only a single value`);if(c=c[0],"client_max_window_bits"===b){if(!0!==c){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if(!this._isServer)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else if("server_max_window_bits"===b){let a=+c;if(!Number.isInteger(a)||a<8||a>15)throw TypeError(`Invalid value for parameter "${b}": ${c}`);c=a}else if("client_no_context_takeover"===b||"server_no_context_takeover"===b){if(!0!==c)throw TypeError(`Invalid value for parameter "${b}": ${c}`)}else throw Error(`Unknown parameter "${b}"`);a[b]=c})}),a}decompress(a,b,c){d.add(d=>{this._decompress(a,b,(a,b)=>{d(),c(a,b)})})}compress(a,b,c){d.add(d=>{this._compress(a,b,(a,b)=>{d(),c(a,b)})})}_decompress(a,b,c){let d=this._isServer?"client":"server";if(!this._inflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._inflate=e.createInflateRaw({...this._options.zlibInflateOptions,windowBits:b}),this._inflate[k]=this,this._inflate[l]=0,this._inflate[o]=[],this._inflate.on("error",t),this._inflate.on("data",s)}this._inflate[m]=c,this._inflate.write(a),b&&this._inflate.write(j),this._inflate.flush(()=>{let a=this._inflate[p];if(a){this._inflate.close(),this._inflate=null,c(a);return}let e=f.concat(this._inflate[o],this._inflate[l]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[l]=0,this._inflate[o]=[],b&&this.params[`${d}_no_context_takeover`]&&this._inflate.reset()),c(null,e)})}_compress(a,b,c){let d=this._isServer?"server":"client";if(!this._deflate){let a=`${d}_max_window_bits`,b="number"!=typeof this.params[a]?e.Z_DEFAULT_WINDOWBITS:this.params[a];this._deflate=e.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:b}),this._deflate[l]=0,this._deflate[o]=[],this._deflate.on("data",r)}this._deflate[m]=c,this._deflate.write(a),this._deflate.flush(e.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let a=f.concat(this._deflate[o],this._deflate[l]);b&&(a=new i(a.buffer,a.byteOffset,a.length-4)),this._deflate[m]=null,this._deflate[l]=0,this._deflate[o]=[],b&&this.params[`${d}_no_context_takeover`]&&this._deflate.reset(),c(null,a)})}}function r(a){this[o].push(a),this[l]+=a.length}function s(a){if(this[l]+=a.length,this[k]._maxPayload<1||this[l]<=this[k]._maxPayload)return void this[o].push(a);this[p]=RangeError("Max payload size exceeded"),this[p].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[p][h]=1009,this.removeListener("data",s),this.reset()}function t(a){if(this[k]._inflate=null,this[p])return void this[m](this[p]);a[h]=1007,this[m](a)}a.exports=q},8011:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BaseExternalAccountClient=b.CLOUD_RESOURCE_MANAGER=b.EXTERNAL_ACCOUNT_TYPE=b.EXPIRATION_TIME_OFFSET=void 0;let d=c(15921),e=c(27910),f=c(62783),g=c(88706),h=c(21827),i=c(66993),j="https://www.googleapis.com/auth/cloud-platform";b.EXPIRATION_TIME_OFFSET=3e5,b.EXTERNAL_ACCOUNT_TYPE="external_account",b.CLOUD_RESOURCE_MANAGER="https://cloudresourcemanager.googleapis.com/v1/projects/";class k extends f.AuthClient{scopes;projectNumber;audience;subjectTokenType;stsCredential;clientAuth;credentialSourceType;cachedAccessToken;serviceAccountImpersonationUrl;serviceAccountImpersonationLifetime;workforcePoolUserProject;configLifetimeRequested;tokenUrl;cloudResourceManagerURL;supplierContext;#a=null;constructor(a){super(a);let c=(0,h.originalOrCamelOptions)(a),d=c.get("type");if(d&&d!==b.EXTERNAL_ACCOUNT_TYPE)throw Error(`Expected "${b.EXTERNAL_ACCOUNT_TYPE}" type but received "${a.type}"`);let e=c.get("client_id"),f=c.get("client_secret");this.tokenUrl=c.get("token_url")??"https://sts.{universeDomain}/v1/token".replace("{universeDomain}",this.universeDomain);let i=c.get("subject_token_type"),k=c.get("workforce_pool_user_project"),l=c.get("service_account_impersonation_url"),m=c.get("service_account_impersonation"),o=(0,h.originalOrCamelOptions)(m).get("token_lifetime_seconds");this.cloudResourceManagerURL=new URL(c.get("cloud_resource_manager_url")||`https://cloudresourcemanager.${this.universeDomain}/v1/projects/`),e&&(this.clientAuth={confidentialClientType:"basic",clientId:e,clientSecret:f}),this.stsCredential=new g.StsCredentials({tokenExchangeEndpoint:this.tokenUrl,clientAuthentication:this.clientAuth}),this.scopes=c.get("scopes")||[j],this.cachedAccessToken=null,this.audience=c.get("audience"),this.subjectTokenType=i,this.workforcePoolUserProject=k;let p=RegExp("//iam\\.googleapis\\.com/locations/[^/]+/workforcePools/[^/]+/providers/.+");if(this.workforcePoolUserProject&&!this.audience.match(p))throw Error("workforcePoolUserProject should not be set for non-workforce pool credentials.");this.serviceAccountImpersonationUrl=l,this.serviceAccountImpersonationLifetime=o,this.serviceAccountImpersonationLifetime?this.configLifetimeRequested=!0:(this.configLifetimeRequested=!1,this.serviceAccountImpersonationLifetime=3600),this.projectNumber=this.getProjectNumber(this.audience),this.supplierContext={audience:this.audience,subjectTokenType:this.subjectTokenType,transporter:this.transporter}}getServiceAccountEmail(){if(this.serviceAccountImpersonationUrl){if(this.serviceAccountImpersonationUrl.length>256)throw RangeError(`URL is too long: ${this.serviceAccountImpersonationUrl}`);let a=/serviceAccounts\/(?<email>[^:]+):generateAccessToken$/.exec(this.serviceAccountImpersonationUrl);return a?.groups?.email||null}return null}setCredentials(a){super.setCredentials(a),this.cachedAccessToken=a}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async getProjectId(){let a=this.projectNumber||this.workforcePoolUserProject;if(this.projectId)return this.projectId;if(a){let b=await this.getRequestHeaders(),c={...k.RETRY_CONFIG,headers:b,url:`${this.cloudResourceManagerURL.toString()}${a}`};f.AuthClient.setMethodName(c,"getProjectId");let d=await this.transporter.request(c);return this.projectId=d.data.projectId,this.projectId}return null}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=d.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,f=c.config.data instanceof e.Readable;if(!b&&(401===d||403===d)&&!f&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){this.#a=this.#a||this.#b();try{return await this.#a}finally{this.#a=null}}async #b(){let a=await this.retrieveSubjectToken(),b={grantType:"urn:ietf:params:oauth:grant-type:token-exchange",audience:this.audience,requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:a,subjectTokenType:this.subjectTokenType,scope:this.serviceAccountImpersonationUrl?[j]:this.getScopesArray()},c=!this.clientAuth&&this.workforcePoolUserProject?{userProject:this.workforcePoolUserProject}:void 0,d=new Headers({"x-goog-api-client":this.getMetricsHeaderValue()}),e=await this.stsCredential.exchangeToken(b,d,c);return this.serviceAccountImpersonationUrl?this.cachedAccessToken=await this.getImpersonatedAccessToken(e.access_token):e.expires_in?this.cachedAccessToken={access_token:e.access_token,expiry_date:new Date().getTime()+1e3*e.expires_in,res:e.res}:this.cachedAccessToken={access_token:e.access_token,res:e.res},this.credentials={},Object.assign(this.credentials,this.cachedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedAccessToken.expiry_date,access_token:this.cachedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedAccessToken}getProjectNumber(a){let b=a.match(/\/projects\/([^/]+)/);return b?b[1]:null}async getImpersonatedAccessToken(a){let b={...k.RETRY_CONFIG,url:this.serviceAccountImpersonationUrl,method:"POST",headers:{"content-type":"application/json",authorization:`Bearer ${a}`},data:{scope:this.getScopesArray(),lifetime:this.serviceAccountImpersonationLifetime+"s"}};f.AuthClient.setMethodName(b,"getImpersonatedAccessToken");let c=await this.transporter.request(b),d=c.data;return{access_token:d.accessToken,expiry_date:new Date(d.expireTime).getTime(),res:c}}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}getScopesArray(){return"string"==typeof this.scopes?[this.scopes]:this.scopes||[j]}getMetricsHeaderValue(){let a=process.version.replace(/^v/,""),b=void 0!==this.serviceAccountImpersonationUrl,c=this.credentialSourceType?this.credentialSourceType:"unknown";return`gl-node/${a} auth/${i.pkg.version} google-byoid-sdk source/${c} sa-impersonation/${b} config-lifetime/${this.configLifetimeRequested}`}getTokenUrl(){return this.tokenUrl}}b.BaseExternalAccountClient=k},8050:a=>{"use strict";function b(a,b){return b}a.exports=function(){let a=Error.prepareStackTrace;Error.prepareStackTrace=b;let c=Error().stack;if(Error.prepareStackTrace=a,!Array.isArray(c))return;let d=c.slice(2),e=[];for(let a of d)a&&e.push(a.getFileName());return e}},8086:a=>{"use strict";a.exports=require("module")},8431:(a,b,c)=>{"use strict";let d,e,f,g,h,i,j,k;c.r(b),c.d(b,{"40622ed279d917b6463604c69302242b45356ef24b":()=>iJ,"40e068f070ee0c87ce95f28eee71a4e4ab2ad0f669":()=>iL,"6059c8a6b5b82ffc7a1d5d100ac4868c75861c3a08":()=>iM,"60d306fda615a5dc15be3c0235749ca6d4859c5b62":()=>iK});var l,m,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE=c(54413);c(32953);function aF(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}Object.create;Object.create,"function"==typeof SuppressedError&&SuppressedError;class aG extends Error{constructor(a,b="FunctionsError",c){super(a),this.name=b,this.context=c}}class aH extends aG{constructor(a){super("Failed to send a request to the Edge Function","FunctionsFetchError",a)}}class aI extends aG{constructor(a){super("Relay Error invoking the Edge Function","FunctionsRelayError",a)}}class aJ extends aG{constructor(a){super("Edge Function returned a non-2xx status code","FunctionsHttpError",a)}}!function(a){a.Any="any",a.ApNortheast1="ap-northeast-1",a.ApNortheast2="ap-northeast-2",a.ApSouth1="ap-south-1",a.ApSoutheast1="ap-southeast-1",a.ApSoutheast2="ap-southeast-2",a.CaCentral1="ca-central-1",a.EuCentral1="eu-central-1",a.EuWest1="eu-west-1",a.EuWest2="eu-west-2",a.EuWest3="eu-west-3",a.SaEast1="sa-east-1",a.UsEast1="us-east-1",a.UsWest1="us-west-1",a.UsWest2="us-west-2"}(l||(l={}));class aK{constructor(a,{headers:b={},customFetch:c,region:d=l.Any}={}){this.url=a,this.headers=b,this.region=d,this.fetch=(a=>a?(...b)=>a(...b):(...a)=>fetch(...a))(c)}setAuth(a){this.headers.Authorization=`Bearer ${a}`}invoke(a){var b,c,d,e;return b=this,c=arguments,d=void 0,e=function*(a,b={}){var c;let d,e;try{let f,{headers:g,method:h,body:i,signal:j,timeout:k}=b,l={},{region:m}=b;m||(m=this.region);let o=new URL(`${this.url}/${a}`);m&&"any"!==m&&(l["x-region"]=m,o.searchParams.set("forceFunctionRegion",m)),i&&(g&&!Object.prototype.hasOwnProperty.call(g,"Content-Type")||!g)?"undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",f=i):"string"==typeof i?(l["Content-Type"]="text/plain",f=i):"undefined"!=typeof FormData&&i instanceof FormData?f=i:(l["Content-Type"]="application/json",f=JSON.stringify(i)):f=i;let p=j;k&&(e=new AbortController,d=setTimeout(()=>e.abort(),k),j?(p=e.signal,j.addEventListener("abort",()=>e.abort())):p=e.signal);let q=yield this.fetch(o.toString(),{method:h||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),g),body:f,signal:p}).catch(a=>{throw new aH(a)}),r=q.headers.get("x-relay-error");if(r&&"true"===r)throw new aI(q);if(!q.ok)throw new aJ(q);let s=(null!=(c=q.headers.get("Content-Type"))?c:"text/plain").split(";")[0].trim();return{data:"application/json"===s?yield q.json():"application/octet-stream"===s||"application/pdf"===s?yield q.blob():"text/event-stream"===s?q:"multipart/form-data"===s?yield q.formData():yield q.text(),error:null,response:q}}catch(a){return{data:null,error:a,response:a instanceof aJ||a instanceof aI?a.context:void 0}}finally{d&&clearTimeout(d)}},new(d||(d=Promise))(function(a,f){function g(a){try{i(e.next(a))}catch(a){f(a)}}function h(a){try{i(e.throw(a))}catch(a){f(a)}}function i(b){var c;b.done?a(b.value):((c=b.value)instanceof d?c:new d(function(a){a(c)})).then(g,h)}i((e=e.apply(b,c||[])).next())})}}var aL=class extends Error{constructor(a){super(a.message),this.name="PostgrestError",this.details=a.details,this.hint=a.hint,this.code=a.code}},aM=class{constructor(a){var b,c;this.shouldThrowOnError=!1,this.method=a.method,this.url=a.url,this.headers=new Headers(a.headers),this.schema=a.schema,this.body=a.body,this.shouldThrowOnError=null!=(b=a.shouldThrowOnError)&&b,this.signal=a.signal,this.isMaybeSingle=null!=(c=a.isMaybeSingle)&&c,a.fetch?this.fetch=a.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(a,b){return this.headers=new Headers(this.headers),this.headers.set(a,b),this}then(a,b){var c=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let d=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var b,d,e,f;let g=null,h=null,i=null,j=a.status,k=a.statusText;if(a.ok){if("HEAD"!==c.method){let b=await a.text();""===b||(h="text/csv"===c.headers.get("Accept")||c.headers.get("Accept")&&(null==(e=c.headers.get("Accept"))?void 0:e.includes("application/vnd.pgrst.plan+text"))?b:JSON.parse(b))}let f=null==(b=c.headers.get("Prefer"))?void 0:b.match(/count=(exact|planned|estimated)/),l=null==(d=a.headers.get("content-range"))?void 0:d.split("/");f&&l&&l.length>1&&(i=parseInt(l[1])),c.isMaybeSingle&&"GET"===c.method&&Array.isArray(h)&&(h.length>1?(g={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,i=null,j=406,k="Not Acceptable"):h=1===h.length?h[0]:null)}else{let b=await a.text();try{g=JSON.parse(b),Array.isArray(g)&&404===a.status&&(h=[],g=null,j=200,k="OK")}catch(c){404===a.status&&""===b?(j=204,k="No Content"):g={message:b}}if(g&&c.isMaybeSingle&&(null==g||null==(f=g.details)?void 0:f.includes("0 rows"))&&(g=null,j=200,k="OK"),g&&c.shouldThrowOnError)throw new aL(g)}return{error:g,data:h,count:i,status:j,statusText:k}});return this.shouldThrowOnError||(d=d.catch(a=>{var b,c,d,e,f,g;let h="",i=null==a?void 0:a.cause;if(i){let b=null!=(c=null==i?void 0:i.message)?c:"",g=null!=(d=null==i?void 0:i.code)?d:"";h=`${null!=(e=null==a?void 0:a.name)?e:"FetchError"}: ${null==a?void 0:a.message}

Caused by: ${null!=(f=null==i?void 0:i.name)?f:"Error"}: ${b}`,g&&(h+=` (${g})`),(null==i?void 0:i.stack)&&(h+=`
${i.stack}`)}else h=null!=(g=null==a?void 0:a.stack)?g:"";return{error:{message:`${null!=(b=null==a?void 0:a.name)?b:"FetchError"}: ${null==a?void 0:a.message}`,details:h,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),d.then(a,b)}returns(){return this}overrideTypes(){return this}},aN=class extends aM{select(a){let b=!1,c=(null!=a?a:"*").split("").map(a=>/\s/.test(a)&&!b?"":('"'===a&&(b=!b),a)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:b=!0,nullsFirst:c,foreignTable:d,referencedTable:e=d}={}){let f=e?`${e}.order`:"order",g=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${g?`${g},`:""}${a}.${b?"asc":"desc"}${void 0===c?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:b,referencedTable:c=b}={}){let d=void 0===c?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,b,{foreignTable:c,referencedTable:d=c}={}){let e=void 0===d?"offset":`${d}.offset`,f=void 0===d?"limit":`${d}.limit`;return this.url.searchParams.set(e,`${a}`),this.url.searchParams.set(f,`${b-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:b=!1,settings:c=!1,buffers:d=!1,wal:e=!1,format:f="text"}={}){var g;let h=[a?"analyze":null,b?"verbose":null,c?"settings":null,d?"buffers":null,e?"wal":null].filter(Boolean).join("|"),i=null!=(g=this.headers.get("Accept"))?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${i}"; options=${h};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}};let aO=RegExp("[,()]");var aP=class extends aN{eq(a,b){return this.url.searchParams.append(a,`eq.${b}`),this}neq(a,b){return this.url.searchParams.append(a,`neq.${b}`),this}gt(a,b){return this.url.searchParams.append(a,`gt.${b}`),this}gte(a,b){return this.url.searchParams.append(a,`gte.${b}`),this}lt(a,b){return this.url.searchParams.append(a,`lt.${b}`),this}lte(a,b){return this.url.searchParams.append(a,`lte.${b}`),this}like(a,b){return this.url.searchParams.append(a,`like.${b}`),this}likeAllOf(a,b){return this.url.searchParams.append(a,`like(all).{${b.join(",")}}`),this}likeAnyOf(a,b){return this.url.searchParams.append(a,`like(any).{${b.join(",")}}`),this}ilike(a,b){return this.url.searchParams.append(a,`ilike.${b}`),this}ilikeAllOf(a,b){return this.url.searchParams.append(a,`ilike(all).{${b.join(",")}}`),this}ilikeAnyOf(a,b){return this.url.searchParams.append(a,`ilike(any).{${b.join(",")}}`),this}regexMatch(a,b){return this.url.searchParams.append(a,`match.${b}`),this}regexIMatch(a,b){return this.url.searchParams.append(a,`imatch.${b}`),this}is(a,b){return this.url.searchParams.append(a,`is.${b}`),this}isDistinct(a,b){return this.url.searchParams.append(a,`isdistinct.${b}`),this}in(a,b){let c=Array.from(new Set(b)).map(a=>"string"==typeof a&&aO.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(a,`in.(${c})`),this}notIn(a,b){let c=Array.from(new Set(b)).map(a=>"string"==typeof a&&aO.test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(a,`not.in.(${c})`),this}contains(a,b){return"string"==typeof b?this.url.searchParams.append(a,`cs.${b}`):Array.isArray(b)?this.url.searchParams.append(a,`cs.{${b.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(b)}`),this}containedBy(a,b){return"string"==typeof b?this.url.searchParams.append(a,`cd.${b}`):Array.isArray(b)?this.url.searchParams.append(a,`cd.{${b.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(b)}`),this}rangeGt(a,b){return this.url.searchParams.append(a,`sr.${b}`),this}rangeGte(a,b){return this.url.searchParams.append(a,`nxl.${b}`),this}rangeLt(a,b){return this.url.searchParams.append(a,`sl.${b}`),this}rangeLte(a,b){return this.url.searchParams.append(a,`nxr.${b}`),this}rangeAdjacent(a,b){return this.url.searchParams.append(a,`adj.${b}`),this}overlaps(a,b){return"string"==typeof b?this.url.searchParams.append(a,`ov.${b}`):this.url.searchParams.append(a,`ov.{${b.join(",")}}`),this}textSearch(a,b,{config:c,type:d}={}){let e="";"plain"===d?e="pl":"phrase"===d?e="ph":"websearch"===d&&(e="w");let f=void 0===c?"":`(${c})`;return this.url.searchParams.append(a,`${e}fts${f}.${b}`),this}match(a){return Object.entries(a).forEach(([a,b])=>{this.url.searchParams.append(a,`eq.${b}`)}),this}not(a,b,c){return this.url.searchParams.append(a,`not.${b}.${c}`),this}or(a,{foreignTable:b,referencedTable:c=b}={}){let d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,b,c){return this.url.searchParams.append(a,`${b}.${c}`),this}},aQ=class{constructor(a,{headers:b={},schema:c,fetch:d}){this.url=a,this.headers=new Headers(b),this.schema=c,this.fetch=d}select(a,b){let{head:c=!1,count:d}=null!=b?b:{},e=!1,f=(null!=a?a:"*").split("").map(a=>/\s/.test(a)&&!e?"":('"'===a&&(e=!e),a)).join("");return this.url.searchParams.set("select",f),d&&this.headers.append("Prefer",`count=${d}`),new aP({method:c?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:b,defaultToNull:c=!0}={}){var d;if(b&&this.headers.append("Prefer",`count=${b}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){let b=a.reduce((a,b)=>a.concat(Object.keys(b)),[]);if(b.length>0){let a=[...new Set(b)].map(a=>`"${a}"`);this.url.searchParams.set("columns",a.join(","))}}return new aP({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:null!=(d=this.fetch)?d:fetch})}upsert(a,{onConflict:b,ignoreDuplicates:c=!1,count:d,defaultToNull:e=!0}={}){var f;if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),void 0!==b&&this.url.searchParams.set("on_conflict",b),d&&this.headers.append("Prefer",`count=${d}`),e||this.headers.append("Prefer","missing=default"),Array.isArray(a)){let b=a.reduce((a,b)=>a.concat(Object.keys(b)),[]);if(b.length>0){let a=[...new Set(b)].map(a=>`"${a}"`);this.url.searchParams.set("columns",a.join(","))}}return new aP({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:null!=(f=this.fetch)?f:fetch})}update(a,{count:b}={}){var c;return b&&this.headers.append("Prefer",`count=${b}`),new aP({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:null!=(c=this.fetch)?c:fetch})}delete({count:a}={}){var b;return a&&this.headers.append("Prefer",`count=${a}`),new aP({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!=(b=this.fetch)?b:fetch})}},aR=class a{constructor(a,{headers:b={},schema:c,fetch:d}={}){this.url=a,this.headers=new Headers(b),this.schemaName=c,this.fetch=d}from(a){if(!a||"string"!=typeof a||""===a.trim())throw Error("Invalid relation name: relation must be a non-empty string.");return new aQ(new URL(`${this.url}/${a}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(b){return new a(this.url,{headers:this.headers,schema:b,fetch:this.fetch})}rpc(a,b={},{head:c=!1,get:d=!1,count:e}={}){var f;let g,h,i=new URL(`${this.url}/rpc/${a}`);c||d?(g=c?"HEAD":"GET",Object.entries(b).filter(([a,b])=>void 0!==b).map(([a,b])=>[a,Array.isArray(b)?`{${b.join(",")}}`:`${b}`]).forEach(([a,b])=>{i.searchParams.append(a,b)})):(g="POST",h=b);let j=new Headers(this.headers);return e&&j.set("Prefer",`count=${e}`),new aP({method:g,url:i,headers:j,schema:this.schemaName,body:h,fetch:null!=(f=this.fetch)?f:fetch})}};class aS{constructor(){}static detectEnvironment(){var a;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null==(a=navigator.userAgent)?void 0:a.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process){let a=process.versions;if(a&&a.node){let b=parseInt(a.node.replace(/^v/,"").split(".")[0]);return b>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${b} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${b} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let a=this.detectEnvironment();if(a.constructor)return a.constructor;let b=a.error||"WebSocket not supported in this environment.";throw a.workaround&&(b+=`

Suggested solution: ${a.workaround}`),Error(b)}static createWebSocket(a,b){return new(this.getWebSocketConstructor())(a,b)}static isWebSocketSupported(){try{let a=this.detectEnvironment();return"native"===a.type||"ws"===a.type}catch(a){return!1}}}let aT="1.0.0";!function(a){a[a.connecting=0]="connecting",a[a.open=1]="open",a[a.closing=2]="closing",a[a.closed=3]="closed"}(m||(m={})),function(a){a.closed="closed",a.errored="errored",a.joined="joined",a.joining="joining",a.leaving="leaving"}(o||(o={})),function(a){a.close="phx_close",a.error="phx_error",a.join="phx_join",a.reply="phx_reply",a.leave="phx_leave",a.access_token="access_token"}(p||(p={})),(q||(q={})).websocket="websocket",function(a){a.Connecting="connecting",a.Open="open",a.Closing="closing",a.Closed="closed"}(r||(r={}));class aU{constructor(a){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=a?a:[]}encode(a,b){return a.event!==this.BROADCAST_EVENT||a.payload instanceof ArrayBuffer||"string"!=typeof a.payload.event?b(JSON.stringify([a.join_ref,a.ref,a.topic,a.event,a.payload])):b(this._binaryEncodeUserBroadcastPush(a))}_binaryEncodeUserBroadcastPush(a){var b;return this._isArrayBuffer(null==(b=a.payload)?void 0:b.payload)?this._encodeBinaryUserBroadcastPush(a):this._encodeJsonUserBroadcastPush(a)}_encodeBinaryUserBroadcastPush(a){var b,c;let d=null!=(c=null==(b=a.payload)?void 0:b.payload)?c:new ArrayBuffer(0);return this._encodeUserBroadcastPush(a,this.BINARY_ENCODING,d)}_encodeJsonUserBroadcastPush(a){var b,c;let d=null!=(c=null==(b=a.payload)?void 0:b.payload)?c:{},e=new TextEncoder().encode(JSON.stringify(d)).buffer;return this._encodeUserBroadcastPush(a,this.JSON_ENCODING,e)}_encodeUserBroadcastPush(a,b,c){let d=a.topic,e=null!=(o=a.ref)?o:"",f=null!=(p=a.join_ref)?p:"",g=a.payload.event,h=this.allowedMetadataKeys?this._pick(a.payload,this.allowedMetadataKeys):{},i=0===Object.keys(h).length?"":JSON.stringify(h);if(f.length>255)throw Error(`joinRef length ${f.length} exceeds maximum of 255`);if(e.length>255)throw Error(`ref length ${e.length} exceeds maximum of 255`);if(d.length>255)throw Error(`topic length ${d.length} exceeds maximum of 255`);if(g.length>255)throw Error(`userEvent length ${g.length} exceeds maximum of 255`);if(i.length>255)throw Error(`metadata length ${i.length} exceeds maximum of 255`);let j=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+e.length+d.length+g.length+i.length,k=new ArrayBuffer(this.HEADER_LENGTH+j),l=new DataView(k),m=0;l.setUint8(m++,this.KINDS.userBroadcastPush),l.setUint8(m++,f.length),l.setUint8(m++,e.length),l.setUint8(m++,d.length),l.setUint8(m++,g.length),l.setUint8(m++,i.length),l.setUint8(m++,b),Array.from(f,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(e,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(d,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(g,a=>l.setUint8(m++,a.charCodeAt(0))),Array.from(i,a=>l.setUint8(m++,a.charCodeAt(0)));var o,p,q=new Uint8Array(k.byteLength+c.byteLength);return q.set(new Uint8Array(k),0),q.set(new Uint8Array(c),k.byteLength),q.buffer}decode(a,b){if(this._isArrayBuffer(a))return b(this._binaryDecode(a));if("string"==typeof a){let[c,d,e,f,g]=JSON.parse(a);return b({join_ref:c,ref:d,topic:e,event:f,payload:g})}return b({})}_binaryDecode(a){let b=new DataView(a),c=b.getUint8(0),d=new TextDecoder;if(c===this.KINDS.userBroadcast)return this._decodeUserBroadcast(a,b,d)}_decodeUserBroadcast(a,b,c){let d=b.getUint8(1),e=b.getUint8(2),f=b.getUint8(3),g=b.getUint8(4),h=this.HEADER_LENGTH+4,i=c.decode(a.slice(h,h+d));h+=d;let j=c.decode(a.slice(h,h+e));h+=e;let k=c.decode(a.slice(h,h+f));h+=f;let l=a.slice(h,a.byteLength),m=g===this.JSON_ENCODING?JSON.parse(c.decode(l)):l,o={type:this.BROADCAST_EVENT,event:j,payload:m};return f>0&&(o.meta=JSON.parse(k)),{join_ref:null,ref:null,topic:i,event:this.BROADCAST_EVENT,payload:o}}_isArrayBuffer(a){var b;return a instanceof ArrayBuffer||(null==(b=null==a?void 0:a.constructor)?void 0:b.name)==="ArrayBuffer"}_pick(a,b){return a&&"object"==typeof a?Object.fromEntries(Object.entries(a).filter(([a])=>b.includes(a))):{}}}class aV{constructor(a,b){this.callback=a,this.timerCalc=b,this.timer=void 0,this.tries=0,this.callback=a,this.timerCalc=b}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(a){a.abstime="abstime",a.bool="bool",a.date="date",a.daterange="daterange",a.float4="float4",a.float8="float8",a.int2="int2",a.int4="int4",a.int4range="int4range",a.int8="int8",a.int8range="int8range",a.json="json",a.jsonb="jsonb",a.money="money",a.numeric="numeric",a.oid="oid",a.reltime="reltime",a.text="text",a.time="time",a.timestamp="timestamp",a.timestamptz="timestamptz",a.timetz="timetz",a.tsrange="tsrange",a.tstzrange="tstzrange"}(s||(s={}));let aW=(a,b,c={})=>{var d;let e=null!=(d=c.skipTypes)?d:[];return b?Object.keys(b).reduce((c,d)=>(c[d]=aX(d,a,b,e),c),{}):{}},aX=(a,b,c,d)=>{let e=b.find(b=>b.name===a),f=null==e?void 0:e.type,g=c[a];return f&&!d.includes(f)?aY(f,g):aZ(g)},aY=(a,b)=>{if("_"===a.charAt(0))return a1(b,a.slice(1,a.length));switch(a){case s.bool:return a$(b);case s.float4:case s.float8:case s.int2:case s.int4:case s.int8:case s.numeric:case s.oid:return a_(b);case s.json:case s.jsonb:return a0(b);case s.timestamp:return a2(b);case s.abstime:case s.date:case s.daterange:case s.int4range:case s.int8range:case s.money:case s.reltime:case s.text:case s.time:case s.timestamptz:case s.timetz:case s.tsrange:case s.tstzrange:default:return aZ(b)}},aZ=a=>a,a$=a=>{switch(a){case"t":return!0;case"f":return!1;default:return a}},a_=a=>{if("string"==typeof a){let b=parseFloat(a);if(!Number.isNaN(b))return b}return a},a0=a=>{if("string"==typeof a)try{return JSON.parse(a)}catch(a){}return a},a1=(a,b)=>{if("string"!=typeof a)return a;let c=a.length-1,d=a[c];if("{"===a[0]&&"}"===d){let d,e=a.slice(1,c);try{d=JSON.parse("["+e+"]")}catch(a){d=e?e.split(","):[]}return d.map(a=>aY(b,a))}return a},a2=a=>"string"==typeof a?a.replace(" ","T"):a,a3=a=>{let b=new URL(a);return b.protocol=b.protocol.replace(/^ws/i,"http"),b.pathname=b.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===b.pathname||"/"===b.pathname?b.pathname="/api/broadcast":b.pathname=b.pathname+"/api/broadcast",b.href};class a4{constructor(a,b,c={},d=1e4){this.channel=a,this.event=b,this.payload=c,this.timeout=d,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(a){this.timeout=a,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(a){this.payload=Object.assign(Object.assign({},this.payload),a)}receive(a,b){var c;return this._hasReceived(a)&&b(null==(c=this.receivedResp)?void 0:c.response),this.recHooks.push({status:a,callback:b}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let a=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},a),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(a,b){this.refEvent&&this.channel._trigger(this.refEvent,{status:a,response:b})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:a,response:b}){this.recHooks.filter(b=>b.status===a).forEach(a=>a.callback(b))}_hasReceived(a){return this.receivedResp&&this.receivedResp.status===a}}!function(a){a.SYNC="sync",a.JOIN="join",a.LEAVE="leave"}(t||(t={}));class a5{constructor(a,b){this.channel=a,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let c=(null==b?void 0:b.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(c.state,{},a=>{let{onJoin:b,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=a5.syncState(this.state,a,b,c),this.pendingDiffs.forEach(a=>{this.state=a5.syncDiff(this.state,a,b,c)}),this.pendingDiffs=[],d()}),this.channel._on(c.diff,{},a=>{let{onJoin:b,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=a5.syncDiff(this.state,a,b,c),d())}),this.onJoin((a,b,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:b,newPresences:c})}),this.onLeave((a,b,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:b,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(a,b,c,d){let e=this.cloneDeep(a),f=this.transformState(b),g={},h={};return this.map(e,(a,b)=>{f[a]||(h[a]=b)}),this.map(f,(a,b)=>{let c=e[a];if(c){let d=b.map(a=>a.presence_ref),e=c.map(a=>a.presence_ref),f=b.filter(a=>0>e.indexOf(a.presence_ref)),i=c.filter(a=>0>d.indexOf(a.presence_ref));f.length>0&&(g[a]=f),i.length>0&&(h[a]=i)}else g[a]=b}),this.syncDiff(e,{joins:g,leaves:h},c,d)}static syncDiff(a,b,c,d){let{joins:e,leaves:f}={joins:this.transformState(b.joins),leaves:this.transformState(b.leaves)};return c||(c=()=>{}),d||(d=()=>{}),this.map(e,(b,d)=>{var e;let f=null!=(e=a[b])?e:[];if(a[b]=this.cloneDeep(d),f.length>0){let c=a[b].map(a=>a.presence_ref),d=f.filter(a=>0>c.indexOf(a.presence_ref));a[b].unshift(...d)}c(b,f,d)}),this.map(f,(b,c)=>{let e=a[b];if(!e)return;let f=c.map(a=>a.presence_ref);e=e.filter(a=>0>f.indexOf(a.presence_ref)),a[b]=e,d(b,e,c),0===e.length&&delete a[b]}),a}static map(a,b){return Object.getOwnPropertyNames(a).map(c=>b(c,a[c]))}static transformState(a){return Object.getOwnPropertyNames(a=this.cloneDeep(a)).reduce((b,c)=>{let d=a[c];return"metas"in d?b[c]=d.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):b[c]=d,b},{})}static cloneDeep(a){return JSON.parse(JSON.stringify(a))}onJoin(a){this.caller.onJoin=a}onLeave(a){this.caller.onLeave=a}onSync(a){this.caller.onSync=a}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(a){a.ALL="*",a.INSERT="INSERT",a.UPDATE="UPDATE",a.DELETE="DELETE"}(u||(u={})),function(a){a.BROADCAST="broadcast",a.PRESENCE="presence",a.POSTGRES_CHANGES="postgres_changes",a.SYSTEM="system"}(v||(v={})),function(a){a.SUBSCRIBED="SUBSCRIBED",a.TIMED_OUT="TIMED_OUT",a.CLOSED="CLOSED",a.CHANNEL_ERROR="CHANNEL_ERROR"}(w||(w={}));class a6{constructor(a,b={config:{}},c){var d,e;if(this.topic=a,this.params=b,this.socket=c,this.bindings={},this.state=o.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=a.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},b.config),this.timeout=this.socket.timeout,this.joinPush=new a4(this,p.join,this.params,this.timeout),this.rejoinTimer=new aV(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=o.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=o.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=o.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=o.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=o.errored,this.rejoinTimer.scheduleTimeout())}),this._on(p.reply,{},(a,b)=>{this._trigger(this._replyEventName(b),a)}),this.presence=new a5(this),this.broadcastEndpointURL=a3(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null==(e=null==(d=this.params.config)?void 0:d.broadcast)?void 0:e.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(a,b=this.timeout){var c,d,e;if(this.socket.isConnected()||this.socket.connect(),this.state==o.closed){let{config:{broadcast:f,presence:g,private:h}}=this.params,i=null!=(d=null==(c=this.bindings.postgres_changes)?void 0:c.map(a=>a.filter))?d:[],j=!!this.bindings[v.PRESENCE]&&this.bindings[v.PRESENCE].length>0||(null==(e=this.params.config.presence)?void 0:e.enabled)===!0,k={},l={broadcast:f,presence:Object.assign(Object.assign({},g),{enabled:j}),postgres_changes:i,private:h};this.socket.accessTokenValue&&(k.access_token=this.socket.accessTokenValue),this._onError(b=>null==a?void 0:a(w.CHANNEL_ERROR,b)),this._onClose(()=>null==a?void 0:a(w.CLOSED)),this.updateJoinPayload(Object.assign({config:l},k)),this.joinedOnce=!0,this._rejoin(b),this.joinPush.receive("ok",async({postgres_changes:b})=>{var c;if(this.socket._isManualToken()||this.socket.setAuth(),void 0===b){null==a||a(w.SUBSCRIBED);return}{let d=this.bindings.postgres_changes,e=null!=(c=null==d?void 0:d.length)?c:0,f=[];for(let c=0;c<e;c++){let e=d[c],{filter:{event:g,schema:h,table:i,filter:j}}=e,k=b&&b[c];if(k&&k.event===g&&a6.isFilterValueEqual(k.schema,h)&&a6.isFilterValueEqual(k.table,i)&&a6.isFilterValueEqual(k.filter,j))f.push(Object.assign(Object.assign({},e),{id:k.id}));else{this.unsubscribe(),this.state=o.errored,null==a||a(w.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,a&&a(w.SUBSCRIBED);return}}).receive("error",b=>{this.state=o.errored,null==a||a(w.CHANNEL_ERROR,Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{null==a||a(w.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(a,b={}){return await this.send({type:"presence",event:"track",payload:a},b.timeout||this.timeout)}async untrack(a={}){return await this.send({type:"presence",event:"untrack"},a)}on(a,b,c){return this.state===o.joined&&a===v.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(a,b,c)}async httpSend(a,b,c={}){var d;if(null==b)return Promise.reject("Payload is required for httpSend()");let e={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(e.Authorization=`Bearer ${this.socket.accessTokenValue}`);let f={method:"POST",headers:e,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:b,private:this.private}]})},g=await this._fetchWithTimeout(this.broadcastEndpointURL,f,null!=(d=c.timeout)?d:this.timeout);if(202===g.status)return{success:!0};let h=g.statusText;try{let a=await g.json();h=a.error||a.message||h}catch(a){}return Promise.reject(Error(h))}async send(a,b={}){var c,d;if(this._canPush()||"broadcast"!==a.type)return new Promise(c=>{var d,e,f;let g=this._push(a.type,a,b.timeout||this.timeout);"broadcast"!==a.type||(null==(f=null==(e=null==(d=this.params)?void 0:d.config)?void 0:e.broadcast)?void 0:f.ack)||c("ok"),g.receive("ok",()=>c("ok")),g.receive("error",()=>c("error")),g.receive("timeout",()=>c("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");let{event:e,payload:f}=a,g={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(g.Authorization=`Bearer ${this.socket.accessTokenValue}`);let h={method:"POST",headers:g,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:f,private:this.private}]})};try{let a=await this._fetchWithTimeout(this.broadcastEndpointURL,h,null!=(c=b.timeout)?c:this.timeout);return await (null==(d=a.body)?void 0:d.cancel()),a.ok?"ok":"error"}catch(a){if("AbortError"===a.name)return"timed out";return"error"}}}updateJoinPayload(a){this.joinPush.updatePayload(a)}unsubscribe(a=this.timeout){this.state=o.leaving;let b=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(p.close,"leave",this._joinRef())};this.joinPush.destroy();let c=null;return new Promise(d=>{(c=new a4(this,p.leave,{},a)).receive("ok",()=>{b(),d("ok")}).receive("timeout",()=>{b(),d("timed out")}).receive("error",()=>{d("error")}),c.send(),this._canPush()||c.trigger("ok",{})}).finally(()=>{null==c||c.destroy()})}teardown(){this.pushBuffer.forEach(a=>a.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=o.closed,this.bindings={}}async _fetchWithTimeout(a,b,c){let d=new AbortController,e=setTimeout(()=>d.abort(),c),f=await this.socket.fetch(a,Object.assign(Object.assign({},b),{signal:d.signal}));return clearTimeout(e),f}_push(a,b,c=this.timeout){if(!this.joinedOnce)throw`tried to push '${a}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let d=new a4(this,a,b,c);return this._canPush()?d.send():this._addToPushBuffer(d),d}_addToPushBuffer(a){if(a.startTimeout(),this.pushBuffer.push(a),this.pushBuffer.length>100){let a=this.pushBuffer.shift();a&&(a.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${a.event}`,a.payload))}}_onMessage(a,b,c){return b}_isMember(a){return this.topic===a}_joinRef(){return this.joinPush.ref}_trigger(a,b,c){var d,e;let f=a.toLocaleLowerCase(),{close:g,error:h,leave:i,join:j}=p;if(c&&[g,h,i,j].indexOf(f)>=0&&c!==this._joinRef())return;let k=this._onMessage(f,b,c);if(b&&!k)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(f)?null==(d=this.bindings.postgres_changes)||d.filter(a=>{var b,c,d;return(null==(b=a.filter)?void 0:b.event)==="*"||(null==(d=null==(c=a.filter)?void 0:c.event)?void 0:d.toLocaleLowerCase())===f}).map(a=>a.callback(k,c)):null==(e=this.bindings[f])||e.filter(a=>{var c,d,e,g,h,i;if(!["broadcast","presence","postgres_changes"].includes(f))return a.type.toLocaleLowerCase()===f;if("id"in a){let f=a.id,g=null==(c=a.filter)?void 0:c.event;return f&&(null==(d=b.ids)?void 0:d.includes(f))&&("*"===g||(null==g?void 0:g.toLocaleLowerCase())===(null==(e=b.data)?void 0:e.type.toLocaleLowerCase()))}{let c=null==(h=null==(g=null==a?void 0:a.filter)?void 0:g.event)?void 0:h.toLocaleLowerCase();return"*"===c||c===(null==(i=null==b?void 0:b.event)?void 0:i.toLocaleLowerCase())}}).map(a=>{if("object"==typeof k&&"ids"in k){let a=k.data,{schema:b,table:c,commit_timestamp:d,type:e,errors:f}=a;k=Object.assign(Object.assign({},{schema:b,table:c,commit_timestamp:d,eventType:e,new:{},old:{},errors:f}),this._getPayloadRecords(a))}a.callback(k,c)})}_isClosed(){return this.state===o.closed}_isJoined(){return this.state===o.joined}_isJoining(){return this.state===o.joining}_isLeaving(){return this.state===o.leaving}_replyEventName(a){return`chan_reply_${a}`}_on(a,b,c){let d=a.toLocaleLowerCase(),e={type:d,filter:b,callback:c};return this.bindings[d]?this.bindings[d].push(e):this.bindings[d]=[e],this}_off(a,b){let c=a.toLocaleLowerCase();return this.bindings[c]&&(this.bindings[c]=this.bindings[c].filter(a=>{var d;return!((null==(d=a.type)?void 0:d.toLocaleLowerCase())===c&&a6.isEqual(a.filter,b))})),this}static isEqual(a,b){if(Object.keys(a).length!==Object.keys(b).length)return!1;for(let c in a)if(a[c]!==b[c])return!1;return!0}static isFilterValueEqual(a,b){return(null!=a?a:void 0)===(null!=b?b:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(a){this._on(p.close,{},a)}_onError(a){this._on(p.error,{},b=>a(b))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(a=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=o.joining,this.joinPush.resend(a))}_getPayloadRecords(a){let b={new:{},old:{}};return("INSERT"===a.type||"UPDATE"===a.type)&&(b.new=aW(a.columns,a.record)),("UPDATE"===a.type||"DELETE"===a.type)&&(b.old=aW(a.columns,a.old_record)),b}}let a7=()=>{},a8={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},a9=[1e3,2e3,5e3,1e4],ba=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bb{constructor(a,b){var c;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=a8.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=a7,this.ref=0,this.reconnectTimer=null,this.vsn=aT,this.logger=a7,this.conn=null,this.sendBuffer=[],this.serializer=new aU,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>a?(...b)=>a(...b):(...a)=>fetch(...a),!(null==(c=null==b?void 0:b.params)?void 0:c.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=b.params.apikey,this.endPoint=`${a}/${q.websocket}`,this.httpEndpoint=a3(a),this._initializeOptions(b),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==b?void 0:b.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=aS.createWebSocket(this.endpointURL())}catch(b){this._setConnectionState("disconnected");let a=b.message;if(a.includes("Node.js"))throw Error(`${a}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${a}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(a,b){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let c=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(c),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(a?this.conn.close(a,null!=b?b:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(a){let b=await a.unsubscribe();return 0===this.channels.length&&this.disconnect(),b}async removeAllChannels(){let a=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.channels=[],this.disconnect(),a}log(a,b,c){this.logger(a,b,c)}connectionState(){switch(this.conn&&this.conn.readyState){case m.connecting:return r.Connecting;case m.open:return r.Open;case m.closing:return r.Closing;default:return r.Closed}}isConnected(){return this.connectionState()===r.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(a,b={config:{}}){let c=`realtime:${a}`,d=this.getChannels().find(a=>a.topic===c);if(d)return d;{let c=new a6(`realtime:${a}`,b,this);return this.channels.push(c),c}}push(a){let{topic:b,event:c,payload:d,ref:e}=a,f=()=>{this.encode(a,a=>{var b;null==(b=this.conn)||b.send(a)})};this.log("push",`${b} ${c} (${e})`,d),this.isConnected()?f():this.sendBuffer.push(f)}async setAuth(a=null){this._authPromise=this._performAuth(a);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var a;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(a){this.log("error","error in heartbeat callback",a)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(a){this.log("error","error in heartbeat callback",a)}this._wasManualDisconnect=!1,null==(a=this.conn)||a.close(1e3,"heartbeat timeout"),setTimeout(()=>{var a;this.isConnected()||null==(a=this.reconnectTimer)||a.scheduleTimeout()},a8.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(a){this.log("error","error in heartbeat callback",a)}this._setAuthSafely("heartbeat")}onHeartbeat(a){this.heartbeatCallback=a}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(a=>a()),this.sendBuffer=[])}_makeRef(){let a=this.ref+1;return a===this.ref?this.ref=0:this.ref=a,this.ref.toString()}_leaveOpenTopic(a){let b=this.channels.find(b=>b.topic===a&&(b._isJoined()||b._isJoining()));b&&(this.log("transport",`leaving duplicate topic "${a}"`),b.unsubscribe())}_remove(a){this.channels=this.channels.filter(b=>b.topic!==a.topic)}_onConnMessage(a){this.decode(a.data,a=>{if("phoenix"===a.topic&&"phx_reply"===a.event)try{this.heartbeatCallback("ok"===a.payload.status?"ok":"error")}catch(a){this.log("error","error in heartbeat callback",a)}a.ref&&a.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);let{topic:b,event:c,payload:d,ref:e}=a,f=e?`(${e})`:"",g=d.status||"";this.log("receive",`${g} ${b} ${c} ${f}`.trim(),d),this.channels.filter(a=>a._isMember(b)).forEach(a=>a._trigger(c,d,e)),this._triggerStateCallbacks("message",a)})}_clearTimer(a){var b;"heartbeat"===a&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===a&&(null==(b=this.reconnectTimer)||b.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=a=>this._onConnError(a),this.conn.onmessage=a=>this._onConnMessage(a),this.conn.onclose=a=>this._onConnClose(a),this.conn.readyState===m.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===m.open||this.conn.readyState===m.connecting)try{this.conn.close()}catch(a){this.log("error","Error closing connection",a)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(a=>a.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(a=>{this.log("error","error waiting for auth on connect",a),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let a=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(a),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this._terminateWorker()},this.workerRef.onmessage=a=>{"keepAlive"===a.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(a){var b;this._setConnectionState("disconnected"),this.log("transport","close",a),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null==(b=this.reconnectTimer)||b.scheduleTimeout(),this._triggerStateCallbacks("close",a)}_onConnError(a){this._setConnectionState("disconnected"),this.log("transport",`${a}`),this._triggerChanError(),this._triggerStateCallbacks("error",a)}_triggerChanError(){this.channels.forEach(a=>a._trigger(p.error))}_appendParams(a,b){if(0===Object.keys(b).length)return a;let c=a.match(/\?/)?"&":"?",d=new URLSearchParams(b);return`${a}${c}${d}`}_workerObjectUrl(a){let b;if(a)b=a;else{let a=new Blob([ba],{type:"application/javascript"});b=URL.createObjectURL(a)}return b}_setConnectionState(a,b=!1){this._connectionState=a,"connecting"===a?this._wasManualDisconnect=!1:"disconnecting"===a&&(this._wasManualDisconnect=b)}async _performAuth(a=null){let b,c=!1;if(a)b=a,c=!0;else if(this.accessToken)try{b=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),b=this.accessTokenValue}else b=this.accessTokenValue;c?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=b&&(this.accessTokenValue=b,this.channels.forEach(a=>{let c={access_token:b,version:"realtime-js/2.89.0"};b&&a.updateJoinPayload(c),a.joinedOnce&&a._isJoined()&&a._push(p.access_token,{access_token:b})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(a="general"){this._isManualToken()||this.setAuth().catch(b=>{this.log("error",`Error setting auth in ${a}`,b)})}_triggerStateCallbacks(a,b){try{this.stateChangeCallbacks[a].forEach(c=>{try{c(b)}catch(b){this.log("error",`error in ${a} callback`,b)}})}catch(b){this.log("error",`error triggering ${a} callbacks`,b)}}_setupReconnectionTimer(){this.reconnectTimer=new aV(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},a8.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(a){var b,c,d,e,f,g,h,i,j,k,l,m;switch(this.transport=null!=(b=null==a?void 0:a.transport)?b:null,this.timeout=null!=(c=null==a?void 0:a.timeout)?c:1e4,this.heartbeatIntervalMs=null!=(d=null==a?void 0:a.heartbeatIntervalMs)?d:a8.HEARTBEAT_INTERVAL,this.worker=null!=(e=null==a?void 0:a.worker)&&e,this.accessToken=null!=(f=null==a?void 0:a.accessToken)?f:null,this.heartbeatCallback=null!=(g=null==a?void 0:a.heartbeatCallback)?g:a7,this.vsn=null!=(h=null==a?void 0:a.vsn)?h:aT,(null==a?void 0:a.params)&&(this.params=a.params),(null==a?void 0:a.logger)&&(this.logger=a.logger),((null==a?void 0:a.logLevel)||(null==a?void 0:a.log_level))&&(this.logLevel=a.logLevel||a.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!=(i=null==a?void 0:a.reconnectAfterMs)?i:a=>a9[a-1]||1e4,this.vsn){case aT:this.encode=null!=(j=null==a?void 0:a.encode)?j:(a,b)=>b(JSON.stringify(a)),this.decode=null!=(k=null==a?void 0:a.decode)?k:(a,b)=>b(JSON.parse(a));break;case"2.0.0":this.encode=null!=(l=null==a?void 0:a.encode)?l:this.serializer.encode.bind(this.serializer),this.decode=null!=(m=null==a?void 0:a.decode)?m:this.serializer.decode.bind(this.serializer);break;default:throw Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.workerUrl=null==a?void 0:a.workerUrl}}}var bc=class extends Error{constructor(a,b){super(a),this.name="IcebergError",this.status=b.status,this.icebergType=b.icebergType,this.icebergCode=b.icebergCode,this.details=b.details,this.isCommitStateUnknown="CommitStateUnknownException"===b.icebergType||[500,502,504].includes(b.status)&&b.icebergType?.includes("CommitState")===!0}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};async function bd(a){return a&&"none"!==a.type?"bearer"===a.type?{Authorization:`Bearer ${a.token}`}:"header"===a.type?{[a.name]:a.value}:"custom"===a.type?await a.getHeaders():{}:{}}function be(a){return a.join("\x1f")}var bf=class{constructor(a,b=""){this.client=a,this.prefix=b}async listNamespaces(a){let b=a?{parent:be(a.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:b})).data.namespaces.map(a=>({namespace:a}))}async createNamespace(a,b){let c={namespace:a.namespace,properties:b?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:c})).data}async dropNamespace(a){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${be(a.namespace)}`})}async loadNamespaceMetadata(a){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${be(a.namespace)}`})).data.properties}}async namespaceExists(a){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${be(a.namespace)}`}),!0}catch(a){if(a instanceof bc&&404===a.status)return!1;throw a}}async createNamespaceIfNotExists(a,b){try{return await this.createNamespace(a,b)}catch(a){if(a instanceof bc&&409===a.status)return;throw a}}};function bg(a){return a.join("\x1f")}var bh=class{constructor(a,b="",c){this.client=a,this.prefix=b,this.accessDelegation=c}async listTables(a){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bg(a.namespace)}/tables`})).data.identifiers}async createTable(a,b){let c={};return this.accessDelegation&&(c["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bg(a.namespace)}/tables`,body:b,headers:c})).data.metadata}async updateTable(a,b){let c=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bg(a.namespace)}/tables/${a.name}`,body:b});return{"metadata-location":c.data["metadata-location"],metadata:c.data.metadata}}async dropTable(a,b){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${bg(a.namespace)}/tables/${a.name}`,query:{purgeRequested:String(b?.purge??!1)}})}async loadTable(a){let b={};return this.accessDelegation&&(b["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bg(a.namespace)}/tables/${a.name}`,headers:b})).data.metadata}async tableExists(a){let b={};this.accessDelegation&&(b["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${bg(a.namespace)}/tables/${a.name}`,headers:b}),!0}catch(a){if(a instanceof bc&&404===a.status)return!1;throw a}}async createTableIfNotExists(a,b){try{return await this.createTable(a,b)}catch(c){if(c instanceof bc&&409===c.status)return await this.loadTable({namespace:a.namespace,name:b.name});throw c}}},bi=class{constructor(a){let b="v1";a.catalogName&&(b+=`/${a.catalogName}`);let c=a.baseUrl.endsWith("/")?a.baseUrl:`${a.baseUrl}/`;this.client=function(a){let b=a.fetchImpl??globalThis.fetch;return{async request({method:c,path:d,query:e,body:f,headers:g}){let h=function(a,b,c){let d=new URL(b,a);if(c)for(let[a,b]of Object.entries(c))void 0!==b&&d.searchParams.set(a,b);return d.toString()}(a.baseUrl,d,e),i=await bd(a.auth),j=await b(h,{method:c,headers:{...f?{"Content-Type":"application/json"}:{},...i,...g},body:f?JSON.stringify(f):void 0}),k=await j.text(),l=(j.headers.get("content-type")||"").includes("application/json"),m=l&&k?JSON.parse(k):k;if(!j.ok){let a=l?m:void 0,b=a?.error;throw new bc(b?.message??`Request failed with status ${j.status}`,{status:j.status,icebergType:b?.type,icebergCode:b?.code,details:a})}return{status:j.status,headers:j.headers,data:m}}}}({baseUrl:c,auth:a.auth,fetchImpl:a.fetch}),this.accessDelegation=a.accessDelegation?.join(","),this.namespaceOps=new bf(this.client,b),this.tableOps=new bh(this.client,b,this.accessDelegation)}async listNamespaces(a){return this.namespaceOps.listNamespaces(a)}async createNamespace(a,b){return this.namespaceOps.createNamespace(a,b)}async dropNamespace(a){await this.namespaceOps.dropNamespace(a)}async loadNamespaceMetadata(a){return this.namespaceOps.loadNamespaceMetadata(a)}async listTables(a){return this.tableOps.listTables(a)}async createTable(a,b){return this.tableOps.createTable(a,b)}async updateTable(a,b){return this.tableOps.updateTable(a,b)}async dropTable(a,b){await this.tableOps.dropTable(a,b)}async loadTable(a){return this.tableOps.loadTable(a)}async namespaceExists(a){return this.namespaceOps.namespaceExists(a)}async tableExists(a){return this.tableOps.tableExists(a)}async createNamespaceIfNotExists(a,b){return this.namespaceOps.createNamespaceIfNotExists(a,b)}async createTableIfNotExists(a,b){return this.tableOps.createTableIfNotExists(a,b)}},bj=class extends Error{constructor(a){super(a),this.__isStorageError=!0,this.name="StorageError"}};function bk(a){return"object"==typeof a&&null!==a&&"__isStorageError"in a}var bl=class extends bj{constructor(a,b,c){super(a),this.name="StorageApiError",this.status=b,this.statusCode=c}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},bm=class extends bj{constructor(a,b){super(a),this.name="StorageUnknownError",this.originalError=b}};let bn=a=>a?(...b)=>a(...b):(...a)=>fetch(...a),bo=a=>{if(Array.isArray(a))return a.map(a=>bo(a));if("function"==typeof a||a!==Object(a))return a;let b={};return Object.entries(a).forEach(([a,c])=>{b[a.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""))]=bo(c)}),b};function bp(a){return(bp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function bq(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function br(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?bq(Object(c),!0).forEach(function(b){!function(a,b,c){var d;(d=function(a,b){if("object"!=bp(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=bp(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(b,"string"),(b="symbol"==bp(d)?d:d+"")in a)?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c}(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):bq(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}let bs=a=>{var b;return a.msg||a.message||a.error_description||("string"==typeof a.error?a.error:null==(b=a.error)?void 0:b.message)||JSON.stringify(a)},bt=async(a,b,c)=>{a instanceof await Response&&!(null==c?void 0:c.noResolveJson)?a.json().then(c=>{let d=a.status||500,e=(null==c?void 0:c.statusCode)||d+"";b(new bl(bs(c),d,e))}).catch(a=>{b(new bm(bs(a),a))}):b(new bm(bs(a),a))};async function bu(a,b,c,d,e,f){return new Promise((g,h)=>{a(c,((a,b,c,d)=>{let e={method:a,headers:(null==b?void 0:b.headers)||{}};return"GET"!==a&&d?((a=>{if("object"!=typeof a||null===a)return!1;let b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)})(d)?(e.headers=br({"Content-Type":"application/json"},null==b?void 0:b.headers),e.body=JSON.stringify(d)):e.body=d,(null==b?void 0:b.duplex)&&(e.duplex=b.duplex),br(br({},e),c)):e})(b,d,e,f)).then(a=>{if(!a.ok)throw a;return(null==d?void 0:d.noResolveJson)?a:a.json()}).then(a=>g(a)).catch(a=>bt(a,h,d))})}async function bv(a,b,c,d){return bu(a,"GET",b,c,d)}async function bw(a,b,c,d,e){return bu(a,"POST",b,d,e,c)}async function bx(a,b,c,d,e){return bu(a,"PUT",b,d,e,c)}async function by(a,b,c,d){return bu(a,"HEAD",b,br(br({},c),{},{noResolveJson:!0}),d)}async function bz(a,b,c,d,e){return bu(a,"DELETE",b,d,e,c)}var bA=class{constructor(a,b){this.downloadFn=a,this.shouldThrowOnError=b}then(a,b){return this.execute().then(a,b)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}};d=Symbol.toStringTag;var bB=class{constructor(a,b){this.downloadFn=a,this.shouldThrowOnError=b,this[d]="BlobDownloadBuilder",this.promise=null}asStream(){return new bA(this.downloadFn,this.shouldThrowOnError)}then(a,b){return this.getPromise().then(a,b)}catch(a){return this.getPromise().catch(a)}finally(a){return this.getPromise().finally(a)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await (await this.downloadFn()).blob(),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}};let bC={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},bD={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var bE=class{constructor(a,b={},c,d){this.shouldThrowOnError=!1,this.url=a,this.headers=b,this.bucketId=c,this.fetch=bn(d)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(a,b,c,d){try{let e,f=br(br({},bD),d),g=br(br({},this.headers),"POST"===a&&{"x-upsert":String(f.upsert)}),h=f.metadata;"undefined"!=typeof Blob&&c instanceof Blob?((e=new FormData).append("cacheControl",f.cacheControl),h&&e.append("metadata",this.encodeMetadata(h)),e.append("",c)):"undefined"!=typeof FormData&&c instanceof FormData?((e=c).has("cacheControl")||e.append("cacheControl",f.cacheControl),h&&!e.has("metadata")&&e.append("metadata",this.encodeMetadata(h))):(e=c,g["cache-control"]=`max-age=${f.cacheControl}`,g["content-type"]=f.contentType,h&&(g["x-metadata"]=this.toBase64(this.encodeMetadata(h))),("undefined"!=typeof ReadableStream&&e instanceof ReadableStream||e&&"object"==typeof e&&"pipe"in e&&"function"==typeof e.pipe)&&!f.duplex&&(f.duplex="half")),(null==d?void 0:d.headers)&&(g=br(br({},g),d.headers));let i=this._removeEmptyFolders(b),j=this._getFinalPath(i),k=await ("PUT"==a?bx:bw)(this.fetch,`${this.url}/object/${j}`,e,br({headers:g},(null==f?void 0:f.duplex)?{duplex:f.duplex}:{}));return{data:{path:i,id:k.Id,fullPath:k.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async upload(a,b,c){return this.uploadOrUpdate("POST",a,b,c)}async uploadToSignedUrl(a,b,c,d){let e=this._removeEmptyFolders(a),f=this._getFinalPath(e),g=new URL(this.url+`/object/upload/sign/${f}`);g.searchParams.set("token",b);try{let a,b=br({upsert:bD.upsert},d),f=br(br({},this.headers),{"x-upsert":String(b.upsert)});return"undefined"!=typeof Blob&&c instanceof Blob?((a=new FormData).append("cacheControl",b.cacheControl),a.append("",c)):"undefined"!=typeof FormData&&c instanceof FormData?(a=c).append("cacheControl",b.cacheControl):(a=c,f["cache-control"]=`max-age=${b.cacheControl}`,f["content-type"]=b.contentType),{data:{path:e,fullPath:(await bx(this.fetch,g.toString(),a,{headers:f})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async createSignedUploadUrl(a,b){try{let c=this._getFinalPath(a),d=br({},this.headers);(null==b?void 0:b.upsert)&&(d["x-upsert"]="true");let e=await bw(this.fetch,`${this.url}/object/upload/sign/${c}`,{},{headers:d}),f=new URL(this.url+e.url),g=f.searchParams.get("token");if(!g)throw new bj("No token returned by API");return{data:{signedUrl:f.toString(),path:a,token:g},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async update(a,b,c){return this.uploadOrUpdate("PUT",a,b,c)}async move(a,b,c){try{return{data:await bw(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:a,destinationKey:b,destinationBucket:null==c?void 0:c.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async copy(a,b,c){try{return{data:{path:(await bw(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:a,destinationKey:b,destinationBucket:null==c?void 0:c.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async createSignedUrl(a,b,c){try{let d=this._getFinalPath(a),e=await bw(this.fetch,`${this.url}/object/sign/${d}`,br({expiresIn:b},(null==c?void 0:c.transform)?{transform:c.transform}:{}),{headers:this.headers}),f=(null==c?void 0:c.download)?`&download=${!0===c.download?"":c.download}`:"";return{data:e={signedUrl:encodeURI(`${this.url}${e.signedURL}${f}`)},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async createSignedUrls(a,b,c){var d=this;try{let e=await bw(d.fetch,`${d.url}/object/sign/${d.bucketId}`,{expiresIn:b,paths:a},{headers:d.headers}),f=(null==c?void 0:c.download)?`&download=${!0===c.download?"":c.download}`:"";return{data:e.map(a=>br(br({},a),{},{signedUrl:a.signedURL?encodeURI(`${d.url}${a.signedURL}${f}`):null})),error:null}}catch(a){if(d.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}download(a,b){let c=void 0!==(null==b?void 0:b.transform)?"render/image/authenticated":"object",d=this.transformOptsToQueryString((null==b?void 0:b.transform)||{}),e=d?`?${d}`:"",f=this._getFinalPath(a);return new bB(()=>bv(this.fetch,`${this.url}/${c}/${f}${e}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(a){let b=this._getFinalPath(a);try{return{data:bo(await bv(this.fetch,`${this.url}/object/info/${b}`,{headers:this.headers})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async exists(a){let b=this._getFinalPath(a);try{return await by(this.fetch,`${this.url}/object/${b}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a)&&a instanceof bm){let b=a.originalError;if([400,404].includes(null==b?void 0:b.status))return{data:!1,error:a}}throw a}}getPublicUrl(a,b){let c=this._getFinalPath(a),d=[],e=(null==b?void 0:b.download)?`download=${!0===b.download?"":b.download}`:"";""!==e&&d.push(e);let f=void 0!==(null==b?void 0:b.transform)?"render/image":"object",g=this.transformOptsToQueryString((null==b?void 0:b.transform)||{});""!==g&&d.push(g);let h=d.join("&");return""!==h&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${c}${h}`)}}}async remove(a){try{return{data:await bz(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:a},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async list(a,b,c){try{let d=br(br(br({},bC),b),{},{prefix:a||""});return{data:await bw(this.fetch,`${this.url}/object/list/${this.bucketId}`,d,{headers:this.headers},c),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async listV2(a,b){try{let c=br({},a);return{data:await bw(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,c,{headers:this.headers},b),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}encodeMetadata(a){return JSON.stringify(a)}toBase64(a){return"undefined"!=typeof Buffer?Buffer.from(a).toString("base64"):btoa(a)}_getFinalPath(a){return`${this.bucketId}/${a.replace(/^\/+/,"")}`}_removeEmptyFolders(a){return a.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(a){let b=[];return a.width&&b.push(`width=${a.width}`),a.height&&b.push(`height=${a.height}`),a.resize&&b.push(`resize=${a.resize}`),a.format&&b.push(`format=${a.format}`),a.quality&&b.push(`quality=${a.quality}`),b.join("&")}};let bF="2.89.0",bG={"X-Client-Info":`storage-js/${bF}`};var bH=class{constructor(a,b={},c,d){this.shouldThrowOnError=!1;let e=new URL(a);(null==d?void 0:d.useNewHostname)&&/supabase\.(co|in|red)$/.test(e.hostname)&&!e.hostname.includes("storage.supabase.")&&(e.hostname=e.hostname.replace("supabase.","storage.supabase.")),this.url=e.href.replace(/\/$/,""),this.headers=br(br({},bG),b),this.fetch=bn(c)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(a){try{let b=this.listBucketOptionsToQueryString(a);return{data:await bv(this.fetch,`${this.url}/bucket${b}`,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async getBucket(a){try{return{data:await bv(this.fetch,`${this.url}/bucket/${a}`,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async createBucket(a,b={public:!1}){try{return{data:await bw(this.fetch,`${this.url}/bucket`,{id:a,name:a,type:b.type,public:b.public,file_size_limit:b.fileSizeLimit,allowed_mime_types:b.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async updateBucket(a,b){try{return{data:await bx(this.fetch,`${this.url}/bucket/${a}`,{id:a,name:a,public:b.public,file_size_limit:b.fileSizeLimit,allowed_mime_types:b.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async emptyBucket(a){try{return{data:await bw(this.fetch,`${this.url}/bucket/${a}/empty`,{},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async deleteBucket(a){try{return{data:await bz(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}listBucketOptionsToQueryString(a){let b={};return a&&("limit"in a&&(b.limit=String(a.limit)),"offset"in a&&(b.offset=String(a.offset)),a.search&&(b.search=a.search),a.sortColumn&&(b.sortColumn=a.sortColumn),a.sortOrder&&(b.sortOrder=a.sortOrder)),Object.keys(b).length>0?"?"+new URLSearchParams(b).toString():""}},bI=class{constructor(a,b={},c){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=br(br({},bG),b),this.fetch=bn(c)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(a){try{return{data:await bw(this.fetch,`${this.url}/bucket`,{name:a},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async listBuckets(a){try{let b=new URLSearchParams;(null==a?void 0:a.limit)!==void 0&&b.set("limit",a.limit.toString()),(null==a?void 0:a.offset)!==void 0&&b.set("offset",a.offset.toString()),(null==a?void 0:a.sortColumn)&&b.set("sortColumn",a.sortColumn),(null==a?void 0:a.sortOrder)&&b.set("sortOrder",a.sortOrder),(null==a?void 0:a.search)&&b.set("search",a.search);let c=b.toString(),d=c?`${this.url}/bucket?${c}`:`${this.url}/bucket`;return{data:await bv(this.fetch,d,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}async deleteBucket(a){try{return{data:await bz(this.fetch,`${this.url}/bucket/${a}`,{},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bk(a))return{data:null,error:a};throw a}}from(a){var b=this;if(!(!(!a||"string"!=typeof a||0===a.length||a.length>100||a.trim()!==a||a.includes("/")||a.includes("\\"))&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(a)))throw new bj("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");let c=new bi({baseUrl:this.url,catalogName:a,auth:{type:"custom",getHeaders:async()=>b.headers},fetch:this.fetch}),d=this.shouldThrowOnError;return new Proxy(c,{get(a,b){let c=a[b];return"function"!=typeof c?c:async(...b)=>{try{return{data:await c.apply(a,b),error:null}}catch(a){if(d)throw a;return{data:null,error:a}}}}})}};let bJ={"X-Client-Info":`storage-js/${bF}`,"Content-Type":"application/json"};var bK=class extends Error{constructor(a){super(a),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function bL(a){return"object"==typeof a&&null!==a&&"__isStorageVectorsError"in a}var bM=class extends bK{constructor(a,b,c){super(a),this.name="StorageVectorsApiError",this.status=b,this.statusCode=c}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},bN=class extends bK{constructor(a,b){super(a),this.name="StorageVectorsUnknownError",this.originalError=b}};let bO=a=>a?(...b)=>a(...b):(...a)=>fetch(...a),bP=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),bQ=async(a,b,c)=>{if(a&&"object"==typeof a&&"status"in a&&"ok"in a&&"number"==typeof a.status&&!(null==c?void 0:c.noResolveJson)){let c=a.status||500;"function"==typeof a.json?a.json().then(a=>{let d=(null==a?void 0:a.statusCode)||(null==a?void 0:a.code)||c+"";b(new bM(bP(a),c,d))}).catch(()=>{b(new bM(a.statusText||`HTTP ${c} error`,c,c+""))}):b(new bM(a.statusText||`HTTP ${c} error`,c,c+""))}else b(new bN(bP(a),a))};async function bR(a,b,c,d,e,f){return new Promise((g,h)=>{a(c,((a,b,c,d)=>{let e={method:a,headers:(null==b?void 0:b.headers)||{}};return"GET"!==a&&d?((a=>{if("object"!=typeof a||null===a)return!1;let b=Object.getPrototypeOf(a);return(null===b||b===Object.prototype||null===Object.getPrototypeOf(b))&&!(Symbol.toStringTag in a)&&!(Symbol.iterator in a)})(d)?(e.headers=br({"Content-Type":"application/json"},null==b?void 0:b.headers),e.body=JSON.stringify(d)):e.body=d,br(br({},e),c)):e})(b,d,e,f)).then(a=>{if(!a.ok)throw a;if(null==d?void 0:d.noResolveJson)return a;let b=a.headers.get("content-type");return b&&b.includes("application/json")?a.json():{}}).then(a=>g(a)).catch(a=>bQ(a,h,d))})}async function bS(a,b,c,d,e){return bR(a,"POST",b,d,e,c)}var bT=class{constructor(a,b={},c){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=br(br({},bJ),b),this.fetch=bO(c)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(a){try{return{data:await bS(this.fetch,`${this.url}/CreateIndex`,a,{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}async getIndex(a,b){try{return{data:await bS(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:a,indexName:b},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}async listIndexes(a){try{return{data:await bS(this.fetch,`${this.url}/ListIndexes`,a,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}async deleteIndex(a,b){try{return{data:await bS(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:a,indexName:b},{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}},bU=class{constructor(a,b={},c){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=br(br({},bJ),b),this.fetch=bO(c)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(a){try{if(a.vectors.length<1||a.vectors.length>500)throw Error("Vector batch size must be between 1 and 500 items");return{data:await bS(this.fetch,`${this.url}/PutVectors`,a,{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}async getVectors(a){try{return{data:await bS(this.fetch,`${this.url}/GetVectors`,a,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}async listVectors(a){try{if(void 0!==a.segmentCount){if(a.segmentCount<1||a.segmentCount>16)throw Error("segmentCount must be between 1 and 16");if(void 0!==a.segmentIndex&&(a.segmentIndex<0||a.segmentIndex>=a.segmentCount))throw Error(`segmentIndex must be between 0 and ${a.segmentCount-1}`)}return{data:await bS(this.fetch,`${this.url}/ListVectors`,a,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}async queryVectors(a){try{return{data:await bS(this.fetch,`${this.url}/QueryVectors`,a,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}async deleteVectors(a){try{if(a.keys.length<1||a.keys.length>500)throw Error("Keys batch size must be between 1 and 500 items");return{data:await bS(this.fetch,`${this.url}/DeleteVectors`,a,{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}},bV=class{constructor(a,b={},c){this.shouldThrowOnError=!1,this.url=a.replace(/\/$/,""),this.headers=br(br({},bJ),b),this.fetch=bO(c)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(a){try{return{data:await bS(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:a},{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}async getBucket(a){try{return{data:await bS(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:a},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}async listBuckets(a={}){try{return{data:await bS(this.fetch,`${this.url}/ListVectorBuckets`,a,{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}async deleteBucket(a){try{return{data:await bS(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:a},{headers:this.headers})||{},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(bL(a))return{data:null,error:a};throw a}}},bW=class extends bV{constructor(a,b={}){super(a,b.headers||{},b.fetch)}from(a){return new bX(this.url,this.headers,a,this.fetch)}async createBucket(a){return super.createBucket.call(this,a)}async getBucket(a){return super.getBucket.call(this,a)}async listBuckets(a={}){return super.listBuckets.call(this,a)}async deleteBucket(a){return super.deleteBucket.call(this,a)}},bX=class extends bT{constructor(a,b,c,d){super(a,b,d),this.vectorBucketName=c}async createIndex(a){return super.createIndex.call(this,br(br({},a),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(a={}){return super.listIndexes.call(this,br(br({},a),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(a){return super.getIndex.call(this,this.vectorBucketName,a)}async deleteIndex(a){return super.deleteIndex.call(this,this.vectorBucketName,a)}index(a){return new bY(this.url,this.headers,this.vectorBucketName,a,this.fetch)}},bY=class extends bU{constructor(a,b,c,d,e){super(a,b,e),this.vectorBucketName=c,this.indexName=d}async putVectors(a){return super.putVectors.call(this,br(br({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async getVectors(a){return super.getVectors.call(this,br(br({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async listVectors(a={}){return super.listVectors.call(this,br(br({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async queryVectors(a){return super.queryVectors.call(this,br(br({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async deleteVectors(a){return super.deleteVectors.call(this,br(br({},a),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}},bZ=class extends bH{constructor(a,b={},c,d){super(a,b,c,d)}from(a){return new bE(this.url,this.headers,a,this.fetch)}get vectors(){return new bW(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new bI(this.url+"/iceberg",this.headers,this.fetch)}};let b$="2.89.0",b_={"X-Client-Info":`gotrue-js/${b$}`},b0="X-Supabase-Api-Version",b1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},b2=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class b3 extends Error{constructor(a,b,c){super(a),this.__isAuthError=!0,this.name="AuthError",this.status=b,this.code=c}}function b4(a){return"object"==typeof a&&null!==a&&"__isAuthError"in a}class b5 extends b3{constructor(a,b,c){super(a,b,c),this.name="AuthApiError",this.status=b,this.code=c}}class b6 extends b3{constructor(a,b){super(a),this.name="AuthUnknownError",this.originalError=b}}class b7 extends b3{constructor(a,b,c,d){super(a,c,d),this.name=b,this.status=c}}class b8 extends b7{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class b9 extends b7{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ca extends b7{constructor(a){super(a,"AuthInvalidCredentialsError",400,void 0)}}class cb extends b7{constructor(a,b=null){super(a,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=b}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cc extends b7{constructor(a,b=null){super(a,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=b}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class cd extends b7{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class ce extends b7{constructor(a,b){super(a,"AuthRetryableFetchError",b,void 0)}}function cf(a){return b4(a)&&"AuthRetryableFetchError"===a.name}class cg extends b7{constructor(a,b,c){super(a,"AuthWeakPasswordError",b,"weak_password"),this.reasons=c}}class ch extends b7{constructor(a){super(a,"AuthInvalidJwtError",400,"invalid_jwt")}}let ci="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),cj=" 	\n\r=".split(""),ck=(()=>{let a=Array(128);for(let b=0;b<a.length;b+=1)a[b]=-1;for(let b=0;b<cj.length;b+=1)a[cj[b].charCodeAt(0)]=-2;for(let b=0;b<ci.length;b+=1)a[ci[b].charCodeAt(0)]=b;return a})();function cl(a,b,c){if(null!==a)for(b.queue=b.queue<<8|a,b.queuedBits+=8;b.queuedBits>=6;)c(ci[b.queue>>b.queuedBits-6&63]),b.queuedBits-=6;else if(b.queuedBits>0)for(b.queue=b.queue<<6-b.queuedBits,b.queuedBits=6;b.queuedBits>=6;)c(ci[b.queue>>b.queuedBits-6&63]),b.queuedBits-=6}function cm(a,b,c){let d=ck[a];if(d>-1)for(b.queue=b.queue<<6|d,b.queuedBits+=6;b.queuedBits>=8;)c(b.queue>>b.queuedBits-8&255),b.queuedBits-=8;else if(-2===d)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(a)}"`)}function cn(a){let b=[],c=a=>{b.push(String.fromCodePoint(a))},d={utf8seq:0,codepoint:0},e={queue:0,queuedBits:0},f=a=>{!function(a,b,c){if(0===b.utf8seq){if(a<=127)return c(a);for(let c=1;c<6;c+=1)if((a>>7-c&1)==0){b.utf8seq=c;break}if(2===b.utf8seq)b.codepoint=31&a;else if(3===b.utf8seq)b.codepoint=15&a;else if(4===b.utf8seq)b.codepoint=7&a;else throw Error("Invalid UTF-8 sequence");b.utf8seq-=1}else if(b.utf8seq>0){if(a<=127)throw Error("Invalid UTF-8 sequence");b.codepoint=b.codepoint<<6|63&a,b.utf8seq-=1,0===b.utf8seq&&c(b.codepoint)}}(a,d,c)};for(let b=0;b<a.length;b+=1)cm(a.charCodeAt(b),e,f);return b.join("")}function co(a){let b=[],c={queue:0,queuedBits:0},d=a=>{b.push(a)};for(let b=0;b<a.length;b+=1)cm(a.charCodeAt(b),c,d);return new Uint8Array(b)}function cp(a){let b=[],c={queue:0,queuedBits:0},d=a=>{b.push(a)};return a.forEach(a=>cl(a,c,d)),cl(null,c,d),b.join("")}let cq=()=>"undefined"!=typeof window&&"undefined"!=typeof document,cr={tested:!1,writable:!1},cs=()=>{if(!cq())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(a){return!1}if(cr.tested)return cr.writable;let a=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(a,a),globalThis.localStorage.removeItem(a),cr.tested=!0,cr.writable=!0}catch(a){cr.tested=!0,cr.writable=!1}return cr.writable},ct=a=>a?(...b)=>a(...b):(...a)=>fetch(...a),cu=async(a,b,c)=>{await a.setItem(b,JSON.stringify(c))},cv=async(a,b)=>{let c=await a.getItem(b);if(!c)return null;try{return JSON.parse(c)}catch(a){return c}},cw=async(a,b)=>{await a.removeItem(b)};class cx{constructor(){this.promise=new cx.promiseConstructor((a,b)=>{this.resolve=a,this.reject=b})}}function cy(a){let b=a.split(".");if(3!==b.length)throw new ch("Invalid JWT structure");for(let a=0;a<b.length;a++)if(!b2.test(b[a]))throw new ch("JWT not in base64url format");return{header:JSON.parse(cn(b[0])),payload:JSON.parse(cn(b[1])),signature:co(b[2]),raw:{header:b[0],payload:b[1]}}}async function cz(a){return await new Promise(b=>{setTimeout(()=>b(null),a)})}function cA(a){return("0"+a.toString(16)).substr(-2)}async function cB(a){let b=new TextEncoder().encode(a);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",b))).map(a=>String.fromCharCode(a)).join("")}async function cC(a){return"undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder?(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),a):btoa(await cB(a)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function cD(a,b,c=!1){let d=function(){let a=new Uint32Array(56);if("undefined"==typeof crypto){let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",b=a.length,c="";for(let d=0;d<56;d++)c+=a.charAt(Math.floor(Math.random()*b));return c}return crypto.getRandomValues(a),Array.from(a,cA).join("")}(),e=d;c&&(e+="/PASSWORD_RECOVERY"),await cu(a,`${b}-code-verifier`,e);let f=await cC(d),g=d===f?"plain":"s256";return[f,g]}cx.promiseConstructor=Promise;let cE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,cF=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function cG(a){if(!cF.test(a))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function cH(){return new Proxy({},{get:(a,b)=>{if("__isUserNotAvailableProxy"===b)return!0;if("symbol"==typeof b){let a=b.toString();if("Symbol(Symbol.toPrimitive)"===a||"Symbol(Symbol.toStringTag)"===a||"Symbol(util.inspect.custom)"===a)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${b}" property of the session object is not supported. Please use getUser() instead.`)},set:(a,b)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${b}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(a,b)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${b}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function cI(a){return JSON.parse(JSON.stringify(a))}let cJ=a=>a.msg||a.message||a.error_description||a.error||JSON.stringify(a),cK=[502,503,504];async function cL(a){var b;let c,d;if(!("object"==typeof a&&null!==a&&"status"in a&&"ok"in a&&"json"in a&&"function"==typeof a.json))throw new ce(cJ(a),0);if(cK.includes(a.status))throw new ce(cJ(a),a.status);try{c=await a.json()}catch(a){throw new b6(cJ(a),a)}let e=function(a){let b=a.headers.get(b0);if(!b||!b.match(cE))return null;try{return new Date(`${b}T00:00:00.0Z`)}catch(a){return null}}(a);if(e&&e.getTime()>=b1["2024-01-01"].timestamp&&"object"==typeof c&&c&&"string"==typeof c.code?d=c.code:"object"==typeof c&&c&&"string"==typeof c.error_code&&(d=c.error_code),d){if("weak_password"===d)throw new cg(cJ(c),a.status,(null==(b=c.weak_password)?void 0:b.reasons)||[]);else if("session_not_found"===d)throw new b8}else if("object"==typeof c&&c&&"object"==typeof c.weak_password&&c.weak_password&&Array.isArray(c.weak_password.reasons)&&c.weak_password.reasons.length&&c.weak_password.reasons.reduce((a,b)=>a&&"string"==typeof b,!0))throw new cg(cJ(c),a.status,c.weak_password.reasons);throw new b5(cJ(c),a.status||500,d)}async function cM(a,b,c,d){var e;let f=Object.assign({},null==d?void 0:d.headers);f[b0]||(f[b0]=b1["2024-01-01"].name),(null==d?void 0:d.jwt)&&(f.Authorization=`Bearer ${d.jwt}`);let g=null!=(e=null==d?void 0:d.query)?e:{};(null==d?void 0:d.redirectTo)&&(g.redirect_to=d.redirectTo);let h=Object.keys(g).length?"?"+new URLSearchParams(g).toString():"",i=await cN(a,b,c+h,{headers:f,noResolveJson:null==d?void 0:d.noResolveJson},{},null==d?void 0:d.body);return(null==d?void 0:d.xform)?null==d?void 0:d.xform(i):{data:Object.assign({},i),error:null}}async function cN(a,b,c,d,e,f){let g,h=((a,b,c,d)=>{let e={method:a,headers:(null==b?void 0:b.headers)||{}};return"GET"===a?e:(e.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==b?void 0:b.headers),e.body=JSON.stringify(d),Object.assign(Object.assign({},e),c))})(b,d,e,f);try{g=await a(c,Object.assign({},h))}catch(a){throw console.error(a),new ce(cJ(a),0)}if(g.ok||await cL(g),null==d?void 0:d.noResolveJson)return g;try{return await g.json()}catch(a){await cL(a)}}function cO(a){var b,c,d;let e=null;(d=a).access_token&&d.refresh_token&&d.expires_in&&(e=Object.assign({},a),a.expires_at||(e.expires_at=(c=a.expires_in,Math.round(Date.now()/1e3)+c)));return{data:{session:e,user:null!=(b=a.user)?b:a},error:null}}function cP(a){let b=cO(a);return!b.error&&a.weak_password&&"object"==typeof a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.message&&"string"==typeof a.weak_password.message&&a.weak_password.reasons.reduce((a,b)=>a&&"string"==typeof b,!0)&&(b.data.weak_password=a.weak_password),b}function cQ(a){var b;return{data:{user:null!=(b=a.user)?b:a},error:null}}function cR(a){return{data:a,error:null}}function cS(a){let{action_link:b,email_otp:c,hashed_token:d,redirect_to:e,verification_type:f}=a;return{data:{properties:{action_link:b,email_otp:c,hashed_token:d,redirect_to:e,verification_type:f},user:Object.assign({},aF(a,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function cT(a){return a}let cU=["global","local","others"];class cV{constructor({url:a="",headers:b={},fetch:c}){this.url=a,this.headers=b,this.fetch=ct(c),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(a,b=cU[0]){if(0>cU.indexOf(b))throw Error(`@supabase/auth-js: Parameter scope must be one of ${cU.join(", ")}`);try{return await cM(this.fetch,"POST",`${this.url}/logout?scope=${b}`,{headers:this.headers,jwt:a,noResolveJson:!0}),{data:null,error:null}}catch(a){if(b4(a))return{data:null,error:a};throw a}}async inviteUserByEmail(a,b={}){try{return await cM(this.fetch,"POST",`${this.url}/invite`,{body:{email:a,data:b.data},headers:this.headers,redirectTo:b.redirectTo,xform:cQ})}catch(a){if(b4(a))return{data:{user:null},error:a};throw a}}async generateLink(a){try{let{options:b}=a,c=aF(a,["options"]),d=Object.assign(Object.assign({},c),b);return"newEmail"in c&&(d.new_email=null==c?void 0:c.newEmail,delete d.newEmail),await cM(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:d,headers:this.headers,xform:cS,redirectTo:null==b?void 0:b.redirectTo})}catch(a){if(b4(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(a){try{return await cM(this.fetch,"POST",`${this.url}/admin/users`,{body:a,headers:this.headers,xform:cQ})}catch(a){if(b4(a))return{data:{user:null},error:a};throw a}}async listUsers(a){var b,c,d,e,f,g,h;try{let i={nextPage:null,lastPage:0,total:0},j=await cM(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(c=null==(b=null==a?void 0:a.page)?void 0:b.toString())?c:"",per_page:null!=(e=null==(d=null==a?void 0:a.perPage)?void 0:d.toString())?e:""},xform:cT});if(j.error)throw j.error;let k=await j.json(),l=null!=(f=j.headers.get("x-total-count"))?f:0,m=null!=(h=null==(g=j.headers.get("link"))?void 0:g.split(","))?h:[];return m.length>0&&(m.forEach(a=>{let b=parseInt(a.split(";")[0].split("=")[1].substring(0,1)),c=JSON.parse(a.split(";")[1].split("=")[1]);i[`${c}Page`]=b}),i.total=parseInt(l)),{data:Object.assign(Object.assign({},k),i),error:null}}catch(a){if(b4(a))return{data:{users:[]},error:a};throw a}}async getUserById(a){cG(a);try{return await cM(this.fetch,"GET",`${this.url}/admin/users/${a}`,{headers:this.headers,xform:cQ})}catch(a){if(b4(a))return{data:{user:null},error:a};throw a}}async updateUserById(a,b){cG(a);try{return await cM(this.fetch,"PUT",`${this.url}/admin/users/${a}`,{body:b,headers:this.headers,xform:cQ})}catch(a){if(b4(a))return{data:{user:null},error:a};throw a}}async deleteUser(a,b=!1){cG(a);try{return await cM(this.fetch,"DELETE",`${this.url}/admin/users/${a}`,{headers:this.headers,body:{should_soft_delete:b},xform:cQ})}catch(a){if(b4(a))return{data:{user:null},error:a};throw a}}async _listFactors(a){cG(a.userId);try{let{data:b,error:c}=await cM(this.fetch,"GET",`${this.url}/admin/users/${a.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:b,error:c}}catch(a){if(b4(a))return{data:null,error:a};throw a}}async _deleteFactor(a){cG(a.userId),cG(a.id);try{return{data:await cM(this.fetch,"DELETE",`${this.url}/admin/users/${a.userId}/factors/${a.id}`,{headers:this.headers}),error:null}}catch(a){if(b4(a))return{data:null,error:a};throw a}}async _listOAuthClients(a){var b,c,d,e,f,g,h;try{let i={nextPage:null,lastPage:0,total:0},j=await cM(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(c=null==(b=null==a?void 0:a.page)?void 0:b.toString())?c:"",per_page:null!=(e=null==(d=null==a?void 0:a.perPage)?void 0:d.toString())?e:""},xform:cT});if(j.error)throw j.error;let k=await j.json(),l=null!=(f=j.headers.get("x-total-count"))?f:0,m=null!=(h=null==(g=j.headers.get("link"))?void 0:g.split(","))?h:[];return m.length>0&&(m.forEach(a=>{let b=parseInt(a.split(";")[0].split("=")[1].substring(0,1)),c=JSON.parse(a.split(";")[1].split("=")[1]);i[`${c}Page`]=b}),i.total=parseInt(l)),{data:Object.assign(Object.assign({},k),i),error:null}}catch(a){if(b4(a))return{data:{clients:[]},error:a};throw a}}async _createOAuthClient(a){try{return await cM(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:a,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(b4(a))return{data:null,error:a};throw a}}async _getOAuthClient(a){try{return await cM(this.fetch,"GET",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(b4(a))return{data:null,error:a};throw a}}async _updateOAuthClient(a,b){try{return await cM(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${a}`,{body:b,headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(b4(a))return{data:null,error:a};throw a}}async _deleteOAuthClient(a){try{return await cM(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${a}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(a){if(b4(a))return{data:null,error:a};throw a}}async _regenerateOAuthClientSecret(a){try{return await cM(this.fetch,"POST",`${this.url}/admin/oauth/clients/${a}/regenerate_secret`,{headers:this.headers,xform:a=>({data:a,error:null})})}catch(a){if(b4(a))return{data:null,error:a};throw a}}}function cW(a={}){return{getItem:b=>a[b]||null,setItem:(b,c)=>{a[b]=c},removeItem:b=>{delete a[b]}}}let cX={debug:!!(globalThis&&cs()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class cY extends Error{constructor(a){super(a),this.isAcquireTimeout=!0}}class cZ extends cY{}async function c$(a,b,c){cX.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",a,b);let d=new globalThis.AbortController;return b>0&&setTimeout(()=>{d.abort(),cX.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",a)},b),await Promise.resolve().then(()=>globalThis.navigator.locks.request(a,0===b?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:d.signal},async d=>{if(d){cX.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",a,d.name);try{return await c()}finally{cX.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",a,d.name)}}if(0===b)throw cX.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",a),new cZ(`Acquiring an exclusive Navigator LockManager lock "${a}" immediately failed`);if(cX.debug)try{let a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await c()}))}function c_(a){if(!/^0x[a-fA-F0-9]{40}$/.test(a))throw Error(`@supabase/auth-js: Address "${a}" is invalid.`);return a.toLowerCase()}class c0 extends Error{constructor({message:a,code:b,cause:c,name:d}){var e;super(a,{cause:c}),this.__isWebAuthnError=!0,this.name=null!=(e=null!=d?d:c instanceof Error?c.name:void 0)?e:"Unknown Error",this.code=b}}class c1 extends c0{constructor(a,b){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:b,message:a}),this.name="WebAuthnUnknownError",this.originalError=b}}class c2{createNewAbortSignal(){if(this.controller){let a=Error("Cancelling existing WebAuthn API call for new one");a.name="AbortError",this.controller.abort(a)}let a=new AbortController;return this.controller=a,a.signal}cancelCeremony(){if(this.controller){let a=Error("Manually cancelling existing WebAuthn API call");a.name="AbortError",this.controller.abort(a),this.controller=void 0}}}let c3=new c2;function c4(a){return"localhost"===a||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(a)}function c5(){var a,b;return!!(cq()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"==typeof(null==(a=null==navigator?void 0:navigator.credentials)?void 0:a.create)&&"function"==typeof(null==(b=null==navigator?void 0:navigator.credentials)?void 0:b.get))}async function c6(a){try{let b=await navigator.credentials.create(a);if(!b)return{data:null,error:new c1("Empty credential response",b)};if(!(b instanceof PublicKeyCredential))return{data:null,error:new c1("Browser returned unexpected credential type",b)};return{data:b,error:null}}catch(b){return{data:null,error:function({error:a,options:b}){var c,d,e;let{publicKey:f}=b;if(!f)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new c0({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("ConstraintError"===a.name){if((null==(c=f.authenticatorSelection)?void 0:c.requireResidentKey)===!0)return new c0({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:a});else if("conditional"===b.mediation&&(null==(d=f.authenticatorSelection)?void 0:d.userVerification)==="required")return new c0({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:a});else if((null==(e=f.authenticatorSelection)?void 0:e.userVerification)==="required")return new c0({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:a})}else if("InvalidStateError"===a.name)return new c0({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:a});else if("NotAllowedError"===a.name)return new c0({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("NotSupportedError"===a.name)return new c0(0===f.pubKeyCredParams.filter(a=>"public-key"===a.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:a}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:a});else if("SecurityError"===a.name){let b=window.location.hostname;if(!c4(b))return new c0({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(f.rp.id!==b)return new c0({message:`The RP ID "${f.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("TypeError"===a.name){if(f.user.id.byteLength<1||f.user.id.byteLength>64)return new c0({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:a})}else if("UnknownError"===a.name)return new c0({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return new c0({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}({error:b,options:a})}}}async function c7(a){try{let b=await navigator.credentials.get(a);if(!b)return{data:null,error:new c1("Empty credential response",b)};if(!(b instanceof PublicKeyCredential))return{data:null,error:new c1("Browser returned unexpected credential type",b)};return{data:b,error:null}}catch(b){return{data:null,error:function({error:a,options:b}){let{publicKey:c}=b;if(!c)throw Error("options was missing required publicKey property");if("AbortError"===a.name){if(b.signal instanceof AbortSignal)return new c0({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:a})}else if("NotAllowedError"===a.name)return new c0({message:a.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a});else if("SecurityError"===a.name){let b=window.location.hostname;if(!c4(b))return new c0({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:a});if(c.rpId!==b)return new c0({message:`The RP ID "${c.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:a})}else if("UnknownError"===a.name)return new c0({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:a});return new c0({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:a})}({error:b,options:a})}}}let c8={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},c9={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function da(...a){let b=a=>null!==a&&"object"==typeof a&&!Array.isArray(a),c=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),d={};for(let e of a)if(e)for(let a in e){let f=e[a];if(void 0!==f)if(Array.isArray(f))d[a]=f;else if(c(f))d[a]=f;else if(b(f)){let c=d[a];b(c)?d[a]=da(c,f):d[a]=da(f)}else d[a]=f}return d}class db{constructor(a){this.client=a,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(a){return this.client.mfa.enroll(Object.assign(Object.assign({},a),{factorType:"webauthn"}))}async _challenge({factorId:a,webauthn:b,friendlyName:c,signal:d},e){try{var f,g,h,i;let{data:j,error:k}=await this.client.mfa.challenge({factorId:a,webauthn:b});if(!j)return{data:null,error:k};let l=null!=d?d:c3.createNewAbortSignal();if("create"===j.webauthn.type){let{user:a}=j.webauthn.credential_options.publicKey;a.name||(a.name=`${a.id}:${c}`),a.displayName||(a.displayName=a.name)}switch(j.webauthn.type){case"create":{let b=(f=j.webauthn.credential_options.publicKey,g=null==e?void 0:e.create,da(c8,f,g||{})),{data:c,error:d}=await c6({publicKey:b,signal:l});if(c)return{data:{factorId:a,challengeId:j.id,webauthn:{type:j.webauthn.type,credential_response:c}},error:null};return{data:null,error:d}}case"request":{let b=(h=j.webauthn.credential_options.publicKey,i=null==e?void 0:e.request,da(c9,h,i||{})),{data:c,error:d}=await c7(Object.assign(Object.assign({},j.webauthn.credential_options),{publicKey:b,signal:l}));if(c)return{data:{factorId:a,challengeId:j.id,webauthn:{type:j.webauthn.type,credential_response:c}},error:null};return{data:null,error:d}}}}catch(a){if(b4(a))return{data:null,error:a};return{data:null,error:new b6("Unexpected error in challenge",a)}}}async _verify({challengeId:a,factorId:b,webauthn:c}){return this.client.mfa.verify({factorId:b,challengeId:a,webauthn:c})}async _authenticate({factorId:a,webauthn:{rpId:b="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:c="undefined"!=typeof window?[window.location.origin]:void 0,signal:d}={}},e){if(!b)return{data:null,error:new b3("rpId is required for WebAuthn authentication")};try{if(!c5())return{data:null,error:new b6("Browser does not support WebAuthn",null)};let{data:f,error:g}=await this.challenge({factorId:a,webauthn:{rpId:b,rpOrigins:c},signal:d},{request:e});if(!f)return{data:null,error:g};let{webauthn:h}=f;return this._verify({factorId:a,challengeId:f.challengeId,webauthn:{type:h.type,rpId:b,rpOrigins:c,credential_response:h.credential_response}})}catch(a){if(b4(a))return{data:null,error:a};return{data:null,error:new b6("Unexpected error in authenticate",a)}}}async _register({friendlyName:a,webauthn:{rpId:b="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:c="undefined"!=typeof window?[window.location.origin]:void 0,signal:d}={}},e){if(!b)return{data:null,error:new b3("rpId is required for WebAuthn registration")};try{if(!c5())return{data:null,error:new b6("Browser does not support WebAuthn",null)};let{data:f,error:g}=await this._enroll({friendlyName:a});if(!f)return await this.client.mfa.listFactors().then(b=>{var c;return null==(c=b.data)?void 0:c.all.find(b=>"webauthn"===b.factor_type&&b.friendly_name===a&&"unverified"!==b.status)}).then(a=>a?this.client.mfa.unenroll({factorId:null==a?void 0:a.id}):void 0),{data:null,error:g};let{data:h,error:i}=await this._challenge({factorId:f.id,friendlyName:f.friendly_name,webauthn:{rpId:b,rpOrigins:c},signal:d},{create:e});if(!h)return{data:null,error:i};return this._verify({factorId:f.id,challengeId:h.challengeId,webauthn:{rpId:b,rpOrigins:c,type:h.webauthn.type,credential_response:h.webauthn.credential_response}})}catch(a){if(b4(a))return{data:null,error:a};return{data:null,error:new b6("Unexpected error in register",a)}}}}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(a){"undefined"!=typeof self&&(self.globalThis=self)}let dc={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:b_,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function dd(a,b,c){return await c()}let de={};class df{get jwks(){var a,b;return null!=(b=null==(a=de[this.storageKey])?void 0:a.jwks)?b:{keys:[]}}set jwks(a){de[this.storageKey]=Object.assign(Object.assign({},de[this.storageKey]),{jwks:a})}get jwks_cached_at(){var a,b;return null!=(b=null==(a=de[this.storageKey])?void 0:a.cachedAt)?b:Number.MIN_SAFE_INTEGER}set jwks_cached_at(a){de[this.storageKey]=Object.assign(Object.assign({},de[this.storageKey]),{cachedAt:a})}constructor(a){var b,c,d;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;let e=Object.assign(Object.assign({},dc),a);if(this.storageKey=e.storageKey,this.instanceID=null!=(b=df.nextInstanceID[this.storageKey])?b:0,df.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!e.debug,"function"==typeof e.debug&&(this.logger=e.debug),this.instanceID>0&&cq()){let a=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(a),this.logDebugMessages&&console.trace(a)}if(this.persistSession=e.persistSession,this.autoRefreshToken=e.autoRefreshToken,this.admin=new cV({url:e.url,headers:e.headers,fetch:e.fetch}),this.url=e.url,this.headers=e.headers,this.fetch=ct(e.fetch),this.lock=e.lock||dd,this.detectSessionInUrl=e.detectSessionInUrl,this.flowType=e.flowType,this.hasCustomAuthorizationHeader=e.hasCustomAuthorizationHeader,this.throwOnError=e.throwOnError,e.lock?this.lock=e.lock:this.persistSession&&cq()&&(null==(c=null==globalThis?void 0:globalThis.navigator)?void 0:c.locks)?this.lock=c$:this.lock=dd,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new db(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(e.storage?this.storage=e.storage:cs()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=cW(this.memoryStorage)),e.userStorage&&(this.userStorage=e.userStorage)):(this.memoryStorage={},this.storage=cW(this.memoryStorage)),cq()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}null==(d=this.broadcastChannel)||d.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(a){if(this.throwOnError&&a&&a.error)throw a.error;return a}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${b$}) ${new Date().toISOString()}`}_debug(...a){return this.logDebugMessages&&this.logger(this._logPrefix(),...a),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var a;try{let b={},c="none";if(cq()&&(b=function(a){let b={},c=new URL(a);if(c.hash&&"#"===c.hash[0])try{new URLSearchParams(c.hash.substring(1)).forEach((a,c)=>{b[c]=a})}catch(a){}return c.searchParams.forEach((a,c)=>{b[c]=a}),b}(window.location.href),this._isImplicitGrantCallback(b)?c="implicit":await this._isPKCECallback(b)&&(c="pkce")),cq()&&this.detectSessionInUrl&&"none"!==c){let{data:d,error:e}=await this._getSessionFromURL(b,c);if(e){if(this._debug("#_initialize()","error detecting session from URL",e),b4(e)&&"AuthImplicitGrantRedirectError"===e.name){let b=null==(a=e.details)?void 0:a.code;if("identity_already_exists"===b||"identity_not_found"===b||"single_identity_not_deletable"===b)return{error:e}}return await this._removeSession(),{error:e}}let{session:f,redirectType:g}=d;return this._debug("#_initialize()","detected session in URL",f,"redirect type",g),await this._saveSession(f),setTimeout(async()=>{"recovery"===g?await this._notifyAllSubscribers("PASSWORD_RECOVERY",f):await this._notifyAllSubscribers("SIGNED_IN",f)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(a){if(b4(a))return this._returnResult({error:a});return this._returnResult({error:new b6("Unexpected error during initialization",a)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(a){var b,c,d;try{let{data:e,error:f}=await cM(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(c=null==(b=null==a?void 0:a.options)?void 0:b.data)?c:{},gotrue_meta_security:{captcha_token:null==(d=null==a?void 0:a.options)?void 0:d.captchaToken}},xform:cO});if(f||!e)return this._returnResult({data:{user:null,session:null},error:f});let g=e.session,h=e.user;return e.session&&(await this._saveSession(e.session),await this._notifyAllSubscribers("SIGNED_IN",g)),this._returnResult({data:{user:h,session:g},error:null})}catch(a){if(b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(a){var b,c,d;try{let e;if("email"in a){let{email:c,password:d,options:f}=a,g=null,h=null;"pkce"===this.flowType&&([g,h]=await cD(this.storage,this.storageKey)),e=await cM(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==f?void 0:f.emailRedirectTo,body:{email:c,password:d,data:null!=(b=null==f?void 0:f.data)?b:{},gotrue_meta_security:{captcha_token:null==f?void 0:f.captchaToken},code_challenge:g,code_challenge_method:h},xform:cO})}else if("phone"in a){let{phone:b,password:f,options:g}=a;e=await cM(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:b,password:f,data:null!=(c=null==g?void 0:g.data)?c:{},channel:null!=(d=null==g?void 0:g.channel)?d:"sms",gotrue_meta_security:{captcha_token:null==g?void 0:g.captchaToken}},xform:cO})}else throw new ca("You must provide either an email or phone number and a password");let{data:f,error:g}=e;if(g||!f)return await cw(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:g});let h=f.session,i=f.user;return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",h)),this._returnResult({data:{user:i,session:h},error:null})}catch(a){if(await cw(this.storage,`${this.storageKey}-code-verifier`),b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(a){try{let b;if("email"in a){let{email:c,password:d,options:e}=a;b=await cM(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:c,password:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:cP})}else if("phone"in a){let{phone:c,password:d,options:e}=a;b=await cM(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:c,password:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},xform:cP})}else throw new ca("You must provide either an email or phone number and a password");let{data:c,error:d}=b;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){let a=new b9;return this._returnResult({data:{user:null,session:null},error:a})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:Object.assign({user:c.user,session:c.session},c.weak_password?{weakPassword:c.weak_password}:null),error:d})}catch(a){if(b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOAuth(a){var b,c,d,e;return await this._handleProviderSignIn(a.provider,{redirectTo:null==(b=a.options)?void 0:b.redirectTo,scopes:null==(c=a.options)?void 0:c.scopes,queryParams:null==(d=a.options)?void 0:d.queryParams,skipBrowserRedirect:null==(e=a.options)?void 0:e.skipBrowserRedirect})}async exchangeCodeForSession(a){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(a))}async signInWithWeb3(a){let{chain:b}=a;switch(b){case"ethereum":return await this.signInWithEthereum(a);case"solana":return await this.signInWithSolana(a);default:throw Error(`@supabase/auth-js: Unsupported chain "${b}"`)}}async signInWithEthereum(a){var b,c,d,e,f,g,h,i,j,k,l,m;let o,p;if("message"in a)o=a.message,p=a.signature;else{let k,{chain:l,wallet:q,statement:r,options:s}=a;if(cq())if("object"==typeof q)k=q;else{let a=window;if("ethereum"in a&&"object"==typeof a.ethereum&&"request"in a.ethereum&&"function"==typeof a.ethereum.request)k=a.ethereum;else throw Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if("object"!=typeof q||!(null==s?void 0:s.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=q}let t=new URL(null!=(b=null==s?void 0:s.url)?b:window.location.href),u=await k.request({method:"eth_requestAccounts"}).then(a=>a).catch(()=>{throw Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!u||0===u.length)throw Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let v=c_(u[0]),w=null==(c=null==s?void 0:s.signInWithEthereum)?void 0:c.chainId;w||(w=parseInt(await k.request({method:"eth_chainId"}),16)),o=function(a){var b;let{chainId:c,domain:d,expirationTime:e,issuedAt:f=new Date,nonce:g,notBefore:h,requestId:i,resources:j,scheme:k,uri:l,version:m}=a;if(!Number.isInteger(c))throw Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${c}`);if(!d)throw Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(g&&g.length<8)throw Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${g}`);if(!l)throw Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==m)throw Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${m}`);if(null==(b=a.statement)?void 0:b.includes("\n"))throw Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${a.statement}`);let o=c_(a.address),p=k?`${k}://${d}`:d,q=a.statement?`${a.statement}
`:"",r=`${p} wants you to sign in with your Ethereum account:
${o}

${q}`,s=`URI: ${l}
Version: ${m}
Chain ID: ${c}${g?`
Nonce: ${g}`:""}
Issued At: ${f.toISOString()}`;if(e&&(s+=`
Expiration Time: ${e.toISOString()}`),h&&(s+=`
Not Before: ${h.toISOString()}`),i&&(s+=`
Request ID: ${i}`),j){let a="\nResources:";for(let b of j){if(!b||"string"!=typeof b)throw Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);a+=`
- ${b}`}s+=a}return`${r}
${s}`}({domain:t.host,address:v,statement:r,uri:t.href,version:"1",chainId:w,nonce:null==(d=null==s?void 0:s.signInWithEthereum)?void 0:d.nonce,issuedAt:null!=(f=null==(e=null==s?void 0:s.signInWithEthereum)?void 0:e.issuedAt)?f:new Date,expirationTime:null==(g=null==s?void 0:s.signInWithEthereum)?void 0:g.expirationTime,notBefore:null==(h=null==s?void 0:s.signInWithEthereum)?void 0:h.notBefore,requestId:null==(i=null==s?void 0:s.signInWithEthereum)?void 0:i.requestId,resources:null==(j=null==s?void 0:s.signInWithEthereum)?void 0:j.resources}),p=await k.request({method:"personal_sign",params:[(m=o,"0x"+Array.from(new TextEncoder().encode(m),a=>a.toString(16).padStart(2,"0")).join("")),v]})}try{let{data:b,error:c}=await cM(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:o,signature:p},(null==(k=a.options)?void 0:k.captchaToken)?{gotrue_meta_security:{captcha_token:null==(l=a.options)?void 0:l.captchaToken}}:null),xform:cO});if(c)throw c;if(!b||!b.session||!b.user){let a=new b9;return this._returnResult({data:{user:null,session:null},error:a})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:c})}catch(a){if(b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSolana(a){var b,c,d,e,f,g,h,i,j,k,l,m;let o,p;if("message"in a)o=a.message,p=a.signature;else{let l,{chain:m,wallet:q,statement:r,options:s}=a;if(cq())if("object"==typeof q)l=q;else{let a=window;if("solana"in a&&"object"==typeof a.solana&&("signIn"in a.solana&&"function"==typeof a.solana.signIn||"signMessage"in a.solana&&"function"==typeof a.solana.signMessage))l=a.solana;else throw Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if("object"!=typeof q||!(null==s?void 0:s.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");l=q}let t=new URL(null!=(b=null==s?void 0:s.url)?b:window.location.href);if("signIn"in l&&l.signIn){let a,b=await l.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==s?void 0:s.signInWithSolana),{version:"1",domain:t.host,uri:t.href}),r?{statement:r}:null));if(Array.isArray(b)&&b[0]&&"object"==typeof b[0])a=b[0];else if(b&&"object"==typeof b&&"signedMessage"in b&&"signature"in b)a=b;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in a&&"signature"in a&&("string"==typeof a.signedMessage||a.signedMessage instanceof Uint8Array)&&a.signature instanceof Uint8Array)o="string"==typeof a.signedMessage?a.signedMessage:new TextDecoder().decode(a.signedMessage),p=a.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in l)||"function"!=typeof l.signMessage||!("publicKey"in l)||"object"!=typeof l||!l.publicKey||!("toBase58"in l.publicKey)||"function"!=typeof l.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");o=[`${t.host} wants you to sign in with your Solana account:`,l.publicKey.toBase58(),...r?["",r,""]:[""],"Version: 1",`URI: ${t.href}`,`Issued At: ${null!=(d=null==(c=null==s?void 0:s.signInWithSolana)?void 0:c.issuedAt)?d:new Date().toISOString()}`,...(null==(e=null==s?void 0:s.signInWithSolana)?void 0:e.notBefore)?[`Not Before: ${s.signInWithSolana.notBefore}`]:[],...(null==(f=null==s?void 0:s.signInWithSolana)?void 0:f.expirationTime)?[`Expiration Time: ${s.signInWithSolana.expirationTime}`]:[],...(null==(g=null==s?void 0:s.signInWithSolana)?void 0:g.chainId)?[`Chain ID: ${s.signInWithSolana.chainId}`]:[],...(null==(h=null==s?void 0:s.signInWithSolana)?void 0:h.nonce)?[`Nonce: ${s.signInWithSolana.nonce}`]:[],...(null==(i=null==s?void 0:s.signInWithSolana)?void 0:i.requestId)?[`Request ID: ${s.signInWithSolana.requestId}`]:[],...(null==(k=null==(j=null==s?void 0:s.signInWithSolana)?void 0:j.resources)?void 0:k.length)?["Resources",...s.signInWithSolana.resources.map(a=>`- ${a}`)]:[]].join("\n");let a=await l.signMessage(new TextEncoder().encode(o),"utf8");if(!a||!(a instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=a}}try{let{data:b,error:c}=await cM(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:o,signature:cp(p)},(null==(l=a.options)?void 0:l.captchaToken)?{gotrue_meta_security:{captcha_token:null==(m=a.options)?void 0:m.captchaToken}}:null),xform:cO});if(c)throw c;if(!b||!b.session||!b.user){let a=new b9;return this._returnResult({data:{user:null,session:null},error:a})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:c})}catch(a){if(b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async _exchangeCodeForSession(a){let b=await cv(this.storage,`${this.storageKey}-code-verifier`),[c,d]=(null!=b?b:"").split("/");try{if(!c&&"pkce"===this.flowType)throw new cd;let{data:b,error:e}=await cM(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:a,code_verifier:c},xform:cO});if(await cw(this.storage,`${this.storageKey}-code-verifier`),e)throw e;if(!b||!b.session||!b.user){let a=new b9;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign(Object.assign({},b),{redirectType:null!=d?d:null}),error:e})}catch(a){if(await cw(this.storage,`${this.storageKey}-code-verifier`),b4(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(a){try{let{options:b,provider:c,token:d,access_token:e,nonce:f}=a,{data:g,error:h}=await cM(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:c,id_token:d,access_token:e,nonce:f,gotrue_meta_security:{captcha_token:null==b?void 0:b.captchaToken}},xform:cO});if(h)return this._returnResult({data:{user:null,session:null},error:h});if(!g||!g.session||!g.user){let a=new b9;return this._returnResult({data:{user:null,session:null},error:a})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:g,error:h})}catch(a){if(b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithOtp(a){var b,c,d,e,f;try{if("email"in a){let{email:d,options:e}=a,f=null,g=null;"pkce"===this.flowType&&([f,g]=await cD(this.storage,this.storageKey));let{error:h}=await cM(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:null!=(b=null==e?void 0:e.data)?b:{},create_user:null==(c=null==e?void 0:e.shouldCreateUser)||c,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken},code_challenge:f,code_challenge_method:g},redirectTo:null==e?void 0:e.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in a){let{phone:b,options:c}=a,{data:g,error:h}=await cM(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:b,data:null!=(d=null==c?void 0:c.data)?d:{},create_user:null==(e=null==c?void 0:c.shouldCreateUser)||e,gotrue_meta_security:{captcha_token:null==c?void 0:c.captchaToken},channel:null!=(f=null==c?void 0:c.channel)?f:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==g?void 0:g.message_id},error:h})}throw new ca("You must provide either an email or phone number.")}catch(a){if(await cw(this.storage,`${this.storageKey}-code-verifier`),b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(a){var b,c;try{let d,e;"options"in a&&(d=null==(b=a.options)?void 0:b.redirectTo,e=null==(c=a.options)?void 0:c.captchaToken);let{data:f,error:g}=await cM(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},a),{gotrue_meta_security:{captcha_token:e}}),redirectTo:d,xform:cO});if(g)throw g;if(!f)throw Error("An error occurred on token verification.");let h=f.session,i=f.user;return(null==h?void 0:h.access_token)&&(await this._saveSession(h),await this._notifyAllSubscribers("recovery"==a.type?"PASSWORD_RECOVERY":"SIGNED_IN",h)),this._returnResult({data:{user:i,session:h},error:null})}catch(a){if(b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(a){var b,c,d,e,f;try{let g=null,h=null;"pkce"===this.flowType&&([g,h]=await cD(this.storage,this.storageKey));let i=await cM(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in a?{provider_id:a.providerId}:null),"domain"in a?{domain:a.domain}:null),{redirect_to:null!=(c=null==(b=a.options)?void 0:b.redirectTo)?c:void 0}),(null==(d=null==a?void 0:a.options)?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:a.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:g,code_challenge_method:h}),headers:this.headers,xform:cR});return(null==(e=i.data)?void 0:e.url)&&cq()&&!(null==(f=a.options)?void 0:f.skipBrowserRedirect)&&window.location.assign(i.data.url),this._returnResult(i)}catch(a){if(await cw(this.storage,`${this.storageKey}-code-verifier`),b4(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async a=>{let{data:{session:b},error:c}=a;if(c)throw c;if(!b)throw new b8;let{error:d}=await cM(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:b.access_token});return this._returnResult({data:{user:null,session:null},error:d})})}catch(a){if(b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async resend(a){try{let b=`${this.url}/resend`;if("email"in a){let{email:c,type:d,options:e}=a,{error:f}=await cM(this.fetch,"POST",b,{headers:this.headers,body:{email:c,type:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}},redirectTo:null==e?void 0:e.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in a){let{phone:c,type:d,options:e}=a,{data:f,error:g}=await cM(this.fetch,"POST",b,{headers:this.headers,body:{phone:c,type:d,gotrue_meta_security:{captcha_token:null==e?void 0:e.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==f?void 0:f.message_id},error:g})}throw new ca("You must provide either an email or phone number and a type")}catch(a){if(b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async a=>a))}async _acquireLock(a,b){this._debug("#_acquireLock","begin",a);try{if(this.lockAcquired){let a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),c=(async()=>(await a,await b()))();return this.pendingInLock.push((async()=>{try{await c}catch(a){}})()),c}return await this.lock(`lock:${this.storageKey}`,a,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let a=b();for(this.pendingInLock.push((async()=>{try{await a}catch(a){}})()),await a;this.pendingInLock.length;){let a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(a){this._debug("#_useSession","begin");try{let b=await this.__loadSession();return await a(b)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let b=null,c=await cv(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",c),null!==c&&(this._isValidSession(c)?b=c:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!b)return{data:{session:null},error:null};let d=!!b.expires_at&&1e3*b.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${d?"":" not"} expired`,"expires_at",b.expires_at),!d){if(this.userStorage){let a=await cv(this.userStorage,this.storageKey+"-user");(null==a?void 0:a.user)?b.user=a.user:b.user=cH()}if(this.storage.isServer&&b.user&&!b.user.__isUserNotAvailableProxy){var a;let c={value:this.suppressGetSessionWarning};b.user=(a=b.user,new Proxy(a,{get:(a,b,d)=>{if("__isInsecureUserWarningProxy"===b)return!0;if("symbol"==typeof b){let c=b.toString();if("Symbol(Symbol.toPrimitive)"===c||"Symbol(Symbol.toStringTag)"===c||"Symbol(util.inspect.custom)"===c||"Symbol(nodejs.util.inspect.custom)"===c)return Reflect.get(a,b,d)}return c.value||"string"!=typeof b||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c.value=!0),Reflect.get(a,b,d)}})),c.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:b},error:null}}let{data:e,error:f}=await this._callRefreshToken(b.refresh_token);if(f)return this._returnResult({data:{session:null},error:f});return this._returnResult({data:{session:e},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(a){if(a)return await this._getUser(a);await this.initializePromise;let b=await this._acquireLock(-1,async()=>await this._getUser());return b.data.user&&(this.suppressGetSessionWarning=!0),b}async _getUser(a){try{if(a)return await cM(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:a,xform:cQ});return await this._useSession(async a=>{var b,c,d;let{data:e,error:f}=a;if(f)throw f;return(null==(b=e.session)?void 0:b.access_token)||this.hasCustomAuthorizationHeader?await cM(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(d=null==(c=e.session)?void 0:c.access_token)?d:void 0,xform:cQ}):{data:{user:null},error:new b8}})}catch(a){if(b4(a))return b4(a)&&"AuthSessionMissingError"===a.name&&(await this._removeSession(),await cw(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:a});throw a}}async updateUser(a,b={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(a,b))}async _updateUser(a,b={}){try{return await this._useSession(async c=>{let{data:d,error:e}=c;if(e)throw e;if(!d.session)throw new b8;let f=d.session,g=null,h=null;"pkce"===this.flowType&&null!=a.email&&([g,h]=await cD(this.storage,this.storageKey));let{data:i,error:j}=await cM(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==b?void 0:b.emailRedirectTo,body:Object.assign(Object.assign({},a),{code_challenge:g,code_challenge_method:h}),jwt:f.access_token,xform:cQ});if(j)throw j;return f.user=i.user,await this._saveSession(f),await this._notifyAllSubscribers("USER_UPDATED",f),this._returnResult({data:{user:f.user},error:null})})}catch(a){if(await cw(this.storage,`${this.storageKey}-code-verifier`),b4(a))return this._returnResult({data:{user:null},error:a});throw a}}async setSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(a))}async _setSession(a){try{if(!a.access_token||!a.refresh_token)throw new b8;let b=Date.now()/1e3,c=b,d=!0,e=null,{payload:f}=cy(a.access_token);if(f.exp&&(d=(c=f.exp)<=b),d){let{data:b,error:c}=await this._callRefreshToken(a.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!b)return{data:{user:null,session:null},error:null};e=b}else{let{data:d,error:f}=await this._getUser(a.access_token);if(f)throw f;e={access_token:a.access_token,refresh_token:a.refresh_token,user:d.user,token_type:"bearer",expires_in:c-b,expires_at:c},await this._saveSession(e),await this._notifyAllSubscribers("SIGNED_IN",e)}return this._returnResult({data:{user:e.user,session:e},error:null})}catch(a){if(b4(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}}async refreshSession(a){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(a))}async _refreshSession(a){try{return await this._useSession(async b=>{var c;if(!a){let{data:d,error:e}=b;if(e)throw e;a=null!=(c=d.session)?c:void 0}if(!(null==a?void 0:a.refresh_token))throw new b8;let{data:d,error:e}=await this._callRefreshToken(a.refresh_token);return e?this._returnResult({data:{user:null,session:null},error:e}):d?this._returnResult({data:{user:d.user,session:d},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(a){if(b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async _getSessionFromURL(a,b){try{if(!cq())throw new cb("No browser detected.");if(a.error||a.error_description||a.error_code)throw new cb(a.error_description||"Error in URL with unspecified error_description",{error:a.error||"unspecified_error",code:a.error_code||"unspecified_code"});switch(b){case"implicit":if("pkce"===this.flowType)throw new cc("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new cb("Not a valid implicit grant flow url.")}if("pkce"===b){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!a.code)throw new cc("No code detected.");let{data:b,error:c}=await this._exchangeCodeForSession(a.code);if(c)throw c;let d=new URL(window.location.href);return d.searchParams.delete("code"),window.history.replaceState(window.history.state,"",d.toString()),{data:{session:b.session,redirectType:null},error:null}}let{provider_token:c,provider_refresh_token:d,access_token:e,refresh_token:f,expires_in:g,expires_at:h,token_type:i}=a;if(!e||!g||!f||!i)throw new cb("No session defined in URL");let j=Math.round(Date.now()/1e3),k=parseInt(g),l=j+k;h&&(l=parseInt(h));let m=l-j;1e3*m<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${k}s`);let o=l-k;j-o>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",o,l,j):j-o<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",o,l,j);let{data:p,error:q}=await this._getUser(e);if(q)throw q;let r={provider_token:c,provider_refresh_token:d,access_token:e,expires_in:k,expires_at:l,refresh_token:f,token_type:i,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:r,redirectType:a.type},error:null})}catch(a){if(b4(a))return this._returnResult({data:{session:null,redirectType:null},error:a});throw a}}_isImplicitGrantCallback(a){return"function"==typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),a):!!(a.access_token||a.error_description)}async _isPKCECallback(a){let b=await cv(this.storage,`${this.storageKey}-code-verifier`);return!!(a.code&&b)}async signOut(a={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(a))}async _signOut({scope:a}={scope:"global"}){return await this._useSession(async b=>{var c;let{data:d,error:e}=b;if(e)return this._returnResult({error:e});let f=null==(c=d.session)?void 0:c.access_token;if(f){let{error:b}=await this.admin.signOut(f,a);if(b&&!(b4(b)&&"AuthApiError"===b.name&&(404===b.status||401===b.status||403===b.status)))return this._returnResult({error:b})}return"others"!==a&&(await this._removeSession(),await cw(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(a){let b=Symbol("auth-callback"),c={id:b,callback:a,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",b),this.stateChangeEmitters.delete(b)}};return this._debug("#onAuthStateChange()","registered callback with id",b),this.stateChangeEmitters.set(b,c),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(b)})})(),{data:{subscription:c}}}async _emitInitialSession(a){return await this._useSession(async b=>{var c,d;try{let{data:{session:d},error:e}=b;if(e)throw e;await (null==(c=this.stateChangeEmitters.get(a))?void 0:c.callback("INITIAL_SESSION",d)),this._debug("INITIAL_SESSION","callback id",a,"session",d)}catch(b){await (null==(d=this.stateChangeEmitters.get(a))?void 0:d.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",a,"error",b),console.error(b)}})}async resetPasswordForEmail(a,b={}){let c=null,d=null;"pkce"===this.flowType&&([c,d]=await cD(this.storage,this.storageKey,!0));try{return await cM(this.fetch,"POST",`${this.url}/recover`,{body:{email:a,code_challenge:c,code_challenge_method:d,gotrue_meta_security:{captcha_token:b.captchaToken}},headers:this.headers,redirectTo:b.redirectTo})}catch(a){if(await cw(this.storage,`${this.storageKey}-code-verifier`),b4(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var a;try{let{data:b,error:c}=await this.getUser();if(c)throw c;return this._returnResult({data:{identities:null!=(a=b.user.identities)?a:[]},error:null})}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}}async linkIdentity(a){return"token"in a?this.linkIdentityIdToken(a):this.linkIdentityOAuth(a)}async linkIdentityOAuth(a){var b;try{let{data:c,error:d}=await this._useSession(async b=>{var c,d,e,f,g;let{data:h,error:i}=b;if(i)throw i;let j=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,a.provider,{redirectTo:null==(c=a.options)?void 0:c.redirectTo,scopes:null==(d=a.options)?void 0:d.scopes,queryParams:null==(e=a.options)?void 0:e.queryParams,skipBrowserRedirect:!0});return await cM(this.fetch,"GET",j,{headers:this.headers,jwt:null!=(g=null==(f=h.session)?void 0:f.access_token)?g:void 0})});if(d)throw d;return!cq()||(null==(b=a.options)?void 0:b.skipBrowserRedirect)||window.location.assign(null==c?void 0:c.url),this._returnResult({data:{provider:a.provider,url:null==c?void 0:c.url},error:null})}catch(b){if(b4(b))return this._returnResult({data:{provider:a.provider,url:null},error:b});throw b}}async linkIdentityIdToken(a){return await this._useSession(async b=>{var c;try{let{error:d,data:{session:e}}=b;if(d)throw d;let{options:f,provider:g,token:h,access_token:i,nonce:j}=a,{data:k,error:l}=await cM(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!=(c=null==e?void 0:e.access_token)?c:void 0,body:{provider:g,id_token:h,access_token:i,nonce:j,link_identity:!0,gotrue_meta_security:{captcha_token:null==f?void 0:f.captchaToken}},xform:cO});if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!k||!k.session||!k.user)return this._returnResult({data:{user:null,session:null},error:new b9});return k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("USER_UPDATED",k.session)),this._returnResult({data:k,error:l})}catch(a){if(await cw(this.storage,`${this.storageKey}-code-verifier`),b4(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(a){try{return await this._useSession(async b=>{var c,d;let{data:e,error:f}=b;if(f)throw f;return await cM(this.fetch,"DELETE",`${this.url}/user/identities/${a.identity_id}`,{headers:this.headers,jwt:null!=(d=null==(c=e.session)?void 0:c.access_token)?d:void 0})})}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}}async _refreshAccessToken(a){let b=`#_refreshAccessToken(${a.substring(0,5)}...)`;this._debug(b,"begin");try{var c,d;let e=Date.now();return await (c=async c=>(c>0&&await cz(200*Math.pow(2,c-1)),this._debug(b,"refreshing attempt",c),await cM(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:a},headers:this.headers,xform:cO})),d=(a,b)=>{let c=200*Math.pow(2,a);return b&&cf(b)&&Date.now()+c-e<3e4},new Promise((a,b)=>{(async()=>{for(let e=0;e<1/0;e++)try{let b=await c(e);if(!d(e,null,b))return void a(b)}catch(a){if(!d(e,a))return void b(a)}})()}))}catch(a){if(this._debug(b,"error",a),b4(a))return this._returnResult({data:{session:null,user:null},error:a});throw a}finally{this._debug(b,"end")}}_isValidSession(a){return"object"==typeof a&&null!==a&&"access_token"in a&&"refresh_token"in a&&"expires_at"in a}async _handleProviderSignIn(a,b){let c=await this._getUrlForProvider(`${this.url}/authorize`,a,{redirectTo:b.redirectTo,scopes:b.scopes,queryParams:b.queryParams});return this._debug("#_handleProviderSignIn()","provider",a,"options",b,"url",c),cq()&&!b.skipBrowserRedirect&&window.location.assign(c),{data:{provider:a,url:c},error:null}}async _recoverAndRefresh(){var a,b;let c="#_recoverAndRefresh()";this._debug(c,"begin");try{let d=await cv(this.storage,this.storageKey);if(d&&this.userStorage){let b=await cv(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!b&&(b={user:d.user},await cu(this.userStorage,this.storageKey+"-user",b)),d.user=null!=(a=null==b?void 0:b.user)?a:cH()}else if(d&&!d.user&&!d.user){let a=await cv(this.storage,this.storageKey+"-user");a&&(null==a?void 0:a.user)?(d.user=a.user,await cw(this.storage,this.storageKey+"-user"),await cu(this.storage,this.storageKey,d)):d.user=cH()}if(this._debug(c,"session from storage",d),!this._isValidSession(d)){this._debug(c,"session is not valid"),null!==d&&await this._removeSession();return}let e=(null!=(b=d.expires_at)?b:1/0)*1e3-Date.now()<9e4;if(this._debug(c,`session has${e?"":" not"} expired with margin of 90000s`),e){if(this.autoRefreshToken&&d.refresh_token){let{error:a}=await this._callRefreshToken(d.refresh_token);a&&(console.error(a),cf(a)||(this._debug(c,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(d.user&&!0===d.user.__isUserNotAvailableProxy)try{let{data:a,error:b}=await this._getUser(d.access_token);!b&&(null==a?void 0:a.user)?(d.user=a.user,await this._saveSession(d),await this._notifyAllSubscribers("SIGNED_IN",d)):this._debug(c,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(c,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",d)}catch(a){this._debug(c,"error",a),console.error(a);return}finally{this._debug(c,"end")}}async _callRefreshToken(a){var b,c;if(!a)throw new b8;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let d=`#_callRefreshToken(${a.substring(0,5)}...)`;this._debug(d,"begin");try{this.refreshingDeferred=new cx;let{data:b,error:c}=await this._refreshAccessToken(a);if(c)throw c;if(!b.session)throw new b8;await this._saveSession(b.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",b.session);let d={data:b.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(a){if(this._debug(d,"error",a),b4(a)){let c={data:null,error:a};return cf(a)||await this._removeSession(),null==(b=this.refreshingDeferred)||b.resolve(c),c}throw null==(c=this.refreshingDeferred)||c.reject(a),a}finally{this.refreshingDeferred=null,this._debug(d,"end")}}async _notifyAllSubscribers(a,b,c=!0){let d=`#_notifyAllSubscribers(${a})`;this._debug(d,"begin",b,`broadcast = ${c}`);try{this.broadcastChannel&&c&&this.broadcastChannel.postMessage({event:a,session:b});let d=[],e=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(a,b)}catch(a){d.push(a)}});if(await Promise.all(e),d.length>0){for(let a=0;a<d.length;a+=1)console.error(d[a]);throw d[0]}}finally{this._debug(d,"end")}}async _saveSession(a){this._debug("#_saveSession()",a),this.suppressGetSessionWarning=!0,await cw(this.storage,`${this.storageKey}-code-verifier`);let b=Object.assign({},a),c=b.user&&!0===b.user.__isUserNotAvailableProxy;if(this.userStorage){!c&&b.user&&await cu(this.userStorage,this.storageKey+"-user",{user:b.user});let a=Object.assign({},b);delete a.user;let d=cI(a);await cu(this.storage,this.storageKey,d)}else{let a=cI(b);await cu(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await cw(this.storage,this.storageKey),await cw(this.storage,this.storageKey+"-code-verifier"),await cw(this.storage,this.storageKey+"-user"),this.userStorage&&await cw(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let a=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{a&&cq()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",a)}catch(a){console.error("removing visibilitychange callback failed",a)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let a=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=a,a&&"object"==typeof a&&"function"==typeof a.unref?a.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(a),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let a=this.autoRefreshTicker;this.autoRefreshTicker=null,a&&clearInterval(a)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let a=Date.now();try{return await this._useSession(async b=>{let{data:{session:c}}=b;if(!c||!c.refresh_token||!c.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let d=Math.floor((1e3*c.expires_at-a)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${d} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),d<=3&&await this._callRefreshToken(c.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(a){if(a.isAcquireTimeout||a instanceof cY)this._debug("auto refresh token tick lock not available");else throw a}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!cq()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(a){console.error("_handleVisibilityChange",a)}}async _onVisibilityChanged(a){let b=`#_onVisibilityChanged(${a})`;this._debug(b,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),a||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState)return void this._debug(b,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(a,b,c){let d=[`provider=${encodeURIComponent(b)}`];if((null==c?void 0:c.redirectTo)&&d.push(`redirect_to=${encodeURIComponent(c.redirectTo)}`),(null==c?void 0:c.scopes)&&d.push(`scopes=${encodeURIComponent(c.scopes)}`),"pkce"===this.flowType){let[a,b]=await cD(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(b)}`});d.push(c.toString())}if(null==c?void 0:c.queryParams){let a=new URLSearchParams(c.queryParams);d.push(a.toString())}return(null==c?void 0:c.skipBrowserRedirect)&&d.push(`skip_http_redirect=${c.skipBrowserRedirect}`),`${a}?${d.join("&")}`}async _unenroll(a){try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;return e?this._returnResult({data:null,error:e}):await cM(this.fetch,"DELETE",`${this.url}/factors/${a.factorId}`,{headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token})})}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}}async _enroll(a){try{return await this._useSession(async b=>{var c,d;let{data:e,error:f}=b;if(f)return this._returnResult({data:null,error:f});let g=Object.assign({friendly_name:a.friendlyName,factor_type:a.factorType},"phone"===a.factorType?{phone:a.phone}:"totp"===a.factorType?{issuer:a.issuer}:{}),{data:h,error:i}=await cM(this.fetch,"POST",`${this.url}/factors`,{body:g,headers:this.headers,jwt:null==(c=null==e?void 0:e.session)?void 0:c.access_token});return i?this._returnResult({data:null,error:i}):("totp"===a.factorType&&"totp"===h.type&&(null==(d=null==h?void 0:h.totp)?void 0:d.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),this._returnResult({data:h,error:null}))})}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}}async _verify(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async b=>{var c,d,e;let{data:f,error:g}=b;if(g)return this._returnResult({data:null,error:g});let h=Object.assign({challenge_id:a.challengeId},"webauthn"in a?{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_response:"create"===a.webauthn.type?(d=a.webauthn.credential_response,"toJSON"in d&&"function"==typeof d.toJSON?d.toJSON():{id:d.id,rawId:d.id,response:{attestationObject:cp(new Uint8Array(d.response.attestationObject)),clientDataJSON:cp(new Uint8Array(d.response.clientDataJSON))},type:"public-key",clientExtensionResults:d.getClientExtensionResults(),authenticatorAttachment:null!=(e=d.authenticatorAttachment)?e:void 0}):function(a){var b;if("toJSON"in a&&"function"==typeof a.toJSON)return a.toJSON();let c=a.getClientExtensionResults(),d=a.response;return{id:a.id,rawId:a.id,response:{authenticatorData:cp(new Uint8Array(d.authenticatorData)),clientDataJSON:cp(new Uint8Array(d.clientDataJSON)),signature:cp(new Uint8Array(d.signature)),userHandle:d.userHandle?cp(new Uint8Array(d.userHandle)):void 0},type:"public-key",clientExtensionResults:c,authenticatorAttachment:null!=(b=a.authenticatorAttachment)?b:void 0}}(a.webauthn.credential_response)})}:{code:a.code}),{data:i,error:j}=await cM(this.fetch,"POST",`${this.url}/factors/${a.factorId}/verify`,{body:h,headers:this.headers,jwt:null==(c=null==f?void 0:f.session)?void 0:c.access_token});return j?this._returnResult({data:null,error:j}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),this._returnResult({data:i,error:j}))})}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}})}async _challenge(a){return this._acquireLock(-1,async()=>{try{return await this._useSession(async b=>{var c;let{data:d,error:e}=b;if(e)return this._returnResult({data:null,error:e});let f=await cM(this.fetch,"POST",`${this.url}/factors/${a.factorId}/challenge`,{body:a,headers:this.headers,jwt:null==(c=null==d?void 0:d.session)?void 0:c.access_token});if(f.error)return f;let{data:g}=f;if("webauthn"!==g.type)return{data:g,error:null};switch(g.webauthn.type){case"create":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:function(a){if(!a)throw Error("Credential creation options are required");if("undefined"!=typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(a);let{challenge:b,user:c,excludeCredentials:d}=a,e=aF(a,["challenge","user","excludeCredentials"]),f=co(b).buffer,g=Object.assign(Object.assign({},c),{id:co(c.id).buffer}),h=Object.assign(Object.assign({},e),{challenge:f,user:g});if(d&&d.length>0){h.excludeCredentials=Array(d.length);for(let a=0;a<d.length;a++){let b=d[a];h.excludeCredentials[a]=Object.assign(Object.assign({},b),{id:co(b.id).buffer,type:b.type||"public-key",transports:b.transports})}}return h}(g.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},g),{webauthn:Object.assign(Object.assign({},g.webauthn),{credential_options:Object.assign(Object.assign({},g.webauthn.credential_options),{publicKey:function(a){if(!a)throw Error("Credential request options are required");if("undefined"!=typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(a);let{challenge:b,allowCredentials:c}=a,d=aF(a,["challenge","allowCredentials"]),e=co(b).buffer,f=Object.assign(Object.assign({},d),{challenge:e});if(c&&c.length>0){f.allowCredentials=Array(c.length);for(let a=0;a<c.length;a++){let b=c[a];f.allowCredentials[a]=Object.assign(Object.assign({},b),{id:co(b.id).buffer,type:b.type||"public-key",transports:b.transports})}}return f}(g.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}})}async _challengeAndVerify(a){let{data:b,error:c}=await this._challenge({factorId:a.factorId});return c?this._returnResult({data:null,error:c}):await this._verify({factorId:a.factorId,challengeId:b.id,code:a.code})}async _listFactors(){var a;let{data:{user:b},error:c}=await this.getUser();if(c)return{data:null,error:c};let d={all:[],phone:[],totp:[],webauthn:[]};for(let c of null!=(a=null==b?void 0:b.factors)?a:[])d.all.push(c),"verified"===c.status&&d[c.factor_type].push(c);return{data:d,error:null}}async _getAuthenticatorAssuranceLevel(){var a,b;let{data:{session:c},error:d}=await this.getSession();if(d)return this._returnResult({data:null,error:d});if(!c)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:e}=cy(c.access_token),f=null;e.aal&&(f=e.aal);let g=f;return(null!=(b=null==(a=c.user.factors)?void 0:a.filter(a=>"verified"===a.status))?b:[]).length>0&&(g="aal2"),{data:{currentLevel:f,nextLevel:g,currentAuthenticationMethods:e.amr||[]},error:null}}async _getAuthorizationDetails(a){try{return await this._useSession(async b=>{let{data:{session:c},error:d}=b;return d?this._returnResult({data:null,error:d}):c?await cM(this.fetch,"GET",`${this.url}/oauth/authorizations/${a}`,{headers:this.headers,jwt:c.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new b8})})}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}}async _approveAuthorization(a,b){try{return await this._useSession(async c=>{let{data:{session:d},error:e}=c;if(e)return this._returnResult({data:null,error:e});if(!d)return this._returnResult({data:null,error:new b8});let f=await cM(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:d.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return f.data&&f.data.redirect_url&&cq()&&!(null==b?void 0:b.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}}async _denyAuthorization(a,b){try{return await this._useSession(async c=>{let{data:{session:d},error:e}=c;if(e)return this._returnResult({data:null,error:e});if(!d)return this._returnResult({data:null,error:new b8});let f=await cM(this.fetch,"POST",`${this.url}/oauth/authorizations/${a}/consent`,{headers:this.headers,jwt:d.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return f.data&&f.data.redirect_url&&cq()&&!(null==b?void 0:b.skipBrowserRedirect)&&window.location.assign(f.data.redirect_url),f})}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}}async _listOAuthGrants(){try{return await this._useSession(async a=>{let{data:{session:b},error:c}=a;return c?this._returnResult({data:null,error:c}):b?await cM(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:b.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new b8})})}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}}async _revokeOAuthGrant(a){try{return await this._useSession(async b=>{let{data:{session:c},error:d}=b;return d?this._returnResult({data:null,error:d}):c?(await cM(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:c.access_token,query:{client_id:a.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new b8})})}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}}async fetchJwk(a,b={keys:[]}){let c=b.keys.find(b=>b.kid===a);if(c)return c;let d=Date.now();if((c=this.jwks.keys.find(b=>b.kid===a))&&this.jwks_cached_at+6e5>d)return c;let{data:e,error:f}=await cM(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(f)throw f;return e.keys&&0!==e.keys.length&&(this.jwks=e,this.jwks_cached_at=d,c=e.keys.find(b=>b.kid===a))?c:null}async getClaims(a,b={}){try{let c=a;if(!c){let{data:a,error:b}=await this.getSession();if(b||!a.session)return this._returnResult({data:null,error:b});c=a.session.access_token}let{header:d,payload:e,signature:f,raw:{header:g,payload:h}}=cy(c);(null==b?void 0:b.allowExpired)||function(a){if(!a)throw Error("Missing exp claim");if(a<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(e.exp);let i=!d.alg||d.alg.startsWith("HS")||!d.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(d.kid,(null==b?void 0:b.keys)?{keys:b.keys}:null==b?void 0:b.jwks);if(!i){let{error:a}=await this.getUser(c);if(a)throw a;return{data:{claims:e,header:d,signature:f},error:null}}let j=function(a){switch(a){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(d.alg),k=await crypto.subtle.importKey("jwk",i,j,!0,["verify"]);if(!await crypto.subtle.verify(j,k,f,function(a){let b=[];return!function(a,b){for(let c=0;c<a.length;c+=1){let d=a.charCodeAt(c);if(d>55295&&d<=56319){let b=(d-55296)*1024&65535;d=(a.charCodeAt(c+1)-56320&65535|b)+65536,c+=1}!function(a,b){if(a<=127)return b(a);if(a<=2047){b(192|a>>6),b(128|63&a);return}if(a<=65535){b(224|a>>12),b(128|a>>6&63),b(128|63&a);return}if(a<=1114111){b(240|a>>18),b(128|a>>12&63),b(128|a>>6&63),b(128|63&a);return}throw Error(`Unrecognized Unicode codepoint: ${a.toString(16)}`)}(d,b)}}(a,a=>b.push(a)),new Uint8Array(b)}(`${g}.${h}`)))throw new ch("Invalid JWT signature");return{data:{claims:e,header:d,signature:f},error:null}}catch(a){if(b4(a))return this._returnResult({data:null,error:a});throw a}}}df.nextInstanceID={};let dg=df,dh="";dh="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let di={headers:{"X-Client-Info":`supabase-js-${dh}/2.89.0`}},dj={schema:"public"},dk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},dl={};function dm(a){return(dm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function dn(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function dp(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?dn(Object(c),!0).forEach(function(b){!function(a,b,c){var d;(d=function(a,b){if("object"!=dm(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=dm(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(b,"string"),(b="symbol"==dm(d)?d:d+"")in a)?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c}(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):dn(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}var dq=class extends dg{constructor(a){super(a)}},dr=class{constructor(a,b,c){var d,e,f;this.supabaseUrl=a,this.supabaseKey=b;let g=function(a){let b=null==a?void 0:a.trim();if(!b)throw Error("supabaseUrl is required.");if(!b.match(/^https?:\/\//i))throw Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(b.endsWith("/")?b:b+"/")}catch(a){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}(a);if(!b)throw Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",g),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",g),this.storageUrl=new URL("storage/v1",g),this.functionsUrl=new URL("functions/v1",g);let h=`sb-${g.hostname.split(".")[0]}-auth-token`,i=function(a,b){var c,d;let{db:e,auth:f,realtime:g,global:h}=a,{db:i,auth:j,realtime:k,global:l}=b,m={db:dp(dp({},i),e),auth:dp(dp({},j),f),realtime:dp(dp({},k),g),storage:{},global:dp(dp(dp({},l),h),{},{headers:dp(dp({},null!=(c=null==l?void 0:l.headers)?c:{}),null!=(d=null==h?void 0:h.headers)?d:{})}),accessToken:async()=>""};return a.accessToken?m.accessToken=a.accessToken:delete m.accessToken,m}(null!=c?c:{},{db:dj,realtime:dl,auth:dp(dp({},dk),{},{storageKey:h}),global:di});this.storageKey=null!=(d=i.auth.storageKey)?d:"",this.headers=null!=(e=i.global.headers)?e:{},i.accessToken?(this.accessToken=i.accessToken,this.auth=new Proxy({},{get:(a,b)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(f=i.auth)?f:{},this.headers,i.global.fetch),this.fetch=((a,b,c)=>{let d=(a=>a?(...b)=>a(...b):(...a)=>fetch(...a))(c),e=Headers;return async(c,f)=>{var g;let h=null!=(g=await b())?g:a,i=new e(null==f?void 0:f.headers);return i.has("apikey")||i.set("apikey",a),i.has("Authorization")||i.set("Authorization",`Bearer ${h}`),d(c,dp(dp({},f),{},{headers:i}))}})(b,this._getAccessToken.bind(this),i.global.fetch),this.realtime=this._initRealtimeClient(dp({headers:this.headers,accessToken:this._getAccessToken.bind(this)},i.realtime)),this.accessToken&&this.accessToken().then(a=>this.realtime.setAuth(a)).catch(a=>console.warn("Failed to set initial Realtime auth token:",a)),this.rest=new aR(new URL("rest/v1",g).href,{headers:this.headers,schema:i.db.schema,fetch:this.fetch}),this.storage=new bZ(this.storageUrl.href,this.headers,this.fetch,null==c?void 0:c.storage),i.accessToken||this._listenForAuthEvents()}get functions(){return new aK(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(a){return this.rest.from(a)}schema(a){return this.rest.schema(a)}rpc(a,b={},c={head:!1,get:!1,count:void 0}){return this.rest.rpc(a,b,c)}channel(a,b={config:{}}){return this.realtime.channel(a,b)}getChannels(){return this.realtime.getChannels()}removeChannel(a){return this.realtime.removeChannel(a)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var a,b;if(this.accessToken)return await this.accessToken();let{data:c}=await this.auth.getSession();return null!=(a=null==(b=c.session)?void 0:b.access_token)?a:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:a,persistSession:b,detectSessionInUrl:c,storage:d,userStorage:e,storageKey:f,flowType:g,lock:h,debug:i,throwOnError:j},k,l){let m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new dq({url:this.authUrl.href,headers:dp(dp({},m),k),storageKey:f,autoRefreshToken:a,persistSession:b,detectSessionInUrl:c,storage:d,userStorage:e,flowType:g,lock:h,debug:i,throwOnError:j,fetch:l,hasCustomAuthorizationHeader:Object.keys(this.headers).some(a=>"authorization"===a.toLowerCase())})}_initRealtimeClient(a){return new bb(this.realtimeUrl.href,dp(dp({},a),{},{params:dp(dp({},{apikey:this.supabaseKey}),null==a?void 0:a.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,b)=>{this._handleTokenChanged(a,"CLIENT",null==b?void 0:b.access_token)})}_handleTokenChanged(a,b,c){("TOKEN_REFRESHED"===a||"SIGNED_IN"===a)&&this.changedAccessToken!==c?(this.changedAccessToken=c,this.realtime.setAuth(c)):"SIGNED_OUT"===a&&(this.realtime.setAuth(),"STORAGE"==b&&this.auth.signOut(),this.changedAccessToken=void 0)}};(function(){if("undefined"!=typeof window||"undefined"==typeof process)return!1;let a=process.version;if(null==a)return!1;let b=a.match(/^v(\d+)\./);return!!b&&18>=parseInt(b[1],10)})()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var ds=c(19182);!function(a){a.assertEqual=a=>{},a.assertIs=function(a){},a.assertNever=function(a){throw Error()},a.arrayToEnum=a=>{let b={};for(let c of a)b[c]=c;return b},a.getValidEnumValues=b=>{let c=a.objectKeys(b).filter(a=>"number"!=typeof b[b[a]]),d={};for(let a of c)d[a]=b[a];return a.objectValues(d)},a.objectValues=b=>a.objectKeys(b).map(function(a){return b[a]}),a.objectKeys="function"==typeof Object.keys?a=>Object.keys(a):a=>{let b=[];for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b},a.find=(a,b)=>{for(let c of a)if(b(c))return c},a.isInteger="function"==typeof Number.isInteger?a=>Number.isInteger(a):a=>"number"==typeof a&&Number.isFinite(a)&&Math.floor(a)===a,a.joinValues=function(a,b=" | "){return a.map(a=>"string"==typeof a?`'${a}'`:a).join(b)},a.jsonStringifyReplacer=(a,b)=>"bigint"==typeof b?b.toString():b}(x||(x={})),(y||(y={})).mergeShapes=(a,b)=>({...a,...b});let dt=x.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),du=a=>{switch(typeof a){case"undefined":return dt.undefined;case"string":return dt.string;case"number":return Number.isNaN(a)?dt.nan:dt.number;case"boolean":return dt.boolean;case"function":return dt.function;case"bigint":return dt.bigint;case"symbol":return dt.symbol;case"object":if(Array.isArray(a))return dt.array;if(null===a)return dt.null;if(a.then&&"function"==typeof a.then&&a.catch&&"function"==typeof a.catch)return dt.promise;if("undefined"!=typeof Map&&a instanceof Map)return dt.map;if("undefined"!=typeof Set&&a instanceof Set)return dt.set;if("undefined"!=typeof Date&&a instanceof Date)return dt.date;return dt.object;default:return dt.unknown}},dv=x.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class dw extends Error{get errors(){return this.issues}constructor(a){super(),this.issues=[],this.addIssue=a=>{this.issues=[...this.issues,a]},this.addIssues=(a=[])=>{this.issues=[...this.issues,...a]};let b=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,b):this.__proto__=b,this.name="ZodError",this.issues=a}format(a){let b=a||function(a){return a.message},c={_errors:[]},d=a=>{for(let e of a.issues)if("invalid_union"===e.code)e.unionErrors.map(d);else if("invalid_return_type"===e.code)d(e.returnTypeError);else if("invalid_arguments"===e.code)d(e.argumentsError);else if(0===e.path.length)c._errors.push(b(e));else{let a=c,d=0;for(;d<e.path.length;){let c=e.path[d];d===e.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(b(e))):a[c]=a[c]||{_errors:[]},a=a[c],d++}}};return d(this),c}static assert(a){if(!(a instanceof dw))throw Error(`Not a ZodError: ${a}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,x.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(a=a=>a.message){let b={},c=[];for(let d of this.issues)if(d.path.length>0){let c=d.path[0];b[c]=b[c]||[],b[c].push(a(d))}else c.push(a(d));return{formErrors:c,fieldErrors:b}}get formErrors(){return this.flatten()}}dw.create=a=>new dw(a);let dx=(a,b)=>{let c;switch(a.code){case dv.invalid_type:c=a.received===dt.undefined?"Required":`Expected ${a.expected}, received ${a.received}`;break;case dv.invalid_literal:c=`Invalid literal value, expected ${JSON.stringify(a.expected,x.jsonStringifyReplacer)}`;break;case dv.unrecognized_keys:c=`Unrecognized key(s) in object: ${x.joinValues(a.keys,", ")}`;break;case dv.invalid_union:c="Invalid input";break;case dv.invalid_union_discriminator:c=`Invalid discriminator value. Expected ${x.joinValues(a.options)}`;break;case dv.invalid_enum_value:c=`Invalid enum value. Expected ${x.joinValues(a.options)}, received '${a.received}'`;break;case dv.invalid_arguments:c="Invalid function arguments";break;case dv.invalid_return_type:c="Invalid function return type";break;case dv.invalid_date:c="Invalid date";break;case dv.invalid_string:"object"==typeof a.validation?"includes"in a.validation?(c=`Invalid input: must include "${a.validation.includes}"`,"number"==typeof a.validation.position&&(c=`${c} at one or more positions greater than or equal to ${a.validation.position}`)):"startsWith"in a.validation?c=`Invalid input: must start with "${a.validation.startsWith}"`:"endsWith"in a.validation?c=`Invalid input: must end with "${a.validation.endsWith}"`:x.assertNever(a.validation):c="regex"!==a.validation?`Invalid ${a.validation}`:"Invalid";break;case dv.too_small:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at least":"more than"} ${a.minimum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at least":"over"} ${a.minimum} character(s)`:"number"===a.type||"bigint"===a.type?`Number must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${a.minimum}`:"date"===a.type?`Date must be ${a.exact?"exactly equal to ":a.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(a.minimum))}`:"Invalid input";break;case dv.too_big:c="array"===a.type?`Array must contain ${a.exact?"exactly":a.inclusive?"at most":"less than"} ${a.maximum} element(s)`:"string"===a.type?`String must contain ${a.exact?"exactly":a.inclusive?"at most":"under"} ${a.maximum} character(s)`:"number"===a.type?`Number must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"bigint"===a.type?`BigInt must be ${a.exact?"exactly":a.inclusive?"less than or equal to":"less than"} ${a.maximum}`:"date"===a.type?`Date must be ${a.exact?"exactly":a.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(a.maximum))}`:"Invalid input";break;case dv.custom:c="Invalid input";break;case dv.invalid_intersection_types:c="Intersection results could not be merged";break;case dv.not_multiple_of:c=`Number must be a multiple of ${a.multipleOf}`;break;case dv.not_finite:c="Number must be finite";break;default:c=b.defaultError,x.assertNever(a)}return{message:c}};!function(a){a.errToObj=a=>"string"==typeof a?{message:a}:a||{},a.toString=a=>"string"==typeof a?a:a?.message}(z||(z={}));let dy=a=>{let{data:b,path:c,errorMaps:d,issueData:e}=a,f=[...c,...e.path||[]],g={...e,path:f};if(void 0!==e.message)return{...e,path:f,message:e.message};let h="";for(let a of d.filter(a=>!!a).slice().reverse())h=a(g,{data:b,defaultError:h}).message;return{...e,path:f,message:h}};function dz(a,b){let c=dy({issueData:b,data:a.data,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,dx,void 0].filter(a=>!!a)});a.common.issues.push(c)}class dA{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(a,b){let c=[];for(let d of b){if("aborted"===d.status)return dB;"dirty"===d.status&&a.dirty(),c.push(d.value)}return{status:a.value,value:c}}static async mergeObjectAsync(a,b){let c=[];for(let a of b){let b=await a.key,d=await a.value;c.push({key:b,value:d})}return dA.mergeObjectSync(a,c)}static mergeObjectSync(a,b){let c={};for(let d of b){let{key:b,value:e}=d;if("aborted"===b.status||"aborted"===e.status)return dB;"dirty"===b.status&&a.dirty(),"dirty"===e.status&&a.dirty(),"__proto__"!==b.value&&(void 0!==e.value||d.alwaysSet)&&(c[b.value]=e.value)}return{status:a.value,value:c}}}let dB=Object.freeze({status:"aborted"}),dC=a=>({status:"dirty",value:a}),dD=a=>({status:"valid",value:a}),dE=a=>"undefined"!=typeof Promise&&a instanceof Promise;class dF{constructor(a,b,c,d){this._cachedPath=[],this.parent=a,this.data=b,this._path=c,this._key=d}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let dG=(a,b)=>{if("valid"===b.status)return{success:!0,data:b.value};if(!a.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let b=new dw(a.common.issues);return this._error=b,this._error}}};function dH(a){if(!a)return{};let{errorMap:b,invalid_type_error:c,required_error:d,description:e}=a;if(b&&(c||d))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return b?{errorMap:b,description:e}:{errorMap:(b,e)=>{let{message:f}=a;return"invalid_enum_value"===b.code?{message:f??e.defaultError}:void 0===e.data?{message:f??d??e.defaultError}:"invalid_type"!==b.code?{message:e.defaultError}:{message:f??c??e.defaultError}},description:e}}class dI{get description(){return this._def.description}_getType(a){return du(a.data)}_getOrReturnCtx(a,b){return b||{common:a.parent.common,data:a.data,parsedType:du(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}_processInputParams(a){return{status:new dA,ctx:{common:a.parent.common,data:a.data,parsedType:du(a.data),schemaErrorMap:this._def.errorMap,path:a.path,parent:a.parent}}}_parseSync(a){let b=this._parse(a);if(dE(b))throw Error("Synchronous parse encountered promise.");return b}_parseAsync(a){return Promise.resolve(this._parse(a))}parse(a,b){let c=this.safeParse(a,b);if(c.success)return c.data;throw c.error}safeParse(a,b){let c={common:{issues:[],async:b?.async??!1,contextualErrorMap:b?.errorMap},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:du(a)},d=this._parseSync({data:a,path:c.path,parent:c});return dG(c,d)}"~validate"(a){let b={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:du(a)};if(!this["~standard"].async)try{let c=this._parseSync({data:a,path:[],parent:b});return"valid"===c.status?{value:c.value}:{issues:b.common.issues}}catch(a){a?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),b.common={issues:[],async:!0}}return this._parseAsync({data:a,path:[],parent:b}).then(a=>"valid"===a.status?{value:a.value}:{issues:b.common.issues})}async parseAsync(a,b){let c=await this.safeParseAsync(a,b);if(c.success)return c.data;throw c.error}async safeParseAsync(a,b){let c={common:{issues:[],contextualErrorMap:b?.errorMap,async:!0},path:b?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:a,parsedType:du(a)},d=this._parse({data:a,path:c.path,parent:c});return dG(c,await (dE(d)?d:Promise.resolve(d)))}refine(a,b){return this._refinement((c,d)=>{let e=a(c),f=()=>d.addIssue({code:dv.custom,..."string"==typeof b||void 0===b?{message:b}:"function"==typeof b?b(c):b});return"undefined"!=typeof Promise&&e instanceof Promise?e.then(a=>!!a||(f(),!1)):!!e||(f(),!1)})}refinement(a,b){return this._refinement((c,d)=>!!a(c)||(d.addIssue("function"==typeof b?b(c,d):b),!1))}_refinement(a){return new er({schema:this,typeName:A.ZodEffects,effect:{type:"refinement",refinement:a}})}superRefine(a){return this._refinement(a)}constructor(a){this.spa=this.safeParseAsync,this._def=a,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:a=>this["~validate"](a)}}optional(){return es.create(this,this._def)}nullable(){return et.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ea.create(this)}promise(){return eq.create(this,this._def)}or(a){return ec.create([this,a],this._def)}and(a){return ef.create(this,a,this._def)}transform(a){return new er({...dH(this._def),schema:this,typeName:A.ZodEffects,effect:{type:"transform",transform:a}})}default(a){return new eu({...dH(this._def),innerType:this,defaultValue:"function"==typeof a?a:()=>a,typeName:A.ZodDefault})}brand(){return new ex({typeName:A.ZodBranded,type:this,...dH(this._def)})}catch(a){return new ev({...dH(this._def),innerType:this,catchValue:"function"==typeof a?a:()=>a,typeName:A.ZodCatch})}describe(a){return new this.constructor({...this._def,description:a})}pipe(a){return ey.create(this,a)}readonly(){return ez.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let dJ=/^c[^\s-]{8,}$/i,dK=/^[0-9a-z]+$/,dL=/^[0-9A-HJKMNP-TV-Z]{26}$/i,dM=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,dN=/^[a-z0-9_-]{21}$/i,dO=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,dP=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,dQ=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,dR=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,dS=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,dT=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,dU=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,dV=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,dW=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,dX="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dY=RegExp(`^${dX}$`);function dZ(a){let b="[0-5]\\d";a.precision?b=`${b}\\.\\d{${a.precision}}`:null==a.precision&&(b=`${b}(\\.\\d+)?`);let c=a.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${b})${c}`}class d$ extends dI{_parse(a){var b,c,d,f;let g;if(this._def.coerce&&(a.data=String(a.data)),this._getType(a)!==dt.string){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.string,received:b.parsedType}),dB}let h=new dA;for(let i of this._def.checks)if("min"===i.kind)a.data.length<i.value&&(dz(g=this._getOrReturnCtx(a,g),{code:dv.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("max"===i.kind)a.data.length>i.value&&(dz(g=this._getOrReturnCtx(a,g),{code:dv.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),h.dirty());else if("length"===i.kind){let b=a.data.length>i.value,c=a.data.length<i.value;(b||c)&&(g=this._getOrReturnCtx(a,g),b?dz(g,{code:dv.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&dz(g,{code:dv.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),h.dirty())}else if("email"===i.kind)dQ.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{validation:"email",code:dv.invalid_string,message:i.message}),h.dirty());else if("emoji"===i.kind)e||(e=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),e.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{validation:"emoji",code:dv.invalid_string,message:i.message}),h.dirty());else if("uuid"===i.kind)dM.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{validation:"uuid",code:dv.invalid_string,message:i.message}),h.dirty());else if("nanoid"===i.kind)dN.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{validation:"nanoid",code:dv.invalid_string,message:i.message}),h.dirty());else if("cuid"===i.kind)dJ.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{validation:"cuid",code:dv.invalid_string,message:i.message}),h.dirty());else if("cuid2"===i.kind)dK.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{validation:"cuid2",code:dv.invalid_string,message:i.message}),h.dirty());else if("ulid"===i.kind)dL.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{validation:"ulid",code:dv.invalid_string,message:i.message}),h.dirty());else if("url"===i.kind)try{new URL(a.data)}catch{dz(g=this._getOrReturnCtx(a,g),{validation:"url",code:dv.invalid_string,message:i.message}),h.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{validation:"regex",code:dv.invalid_string,message:i.message}),h.dirty())):"trim"===i.kind?a.data=a.data.trim():"includes"===i.kind?a.data.includes(i.value,i.position)||(dz(g=this._getOrReturnCtx(a,g),{code:dv.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),h.dirty()):"toLowerCase"===i.kind?a.data=a.data.toLowerCase():"toUpperCase"===i.kind?a.data=a.data.toUpperCase():"startsWith"===i.kind?a.data.startsWith(i.value)||(dz(g=this._getOrReturnCtx(a,g),{code:dv.invalid_string,validation:{startsWith:i.value},message:i.message}),h.dirty()):"endsWith"===i.kind?a.data.endsWith(i.value)||(dz(g=this._getOrReturnCtx(a,g),{code:dv.invalid_string,validation:{endsWith:i.value},message:i.message}),h.dirty()):"datetime"===i.kind?(function(a){let b=`${dX}T${dZ(a)}`,c=[];return c.push(a.local?"Z?":"Z"),a.offset&&c.push("([+-]\\d{2}:?\\d{2})"),b=`${b}(${c.join("|")})`,RegExp(`^${b}$`)})(i).test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{code:dv.invalid_string,validation:"datetime",message:i.message}),h.dirty()):"date"===i.kind?dY.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{code:dv.invalid_string,validation:"date",message:i.message}),h.dirty()):"time"===i.kind?RegExp(`^${dZ(i)}$`).test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{code:dv.invalid_string,validation:"time",message:i.message}),h.dirty()):"duration"===i.kind?dP.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{validation:"duration",code:dv.invalid_string,message:i.message}),h.dirty()):"ip"===i.kind?(b=a.data,!(("v4"===(c=i.version)||!c)&&dR.test(b)||("v6"===c||!c)&&dT.test(b))&&1&&(dz(g=this._getOrReturnCtx(a,g),{validation:"ip",code:dv.invalid_string,message:i.message}),h.dirty())):"jwt"===i.kind?!function(a,b){if(!dO.test(a))return!1;try{let[c]=a.split(".");if(!c)return!1;let d=c.replace(/-/g,"+").replace(/_/g,"/").padEnd(c.length+(4-c.length%4)%4,"="),e=JSON.parse(atob(d));if("object"!=typeof e||null===e||"typ"in e&&e?.typ!=="JWT"||!e.alg||b&&e.alg!==b)return!1;return!0}catch{return!1}}(a.data,i.alg)&&(dz(g=this._getOrReturnCtx(a,g),{validation:"jwt",code:dv.invalid_string,message:i.message}),h.dirty()):"cidr"===i.kind?(d=a.data,!(("v4"===(f=i.version)||!f)&&dS.test(d)||("v6"===f||!f)&&dU.test(d))&&1&&(dz(g=this._getOrReturnCtx(a,g),{validation:"cidr",code:dv.invalid_string,message:i.message}),h.dirty())):"base64"===i.kind?dV.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{validation:"base64",code:dv.invalid_string,message:i.message}),h.dirty()):"base64url"===i.kind?dW.test(a.data)||(dz(g=this._getOrReturnCtx(a,g),{validation:"base64url",code:dv.invalid_string,message:i.message}),h.dirty()):x.assertNever(i);return{status:h.value,value:a.data}}_regex(a,b,c){return this.refinement(b=>a.test(b),{validation:b,code:dv.invalid_string,...z.errToObj(c)})}_addCheck(a){return new d$({...this._def,checks:[...this._def.checks,a]})}email(a){return this._addCheck({kind:"email",...z.errToObj(a)})}url(a){return this._addCheck({kind:"url",...z.errToObj(a)})}emoji(a){return this._addCheck({kind:"emoji",...z.errToObj(a)})}uuid(a){return this._addCheck({kind:"uuid",...z.errToObj(a)})}nanoid(a){return this._addCheck({kind:"nanoid",...z.errToObj(a)})}cuid(a){return this._addCheck({kind:"cuid",...z.errToObj(a)})}cuid2(a){return this._addCheck({kind:"cuid2",...z.errToObj(a)})}ulid(a){return this._addCheck({kind:"ulid",...z.errToObj(a)})}base64(a){return this._addCheck({kind:"base64",...z.errToObj(a)})}base64url(a){return this._addCheck({kind:"base64url",...z.errToObj(a)})}jwt(a){return this._addCheck({kind:"jwt",...z.errToObj(a)})}ip(a){return this._addCheck({kind:"ip",...z.errToObj(a)})}cidr(a){return this._addCheck({kind:"cidr",...z.errToObj(a)})}datetime(a){return"string"==typeof a?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:a}):this._addCheck({kind:"datetime",precision:void 0===a?.precision?null:a?.precision,offset:a?.offset??!1,local:a?.local??!1,...z.errToObj(a?.message)})}date(a){return this._addCheck({kind:"date",message:a})}time(a){return"string"==typeof a?this._addCheck({kind:"time",precision:null,message:a}):this._addCheck({kind:"time",precision:void 0===a?.precision?null:a?.precision,...z.errToObj(a?.message)})}duration(a){return this._addCheck({kind:"duration",...z.errToObj(a)})}regex(a,b){return this._addCheck({kind:"regex",regex:a,...z.errToObj(b)})}includes(a,b){return this._addCheck({kind:"includes",value:a,position:b?.position,...z.errToObj(b?.message)})}startsWith(a,b){return this._addCheck({kind:"startsWith",value:a,...z.errToObj(b)})}endsWith(a,b){return this._addCheck({kind:"endsWith",value:a,...z.errToObj(b)})}min(a,b){return this._addCheck({kind:"min",value:a,...z.errToObj(b)})}max(a,b){return this._addCheck({kind:"max",value:a,...z.errToObj(b)})}length(a,b){return this._addCheck({kind:"length",value:a,...z.errToObj(b)})}nonempty(a){return this.min(1,z.errToObj(a))}trim(){return new d$({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new d$({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new d$({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(a=>"datetime"===a.kind)}get isDate(){return!!this._def.checks.find(a=>"date"===a.kind)}get isTime(){return!!this._def.checks.find(a=>"time"===a.kind)}get isDuration(){return!!this._def.checks.find(a=>"duration"===a.kind)}get isEmail(){return!!this._def.checks.find(a=>"email"===a.kind)}get isURL(){return!!this._def.checks.find(a=>"url"===a.kind)}get isEmoji(){return!!this._def.checks.find(a=>"emoji"===a.kind)}get isUUID(){return!!this._def.checks.find(a=>"uuid"===a.kind)}get isNANOID(){return!!this._def.checks.find(a=>"nanoid"===a.kind)}get isCUID(){return!!this._def.checks.find(a=>"cuid"===a.kind)}get isCUID2(){return!!this._def.checks.find(a=>"cuid2"===a.kind)}get isULID(){return!!this._def.checks.find(a=>"ulid"===a.kind)}get isIP(){return!!this._def.checks.find(a=>"ip"===a.kind)}get isCIDR(){return!!this._def.checks.find(a=>"cidr"===a.kind)}get isBase64(){return!!this._def.checks.find(a=>"base64"===a.kind)}get isBase64url(){return!!this._def.checks.find(a=>"base64url"===a.kind)}get minLength(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxLength(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}d$.create=a=>new d$({checks:[],typeName:A.ZodString,coerce:a?.coerce??!1,...dH(a)});class d_ extends dI{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(a){let b;if(this._def.coerce&&(a.data=Number(a.data)),this._getType(a)!==dt.number){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.number,received:b.parsedType}),dB}let c=new dA;for(let d of this._def.checks)"int"===d.kind?x.isInteger(a.data)||(dz(b=this._getOrReturnCtx(a,b),{code:dv.invalid_type,expected:"integer",received:"float",message:d.message}),c.dirty()):"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(dz(b=this._getOrReturnCtx(a,b),{code:dv.too_small,minimum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(dz(b=this._getOrReturnCtx(a,b),{code:dv.too_big,maximum:d.value,type:"number",inclusive:d.inclusive,exact:!1,message:d.message}),c.dirty()):"multipleOf"===d.kind?0!==function(a,b){let c=(a.toString().split(".")[1]||"").length,d=(b.toString().split(".")[1]||"").length,e=c>d?c:d;return Number.parseInt(a.toFixed(e).replace(".",""))%Number.parseInt(b.toFixed(e).replace(".",""))/10**e}(a.data,d.value)&&(dz(b=this._getOrReturnCtx(a,b),{code:dv.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):"finite"===d.kind?Number.isFinite(a.data)||(dz(b=this._getOrReturnCtx(a,b),{code:dv.not_finite,message:d.message}),c.dirty()):x.assertNever(d);return{status:c.value,value:a.data}}gte(a,b){return this.setLimit("min",a,!0,z.toString(b))}gt(a,b){return this.setLimit("min",a,!1,z.toString(b))}lte(a,b){return this.setLimit("max",a,!0,z.toString(b))}lt(a,b){return this.setLimit("max",a,!1,z.toString(b))}setLimit(a,b,c,d){return new d_({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:z.toString(d)}]})}_addCheck(a){return new d_({...this._def,checks:[...this._def.checks,a]})}int(a){return this._addCheck({kind:"int",message:z.toString(a)})}positive(a){return this._addCheck({kind:"min",value:0,inclusive:!1,message:z.toString(a)})}negative(a){return this._addCheck({kind:"max",value:0,inclusive:!1,message:z.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:0,inclusive:!0,message:z.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:0,inclusive:!0,message:z.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:z.toString(b)})}finite(a){return this._addCheck({kind:"finite",message:z.toString(a)})}safe(a){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:z.toString(a)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:z.toString(a)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}get isInt(){return!!this._def.checks.find(a=>"int"===a.kind||"multipleOf"===a.kind&&x.isInteger(a.value))}get isFinite(){let a=null,b=null;for(let c of this._def.checks)if("finite"===c.kind||"int"===c.kind||"multipleOf"===c.kind)return!0;else"min"===c.kind?(null===b||c.value>b)&&(b=c.value):"max"===c.kind&&(null===a||c.value<a)&&(a=c.value);return Number.isFinite(b)&&Number.isFinite(a)}}d_.create=a=>new d_({checks:[],typeName:A.ZodNumber,coerce:a?.coerce||!1,...dH(a)});class d0 extends dI{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(a){let b;if(this._def.coerce)try{a.data=BigInt(a.data)}catch{return this._getInvalidInput(a)}if(this._getType(a)!==dt.bigint)return this._getInvalidInput(a);let c=new dA;for(let d of this._def.checks)"min"===d.kind?(d.inclusive?a.data<d.value:a.data<=d.value)&&(dz(b=this._getOrReturnCtx(a,b),{code:dv.too_small,type:"bigint",minimum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"max"===d.kind?(d.inclusive?a.data>d.value:a.data>=d.value)&&(dz(b=this._getOrReturnCtx(a,b),{code:dv.too_big,type:"bigint",maximum:d.value,inclusive:d.inclusive,message:d.message}),c.dirty()):"multipleOf"===d.kind?a.data%d.value!==BigInt(0)&&(dz(b=this._getOrReturnCtx(a,b),{code:dv.not_multiple_of,multipleOf:d.value,message:d.message}),c.dirty()):x.assertNever(d);return{status:c.value,value:a.data}}_getInvalidInput(a){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.bigint,received:b.parsedType}),dB}gte(a,b){return this.setLimit("min",a,!0,z.toString(b))}gt(a,b){return this.setLimit("min",a,!1,z.toString(b))}lte(a,b){return this.setLimit("max",a,!0,z.toString(b))}lt(a,b){return this.setLimit("max",a,!1,z.toString(b))}setLimit(a,b,c,d){return new d0({...this._def,checks:[...this._def.checks,{kind:a,value:b,inclusive:c,message:z.toString(d)}]})}_addCheck(a){return new d0({...this._def,checks:[...this._def.checks,a]})}positive(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:z.toString(a)})}negative(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:z.toString(a)})}nonpositive(a){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:z.toString(a)})}nonnegative(a){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:z.toString(a)})}multipleOf(a,b){return this._addCheck({kind:"multipleOf",value:a,message:z.toString(b)})}get minValue(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return a}get maxValue(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return a}}d0.create=a=>new d0({checks:[],typeName:A.ZodBigInt,coerce:a?.coerce??!1,...dH(a)});class d1 extends dI{_parse(a){if(this._def.coerce&&(a.data=!!a.data),this._getType(a)!==dt.boolean){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.boolean,received:b.parsedType}),dB}return dD(a.data)}}d1.create=a=>new d1({typeName:A.ZodBoolean,coerce:a?.coerce||!1,...dH(a)});class d2 extends dI{_parse(a){let b;if(this._def.coerce&&(a.data=new Date(a.data)),this._getType(a)!==dt.date){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.date,received:b.parsedType}),dB}if(Number.isNaN(a.data.getTime()))return dz(this._getOrReturnCtx(a),{code:dv.invalid_date}),dB;let c=new dA;for(let d of this._def.checks)"min"===d.kind?a.data.getTime()<d.value&&(dz(b=this._getOrReturnCtx(a,b),{code:dv.too_small,message:d.message,inclusive:!0,exact:!1,minimum:d.value,type:"date"}),c.dirty()):"max"===d.kind?a.data.getTime()>d.value&&(dz(b=this._getOrReturnCtx(a,b),{code:dv.too_big,message:d.message,inclusive:!0,exact:!1,maximum:d.value,type:"date"}),c.dirty()):x.assertNever(d);return{status:c.value,value:new Date(a.data.getTime())}}_addCheck(a){return new d2({...this._def,checks:[...this._def.checks,a]})}min(a,b){return this._addCheck({kind:"min",value:a.getTime(),message:z.toString(b)})}max(a,b){return this._addCheck({kind:"max",value:a.getTime(),message:z.toString(b)})}get minDate(){let a=null;for(let b of this._def.checks)"min"===b.kind&&(null===a||b.value>a)&&(a=b.value);return null!=a?new Date(a):null}get maxDate(){let a=null;for(let b of this._def.checks)"max"===b.kind&&(null===a||b.value<a)&&(a=b.value);return null!=a?new Date(a):null}}d2.create=a=>new d2({checks:[],coerce:a?.coerce||!1,typeName:A.ZodDate,...dH(a)});class d3 extends dI{_parse(a){if(this._getType(a)!==dt.symbol){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.symbol,received:b.parsedType}),dB}return dD(a.data)}}d3.create=a=>new d3({typeName:A.ZodSymbol,...dH(a)});class d4 extends dI{_parse(a){if(this._getType(a)!==dt.undefined){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.undefined,received:b.parsedType}),dB}return dD(a.data)}}d4.create=a=>new d4({typeName:A.ZodUndefined,...dH(a)});class d5 extends dI{_parse(a){if(this._getType(a)!==dt.null){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.null,received:b.parsedType}),dB}return dD(a.data)}}d5.create=a=>new d5({typeName:A.ZodNull,...dH(a)});class d6 extends dI{constructor(){super(...arguments),this._any=!0}_parse(a){return dD(a.data)}}d6.create=a=>new d6({typeName:A.ZodAny,...dH(a)});class d7 extends dI{constructor(){super(...arguments),this._unknown=!0}_parse(a){return dD(a.data)}}d7.create=a=>new d7({typeName:A.ZodUnknown,...dH(a)});class d8 extends dI{_parse(a){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.never,received:b.parsedType}),dB}}d8.create=a=>new d8({typeName:A.ZodNever,...dH(a)});class d9 extends dI{_parse(a){if(this._getType(a)!==dt.undefined){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.void,received:b.parsedType}),dB}return dD(a.data)}}d9.create=a=>new d9({typeName:A.ZodVoid,...dH(a)});class ea extends dI{_parse(a){let{ctx:b,status:c}=this._processInputParams(a),d=this._def;if(b.parsedType!==dt.array)return dz(b,{code:dv.invalid_type,expected:dt.array,received:b.parsedType}),dB;if(null!==d.exactLength){let a=b.data.length>d.exactLength.value,e=b.data.length<d.exactLength.value;(a||e)&&(dz(b,{code:a?dv.too_big:dv.too_small,minimum:e?d.exactLength.value:void 0,maximum:a?d.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:d.exactLength.message}),c.dirty())}if(null!==d.minLength&&b.data.length<d.minLength.value&&(dz(b,{code:dv.too_small,minimum:d.minLength.value,type:"array",inclusive:!0,exact:!1,message:d.minLength.message}),c.dirty()),null!==d.maxLength&&b.data.length>d.maxLength.value&&(dz(b,{code:dv.too_big,maximum:d.maxLength.value,type:"array",inclusive:!0,exact:!1,message:d.maxLength.message}),c.dirty()),b.common.async)return Promise.all([...b.data].map((a,c)=>d.type._parseAsync(new dF(b,a,b.path,c)))).then(a=>dA.mergeArray(c,a));let e=[...b.data].map((a,c)=>d.type._parseSync(new dF(b,a,b.path,c)));return dA.mergeArray(c,e)}get element(){return this._def.type}min(a,b){return new ea({...this._def,minLength:{value:a,message:z.toString(b)}})}max(a,b){return new ea({...this._def,maxLength:{value:a,message:z.toString(b)}})}length(a,b){return new ea({...this._def,exactLength:{value:a,message:z.toString(b)}})}nonempty(a){return this.min(1,a)}}ea.create=(a,b)=>new ea({type:a,minLength:null,maxLength:null,exactLength:null,typeName:A.ZodArray,...dH(b)});class eb extends dI{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let a=this._def.shape(),b=x.objectKeys(a);return this._cached={shape:a,keys:b},this._cached}_parse(a){if(this._getType(a)!==dt.object){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.object,received:b.parsedType}),dB}let{status:b,ctx:c}=this._processInputParams(a),{shape:d,keys:e}=this._getCached(),f=[];if(!(this._def.catchall instanceof d8&&"strip"===this._def.unknownKeys))for(let a in c.data)e.includes(a)||f.push(a);let g=[];for(let a of e){let b=d[a],e=c.data[a];g.push({key:{status:"valid",value:a},value:b._parse(new dF(c,e,c.path,a)),alwaysSet:a in c.data})}if(this._def.catchall instanceof d8){let a=this._def.unknownKeys;if("passthrough"===a)for(let a of f)g.push({key:{status:"valid",value:a},value:{status:"valid",value:c.data[a]}});else if("strict"===a)f.length>0&&(dz(c,{code:dv.unrecognized_keys,keys:f}),b.dirty());else if("strip"===a);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let a=this._def.catchall;for(let b of f){let d=c.data[b];g.push({key:{status:"valid",value:b},value:a._parse(new dF(c,d,c.path,b)),alwaysSet:b in c.data})}}return c.common.async?Promise.resolve().then(async()=>{let a=[];for(let b of g){let c=await b.key,d=await b.value;a.push({key:c,value:d,alwaysSet:b.alwaysSet})}return a}).then(a=>dA.mergeObjectSync(b,a)):dA.mergeObjectSync(b,g)}get shape(){return this._def.shape()}strict(a){return z.errToObj,new eb({...this._def,unknownKeys:"strict",...void 0!==a?{errorMap:(b,c)=>{let d=this._def.errorMap?.(b,c).message??c.defaultError;return"unrecognized_keys"===b.code?{message:z.errToObj(a).message??d}:{message:d}}}:{}})}strip(){return new eb({...this._def,unknownKeys:"strip"})}passthrough(){return new eb({...this._def,unknownKeys:"passthrough"})}extend(a){return new eb({...this._def,shape:()=>({...this._def.shape(),...a})})}merge(a){return new eb({unknownKeys:a._def.unknownKeys,catchall:a._def.catchall,shape:()=>({...this._def.shape(),...a._def.shape()}),typeName:A.ZodObject})}setKey(a,b){return this.augment({[a]:b})}catchall(a){return new eb({...this._def,catchall:a})}pick(a){let b={};for(let c of x.objectKeys(a))a[c]&&this.shape[c]&&(b[c]=this.shape[c]);return new eb({...this._def,shape:()=>b})}omit(a){let b={};for(let c of x.objectKeys(this.shape))a[c]||(b[c]=this.shape[c]);return new eb({...this._def,shape:()=>b})}deepPartial(){return function a(b){if(b instanceof eb){let c={};for(let d in b.shape){let e=b.shape[d];c[d]=es.create(a(e))}return new eb({...b._def,shape:()=>c})}if(b instanceof ea)return new ea({...b._def,type:a(b.element)});if(b instanceof es)return es.create(a(b.unwrap()));if(b instanceof et)return et.create(a(b.unwrap()));if(b instanceof eg)return eg.create(b.items.map(b=>a(b)));else return b}(this)}partial(a){let b={};for(let c of x.objectKeys(this.shape)){let d=this.shape[c];a&&!a[c]?b[c]=d:b[c]=d.optional()}return new eb({...this._def,shape:()=>b})}required(a){let b={};for(let c of x.objectKeys(this.shape))if(a&&!a[c])b[c]=this.shape[c];else{let a=this.shape[c];for(;a instanceof es;)a=a._def.innerType;b[c]=a}return new eb({...this._def,shape:()=>b})}keyof(){return en(x.objectKeys(this.shape))}}eb.create=(a,b)=>new eb({shape:()=>a,unknownKeys:"strip",catchall:d8.create(),typeName:A.ZodObject,...dH(b)}),eb.strictCreate=(a,b)=>new eb({shape:()=>a,unknownKeys:"strict",catchall:d8.create(),typeName:A.ZodObject,...dH(b)}),eb.lazycreate=(a,b)=>new eb({shape:a,unknownKeys:"strip",catchall:d8.create(),typeName:A.ZodObject,...dH(b)});class ec extends dI{_parse(a){let{ctx:b}=this._processInputParams(a),c=this._def.options;if(b.common.async)return Promise.all(c.map(async a=>{let c={...b,common:{...b.common,issues:[]},parent:null};return{result:await a._parseAsync({data:b.data,path:b.path,parent:c}),ctx:c}})).then(function(a){for(let b of a)if("valid"===b.result.status)return b.result;for(let c of a)if("dirty"===c.result.status)return b.common.issues.push(...c.ctx.common.issues),c.result;let c=a.map(a=>new dw(a.ctx.common.issues));return dz(b,{code:dv.invalid_union,unionErrors:c}),dB});{let a,d=[];for(let e of c){let c={...b,common:{...b.common,issues:[]},parent:null},f=e._parseSync({data:b.data,path:b.path,parent:c});if("valid"===f.status)return f;"dirty"!==f.status||a||(a={result:f,ctx:c}),c.common.issues.length&&d.push(c.common.issues)}if(a)return b.common.issues.push(...a.ctx.common.issues),a.result;let e=d.map(a=>new dw(a));return dz(b,{code:dv.invalid_union,unionErrors:e}),dB}}get options(){return this._def.options}}ec.create=(a,b)=>new ec({options:a,typeName:A.ZodUnion,...dH(b)});let ed=a=>{if(a instanceof el)return ed(a.schema);if(a instanceof er)return ed(a.innerType());if(a instanceof em)return[a.value];if(a instanceof eo)return a.options;if(a instanceof ep)return x.objectValues(a.enum);else if(a instanceof eu)return ed(a._def.innerType);else if(a instanceof d4)return[void 0];else if(a instanceof d5)return[null];else if(a instanceof es)return[void 0,...ed(a.unwrap())];else if(a instanceof et)return[null,...ed(a.unwrap())];else if(a instanceof ex)return ed(a.unwrap());else if(a instanceof ez)return ed(a.unwrap());else if(a instanceof ev)return ed(a._def.innerType);else return[]};class ee extends dI{_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==dt.object)return dz(b,{code:dv.invalid_type,expected:dt.object,received:b.parsedType}),dB;let c=this.discriminator,d=b.data[c],e=this.optionsMap.get(d);return e?b.common.async?e._parseAsync({data:b.data,path:b.path,parent:b}):e._parseSync({data:b.data,path:b.path,parent:b}):(dz(b,{code:dv.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[c]}),dB)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(a,b,c){let d=new Map;for(let c of b){let b=ed(c.shape[a]);if(!b.length)throw Error(`A discriminator value for key \`${a}\` could not be extracted from all schema options`);for(let e of b){if(d.has(e))throw Error(`Discriminator property ${String(a)} has duplicate value ${String(e)}`);d.set(e,c)}}return new ee({typeName:A.ZodDiscriminatedUnion,discriminator:a,options:b,optionsMap:d,...dH(c)})}}class ef extends dI{_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=(a,d)=>{if("aborted"===a.status||"aborted"===d.status)return dB;let e=function a(b,c){let d=du(b),e=du(c);if(b===c)return{valid:!0,data:b};if(d===dt.object&&e===dt.object){let d=x.objectKeys(c),e=x.objectKeys(b).filter(a=>-1!==d.indexOf(a)),f={...b,...c};for(let d of e){let e=a(b[d],c[d]);if(!e.valid)return{valid:!1};f[d]=e.data}return{valid:!0,data:f}}if(d===dt.array&&e===dt.array){if(b.length!==c.length)return{valid:!1};let d=[];for(let e=0;e<b.length;e++){let f=a(b[e],c[e]);if(!f.valid)return{valid:!1};d.push(f.data)}return{valid:!0,data:d}}if(d===dt.date&&e===dt.date&&+b==+c)return{valid:!0,data:b};return{valid:!1}}(a.value,d.value);return e.valid?(("dirty"===a.status||"dirty"===d.status)&&b.dirty(),{status:b.value,value:e.data}):(dz(c,{code:dv.invalid_intersection_types}),dB)};return c.common.async?Promise.all([this._def.left._parseAsync({data:c.data,path:c.path,parent:c}),this._def.right._parseAsync({data:c.data,path:c.path,parent:c})]).then(([a,b])=>d(a,b)):d(this._def.left._parseSync({data:c.data,path:c.path,parent:c}),this._def.right._parseSync({data:c.data,path:c.path,parent:c}))}}ef.create=(a,b,c)=>new ef({left:a,right:b,typeName:A.ZodIntersection,...dH(c)});class eg extends dI{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==dt.array)return dz(c,{code:dv.invalid_type,expected:dt.array,received:c.parsedType}),dB;if(c.data.length<this._def.items.length)return dz(c,{code:dv.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),dB;!this._def.rest&&c.data.length>this._def.items.length&&(dz(c,{code:dv.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b.dirty());let d=[...c.data].map((a,b)=>{let d=this._def.items[b]||this._def.rest;return d?d._parse(new dF(c,a,c.path,b)):null}).filter(a=>!!a);return c.common.async?Promise.all(d).then(a=>dA.mergeArray(b,a)):dA.mergeArray(b,d)}get items(){return this._def.items}rest(a){return new eg({...this._def,rest:a})}}eg.create=(a,b)=>{if(!Array.isArray(a))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new eg({items:a,typeName:A.ZodTuple,rest:null,...dH(b)})};class eh extends dI{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==dt.object)return dz(c,{code:dv.invalid_type,expected:dt.object,received:c.parsedType}),dB;let d=[],e=this._def.keyType,f=this._def.valueType;for(let a in c.data)d.push({key:e._parse(new dF(c,a,c.path,a)),value:f._parse(new dF(c,c.data[a],c.path,a)),alwaysSet:a in c.data});return c.common.async?dA.mergeObjectAsync(b,d):dA.mergeObjectSync(b,d)}get element(){return this._def.valueType}static create(a,b,c){return new eh(b instanceof dI?{keyType:a,valueType:b,typeName:A.ZodRecord,...dH(c)}:{keyType:d$.create(),valueType:a,typeName:A.ZodRecord,...dH(b)})}}class ei extends dI{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==dt.map)return dz(c,{code:dv.invalid_type,expected:dt.map,received:c.parsedType}),dB;let d=this._def.keyType,e=this._def.valueType,f=[...c.data.entries()].map(([a,b],f)=>({key:d._parse(new dF(c,a,c.path,[f,"key"])),value:e._parse(new dF(c,b,c.path,[f,"value"]))}));if(c.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of f){let d=await c.key,e=await c.value;if("aborted"===d.status||"aborted"===e.status)return dB;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}})}{let a=new Map;for(let c of f){let d=c.key,e=c.value;if("aborted"===d.status||"aborted"===e.status)return dB;("dirty"===d.status||"dirty"===e.status)&&b.dirty(),a.set(d.value,e.value)}return{status:b.value,value:a}}}}ei.create=(a,b,c)=>new ei({valueType:b,keyType:a,typeName:A.ZodMap,...dH(c)});class ej extends dI{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.parsedType!==dt.set)return dz(c,{code:dv.invalid_type,expected:dt.set,received:c.parsedType}),dB;let d=this._def;null!==d.minSize&&c.data.size<d.minSize.value&&(dz(c,{code:dv.too_small,minimum:d.minSize.value,type:"set",inclusive:!0,exact:!1,message:d.minSize.message}),b.dirty()),null!==d.maxSize&&c.data.size>d.maxSize.value&&(dz(c,{code:dv.too_big,maximum:d.maxSize.value,type:"set",inclusive:!0,exact:!1,message:d.maxSize.message}),b.dirty());let e=this._def.valueType;function f(a){let c=new Set;for(let d of a){if("aborted"===d.status)return dB;"dirty"===d.status&&b.dirty(),c.add(d.value)}return{status:b.value,value:c}}let g=[...c.data.values()].map((a,b)=>e._parse(new dF(c,a,c.path,b)));return c.common.async?Promise.all(g).then(a=>f(a)):f(g)}min(a,b){return new ej({...this._def,minSize:{value:a,message:z.toString(b)}})}max(a,b){return new ej({...this._def,maxSize:{value:a,message:z.toString(b)}})}size(a,b){return this.min(a,b).max(a,b)}nonempty(a){return this.min(1,a)}}ej.create=(a,b)=>new ej({valueType:a,minSize:null,maxSize:null,typeName:A.ZodSet,...dH(b)});class ek extends dI{constructor(){super(...arguments),this.validate=this.implement}_parse(a){let{ctx:b}=this._processInputParams(a);if(b.parsedType!==dt.function)return dz(b,{code:dv.invalid_type,expected:dt.function,received:b.parsedType}),dB;function c(a,c){return dy({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,dx,dx].filter(a=>!!a),issueData:{code:dv.invalid_arguments,argumentsError:c}})}function d(a,c){return dy({data:a,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,dx,dx].filter(a=>!!a),issueData:{code:dv.invalid_return_type,returnTypeError:c}})}let e={errorMap:b.common.contextualErrorMap},f=b.data;if(this._def.returns instanceof eq){let a=this;return dD(async function(...b){let g=new dw([]),h=await a._def.args.parseAsync(b,e).catch(a=>{throw g.addIssue(c(b,a)),g}),i=await Reflect.apply(f,this,h);return await a._def.returns._def.type.parseAsync(i,e).catch(a=>{throw g.addIssue(d(i,a)),g})})}{let a=this;return dD(function(...b){let g=a._def.args.safeParse(b,e);if(!g.success)throw new dw([c(b,g.error)]);let h=Reflect.apply(f,this,g.data),i=a._def.returns.safeParse(h,e);if(!i.success)throw new dw([d(h,i.error)]);return i.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...a){return new ek({...this._def,args:eg.create(a).rest(d7.create())})}returns(a){return new ek({...this._def,returns:a})}implement(a){return this.parse(a)}strictImplement(a){return this.parse(a)}static create(a,b,c){return new ek({args:a||eg.create([]).rest(d7.create()),returns:b||d7.create(),typeName:A.ZodFunction,...dH(c)})}}class el extends dI{get schema(){return this._def.getter()}_parse(a){let{ctx:b}=this._processInputParams(a);return this._def.getter()._parse({data:b.data,path:b.path,parent:b})}}el.create=(a,b)=>new el({getter:a,typeName:A.ZodLazy,...dH(b)});class em extends dI{_parse(a){if(a.data!==this._def.value){let b=this._getOrReturnCtx(a);return dz(b,{received:b.data,code:dv.invalid_literal,expected:this._def.value}),dB}return{status:"valid",value:a.data}}get value(){return this._def.value}}function en(a,b){return new eo({values:a,typeName:A.ZodEnum,...dH(b)})}em.create=(a,b)=>new em({value:a,typeName:A.ZodLiteral,...dH(b)});class eo extends dI{_parse(a){if("string"!=typeof a.data){let b=this._getOrReturnCtx(a),c=this._def.values;return dz(b,{expected:x.joinValues(c),received:b.parsedType,code:dv.invalid_type}),dB}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(a.data)){let b=this._getOrReturnCtx(a),c=this._def.values;return dz(b,{received:b.data,code:dv.invalid_enum_value,options:c}),dB}return dD(a.data)}get options(){return this._def.values}get enum(){let a={};for(let b of this._def.values)a[b]=b;return a}get Values(){let a={};for(let b of this._def.values)a[b]=b;return a}get Enum(){let a={};for(let b of this._def.values)a[b]=b;return a}extract(a,b=this._def){return eo.create(a,{...this._def,...b})}exclude(a,b=this._def){return eo.create(this.options.filter(b=>!a.includes(b)),{...this._def,...b})}}eo.create=en;class ep extends dI{_parse(a){let b=x.getValidEnumValues(this._def.values),c=this._getOrReturnCtx(a);if(c.parsedType!==dt.string&&c.parsedType!==dt.number){let a=x.objectValues(b);return dz(c,{expected:x.joinValues(a),received:c.parsedType,code:dv.invalid_type}),dB}if(this._cache||(this._cache=new Set(x.getValidEnumValues(this._def.values))),!this._cache.has(a.data)){let a=x.objectValues(b);return dz(c,{received:c.data,code:dv.invalid_enum_value,options:a}),dB}return dD(a.data)}get enum(){return this._def.values}}ep.create=(a,b)=>new ep({values:a,typeName:A.ZodNativeEnum,...dH(b)});class eq extends dI{unwrap(){return this._def.type}_parse(a){let{ctx:b}=this._processInputParams(a);return b.parsedType!==dt.promise&&!1===b.common.async?(dz(b,{code:dv.invalid_type,expected:dt.promise,received:b.parsedType}),dB):dD((b.parsedType===dt.promise?b.data:Promise.resolve(b.data)).then(a=>this._def.type.parseAsync(a,{path:b.path,errorMap:b.common.contextualErrorMap})))}}eq.create=(a,b)=>new eq({type:a,typeName:A.ZodPromise,...dH(b)});class er extends dI{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===A.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(a){let{status:b,ctx:c}=this._processInputParams(a),d=this._def.effect||null,e={addIssue:a=>{dz(c,a),a.fatal?b.abort():b.dirty()},get path(){return c.path}};if(e.addIssue=e.addIssue.bind(e),"preprocess"===d.type){let a=d.transform(c.data,e);if(c.common.async)return Promise.resolve(a).then(async a=>{if("aborted"===b.value)return dB;let d=await this._def.schema._parseAsync({data:a,path:c.path,parent:c});return"aborted"===d.status?dB:"dirty"===d.status||"dirty"===b.value?dC(d.value):d});{if("aborted"===b.value)return dB;let d=this._def.schema._parseSync({data:a,path:c.path,parent:c});return"aborted"===d.status?dB:"dirty"===d.status||"dirty"===b.value?dC(d.value):d}}if("refinement"===d.type){let a=a=>{let b=d.refinement(a,e);if(c.common.async)return Promise.resolve(b);if(b instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(c=>"aborted"===c.status?dB:("dirty"===c.status&&b.dirty(),a(c.value).then(()=>({status:b.value,value:c.value}))));{let d=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===d.status?dB:("dirty"===d.status&&b.dirty(),a(d.value),{status:b.value,value:d.value})}}if("transform"===d.type)if(!1!==c.common.async)return this._def.schema._parseAsync({data:c.data,path:c.path,parent:c}).then(a=>"valid"!==a.status?dB:Promise.resolve(d.transform(a.value,e)).then(a=>({status:b.value,value:a})));else{let a=this._def.schema._parseSync({data:c.data,path:c.path,parent:c});if("valid"!==a.status)return dB;let f=d.transform(a.value,e);if(f instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:b.value,value:f}}x.assertNever(d)}}er.create=(a,b,c)=>new er({schema:a,typeName:A.ZodEffects,effect:b,...dH(c)}),er.createWithPreprocess=(a,b,c)=>new er({schema:b,effect:{type:"preprocess",transform:a},typeName:A.ZodEffects,...dH(c)});class es extends dI{_parse(a){return this._getType(a)===dt.undefined?dD(void 0):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}es.create=(a,b)=>new es({innerType:a,typeName:A.ZodOptional,...dH(b)});class et extends dI{_parse(a){return this._getType(a)===dt.null?dD(null):this._def.innerType._parse(a)}unwrap(){return this._def.innerType}}et.create=(a,b)=>new et({innerType:a,typeName:A.ZodNullable,...dH(b)});class eu extends dI{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return b.parsedType===dt.undefined&&(c=this._def.defaultValue()),this._def.innerType._parse({data:c,path:b.path,parent:b})}removeDefault(){return this._def.innerType}}eu.create=(a,b)=>new eu({innerType:a,typeName:A.ZodDefault,defaultValue:"function"==typeof b.default?b.default:()=>b.default,...dH(b)});class ev extends dI{_parse(a){let{ctx:b}=this._processInputParams(a),c={...b,common:{...b.common,issues:[]}},d=this._def.innerType._parse({data:c.data,path:c.path,parent:{...c}});return dE(d)?d.then(a=>({status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new dw(c.common.issues)},input:c.data})})):{status:"valid",value:"valid"===d.status?d.value:this._def.catchValue({get error(){return new dw(c.common.issues)},input:c.data})}}removeCatch(){return this._def.innerType}}ev.create=(a,b)=>new ev({innerType:a,typeName:A.ZodCatch,catchValue:"function"==typeof b.catch?b.catch:()=>b.catch,...dH(b)});class ew extends dI{_parse(a){if(this._getType(a)!==dt.nan){let b=this._getOrReturnCtx(a);return dz(b,{code:dv.invalid_type,expected:dt.nan,received:b.parsedType}),dB}return{status:"valid",value:a.data}}}ew.create=a=>new ew({typeName:A.ZodNaN,...dH(a)}),Symbol("zod_brand");class ex extends dI{_parse(a){let{ctx:b}=this._processInputParams(a),c=b.data;return this._def.type._parse({data:c,path:b.path,parent:b})}unwrap(){return this._def.type}}class ey extends dI{_parse(a){let{status:b,ctx:c}=this._processInputParams(a);if(c.common.async)return(async()=>{let a=await this._def.in._parseAsync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?dB:"dirty"===a.status?(b.dirty(),dC(a.value)):this._def.out._parseAsync({data:a.value,path:c.path,parent:c})})();{let a=this._def.in._parseSync({data:c.data,path:c.path,parent:c});return"aborted"===a.status?dB:"dirty"===a.status?(b.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:c.path,parent:c})}}static create(a,b){return new ey({in:a,out:b,typeName:A.ZodPipeline})}}class ez extends dI{_parse(a){let b=this._def.innerType._parse(a),c=a=>("valid"===a.status&&(a.value=Object.freeze(a.value)),a);return dE(b)?b.then(a=>c(a)):c(b)}unwrap(){return this._def.innerType}}ez.create=(a,b)=>new ez({innerType:a,typeName:A.ZodReadonly,...dH(b)}),eb.lazycreate,function(a){a.ZodString="ZodString",a.ZodNumber="ZodNumber",a.ZodNaN="ZodNaN",a.ZodBigInt="ZodBigInt",a.ZodBoolean="ZodBoolean",a.ZodDate="ZodDate",a.ZodSymbol="ZodSymbol",a.ZodUndefined="ZodUndefined",a.ZodNull="ZodNull",a.ZodAny="ZodAny",a.ZodUnknown="ZodUnknown",a.ZodNever="ZodNever",a.ZodVoid="ZodVoid",a.ZodArray="ZodArray",a.ZodObject="ZodObject",a.ZodUnion="ZodUnion",a.ZodDiscriminatedUnion="ZodDiscriminatedUnion",a.ZodIntersection="ZodIntersection",a.ZodTuple="ZodTuple",a.ZodRecord="ZodRecord",a.ZodMap="ZodMap",a.ZodSet="ZodSet",a.ZodFunction="ZodFunction",a.ZodLazy="ZodLazy",a.ZodLiteral="ZodLiteral",a.ZodEnum="ZodEnum",a.ZodEffects="ZodEffects",a.ZodNativeEnum="ZodNativeEnum",a.ZodOptional="ZodOptional",a.ZodNullable="ZodNullable",a.ZodDefault="ZodDefault",a.ZodCatch="ZodCatch",a.ZodPromise="ZodPromise",a.ZodBranded="ZodBranded",a.ZodPipeline="ZodPipeline",a.ZodReadonly="ZodReadonly"}(A||(A={}));let eA=d$.create;d_.create,ew.create,d0.create,d1.create,d2.create,d3.create,d4.create,d5.create,d6.create,d7.create,d8.create,d9.create,ea.create;let eB=eb.create;eb.strictCreate,ec.create,ee.create,ef.create,eg.create,eh.create,ei.create,ej.create,ek.create,el.create,em.create;let eC=eo.create;ep.create,eq.create,er.create,es.create,et.create,er.createWithPreprocess,ey.create;let eD={number:a=>d_.create({...a,coerce:!0})};(0,ds.config)();let eE=eB({SUPABASE_URL:eA().url("SUPABASE_URL must be a valid URL"),SUPABASE_SERVICE_KEY:eA().min(1,"SUPABASE_SERVICE_KEY is required"),GEMINI_API_KEY:eA().min(1,"GEMINI_API_KEY is required"),FIRECRAWL_API_KEY:eA().min(1,"FIRECRAWL_API_KEY is required"),GEMINI_MODEL:eA().default("gemini-2.5-flash"),LOG_LEVEL:eC(["trace","debug","info","warn","error","fatal"]).default("info"),SYNC_INTERVAL_HOURS:eD.number().int().positive().default(12),DELETION_THRESHOLD:eD.number().int().positive().default(3)}),eF=function(){let a=eE.safeParse(process.env);if(!a.success){let b=a.error.errors.map(a=>`  - ${a.path.join(".")}: ${a.message}`).join("\n");throw Error(`Environment configuration errors:
${b}`)}let b=a.data;return{supabase:{url:b.SUPABASE_URL,serviceKey:b.SUPABASE_SERVICE_KEY},gemini:{apiKey:b.GEMINI_API_KEY,model:b.GEMINI_MODEL},firecrawl:{apiKey:b.FIRECRAWL_API_KEY},sync:{intervalHours:b.SYNC_INTERVAL_HOURS,deletionThreshold:b.DELETION_THRESHOLD},logging:{level:b.LOG_LEVEL}}}();var eG=c(68775);let eH=c.n(eG)()({level:eF.logging.level,transport:{target:"pino-pretty",options:{colorize:!0,translateTime:"SYS:standard",ignore:"pid,hostname"}}});function eI(a){return eH.child({context:a})}let eJ={supabase:eI("supabase"),firecrawl:eI("firecrawl"),gemini:eI("gemini"),ingestion:eI("ingestion"),sync:eI("sync"),search:eI("search"),mcp:eI("mcp")},eK=eJ.supabase,eL=new dr(eF.supabase.url,eF.supabase.serviceKey,i);async function eM(a){eK.info({domain:a.domain},"Creating website record");let{data:b,error:c}=await eL.from("websites").insert(a).select().single();if(c)throw eK.error({error:c,data:a},"Failed to create website"),Error(`Failed to create website: ${c.message}`);return eK.info({websiteId:b.id},"Website created"),b}async function eN(a){let{data:b,error:c}=await eL.from("websites").select().eq("id",a).single();if(c){if("PGRST116"===c.code)return null;throw Error(`Failed to get website: ${c.message}`)}return b}async function eO(a){let{data:b,error:c}=await eL.from("websites").select().eq("domain",a).single();if(c){if("PGRST116"===c.code)return null;throw Error(`Failed to get website by domain: ${c.message}`)}return b}async function eP(a,b){let{data:c,error:d}=await eL.from("websites").update(b).eq("id",a).select().single();if(d)throw Error(`Failed to update website: ${d.message}`);return c}async function eQ(a){let{data:b,error:c}=await eL.from("pages").upsert(a,{onConflict:"website_id,url"}).select().single();if(c)throw Error(`Failed to upsert page: ${c.message}`);return b}async function eR(a,b){let c=eL.from("pages").select().eq("website_id",a);b&&(c=c.eq("status",b));let{data:d,error:e}=await c.order("created_at",{ascending:!1});if(e)throw Error(`Failed to get pages: ${e.message}`);return d??[]}async function eS(a,b){let c=eL.from("pages").select().eq("website_id",a).eq("status","ready_for_indexing").not("markdown_content","is",null).or("gemini_file_id.is.null,gemini_file_id.eq.").order("updated_at",{ascending:!0});b?.processJobId&&(c=c.or(`created_by_ingestion_id.eq.${b.processJobId},created_by_sync_id.eq.${b.processJobId},last_updated_by_sync_id.eq.${b.processJobId}`)),b?.limit&&(c=c.limit(b.limit));let{data:d,error:e}=await c;if(e)throw Error(`Failed to get pages ready for indexing: ${e.message}`);return(d??[]).filter(a=>a.markdown_content&&a.markdown_content.trim().length>0)}async function eT(a,b){let{data:c,error:d}=await eL.from("pages").update(b).eq("id",a).select().single();if(d)throw Error(`Failed to update page: ${d.message}`);return c}async function eU(a){eK.info({websiteId:a.website_id,processType:a.process_type},"Creating process job");let{data:b,error:c}=await eL.from("process_jobs").insert({...a,status:a.status??"running",firecrawl_batch_ids:a.firecrawl_batch_ids??[],metadata:a.metadata??{}}).select().single();if(c)throw eK.error({error:c,data:a},"Failed to create process job"),Error(`Failed to create process job: ${c.message}`);return eK.info({processJobId:b.id},"Process job created"),b}async function eV(a,b){let{data:c,error:d}=await eL.from("process_jobs").update(b).eq("id",a).select().single();if(d)throw eK.error({processJobId:a,error:d},"Failed to update process job"),Error(`Failed to update process job: ${d.message}`);return c}async function eW(a){let{data:b,error:c}=await eL.from("process_jobs").select().eq("id",a).single();if(c){if("PGRST116"===c.code)return null;throw Error(`Failed to get process job: ${c.message}`)}return b}async function eX(a,b){let c=eL.from("process_jobs").select().eq("website_id",a);b?.processType&&(c=c.eq("process_type",b.processType)),c=c.order("started_at",{ascending:!1}),b?.limit&&(c=c.limit(b.limit));let{data:d,error:e}=await c;if(e)throw Error(`Failed to get process jobs: ${e.message}`);return d??[]}let eY=eJ.firecrawl;async function eZ(a,b){let c=`https://api.firecrawl.dev/v2${a}`,d=await fetch(c,{method:b.method,headers:{Authorization:`Bearer ${eF.firecrawl.apiKey}`,"Content-Type":"application/json"},body:b.body?JSON.stringify(b.body):void 0});if(!d.ok){let a=await d.text();throw Error(`FireCrawl API error (${d.status}): ${a}`)}return d.json()}async function e$(a,b){eY.info({seedUrl:a,options:b},"Starting website mapping");try{let c=await eZ("/map",{method:"POST",body:{url:a,includeSubdomains:b?.includeSubdomains??!1,limit:b?.limit??5e3,...b?.search&&{search:b.search},...b?.timeout&&{timeout:b.timeout}}});if(!c.success)return eY.error({seedUrl:a,error:c.error},"Map failed"),{success:!1,links:[],error:c.error||"Unknown error during mapping"};let d=(c.links??[]).map(a=>"string"==typeof a?a:a.url);return eY.info({seedUrl:a,urlCount:d.length},"Mapping complete"),{success:!0,links:d}}catch(c){let b=c instanceof Error?c.message:"Unknown error";return eY.error({seedUrl:a,error:b},"Map request failed"),{success:!1,links:[],error:b}}}async function e_(a,b){eY.info({urlCount:a.length},"Starting batch scrape");try{let c=await eZ("/batch/scrape",{method:"POST",body:{urls:a,formats:b?.formats??["markdown"],onlyMainContent:b?.onlyMainContent??!0,ignoreInvalidURLs:b?.ignoreInvalidURLs??!0,...b?.maxConcurrency&&{maxConcurrency:b.maxConcurrency}}});if(!c.success||!c.id)return eY.error({error:c.error},"Batch scrape start failed"),{success:!1,error:c.error||"Failed to start batch scrape"};return eY.info({jobId:c.id},"Batch scrape started"),{success:!0,jobId:c.id}}catch(b){let a=b instanceof Error?b.message:"Unknown error";return eY.error({error:a},"Batch scrape request failed"),{success:!1,error:a}}}async function e0(a){try{let b=await eZ(`/batch/scrape/${a}`,{method:"GET"});if(!b||"object"!=typeof b)throw Error("Invalid response format from FireCrawl API");if(!1===b.success||b.error)return{success:!1,id:a,status:"failed",completed:0,total:0,error:b.error||"Batch scrape failed"};if("string"!=typeof b.status)return eY.warn({jobId:a,response:b},"Response missing status field"),{success:!1,id:a,status:"failed",completed:0,total:0,error:"Invalid response: missing status field"};let c=b.data?.map(a=>{let b=a.metadata??{};return{markdown:a.markdown??"",html:a.html,metadata:{title:b.title,description:b.description,ogImage:b.ogImage,sourceURL:b.sourceURL??"",statusCode:b.statusCode??200,language:"string"==typeof b.language?b.language:void 0,...Object.fromEntries(Object.entries(b).filter(([a])=>!["title","description","ogImage","sourceURL","statusCode","language"].includes(a)))}}});return{success:!0,id:a,status:b.status,completed:b.completed??0,total:b.total??0,data:c}}catch(c){let b=c instanceof Error?c.message:"Unknown error";return eY.error({jobId:a,error:b},"Failed to check batch status"),{success:!1,id:a,status:"failed",completed:0,total:0,error:b}}}async function e1(a,b){let c=b?.pollIntervalMs??5e3,d=b?.maxWaitMs??6e5,e=Date.now();for(eY.info({jobId:a,pollInterval:c,maxWait:d},"Waiting for batch completion");Date.now()-e<d;)try{let d=await e0(a);if(!d.success)return eY.error({jobId:a,error:d.error},"Status check failed"),d;if("completed"===d.status||"failed"===d.status)return eY.info({jobId:a,status:d.status,completed:d.completed,total:d.total},"Batch finished"),d;b?.onProgress&&d.total>0&&b.onProgress(d.completed,d.total);let f=Date.now()-e;f%3e4<c?eY.info({jobId:a,completed:d.completed,total:d.total,elapsed:Math.round(f/1e3)+"s",progress:d.total>0?Math.round(d.completed/d.total*100)+"%":"0%"},"Batch in progress"):eY.debug({jobId:a,completed:d.completed,total:d.total},"Batch in progress"),await function(a){return new Promise(b=>setTimeout(b,a))}(c)}catch(c){let b=c instanceof Error?c.message:"Unknown error";return eY.error({jobId:a,error:b},"Error during batch status check"),{success:!1,id:a,status:"failed",completed:0,total:0,error:`Status check error: ${b}`}}let f=Math.round((Date.now()-e)/1e3);return eY.error({jobId:a,elapsed:f+"s"},"Batch timed out"),{success:!1,id:a,status:"failed",completed:0,total:0,error:`Batch scrape timed out after ${f} seconds`}}var e2=c(40473),e3=c(29021);let e4=require("fs/promises");var e5=c(57075);let e6=require("node:stream/promises");c(45543),c(9612),c(73280);var e7=c(41596);c(21280);var e8=c(33873);class e9{}function fa(a,b){return a.replace(/\{([^}]+)\}/g,(a,c)=>{if(Object.prototype.hasOwnProperty.call(b,c)){let a=b[c];return null!=a?String(a):""}throw Error(`Key '${c}' not found in valueMap.`)})}function fb(a,b,c){for(let d=0;d<b.length-1;d++){let e=b[d];if(e.endsWith("[]")){let f=e.slice(0,-2);if(!(f in a))if(Array.isArray(c))a[f]=Array.from({length:c.length},()=>({}));else throw Error(`Value must be a list given an array path ${e}`);if(Array.isArray(a[f])){let e=a[f];if(Array.isArray(c))for(let a=0;a<e.length;a++)fb(e[a],b.slice(d+1),c[a]);else for(let a of e)fb(a,b.slice(d+1),c)}return}if(e.endsWith("[0]")){let f=e.slice(0,-3);f in a||(a[f]=[{}]),fb(a[f][0],b.slice(d+1),c);return}a[e]&&"object"==typeof a[e]||(a[e]={}),a=a[e]}let d=b[b.length-1],e=a[d];if(void 0!==e){if(!c||"object"==typeof c&&0===Object.keys(c).length||c===e)return;if("object"==typeof e&&"object"==typeof c&&null!==e&&null!==c)Object.assign(e,c);else throw Error(`Cannot set value for an existing key. Key: ${d}`)}else"_self"!==d||"object"!=typeof c||null===c||Array.isArray(c)?a[d]=c:Object.assign(a,c)}function fc(a,b,c){try{if(1===b.length&&"_self"===b[0])return a;for(let d=0;d<b.length;d++){if("object"!=typeof a||null===a)return c;let e=b[d];if(e.endsWith("[]")){let f=e.slice(0,-2);if(!(f in a))return c;{let e=a[f];if(!Array.isArray(e))return c;return e.map(a=>fc(a,b.slice(d+1),c))}}a=a[e]}return a}catch(a){if(a instanceof TypeError)return c;throw a}}function fd(a){if("string"!=typeof a)throw Error("fromImageBytes must be a string");return a}function fe(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["name"],c);let d=fc(a,["metadata"]);null!=d&&fb(b,["metadata"],d);let e=fc(a,["done"]);null!=e&&fb(b,["done"],e);let f=fc(a,["error"]);null!=f&&fb(b,["error"],f);let g=fc(a,["response"]);return null!=g&&fb(b,["response"],function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["parent"]);null!=d&&fb(b,["parent"],d);let e=fc(a,["documentName"]);return null!=e&&fb(b,["documentName"],e),b}(g)),b}!function(a){a.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",a.OUTCOME_OK="OUTCOME_OK",a.OUTCOME_FAILED="OUTCOME_FAILED",a.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"}(B||(B={})),function(a){a.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",a.PYTHON="PYTHON"}(C||(C={})),function(a){a.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",a.SILENT="SILENT",a.WHEN_IDLE="WHEN_IDLE",a.INTERRUPT="INTERRUPT"}(D||(D={})),function(a){a.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",a.STRING="STRING",a.NUMBER="NUMBER",a.INTEGER="INTEGER",a.BOOLEAN="BOOLEAN",a.ARRAY="ARRAY",a.OBJECT="OBJECT",a.NULL="NULL"}(E||(E={})),function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.MODE_DYNAMIC="MODE_DYNAMIC"}(F||(F={})),function(a){a.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",a.SIMPLE_SEARCH="SIMPLE_SEARCH",a.ELASTIC_SEARCH="ELASTIC_SEARCH"}(G||(G={})),function(a){a.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",a.NO_AUTH="NO_AUTH",a.API_KEY_AUTH="API_KEY_AUTH",a.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",a.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",a.OAUTH="OAUTH",a.OIDC_AUTH="OIDC_AUTH"}(H||(H={})),function(a){a.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",a.HTTP_IN_QUERY="HTTP_IN_QUERY",a.HTTP_IN_HEADER="HTTP_IN_HEADER",a.HTTP_IN_PATH="HTTP_IN_PATH",a.HTTP_IN_BODY="HTTP_IN_BODY",a.HTTP_IN_COOKIE="HTTP_IN_COOKIE"}(I||(I={})),function(a){a.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",a.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",a.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",a.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"}(J||(J={})),function(a){a.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",a.LOW="LOW",a.MEDIUM="MEDIUM",a.HIGH="HIGH",a.MINIMAL="MINIMAL"}(K||(K={})),function(a){a.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",a.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",a.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",a.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",a.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",a.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",a.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",a.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",a.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",a.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",a.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"}(L||(L={})),function(a){a.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",a.SEVERITY="SEVERITY",a.PROBABILITY="PROBABILITY"}(M||(M={})),function(a){a.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",a.BLOCK_NONE="BLOCK_NONE",a.OFF="OFF"}(N||(N={})),function(a){a.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",a.STOP="STOP",a.MAX_TOKENS="MAX_TOKENS",a.SAFETY="SAFETY",a.RECITATION="RECITATION",a.LANGUAGE="LANGUAGE",a.OTHER="OTHER",a.BLOCKLIST="BLOCKLIST",a.PROHIBITED_CONTENT="PROHIBITED_CONTENT",a.SPII="SPII",a.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",a.IMAGE_SAFETY="IMAGE_SAFETY",a.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",a.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",a.NO_IMAGE="NO_IMAGE",a.IMAGE_RECITATION="IMAGE_RECITATION",a.IMAGE_OTHER="IMAGE_OTHER"}(O||(O={})),function(a){a.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",a.NEGLIGIBLE="NEGLIGIBLE",a.LOW="LOW",a.MEDIUM="MEDIUM",a.HIGH="HIGH"}(P||(P={})),function(a){a.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",a.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",a.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",a.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",a.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"}(Q||(Q={})),function(a){a.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",a.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",a.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",a.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",a.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"}(R||(R={})),function(a){a.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",a.SAFETY="SAFETY",a.OTHER="OTHER",a.BLOCKLIST="BLOCKLIST",a.PROHIBITED_CONTENT="PROHIBITED_CONTENT",a.IMAGE_SAFETY="IMAGE_SAFETY",a.MODEL_ARMOR="MODEL_ARMOR",a.JAILBREAK="JAILBREAK"}(S||(S={})),function(a){a.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",a.ON_DEMAND="ON_DEMAND",a.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"}(T||(T={})),function(a){a.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",a.TEXT="TEXT",a.IMAGE="IMAGE",a.AUDIO="AUDIO"}(U||(U={})),function(a){a.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",a.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",a.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",a.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"}(V||(V={})),function(a){a.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",a.TUNING_MODE_FULL="TUNING_MODE_FULL",a.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"}(W||(W={})),function(a){a.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",a.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",a.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",a.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",a.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",a.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",a.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"}(X||(X={})),function(a){a.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",a.JOB_STATE_QUEUED="JOB_STATE_QUEUED",a.JOB_STATE_PENDING="JOB_STATE_PENDING",a.JOB_STATE_RUNNING="JOB_STATE_RUNNING",a.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",a.JOB_STATE_FAILED="JOB_STATE_FAILED",a.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",a.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",a.JOB_STATE_PAUSED="JOB_STATE_PAUSED",a.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",a.JOB_STATE_UPDATING="JOB_STATE_UPDATING",a.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"}(Y||(Y={})),function(a){a.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",a.TUNING_TASK_I2V="TUNING_TASK_I2V",a.TUNING_TASK_T2V="TUNING_TASK_T2V",a.TUNING_TASK_R2V="TUNING_TASK_R2V"}(Z||(Z={})),function(a){a.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",a.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",a.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",a.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",a.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"}($||($={})),function(a){a.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",a.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",a.BALANCED="BALANCED",a.PRIORITIZE_COST="PRIORITIZE_COST"}(_||(_={})),function(a){a.UNSPECIFIED="UNSPECIFIED",a.BLOCKING="BLOCKING",a.NON_BLOCKING="NON_BLOCKING"}(aa||(aa={})),function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.MODE_DYNAMIC="MODE_DYNAMIC"}(ab||(ab={})),function(a){a.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",a.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"}(ac||(ac={})),function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.AUTO="AUTO",a.ANY="ANY",a.NONE="NONE",a.VALIDATED="VALIDATED"}(ad||(ad={})),function(a){a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",a.BLOCK_NONE="BLOCK_NONE"}(ae||(ae={})),function(a){a.DONT_ALLOW="DONT_ALLOW",a.ALLOW_ADULT="ALLOW_ADULT",a.ALLOW_ALL="ALLOW_ALL"}(af||(af={})),function(a){a.auto="auto",a.en="en",a.ja="ja",a.ko="ko",a.hi="hi",a.zh="zh",a.pt="pt",a.es="es"}(ag||(ag={})),function(a){a.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",a.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",a.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",a.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",a.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"}(ah||(ah={})),function(a){a.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",a.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",a.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",a.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"}(ai||(ai={})),function(a){a.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",a.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",a.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",a.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"}(aj||(aj={})),function(a){a.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",a.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",a.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",a.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",a.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",a.EDIT_MODE_STYLE="EDIT_MODE_STYLE",a.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",a.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"}(ak||(ak={})),function(a){a.FOREGROUND="FOREGROUND",a.BACKGROUND="BACKGROUND",a.PROMPT="PROMPT",a.SEMANTIC="SEMANTIC",a.INTERACTIVE="INTERACTIVE"}(al||(al={})),function(a){a.ASSET="ASSET",a.STYLE="STYLE"}(am||(am={})),function(a){a.INSERT="INSERT",a.REMOVE="REMOVE",a.REMOVE_STATIC="REMOVE_STATIC",a.OUTPAINT="OUTPAINT"}(an||(an={})),function(a){a.OPTIMIZED="OPTIMIZED",a.LOSSLESS="LOSSLESS"}(ao||(ao={})),function(a){a.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",a.PREFERENCE_TUNING="PREFERENCE_TUNING"}(ap||(ap={})),function(a){a.STATE_UNSPECIFIED="STATE_UNSPECIFIED",a.STATE_PENDING="STATE_PENDING",a.STATE_ACTIVE="STATE_ACTIVE",a.STATE_FAILED="STATE_FAILED"}(aq||(aq={})),function(a){a.STATE_UNSPECIFIED="STATE_UNSPECIFIED",a.PROCESSING="PROCESSING",a.ACTIVE="ACTIVE",a.FAILED="FAILED"}(ar||(ar={})),function(a){a.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",a.UPLOADED="UPLOADED",a.GENERATED="GENERATED"}(as||(as={})),function(a){a.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",a.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",a.RESPONSE_REJECTED="RESPONSE_REJECTED",a.NEED_MORE_INPUT="NEED_MORE_INPUT"}(at||(at={})),function(a){a.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",a.TEXT="TEXT",a.IMAGE="IMAGE",a.VIDEO="VIDEO",a.AUDIO="AUDIO",a.DOCUMENT="DOCUMENT"}(au||(au={})),function(a){a.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",a.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",a.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"}(av||(av={})),function(a){a.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",a.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",a.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"}(aw||(aw={})),function(a){a.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",a.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",a.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"}(ax||(ax={})),function(a){a.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",a.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",a.NO_INTERRUPTION="NO_INTERRUPTION"}(ay||(ay={})),function(a){a.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",a.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",a.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"}(az||(az={})),function(a){a.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",a.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",a.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",a.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",a.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",a.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",a.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",a.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",a.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",a.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",a.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",a.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",a.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"}(aA||(aA={})),function(a){a.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",a.QUALITY="QUALITY",a.DIVERSITY="DIVERSITY",a.VOCALIZATION="VOCALIZATION"}(aB||(aB={})),function(a){a.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",a.PLAY="PLAY",a.PAUSE="PAUSE",a.STOP="STOP",a.RESET_CONTEXT="RESET_CONTEXT"}(aC||(aC={}));class ff{constructor(a){let b={};for(let c of a.headers.entries())b[c[0]]=c[1];this.headers=b,this.responseInternal=a}json(){return this.responseInternal.json()}}class fg{get text(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let i="",j=!1,k=[];for(let a of null!=(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?h:[]){for(let[b,c]of Object.entries(a))"text"!==b&&"thought"!==b&&"thoughtSignature"!==b&&(null!==c||void 0!==c)&&k.push(b);if("string"==typeof a.text){if("boolean"==typeof a.thought&&a.thought)continue;j=!0,i+=a.text}}return k.length>0&&console.warn(`there are non-text parts ${k} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),j?i:void 0}get data(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let i="",j=[];for(let a of null!=(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?h:[]){for(let[b,c]of Object.entries(a))"inlineData"!==b&&(null!==c||void 0!==c)&&j.push(b);a.inlineData&&"string"==typeof a.inlineData.data&&(i+=atob(a.inlineData.data))}return j.length>0&&console.warn(`there are non-data parts ${j} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}get functionCalls(){var a,b,c,d,e,f,g,h;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");let i=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.functionCall).map(a=>a.functionCall).filter(a=>void 0!==a);if((null==i?void 0:i.length)!==0)return i}get executableCode(){var a,b,c,d,e,f,g,h,i;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");let j=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.executableCode).map(a=>a.executableCode).filter(a=>void 0!==a);if((null==j?void 0:j.length)!==0)return null==(i=null==j?void 0:j[0])?void 0:i.code}get codeExecutionResult(){var a,b,c,d,e,f,g,h,i;if((null==(d=null==(c=null==(b=null==(a=this.candidates)?void 0:a[0])?void 0:b.content)?void 0:c.parts)?void 0:d.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");let j=null==(h=null==(g=null==(f=null==(e=this.candidates)?void 0:e[0])?void 0:f.content)?void 0:g.parts)?void 0:h.filter(a=>a.codeExecutionResult).map(a=>a.codeExecutionResult).filter(a=>void 0!==a);if((null==j?void 0:j.length)!==0)return null==(i=null==j?void 0:j[0])?void 0:i.output}}class fh{}class fi{}class fj{}class fk{}class fl{}class fm{}class fn{}class fo{}class fp{}class fq{}class fr{_fromAPIResponse({apiResponse:a,_isVertexAI:b}){let c=new fr;return Object.assign(c,b?function(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["name"],c);let d=fc(a,["metadata"]);null!=d&&fb(b,["metadata"],d);let e=fc(a,["done"]);null!=e&&fb(b,["done"],e);let f=fc(a,["error"]);null!=f&&fb(b,["error"],f);let g=fc(a,["response"]);return null!=g&&fb(b,["response"],function(a){let b={},c=fc(a,["videos"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["_self"]);return null!=c&&fb(b,["video"],function(a){let b={},c=fc(a,["gcsUri"]);null!=c&&fb(b,["uri"],c);let d=fc(a,["bytesBase64Encoded"]);null!=d&&fb(b,["videoBytes"],fd(d));let e=fc(a,["mimeType"]);return null!=e&&fb(b,["mimeType"],e),b}(c)),b})(a))),fb(b,["generatedVideos"],a)}let d=fc(a,["raiMediaFilteredCount"]);null!=d&&fb(b,["raiMediaFilteredCount"],d);let e=fc(a,["raiMediaFilteredReasons"]);return null!=e&&fb(b,["raiMediaFilteredReasons"],e),b}(g)),b}(a):function(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["name"],c);let d=fc(a,["metadata"]);null!=d&&fb(b,["metadata"],d);let e=fc(a,["done"]);null!=e&&fb(b,["done"],e);let f=fc(a,["error"]);null!=f&&fb(b,["error"],f);let g=fc(a,["response","generateVideoResponse"]);return null!=g&&fb(b,["response"],function(a){let b={},c=fc(a,["generatedSamples"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["video"]);return null!=c&&fb(b,["video"],function(a){let b={},c=fc(a,["uri"]);null!=c&&fb(b,["uri"],c);let d=fc(a,["encodedVideo"]);null!=d&&fb(b,["videoBytes"],fd(d));let e=fc(a,["encoding"]);return null!=e&&fb(b,["mimeType"],e),b}(c)),b})(a))),fb(b,["generatedVideos"],a)}let d=fc(a,["raiMediaFilteredCount"]);null!=d&&fb(b,["raiMediaFilteredCount"],d);let e=fc(a,["raiMediaFilteredReasons"]);return null!=e&&fb(b,["raiMediaFilteredReasons"],e),b}(g)),b}(a)),c}}class fs{}class ft{}class fu{}class fv{}class fw{}class fx{}class fy{}class fz{_fromAPIResponse({apiResponse:a,_isVertexAI:b}){let c=new fz;return Object.assign(c,function(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["name"],c);let d=fc(a,["metadata"]);null!=d&&fb(b,["metadata"],d);let e=fc(a,["done"]);null!=e&&fb(b,["done"],e);let f=fc(a,["error"]);null!=f&&fb(b,["error"],f);let g=fc(a,["response"]);return null!=g&&fb(b,["response"],function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["parent"]);null!=d&&fb(b,["parent"],d);let e=fc(a,["documentName"]);return null!=e&&fb(b,["documentName"],e),b}(g)),b}(a)),c}}class fA{}class fB{}class fC{}class fD{}class fE{get text(){var a,b,c;let d="",e=!1,f=[];for(let g of null!=(c=null==(b=null==(a=this.serverContent)?void 0:a.modelTurn)?void 0:b.parts)?c:[]){for(let[a,b]of Object.entries(g))"text"!==a&&"thought"!==a&&null!==b&&f.push(a);if("string"==typeof g.text){if("boolean"==typeof g.thought&&g.thought)continue;e=!0,d+=g.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),e?d:void 0}get data(){var a,b,c;let d="",e=[];for(let f of null!=(c=null==(b=null==(a=this.serverContent)?void 0:a.modelTurn)?void 0:b.parts)?c:[]){for(let[a,b]of Object.entries(f))"inlineData"!==a&&null!==b&&e.push(a);f.inlineData&&"string"==typeof f.inlineData.data&&(d+=atob(f.inlineData.data))}return e.length>0&&console.warn(`there are non-data parts ${e} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}}class fF{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class fG{_fromAPIResponse({apiResponse:a,_isVertexAI:b}){let c=new fG;return Object.assign(c,fe(a)),c}}function fH(a,b){if(!b||"string"!=typeof b)throw Error("model is required and must be a string");if(b.includes("..")||b.includes("?")||b.includes("&"))throw Error("invalid model parameter");if(a.isVertexAI())if(b.startsWith("publishers/")||b.startsWith("projects/")||b.startsWith("models/"))return b;else{if(!(b.indexOf("/")>=0))return`publishers/google/models/${b}`;let a=b.split("/",2);return`publishers/${a[0]}/models/${a[1]}`}return b.startsWith("models/")||b.startsWith("tunedModels/")?b:`models/${b}`}function fI(a,b){let c=fH(a,b);return c?c.startsWith("publishers/")&&a.isVertexAI()?`projects/${a.getProject()}/locations/${a.getLocation()}/${c}`:c.startsWith("models/")&&a.isVertexAI()?`projects/${a.getProject()}/locations/${a.getLocation()}/publishers/google/${c}`:c:""}function fJ(a){return Array.isArray(a)?a.map(a=>fK(a)):[fK(a)]}function fK(a){if("object"==typeof a&&null!==a)return a;throw Error(`Could not parse input as Blob. Unsupported blob type: ${typeof a}`)}function fL(a){let b=fK(a);if(b.mimeType&&b.mimeType.startsWith("image/"))return b;throw Error(`Unsupported mime type: ${b.mimeType}`)}function fM(a){let b=fK(a);if(b.mimeType&&b.mimeType.startsWith("audio/"))return b;throw Error(`Unsupported mime type: ${b.mimeType}`)}function fN(a){if(null==a)throw Error("PartUnion is required");if("object"==typeof a)return a;if("string"==typeof a)return{text:a};throw Error(`Unsupported part type: ${typeof a}`)}function fO(a){if(null==a||Array.isArray(a)&&0===a.length)throw Error("PartListUnion is required");return Array.isArray(a)?a.map(a=>fN(a)):[fN(a)]}function fP(a){return null!=a&&"object"==typeof a&&"parts"in a&&Array.isArray(a.parts)}function fQ(a){return null!=a&&"object"==typeof a&&"functionCall"in a}function fR(a){return null!=a&&"object"==typeof a&&"functionResponse"in a}function fS(a){if(null==a)throw Error("ContentUnion is required");return fP(a)?a:{role:"user",parts:fO(a)}}function fT(a,b){if(!b)return[];if(a.isVertexAI()&&Array.isArray(b))return b.flatMap(a=>{let b=fS(a);return b.parts&&b.parts.length>0&&void 0!==b.parts[0].text?[b.parts[0].text]:[]});if(a.isVertexAI()){let a=fS(b);return a.parts&&a.parts.length>0&&void 0!==a.parts[0].text?[a.parts[0].text]:[]}return Array.isArray(b)?b.map(a=>fS(a)):[fS(b)]}function fU(a){if(null==a||Array.isArray(a)&&0===a.length)throw Error("contents are required");if(!Array.isArray(a)){if(fQ(a)||fR(a))throw Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[fS(a)]}let b=[],c=[],d=fP(a[0]);for(let e of a){let a=fP(e);if(a!=d)throw Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(a)b.push(e);else if(fQ(e)||fR(e))throw Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");else c.push(e)}return d||b.push({role:"user",parts:fO(c)}),b}function fV(a){let b={},c=["items"],d=["anyOf"],e=["properties"];if(a.type&&a.anyOf)throw Error("type and anyOf cannot be both populated.");let f=a.anyOf;for(let[g,h]of(null!=f&&2==f.length&&("null"===f[0].type?(b.nullable=!0,a=f[1]):"null"===f[1].type&&(b.nullable=!0,a=f[0])),a.type instanceof Array&&function(a,b){a.includes("null")&&(b.nullable=!0);let c=a.filter(a=>"null"!==a);if(1===c.length)b.type=Object.values(E).includes(c[0].toUpperCase())?c[0].toUpperCase():E.TYPE_UNSPECIFIED;else for(let a of(b.anyOf=[],c))b.anyOf.push({type:Object.values(E).includes(a.toUpperCase())?a.toUpperCase():E.TYPE_UNSPECIFIED})}(a.type,b),Object.entries(a)))if(null!=h)if("type"==g){if("null"===h)throw Error("type: null can not be the only possible type for the field.");if(h instanceof Array)continue;b.type=Object.values(E).includes(h.toUpperCase())?h.toUpperCase():E.TYPE_UNSPECIFIED}else if(c.includes(g))b[g]=fV(h);else if(d.includes(g)){let a=[];for(let c of h){if("null"==c.type){b.nullable=!0;continue}a.push(fV(c))}b[g]=a}else if(e.includes(g)){let a={};for(let[b,c]of Object.entries(h))a[b]=fV(c);b[g]=a}else{if("additionalProperties"===g)continue;b[g]=h}return b}function fW(a){if("object"==typeof a)return a;if("string"==typeof a)return{voiceConfig:{prebuiltVoiceConfig:{voiceName:a}}};throw Error(`Unsupported speechConfig type: ${typeof a}`)}function fX(a){if("multiSpeakerVoiceConfig"in a)throw Error("multiSpeakerVoiceConfig is not supported in the live API.");return a}function fY(a){if(a.functionDeclarations)for(let b of a.functionDeclarations)b.parameters&&(Object.keys(b.parameters).includes("$schema")?b.parametersJsonSchema||(b.parametersJsonSchema=b.parameters,delete b.parameters):b.parameters=fV(b.parameters)),b.response&&(Object.keys(b.response).includes("$schema")?b.responseJsonSchema||(b.responseJsonSchema=b.response,delete b.response):b.response=fV(b.response));return a}function fZ(a){if(null==a)throw Error("tools is required");if(!Array.isArray(a))throw Error("tools is required and must be an array of Tools");let b=[];for(let c of a)b.push(c);return b}function f$(a,b){if("string"!=typeof b)throw Error("name must be a string");return function(a,b,c,d=1){let e=!b.startsWith(`${c}/`)&&b.split("/").length===d;if(a.isVertexAI())if(b.startsWith("projects/"))return b;else if(b.startsWith("locations/"))return`projects/${a.getProject()}/${b}`;else if(b.startsWith(`${c}/`))return`projects/${a.getProject()}/locations/${a.getLocation()}/${b}`;else if(e)return`projects/${a.getProject()}/locations/${a.getLocation()}/${c}/${b}`;else return b;return e?`${c}/${b}`:b}(a,b,"cachedContents")}function f_(a){switch(a){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return a}}function f0(a){return null!=a&&"object"==typeof a&&"video"in a}function f1(a){return null!=a&&"object"==typeof a&&"uri"in a}function f2(a){var b;let c;if(null!=a&&"object"==typeof a&&"name"in a&&(c=a.name),!f1(a)||void 0!==(c=a.uri)){if(!f0(a)||void 0!==(c=null==(b=a.video)?void 0:b.uri)){if("string"==typeof a&&(c=a),void 0===c)throw Error("Could not extract file name from the provided input.");if(c.startsWith("https://")){let a=c.split("files/")[1].match(/[a-z0-9]+/);if(null===a)throw Error(`Could not extract file name from URI ${c}`);c=a[0]}else c.startsWith("files/")&&(c=c.split("files/")[1]);return c}}}function f3(a,b){return a.isVertexAI()?b?"publishers/google/models":"models":b?"models":"tunedModels"}function f4(a){for(let d of["models","tunedModels","publisherModels"]){var b,c;if(b=a,c=d,null!==b&&"object"==typeof b&&c in b)return a[d]}return[]}function f5(a,b){let c;if("string"==typeof b)if(a.isVertexAI())if(b.startsWith("gs://"))c={format:"jsonl",gcsUri:[b]};else if(b.startsWith("bq://"))c={format:"bigquery",bigqueryUri:b};else throw Error(`Unsupported string source for Vertex AI: ${b}`);else if(b.startsWith("files/"))c={fileName:b};else throw Error(`Unsupported string source for Gemini API: ${b}`);else if(Array.isArray(b)){if(a.isVertexAI())throw Error("InlinedRequest[] is not supported in Vertex AI.");c={inlinedRequests:b}}else c=b;let d=[c.gcsUri,c.bigqueryUri].filter(Boolean).length,e=[c.inlinedRequests,c.fileName].filter(Boolean).length;if(a.isVertexAI()){if(e>0||1!==d)throw Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(d>0||1!==e)throw Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return c}function f6(a){if("object"!=typeof a||null===a)return{};let b=a.inlinedResponses;if("object"!=typeof b||null===b)return a;let c=b.inlinedResponses;if(!Array.isArray(c)||0===c.length)return a;let d=!1;for(let a of c){if("object"!=typeof a||null===a)continue;let b=a.response;if("object"==typeof b&&null!==b&&void 0!==b.embedding){d=!0;break}}return d&&(a.inlinedEmbedContentResponses=a.inlinedResponses,delete a.inlinedResponses),a}function f7(a,b){if(!a.isVertexAI()){if(/batches\/[^/]+$/.test(b))return b.split("/").pop();throw Error(`Invalid batch job name: ${b}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(b))return b.split("/").pop();if(/^\d+$/.test(b))return b;throw Error(`Invalid batch job name: ${b}.`)}function f8(a){if("BATCH_STATE_UNSPECIFIED"===a)return"JOB_STATE_UNSPECIFIED";if("BATCH_STATE_PENDING"===a)return"JOB_STATE_PENDING";if("BATCH_STATE_RUNNING"===a)return"JOB_STATE_RUNNING";if("BATCH_STATE_SUCCEEDED"===a)return"JOB_STATE_SUCCEEDED";if("BATCH_STATE_FAILED"===a)return"JOB_STATE_FAILED";else if("BATCH_STATE_CANCELLED"===a)return"JOB_STATE_CANCELLED";else if("BATCH_STATE_EXPIRED"===a)return"JOB_STATE_EXPIRED";else return a}function f9(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["name"],c);let d=fc(a,["metadata","displayName"]);null!=d&&fb(b,["displayName"],d);let e=fc(a,["metadata","state"]);null!=e&&fb(b,["state"],f8(e));let f=fc(a,["metadata","createTime"]);null!=f&&fb(b,["createTime"],f);let g=fc(a,["metadata","endTime"]);null!=g&&fb(b,["endTime"],g);let h=fc(a,["metadata","updateTime"]);null!=h&&fb(b,["updateTime"],h);let i=fc(a,["metadata","model"]);null!=i&&fb(b,["model"],i);let j=fc(a,["metadata","output"]);return null!=j&&fb(b,["dest"],function(a){let b={},c=fc(a,["responsesFile"]);null!=c&&fb(b,["fileName"],c);let d=fc(a,["inlinedResponses","inlinedResponses"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["response"]);null!=c&&fb(b,["response"],function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["content"]);null!=c&&fb(b,["content"],c);let d=fc(a,["citationMetadata"]);null!=d&&fb(b,["citationMetadata"],function(a){let b={},c=fc(a,["citationSources"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["citations"],a)}return b}(d));let e=fc(a,["tokenCount"]);null!=e&&fb(b,["tokenCount"],e);let f=fc(a,["finishReason"]);null!=f&&fb(b,["finishReason"],f);let g=fc(a,["avgLogprobs"]);null!=g&&fb(b,["avgLogprobs"],g);let h=fc(a,["groundingMetadata"]);null!=h&&fb(b,["groundingMetadata"],h);let i=fc(a,["index"]);null!=i&&fb(b,["index"],i);let j=fc(a,["logprobsResult"]);null!=j&&fb(b,["logprobsResult"],j);let k=fc(a,["safetyRatings"]);if(null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["safetyRatings"],a)}let l=fc(a,["urlContextMetadata"]);return null!=l&&fb(b,["urlContextMetadata"],l),b})(a))),fb(b,["candidates"],a)}let e=fc(a,["modelVersion"]);null!=e&&fb(b,["modelVersion"],e);let f=fc(a,["promptFeedback"]);null!=f&&fb(b,["promptFeedback"],f);let g=fc(a,["responseId"]);null!=g&&fb(b,["responseId"],g);let h=fc(a,["usageMetadata"]);return null!=h&&fb(b,["usageMetadata"],h),b}(c));let d=fc(a,["error"]);return null!=d&&fb(b,["error"],d),b})(a))),fb(b,["inlinedResponses"],a)}let e=fc(a,["inlinedEmbedContentResponses","inlinedResponses"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["inlinedEmbedContentResponses"],a)}return b}(f6(j))),b}function ga(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["name"],c);let d=fc(a,["displayName"]);null!=d&&fb(b,["displayName"],d);let e=fc(a,["state"]);null!=e&&fb(b,["state"],f8(e));let f=fc(a,["error"]);null!=f&&fb(b,["error"],f);let g=fc(a,["createTime"]);null!=g&&fb(b,["createTime"],g);let h=fc(a,["startTime"]);null!=h&&fb(b,["startTime"],h);let i=fc(a,["endTime"]);null!=i&&fb(b,["endTime"],i);let j=fc(a,["updateTime"]);null!=j&&fb(b,["updateTime"],j);let k=fc(a,["model"]);null!=k&&fb(b,["model"],k);let l=fc(a,["inputConfig"]);null!=l&&fb(b,["src"],function(a){let b={},c=fc(a,["instancesFormat"]);null!=c&&fb(b,["format"],c);let d=fc(a,["gcsSource","uris"]);null!=d&&fb(b,["gcsUri"],d);let e=fc(a,["bigquerySource","inputUri"]);return null!=e&&fb(b,["bigqueryUri"],e),b}(l));let m=fc(a,["outputConfig"]);null!=m&&fb(b,["dest"],function(a){let b={},c=fc(a,["predictionsFormat"]);null!=c&&fb(b,["format"],c);let d=fc(a,["gcsDestination","outputUriPrefix"]);null!=d&&fb(b,["gcsUri"],d);let e=fc(a,["bigqueryDestination","outputUri"]);return null!=e&&fb(b,["bigqueryUri"],e),b}(f6(m)));let o=fc(a,["completionStats"]);return null!=o&&fb(b,["completionStats"],o),b}function gb(a){let b={},c=fc(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["mediaResolution"]);null!=c&&fb(b,["mediaResolution"],c);let d=fc(a,["codeExecutionResult"]);null!=d&&fb(b,["codeExecutionResult"],d);let e=fc(a,["executableCode"]);null!=e&&fb(b,["executableCode"],e);let f=fc(a,["fileData"]);null!=f&&fb(b,["fileData"],function(a){let b={};if(void 0!==fc(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=fc(a,["fileUri"]);null!=c&&fb(b,["fileUri"],c);let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}(f));let g=fc(a,["functionCall"]);null!=g&&fb(b,["functionCall"],function(a){let b={},c=fc(a,["id"]);null!=c&&fb(b,["id"],c);let d=fc(a,["args"]);null!=d&&fb(b,["args"],d);let e=fc(a,["name"]);if(null!=e&&fb(b,["name"],e),void 0!==fc(a,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==fc(a,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return b}(g));let h=fc(a,["functionResponse"]);null!=h&&fb(b,["functionResponse"],h);let i=fc(a,["inlineData"]);null!=i&&fb(b,["inlineData"],function(a){let b={},c=fc(a,["data"]);if(null!=c&&fb(b,["data"],c),void 0!==fc(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}(i));let j=fc(a,["text"]);null!=j&&fb(b,["text"],j);let k=fc(a,["thought"]);null!=k&&fb(b,["thought"],k);let l=fc(a,["thoughtSignature"]);null!=l&&fb(b,["thoughtSignature"],l);let m=fc(a,["videoMetadata"]);return null!=m&&fb(b,["videoMetadata"],m),b})(a))),fb(b,["parts"],a)}let d=fc(a,["role"]);return null!=d&&fb(b,["role"],d),b}function gc(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["src"]);null!=e&&fb(c,["batch","inputConfig"],function(a,b){let c={};if(void 0!==fc(b,["format"]))throw Error("format parameter is not supported in Gemini API.");if(void 0!==fc(b,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==fc(b,["bigqueryUri"]))throw Error("bigqueryUri parameter is not supported in Gemini API.");let d=fc(b,["fileName"]);null!=d&&fb(c,["fileName"],d);let e=fc(b,["inlinedRequests"]);if(null!=e){let b=e;Array.isArray(b)&&(b=b.map(b=>(function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["request","model"],fH(a,d));let e=fc(b,["contents"]);if(null!=e){let a=fU(e);Array.isArray(a)&&(a=a.map(a=>gb(a))),fb(c,["request","contents"],a)}let f=fc(b,["metadata"]);null!=f&&fb(c,["metadata"],f);let g=fc(b,["config"]);return null!=g&&fb(c,["request","generationConfig"],function(a,b,c){let d={},e=fc(b,["systemInstruction"]);void 0!==c&&null!=e&&fb(c,["systemInstruction"],gb(fS(e)));let f=fc(b,["temperature"]);null!=f&&fb(d,["temperature"],f);let g=fc(b,["topP"]);null!=g&&fb(d,["topP"],g);let h=fc(b,["topK"]);null!=h&&fb(d,["topK"],h);let i=fc(b,["candidateCount"]);null!=i&&fb(d,["candidateCount"],i);let j=fc(b,["maxOutputTokens"]);null!=j&&fb(d,["maxOutputTokens"],j);let k=fc(b,["stopSequences"]);null!=k&&fb(d,["stopSequences"],k);let l=fc(b,["responseLogprobs"]);null!=l&&fb(d,["responseLogprobs"],l);let m=fc(b,["logprobs"]);null!=m&&fb(d,["logprobs"],m);let o=fc(b,["presencePenalty"]);null!=o&&fb(d,["presencePenalty"],o);let p=fc(b,["frequencyPenalty"]);null!=p&&fb(d,["frequencyPenalty"],p);let q=fc(b,["seed"]);null!=q&&fb(d,["seed"],q);let r=fc(b,["responseMimeType"]);null!=r&&fb(d,["responseMimeType"],r);let s=fc(b,["responseSchema"]);null!=s&&fb(d,["responseSchema"],fV(s));let t=fc(b,["responseJsonSchema"]);if(null!=t&&fb(d,["responseJsonSchema"],t),void 0!==fc(b,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==fc(b,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let u=fc(b,["safetySettings"]);if(void 0!==c&&null!=u){let a=u;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["category"]);if(null!=c&&fb(b,["category"],c),void 0!==fc(a,["method"]))throw Error("method parameter is not supported in Gemini API.");let d=fc(a,["threshold"]);return null!=d&&fb(b,["threshold"],d),b})(a))),fb(c,["safetySettings"],a)}let v=fc(b,["tools"]);if(void 0!==c&&null!=v){let a=fZ(v);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["functionDeclarations"],a)}if(void 0!==fc(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=fc(a,["googleSearchRetrieval"]);null!=d&&fb(b,["googleSearchRetrieval"],d);let e=fc(a,["computerUse"]);null!=e&&fb(b,["computerUse"],e);let f=fc(a,["fileSearch"]);null!=f&&fb(b,["fileSearch"],f);let g=fc(a,["codeExecution"]);if(null!=g&&fb(b,["codeExecution"],g),void 0!==fc(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let h=fc(a,["googleMaps"]);null!=h&&fb(b,["googleMaps"],function(a){let b={};if(void 0!==fc(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=fc(a,["enableWidget"]);return null!=c&&fb(b,["enableWidget"],c),b}(h));let i=fc(a,["googleSearch"]);null!=i&&fb(b,["googleSearch"],function(a){let b={};if(void 0!==fc(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==fc(a,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let c=fc(a,["timeRangeFilter"]);return null!=c&&fb(b,["timeRangeFilter"],c),b}(i));let j=fc(a,["urlContext"]);return null!=j&&fb(b,["urlContext"],j),b})(fY(a)))),fb(c,["tools"],a)}let w=fc(b,["toolConfig"]);if(void 0!==c&&null!=w&&fb(c,["toolConfig"],function(a){let b={},c=fc(a,["functionCallingConfig"]);null!=c&&fb(b,["functionCallingConfig"],function(a){let b={},c=fc(a,["mode"]);null!=c&&fb(b,["mode"],c);let d=fc(a,["allowedFunctionNames"]);if(null!=d&&fb(b,["allowedFunctionNames"],d),void 0!==fc(a,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return b}(c));let d=fc(a,["retrievalConfig"]);return null!=d&&fb(b,["retrievalConfig"],d),b}(w)),void 0!==fc(b,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let x=fc(b,["cachedContent"]);void 0!==c&&null!=x&&fb(c,["cachedContent"],f$(a,x));let y=fc(b,["responseModalities"]);null!=y&&fb(d,["responseModalities"],y);let z=fc(b,["mediaResolution"]);null!=z&&fb(d,["mediaResolution"],z);let A=fc(b,["speechConfig"]);if(null!=A&&fb(d,["speechConfig"],fW(A)),void 0!==fc(b,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let B=fc(b,["thinkingConfig"]);null!=B&&fb(d,["thinkingConfig"],B);let C=fc(b,["imageConfig"]);null!=C&&fb(d,["imageConfig"],function(a){let b={},c=fc(a,["aspectRatio"]);null!=c&&fb(b,["aspectRatio"],c);let d=fc(a,["imageSize"]);if(null!=d&&fb(b,["imageSize"],d),void 0!==fc(a,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==fc(a,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return b}(C));let D=fc(b,["enableEnhancedCivicAnswers"]);return null!=D&&fb(d,["enableEnhancedCivicAnswers"],D),d}(a,g,fc(c,["request"],{}))),c})(a,b))),fb(c,["requests","requests"],b)}return c}(a,f5(a,e)));let f=fc(b,["config"]);return null!=f&&function(a,b){let c=fc(a,["displayName"]);if(void 0!==b&&null!=c&&fb(b,["batch","displayName"],c),void 0!==fc(a,["dest"]))throw Error("dest parameter is not supported in Gemini API.")}(f,c),c}!function(a){a.PAGED_ITEM_BATCH_JOBS="batchJobs",a.PAGED_ITEM_MODELS="models",a.PAGED_ITEM_TUNING_JOBS="tuningJobs",a.PAGED_ITEM_FILES="files",a.PAGED_ITEM_CACHED_CONTENTS="cachedContents",a.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",a.PAGED_ITEM_DOCUMENTS="documents"}(aD||(aD={}));class gd{constructor(a,b,c,d){this.pageInternal=[],this.paramsInternal={},this.requestInternal=b,this.init(a,c,d)}init(a,b,c){var d,e;this.nameInternal=a,this.pageInternal=b[this.nameInternal]||[],this.sdkHttpResponseInternal=null==b?void 0:b.sdkHttpResponse,this.idxInternal=0;let f={config:{}};(f=c&&0!==Object.keys(c).length?"object"==typeof c?Object.assign({},c):c:{config:{}}).config&&(f.config.pageToken=b.nextPageToken),this.paramsInternal=f,this.pageInternalSize=null!=(e=null==(d=f.config)?void 0:d.pageSize)?e:this.pageInternal.length}initNextPage(a){this.init(this.nameInternal,a,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(a){return this.pageInternal[a]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(!this.hasNextPage())return{value:void 0,done:!0};else await this.nextPage();let a=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:a,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw Error("No more pages to fetch.");let a=await this.requestInternal(this.params);return this.initNextPage(a),this.page}hasNextPage(){var a;return(null==(a=this.params.config)?void 0:a.pageToken)!==void 0}}class ge extends e9{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new gd(aD.PAGED_ITEM_BATCH_JOBS,a=>this.listInternal(a),await this.listInternal(a),a),this.create=async a=>(this.apiClient.isVertexAI()&&(a.config=this.formatDestination(a.src,a.config)),this.createInternal(a)),this.createEmbeddings=async a=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(a)}}createInlinedGenerateContentRequest(a){let b=gc(this.apiClient,a),c=fa("{model}:batchGenerateContent",b._url),d=b.batch.inputConfig.requests,e=d.requests,f=[];for(let a of e){let b=Object.assign({},a);if(b.systemInstruction){let a=b.systemInstruction;delete b.systemInstruction;let c=b.request;c.systemInstruction=a,b.request=c}f.push(b)}return d.requests=f,delete b.config,delete b._url,delete b._query,{path:c,body:b}}getGcsUri(a){return"string"==typeof a?a.startsWith("gs://")?a:void 0:!Array.isArray(a)&&a.gcsUri&&a.gcsUri.length>0?a.gcsUri[0]:void 0}getBigqueryUri(a){return"string"==typeof a?a.startsWith("bq://")?a:void 0:Array.isArray(a)?void 0:a.bigqueryUri}formatDestination(a,b){let c=b?Object.assign({},b):{},d=Date.now().toString();if(c.displayName||(c.displayName=`genaiBatchJob_${d}`),void 0===c.dest){let b=this.getGcsUri(a),e=this.getBigqueryUri(a);if(b)b.endsWith(".jsonl")?c.dest=`${b.slice(0,-6)}/dest`:c.dest=`${b}_dest_${d}`;else if(e)c.dest=`${e}_dest_${d}`;else throw Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return c}async createInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["model"],fH(a,d));let e=fc(b,["src"]);null!=e&&fb(c,["inputConfig"],function(a){let b={},c=fc(a,["format"]);null!=c&&fb(b,["instancesFormat"],c);let d=fc(a,["gcsUri"]);null!=d&&fb(b,["gcsSource","uris"],d);let e=fc(a,["bigqueryUri"]);if(null!=e&&fb(b,["bigquerySource","inputUri"],e),void 0!==fc(a,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==fc(a,["inlinedRequests"]))throw Error("inlinedRequests parameter is not supported in Vertex AI.");return b}(f5(a,e)));let f=fc(b,["config"]);return null!=f&&function(a,b){let c=fc(a,["displayName"]);void 0!==b&&null!=c&&fb(b,["displayName"],c);let d=fc(a,["dest"]);void 0!==b&&null!=d&&fb(b,["outputConfig"],function(a){let b={},c=fc(a,["format"]);null!=c&&fb(b,["predictionsFormat"],c);let d=fc(a,["gcsUri"]);null!=d&&fb(b,["gcsDestination","outputUriPrefix"],d);let e=fc(a,["bigqueryUri"]);if(null!=e&&fb(b,["bigqueryDestination","outputUri"],e),void 0!==fc(a,["fileName"]))throw Error("fileName parameter is not supported in Vertex AI.");if(void 0!==fc(a,["inlinedResponses"]))throw Error("inlinedResponses parameter is not supported in Vertex AI.");if(void 0!==fc(a,["inlinedEmbedContentResponses"]))throw Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return b}(function(a){if("string"!=typeof a)return a;if(a.startsWith("gs://"))return{format:"jsonl",gcsUri:a};if(a.startsWith("bq://"))return{format:"bigquery",bigqueryUri:a};throw Error(`Unsupported destination: ${a}`)}(d)))}(f,c),c}(this.apiClient,a);return f=fa("batchPredictionJobs",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>ga(a))}{let b=gc(this.apiClient,a);return f=fa("{model}:batchGenerateContent",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>f9(a))}}async createEmbeddingsInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["src"]);null!=e&&fb(c,["batch","inputConfig"],function(a,b){let c={},d=fc(b,["fileName"]);null!=d&&fb(c,["file_name"],d);let e=fc(b,["inlinedRequests"]);return null!=e&&fb(c,["requests"],function(a,b){let c={},d=fc(b,["contents"]);if(null!=d){let b=fT(a,d);Array.isArray(b)&&(b=b.map(a=>a)),fb(c,["requests[]","request","content"],b)}let e=fc(b,["config"]);return null!=e&&(fb(c,["_self"],function(a,b){let c=fc(a,["taskType"]);void 0!==b&&null!=c&&fb(b,["requests[]","taskType"],c);let d=fc(a,["title"]);void 0!==b&&null!=d&&fb(b,["requests[]","title"],d);let e=fc(a,["outputDimensionality"]);if(void 0!==b&&null!=e&&fb(b,["requests[]","outputDimensionality"],e),void 0!==fc(a,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==fc(a,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.");return{}}(e,c)),!function(a,b){for(let[c,d]of Object.entries(b)){let b=c.split("."),e=d.split("."),f=new Set,g=-1;for(let a=0;a<b.length;a++)if("*"===b[a]){g=a;break}if(-1!==g&&e.length>g)for(let a=g;a<e.length;a++){let b=e[a];"*"===b||b.endsWith("[]")||b.endsWith("[0]")||f.add(b)}!function a(b,c,d,e,f){if(e>=c.length||"object"!=typeof b||null===b)return;let g=c[e];if(g.endsWith("[]")){let h=g.slice(0,-2);if(h in b&&Array.isArray(b[h]))for(let g of b[h])a(g,c,d,e+1,f)}else if("*"===g){if("object"==typeof b&&null!==b&&!Array.isArray(b)){let a=Object.keys(b).filter(a=>!a.startsWith("_")&&!f.has(a)),c={};for(let d of a)c[d]=b[d];for(let[a,f]of Object.entries(c)){let c=[];for(let b of d.slice(e))"*"===b?c.push(a):c.push(b);fb(b,c,f)}for(let c of a)delete b[c]}}else g in b&&a(b[g],c,d,e+1,f)}(a,b,e,0,f)}}(c,{"requests[].*":"requests[].request.*"})),c}(a,e)),c}(a,e));let f=fc(b,["config"]);return null!=f&&function(a,b){let c=fc(a,["displayName"]);void 0!==b&&null!=c&&fb(b,["batch","displayName"],c)}(f,c),c}(this.apiClient,a);return d=fa("{model}:asyncBatchEmbedContent",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>f9(a))}}async get(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["name"]);return null!=d&&fb(c,["_url","name"],f7(a,d)),c}(this.apiClient,a);return f=fa("batchPredictionJobs/{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>ga(a))}{let b=function(a,b){let c={},d=fc(b,["name"]);return null!=d&&fb(c,["_url","name"],f7(a,d)),c}(this.apiClient,a);return f=fa("batches/{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>f9(a))}}async cancel(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["name"]);return null!=d&&fb(c,["_url","name"],f7(a,d)),c}(this.apiClient,a);f=fa("batchPredictionJobs/{name}:cancel",d._url),g=d._query,delete d._url,delete d._query,await this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal})}else{let b=function(a,b){let c={},d=fc(b,["name"]);return null!=d&&fb(c,["_url","name"],f7(a,d)),c}(this.apiClient,a);f=fa("batches/{name}:cancel",b._url),g=b._query,delete b._url,delete b._query,await this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal})}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a){let b={},c=fc(a,["config"]);return null!=c&&function(a,b){let c=fc(a,["pageSize"]);void 0!==b&&null!=c&&fb(b,["_query","pageSize"],c);let d=fc(a,["pageToken"]);void 0!==b&&null!=d&&fb(b,["_query","pageToken"],d);let e=fc(a,["filter"]);void 0!==b&&null!=e&&fb(b,["_query","filter"],e)}(c,b),b}(a);return f=fa("batchPredictionJobs",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["nextPageToken"]);null!=d&&fb(b,["nextPageToken"],d);let e=fc(a,["batchPredictionJobs"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>ga(a))),fb(b,["batchJobs"],a)}return b}(a),c=new fD;return Object.assign(c,b),c})}{let b=function(a){let b={},c=fc(a,["config"]);return null!=c&&function(a,b){let c=fc(a,["pageSize"]);void 0!==b&&null!=c&&fb(b,["_query","pageSize"],c);let d=fc(a,["pageToken"]);if(void 0!==b&&null!=d&&fb(b,["_query","pageToken"],d),void 0!==fc(a,["filter"]))throw Error("filter parameter is not supported in Gemini API.")}(c,b),b}(a);return f=fa("batches",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["nextPageToken"]);null!=d&&fb(b,["nextPageToken"],d);let e=fc(a,["operations"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>f9(a))),fb(b,["batchJobs"],a)}return b}(a),c=new fD;return Object.assign(c,b),c})}}async delete(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["name"]);return null!=d&&fb(c,["_url","name"],f7(a,d)),c}(this.apiClient,a);return f=fa("batchPredictionJobs/{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>(function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["name"]);null!=d&&fb(b,["name"],d);let e=fc(a,["done"]);null!=e&&fb(b,["done"],e);let f=fc(a,["error"]);return null!=f&&fb(b,["error"],f),b})(a))}{let b=function(a,b){let c={},d=fc(b,["name"]);return null!=d&&fb(c,["_url","name"],f7(a,d)),c}(this.apiClient,a);return f=fa("batches/{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>(function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["name"]);null!=d&&fb(b,["name"],d);let e=fc(a,["done"]);null!=e&&fb(b,["done"],e);let f=fc(a,["error"]);return null!=f&&fb(b,["error"],f),b})(a))}}}function gf(a){let b={},c=fc(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["mediaResolution"]);null!=c&&fb(b,["mediaResolution"],c);let d=fc(a,["codeExecutionResult"]);null!=d&&fb(b,["codeExecutionResult"],d);let e=fc(a,["executableCode"]);null!=e&&fb(b,["executableCode"],e);let f=fc(a,["fileData"]);null!=f&&fb(b,["fileData"],function(a){let b={};if(void 0!==fc(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=fc(a,["fileUri"]);null!=c&&fb(b,["fileUri"],c);let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}(f));let g=fc(a,["functionCall"]);null!=g&&fb(b,["functionCall"],function(a){let b={},c=fc(a,["id"]);null!=c&&fb(b,["id"],c);let d=fc(a,["args"]);null!=d&&fb(b,["args"],d);let e=fc(a,["name"]);if(null!=e&&fb(b,["name"],e),void 0!==fc(a,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==fc(a,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return b}(g));let h=fc(a,["functionResponse"]);null!=h&&fb(b,["functionResponse"],h);let i=fc(a,["inlineData"]);null!=i&&fb(b,["inlineData"],function(a){let b={},c=fc(a,["data"]);if(null!=c&&fb(b,["data"],c),void 0!==fc(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}(i));let j=fc(a,["text"]);null!=j&&fb(b,["text"],j);let k=fc(a,["thought"]);null!=k&&fb(b,["thought"],k);let l=fc(a,["thoughtSignature"]);null!=l&&fb(b,["thoughtSignature"],l);let m=fc(a,["videoMetadata"]);return null!=m&&fb(b,["videoMetadata"],m),b})(a))),fb(b,["parts"],a)}let d=fc(a,["role"]);return null!=d&&fb(b,["role"],d),b}class gg extends e9{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new gd(aD.PAGED_ITEM_CACHED_CONTENTS,a=>this.listInternal(a),await this.listInternal(a),a)}async create(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["model"],fI(a,d));let e=fc(b,["config"]);return null!=e&&function(a,b){let c=fc(a,["ttl"]);void 0!==b&&null!=c&&fb(b,["ttl"],c);let d=fc(a,["expireTime"]);void 0!==b&&null!=d&&fb(b,["expireTime"],d);let e=fc(a,["displayName"]);void 0!==b&&null!=e&&fb(b,["displayName"],e);let f=fc(a,["contents"]);if(void 0!==b&&null!=f){let a=fU(f);Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["contents"],a)}let g=fc(a,["systemInstruction"]);void 0!==b&&null!=g&&fb(b,["systemInstruction"],fS(g));let h=fc(a,["tools"]);if(void 0!==b&&null!=h){let a=h;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==fc(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=fc(a,["description"]);null!=c&&fb(b,["description"],c);let d=fc(a,["name"]);null!=d&&fb(b,["name"],d);let e=fc(a,["parameters"]);null!=e&&fb(b,["parameters"],e);let f=fc(a,["parametersJsonSchema"]);null!=f&&fb(b,["parametersJsonSchema"],f);let g=fc(a,["response"]);null!=g&&fb(b,["response"],g);let h=fc(a,["responseJsonSchema"]);return null!=h&&fb(b,["responseJsonSchema"],h),b})(a))),fb(b,["functionDeclarations"],a)}let d=fc(a,["retrieval"]);null!=d&&fb(b,["retrieval"],d);let e=fc(a,["googleSearchRetrieval"]);null!=e&&fb(b,["googleSearchRetrieval"],e);let f=fc(a,["computerUse"]);if(null!=f&&fb(b,["computerUse"],f),void 0!==fc(a,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let g=fc(a,["codeExecution"]);null!=g&&fb(b,["codeExecution"],g);let h=fc(a,["enterpriseWebSearch"]);null!=h&&fb(b,["enterpriseWebSearch"],h);let i=fc(a,["googleMaps"]);null!=i&&fb(b,["googleMaps"],i);let j=fc(a,["googleSearch"]);null!=j&&fb(b,["googleSearch"],j);let k=fc(a,["urlContext"]);return null!=k&&fb(b,["urlContext"],k),b})(a))),fb(b,["tools"],a)}let i=fc(a,["toolConfig"]);void 0!==b&&null!=i&&fb(b,["toolConfig"],i);let j=fc(a,["kmsKeyName"]);void 0!==b&&null!=j&&fb(b,["encryption_spec","kmsKeyName"],j)}(e,c),c}(this.apiClient,a);return f=fa("cachedContents",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}{let b=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["model"],fI(a,d));let e=fc(b,["config"]);return null!=e&&function(a,b){let c=fc(a,["ttl"]);void 0!==b&&null!=c&&fb(b,["ttl"],c);let d=fc(a,["expireTime"]);void 0!==b&&null!=d&&fb(b,["expireTime"],d);let e=fc(a,["displayName"]);void 0!==b&&null!=e&&fb(b,["displayName"],e);let f=fc(a,["contents"]);if(void 0!==b&&null!=f){let a=fU(f);Array.isArray(a)&&(a=a.map(a=>gf(a))),fb(b,["contents"],a)}let g=fc(a,["systemInstruction"]);void 0!==b&&null!=g&&fb(b,["systemInstruction"],gf(fS(g)));let h=fc(a,["tools"]);if(void 0!==b&&null!=h){let a=h;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["functionDeclarations"],a)}if(void 0!==fc(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=fc(a,["googleSearchRetrieval"]);null!=d&&fb(b,["googleSearchRetrieval"],d);let e=fc(a,["computerUse"]);null!=e&&fb(b,["computerUse"],e);let f=fc(a,["fileSearch"]);null!=f&&fb(b,["fileSearch"],f);let g=fc(a,["codeExecution"]);if(null!=g&&fb(b,["codeExecution"],g),void 0!==fc(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let h=fc(a,["googleMaps"]);null!=h&&fb(b,["googleMaps"],function(a){let b={};if(void 0!==fc(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=fc(a,["enableWidget"]);return null!=c&&fb(b,["enableWidget"],c),b}(h));let i=fc(a,["googleSearch"]);null!=i&&fb(b,["googleSearch"],function(a){let b={};if(void 0!==fc(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==fc(a,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let c=fc(a,["timeRangeFilter"]);return null!=c&&fb(b,["timeRangeFilter"],c),b}(i));let j=fc(a,["urlContext"]);return null!=j&&fb(b,["urlContext"],j),b})(a))),fb(b,["tools"],a)}let i=fc(a,["toolConfig"]);if(void 0!==b&&null!=i&&fb(b,["toolConfig"],function(a){let b={},c=fc(a,["functionCallingConfig"]);null!=c&&fb(b,["functionCallingConfig"],function(a){let b={},c=fc(a,["mode"]);null!=c&&fb(b,["mode"],c);let d=fc(a,["allowedFunctionNames"]);if(null!=d&&fb(b,["allowedFunctionNames"],d),void 0!==fc(a,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return b}(c));let d=fc(a,["retrievalConfig"]);return null!=d&&fb(b,["retrievalConfig"],d),b}(i)),void 0!==fc(a,["kmsKeyName"]))throw Error("kmsKeyName parameter is not supported in Gemini API.")}(e,c),c}(this.apiClient,a);return f=fa("cachedContents",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>a)}}async get(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["name"]);return null!=d&&fb(c,["_url","name"],f$(a,d)),c}(this.apiClient,a);return f=fa("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}{let b=function(a,b){let c={},d=fc(b,["name"]);return null!=d&&fb(c,["_url","name"],f$(a,d)),c}(this.apiClient,a);return f=fa("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>a)}}async delete(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["name"]);return null!=d&&fb(c,["_url","name"],f$(a,d)),c}(this.apiClient,a);return f=fa("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);return null!=c&&fb(b,["sdkHttpResponse"],c),b}(a),c=new fu;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=fc(b,["name"]);return null!=d&&fb(c,["_url","name"],f$(a,d)),c}(this.apiClient,a);return f=fa("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);return null!=c&&fb(b,["sdkHttpResponse"],c),b}(a),c=new fu;return Object.assign(c,b),c})}}async update(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["name"]);null!=d&&fb(c,["_url","name"],f$(a,d));let e=fc(b,["config"]);return null!=e&&function(a,b){let c=fc(a,["ttl"]);void 0!==b&&null!=c&&fb(b,["ttl"],c);let d=fc(a,["expireTime"]);void 0!==b&&null!=d&&fb(b,["expireTime"],d)}(e,c),c}(this.apiClient,a);return f=fa("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}{let b=function(a,b){let c={},d=fc(b,["name"]);null!=d&&fb(c,["_url","name"],f$(a,d));let e=fc(b,["config"]);return null!=e&&function(a,b){let c=fc(a,["ttl"]);void 0!==b&&null!=c&&fb(b,["ttl"],c);let d=fc(a,["expireTime"]);void 0!==b&&null!=d&&fb(b,["expireTime"],d)}(e,c),c}(this.apiClient,a);return f=fa("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"PATCH",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>a)}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a){let b={},c=fc(a,["config"]);return null!=c&&function(a,b){let c=fc(a,["pageSize"]);void 0!==b&&null!=c&&fb(b,["_query","pageSize"],c);let d=fc(a,["pageToken"]);void 0!==b&&null!=d&&fb(b,["_query","pageToken"],d)}(c,b),b}(a);return f=fa("cachedContents",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["nextPageToken"]);null!=d&&fb(b,["nextPageToken"],d);let e=fc(a,["cachedContents"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["cachedContents"],a)}return b}(a),c=new fv;return Object.assign(c,b),c})}{let b=function(a){let b={},c=fc(a,["config"]);return null!=c&&function(a,b){let c=fc(a,["pageSize"]);void 0!==b&&null!=c&&fb(b,["_query","pageSize"],c);let d=fc(a,["pageToken"]);void 0!==b&&null!=d&&fb(b,["_query","pageToken"],d)}(c,b),b}(a);return f=fa("cachedContents",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["nextPageToken"]);null!=d&&fb(b,["nextPageToken"],d);let e=fc(a,["cachedContents"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["cachedContents"],a)}return b}(a),c=new fv;return Object.assign(c,b),c})}}}function gh(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}function gi(a){return this instanceof gi?(this.v=a,this):new gi(a)}function gj(a,b,c){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var d,e=c.apply(a,b||[]),f=[];return d=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",function(a){return function(b){return Promise.resolve(b).then(a,j)}}),d[Symbol.asyncIterator]=function(){return this},d;function g(a,b){e[a]&&(d[a]=function(b){return new Promise(function(c,d){f.push([a,b,c,d])>1||h(a,b)})},b&&(d[a]=b(d[a])))}function h(a,b){try{var c;(c=e[a](b)).value instanceof gi?Promise.resolve(c.value.v).then(i,j):k(f[0][2],c)}catch(a){k(f[0][3],a)}}function i(a){h("next",a)}function j(a){h("throw",a)}function k(a,b){a(b),f.shift(),f.length&&h(f[0][0],f[0][1])}}function gk(a){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var b,c=a[Symbol.asyncIterator];return c?c.call(a):(a=function(a){var b="function"==typeof Symbol&&Symbol.iterator,c=b&&a[b],d=0;if(c)return c.call(a);if(a&&"number"==typeof a.length)return{next:function(){return a&&d>=a.length&&(a=void 0),{value:a&&a[d++],done:!a}}};throw TypeError(b?"Object is not iterable.":"Symbol.iterator is not defined.")}(a),b={},d("next"),d("throw"),d("return"),b[Symbol.asyncIterator]=function(){return this},b);function d(c){b[c]=a[c]&&function(b){return new Promise(function(d,e){var f,g,h;f=d,g=e,h=(b=a[c](b)).done,Promise.resolve(b.value).then(function(a){f({value:a,done:h})},g)})}}}function gl(a){if(void 0===a.parts||0===a.parts.length)return!1;for(let b of a.parts)if(void 0===b||0===Object.keys(b).length)return!1;return!0}function gm(a){if(void 0===a||0===a.length)return[];let b=[],c=a.length,d=0;for(;d<c;)if("user"===a[d].role)b.push(a[d]),d++;else{let e=[],f=!0;for(;d<c&&"model"===a[d].role;)e.push(a[d]),f&&!gl(a[d])&&(f=!1),d++;f?b.push(...e):b.pop()}return b}"function"==typeof SuppressedError&&SuppressedError;class gn{constructor(a,b){this.modelsModule=a,this.apiClient=b}create(a){return new go(this.apiClient,this.modelsModule,a.model,a.config,structuredClone(a.history))}}class go{constructor(a,b,c,d={},e=[]){this.apiClient=a,this.modelsModule=b,this.model=c,this.config=d,this.history=e,this.sendPromise=Promise.resolve(),function(a){if(0!==a.length){for(let b of a)if("user"!==b.role&&"model"!==b.role)throw Error(`Role must be user or model, but got ${b.role}.`)}}(e)}async sendMessage(a){var b;await this.sendPromise;let c=fS(a.message),d=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(c),config:null!=(b=a.config)?b:this.config});return this.sendPromise=(async()=>{var a,b,e;let f=await d,g=null==(b=null==(a=f.candidates)?void 0:a[0])?void 0:b.content,h=f.automaticFunctionCallingHistory,i=this.getHistory(!0).length,j=[];null!=h&&(j=null!=(e=h.slice(i))?e:[]),this.recordHistory(c,g?[g]:[],j)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),d}async sendMessageStream(a){var b;await this.sendPromise;let c=fS(a.message),d=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(c),config:null!=(b=a.config)?b:this.config});this.sendPromise=d.then(()=>void 0).catch(()=>void 0);let e=await d;return this.processStreamResponse(e,c)}getHistory(a=!1){return structuredClone(a?gm(this.history):this.history)}processStreamResponse(a,b){return gj(this,arguments,function*(){let c=[];try{for(var d,e,f,g,h,i,j,k=!0,l=gk(a);!(d=(j=yield gi(l.next())).done);k=!0){if(g=j.value,k=!1,function(a){var b;if(void 0==a.candidates||0===a.candidates.length)return!1;let c=null==(b=a.candidates[0])?void 0:b.content;return void 0!==c&&gl(c)}(g)){let a=null==(i=null==(h=g.candidates)?void 0:h[0])?void 0:i.content;void 0!==a&&c.push(a)}yield yield gi(g)}}catch(a){e={error:a}}finally{try{!k&&!d&&(f=l.return)&&(yield gi(f.call(l)))}finally{if(e)throw e.error}}this.recordHistory(b,c)})}recordHistory(a,b,c){let d=[];b.length>0&&b.every(a=>void 0!==a.role)?d=b:d.push({role:"model",parts:[]}),c&&c.length>0?this.history.push(...gm(c)):this.history.push(a),this.history.push(...d)}}class gp extends Error{constructor(a){super(a.message),this.name="ApiError",this.status=a.status,Object.setPrototypeOf(this,gp.prototype)}}class gq extends e9{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new gd(aD.PAGED_ITEM_FILES,a=>this.listInternal(a),await this.listInternal(a),a)}async upload(a){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(a.file,a.config).then(a=>a)}async download(a){await this.apiClient.downloadFile(a)}async listInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["config"]);return null!=c&&function(a,b){let c=fc(a,["pageSize"]);void 0!==b&&null!=c&&fb(b,["_query","pageSize"],c);let d=fc(a,["pageToken"]);void 0!==b&&null!=d&&fb(b,["_query","pageToken"],d)}(c,b),b}(a);return d=fa("files",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["nextPageToken"]);null!=d&&fb(b,["nextPageToken"],d);let e=fc(a,["files"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["files"],a)}return b}(a),c=new fA;return Object.assign(c,b),c})}}async createInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["file"]);return null!=c&&fb(b,["file"],c),b}(a);return d=fa("upload/v1beta/files",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);return null!=c&&fb(b,["sdkHttpResponse"],c),b}(a),c=new fB;return Object.assign(c,b),c})}}async get(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["name"]);return null!=c&&fb(b,["_url","file"],f2(c)),b}(a);return d=fa("files/{file}",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}async delete(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["name"]);return null!=c&&fb(b,["_url","file"],f2(c)),b}(a);return d=fa("files/{file}",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);return null!=c&&fb(b,["sdkHttpResponse"],c),b}(a),c=new fC;return Object.assign(c,b),c})}}}function gr(a){let b={},c=fc(a,["data"]);if(null!=c&&fb(b,["data"],c),void 0!==fc(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}function gs(a){let b={},c=fc(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["mediaResolution"]);null!=c&&fb(b,["mediaResolution"],c);let d=fc(a,["codeExecutionResult"]);null!=d&&fb(b,["codeExecutionResult"],d);let e=fc(a,["executableCode"]);null!=e&&fb(b,["executableCode"],e);let f=fc(a,["fileData"]);null!=f&&fb(b,["fileData"],function(a){let b={};if(void 0!==fc(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=fc(a,["fileUri"]);null!=c&&fb(b,["fileUri"],c);let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}(f));let g=fc(a,["functionCall"]);null!=g&&fb(b,["functionCall"],function(a){let b={},c=fc(a,["id"]);null!=c&&fb(b,["id"],c);let d=fc(a,["args"]);null!=d&&fb(b,["args"],d);let e=fc(a,["name"]);if(null!=e&&fb(b,["name"],e),void 0!==fc(a,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==fc(a,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return b}(g));let h=fc(a,["functionResponse"]);null!=h&&fb(b,["functionResponse"],h);let i=fc(a,["inlineData"]);null!=i&&fb(b,["inlineData"],function(a){let b={},c=fc(a,["data"]);if(null!=c&&fb(b,["data"],c),void 0!==fc(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}(i));let j=fc(a,["text"]);null!=j&&fb(b,["text"],j);let k=fc(a,["thought"]);null!=k&&fb(b,["thought"],k);let l=fc(a,["thoughtSignature"]);null!=l&&fb(b,["thoughtSignature"],l);let m=fc(a,["videoMetadata"]);return null!=m&&fb(b,["videoMetadata"],m),b})(a))),fb(b,["parts"],a)}let d=fc(a,["role"]);return null!=d&&fb(b,["role"],d),b}function gt(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["contents"]);if(null!=e){let a=fU(e);Array.isArray(a)&&(a=a.map(a=>gs(a))),fb(c,["contents"],a)}let f=fc(b,["config"]);return null!=f&&fb(c,["generationConfig"],function(a,b,c){let d={},e=fc(b,["systemInstruction"]);void 0!==c&&null!=e&&fb(c,["systemInstruction"],gs(fS(e)));let f=fc(b,["temperature"]);null!=f&&fb(d,["temperature"],f);let g=fc(b,["topP"]);null!=g&&fb(d,["topP"],g);let h=fc(b,["topK"]);null!=h&&fb(d,["topK"],h);let i=fc(b,["candidateCount"]);null!=i&&fb(d,["candidateCount"],i);let j=fc(b,["maxOutputTokens"]);null!=j&&fb(d,["maxOutputTokens"],j);let k=fc(b,["stopSequences"]);null!=k&&fb(d,["stopSequences"],k);let l=fc(b,["responseLogprobs"]);null!=l&&fb(d,["responseLogprobs"],l);let m=fc(b,["logprobs"]);null!=m&&fb(d,["logprobs"],m);let o=fc(b,["presencePenalty"]);null!=o&&fb(d,["presencePenalty"],o);let p=fc(b,["frequencyPenalty"]);null!=p&&fb(d,["frequencyPenalty"],p);let q=fc(b,["seed"]);null!=q&&fb(d,["seed"],q);let r=fc(b,["responseMimeType"]);null!=r&&fb(d,["responseMimeType"],r);let s=fc(b,["responseSchema"]);null!=s&&fb(d,["responseSchema"],fV(s));let t=fc(b,["responseJsonSchema"]);if(null!=t&&fb(d,["responseJsonSchema"],t),void 0!==fc(b,["routingConfig"]))throw Error("routingConfig parameter is not supported in Gemini API.");if(void 0!==fc(b,["modelSelectionConfig"]))throw Error("modelSelectionConfig parameter is not supported in Gemini API.");let u=fc(b,["safetySettings"]);if(void 0!==c&&null!=u){let a=u;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["category"]);if(null!=c&&fb(b,["category"],c),void 0!==fc(a,["method"]))throw Error("method parameter is not supported in Gemini API.");let d=fc(a,["threshold"]);return null!=d&&fb(b,["threshold"],d),b})(a))),fb(c,["safetySettings"],a)}let v=fc(b,["tools"]);if(void 0!==c&&null!=v){let a=fZ(v);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["functionDeclarations"],a)}if(void 0!==fc(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=fc(a,["googleSearchRetrieval"]);null!=d&&fb(b,["googleSearchRetrieval"],d);let e=fc(a,["computerUse"]);null!=e&&fb(b,["computerUse"],e);let f=fc(a,["fileSearch"]);null!=f&&fb(b,["fileSearch"],f);let g=fc(a,["codeExecution"]);if(null!=g&&fb(b,["codeExecution"],g),void 0!==fc(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let h=fc(a,["googleMaps"]);null!=h&&fb(b,["googleMaps"],function(a){let b={};if(void 0!==fc(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=fc(a,["enableWidget"]);return null!=c&&fb(b,["enableWidget"],c),b}(h));let i=fc(a,["googleSearch"]);null!=i&&fb(b,["googleSearch"],function(a){let b={};if(void 0!==fc(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==fc(a,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let c=fc(a,["timeRangeFilter"]);return null!=c&&fb(b,["timeRangeFilter"],c),b}(i));let j=fc(a,["urlContext"]);return null!=j&&fb(b,["urlContext"],j),b})(fY(a)))),fb(c,["tools"],a)}let w=fc(b,["toolConfig"]);if(void 0!==c&&null!=w&&fb(c,["toolConfig"],function(a){let b={},c=fc(a,["functionCallingConfig"]);null!=c&&fb(b,["functionCallingConfig"],function(a){let b={},c=fc(a,["mode"]);null!=c&&fb(b,["mode"],c);let d=fc(a,["allowedFunctionNames"]);if(null!=d&&fb(b,["allowedFunctionNames"],d),void 0!==fc(a,["streamFunctionCallArguments"]))throw Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return b}(c));let d=fc(a,["retrievalConfig"]);return null!=d&&fb(b,["retrievalConfig"],d),b}(w)),void 0!==fc(b,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let x=fc(b,["cachedContent"]);void 0!==c&&null!=x&&fb(c,["cachedContent"],f$(a,x));let y=fc(b,["responseModalities"]);null!=y&&fb(d,["responseModalities"],y);let z=fc(b,["mediaResolution"]);null!=z&&fb(d,["mediaResolution"],z);let A=fc(b,["speechConfig"]);if(null!=A&&fb(d,["speechConfig"],fW(A)),void 0!==fc(b,["audioTimestamp"]))throw Error("audioTimestamp parameter is not supported in Gemini API.");let B=fc(b,["thinkingConfig"]);null!=B&&fb(d,["thinkingConfig"],B);let C=fc(b,["imageConfig"]);null!=C&&fb(d,["imageConfig"],function(a){let b={},c=fc(a,["aspectRatio"]);null!=c&&fb(b,["aspectRatio"],c);let d=fc(a,["imageSize"]);if(null!=d&&fb(b,["imageSize"],d),void 0!==fc(a,["outputMimeType"]))throw Error("outputMimeType parameter is not supported in Gemini API.");if(void 0!==fc(a,["outputCompressionQuality"]))throw Error("outputCompressionQuality parameter is not supported in Gemini API.");return b}(C));let D=fc(b,["enableEnhancedCivicAnswers"]);return null!=D&&fb(d,["enableEnhancedCivicAnswers"],D),d}(a,f,c)),c}function gu(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["contents"]);if(null!=e){let a=fU(e);Array.isArray(a)&&(a=a.map(a=>a)),fb(c,["contents"],a)}let f=fc(b,["config"]);return null!=f&&fb(c,["generationConfig"],function(a,b,c){let d={},e=fc(b,["systemInstruction"]);void 0!==c&&null!=e&&fb(c,["systemInstruction"],fS(e));let f=fc(b,["temperature"]);null!=f&&fb(d,["temperature"],f);let g=fc(b,["topP"]);null!=g&&fb(d,["topP"],g);let h=fc(b,["topK"]);null!=h&&fb(d,["topK"],h);let i=fc(b,["candidateCount"]);null!=i&&fb(d,["candidateCount"],i);let j=fc(b,["maxOutputTokens"]);null!=j&&fb(d,["maxOutputTokens"],j);let k=fc(b,["stopSequences"]);null!=k&&fb(d,["stopSequences"],k);let l=fc(b,["responseLogprobs"]);null!=l&&fb(d,["responseLogprobs"],l);let m=fc(b,["logprobs"]);null!=m&&fb(d,["logprobs"],m);let o=fc(b,["presencePenalty"]);null!=o&&fb(d,["presencePenalty"],o);let p=fc(b,["frequencyPenalty"]);null!=p&&fb(d,["frequencyPenalty"],p);let q=fc(b,["seed"]);null!=q&&fb(d,["seed"],q);let r=fc(b,["responseMimeType"]);null!=r&&fb(d,["responseMimeType"],r);let s=fc(b,["responseSchema"]);null!=s&&fb(d,["responseSchema"],fV(s));let t=fc(b,["responseJsonSchema"]);null!=t&&fb(d,["responseJsonSchema"],t);let u=fc(b,["routingConfig"]);null!=u&&fb(d,["routingConfig"],u);let v=fc(b,["modelSelectionConfig"]);null!=v&&fb(d,["modelConfig"],v);let w=fc(b,["safetySettings"]);if(void 0!==c&&null!=w){let a=w;Array.isArray(a)&&(a=a.map(a=>a)),fb(c,["safetySettings"],a)}let x=fc(b,["tools"]);if(void 0!==c&&null!=x){let a=fZ(x);Array.isArray(a)&&(a=a.map(a=>gF(fY(a)))),fb(c,["tools"],a)}let y=fc(b,["toolConfig"]);void 0!==c&&null!=y&&fb(c,["toolConfig"],y);let z=fc(b,["labels"]);void 0!==c&&null!=z&&fb(c,["labels"],z);let A=fc(b,["cachedContent"]);void 0!==c&&null!=A&&fb(c,["cachedContent"],f$(a,A));let B=fc(b,["responseModalities"]);null!=B&&fb(d,["responseModalities"],B);let C=fc(b,["mediaResolution"]);null!=C&&fb(d,["mediaResolution"],C);let D=fc(b,["speechConfig"]);null!=D&&fb(d,["speechConfig"],fW(D));let E=fc(b,["audioTimestamp"]);null!=E&&fb(d,["audioTimestamp"],E);let F=fc(b,["thinkingConfig"]);null!=F&&fb(d,["thinkingConfig"],F);let G=fc(b,["imageConfig"]);if(null!=G&&fb(d,["imageConfig"],function(a){let b={},c=fc(a,["aspectRatio"]);null!=c&&fb(b,["aspectRatio"],c);let d=fc(a,["imageSize"]);null!=d&&fb(b,["imageSize"],d);let e=fc(a,["outputMimeType"]);null!=e&&fb(b,["imageOutputOptions","mimeType"],e);let f=fc(a,["outputCompressionQuality"]);return null!=f&&fb(b,["imageOutputOptions","compressionQuality"],f),b}(G)),void 0!==fc(b,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return d}(a,f,c)),c}function gv(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["content"]);null!=c&&fb(b,["content"],c);let d=fc(a,["citationMetadata"]);null!=d&&fb(b,["citationMetadata"],function(a){let b={},c=fc(a,["citationSources"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["citations"],a)}return b}(d));let e=fc(a,["tokenCount"]);null!=e&&fb(b,["tokenCount"],e);let f=fc(a,["finishReason"]);null!=f&&fb(b,["finishReason"],f);let g=fc(a,["avgLogprobs"]);null!=g&&fb(b,["avgLogprobs"],g);let h=fc(a,["groundingMetadata"]);null!=h&&fb(b,["groundingMetadata"],h);let i=fc(a,["index"]);null!=i&&fb(b,["index"],i);let j=fc(a,["logprobsResult"]);null!=j&&fb(b,["logprobsResult"],j);let k=fc(a,["safetyRatings"]);if(null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["safetyRatings"],a)}let l=fc(a,["urlContextMetadata"]);return null!=l&&fb(b,["urlContextMetadata"],l),b})(a))),fb(b,["candidates"],a)}let e=fc(a,["modelVersion"]);null!=e&&fb(b,["modelVersion"],e);let f=fc(a,["promptFeedback"]);null!=f&&fb(b,["promptFeedback"],f);let g=fc(a,["responseId"]);null!=g&&fb(b,["responseId"],g);let h=fc(a,["usageMetadata"]);return null!=h&&fb(b,["usageMetadata"],h),b}function gw(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["candidates"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["candidates"],a)}let e=fc(a,["createTime"]);null!=e&&fb(b,["createTime"],e);let f=fc(a,["modelVersion"]);null!=f&&fb(b,["modelVersion"],f);let g=fc(a,["promptFeedback"]);null!=g&&fb(b,["promptFeedback"],g);let h=fc(a,["responseId"]);null!=h&&fb(b,["responseId"],h);let i=fc(a,["usageMetadata"]);return null!=i&&fb(b,["usageMetadata"],i),b}function gx(a){let b={},c=fc(a,["_self"]);null!=c&&fb(b,["image"],gy(c));let d=fc(a,["raiFilteredReason"]);null!=d&&fb(b,["raiFilteredReason"],d);let e=fc(a,["_self"]);null!=e&&fb(b,["safetyAttributes"],gE(e));let f=fc(a,["prompt"]);return null!=f&&fb(b,["enhancedPrompt"],f),b}function gy(a){let b={},c=fc(a,["gcsUri"]);null!=c&&fb(b,["gcsUri"],c);let d=fc(a,["bytesBase64Encoded"]);null!=d&&fb(b,["imageBytes"],fd(d));let e=fc(a,["mimeType"]);return null!=e&&fb(b,["mimeType"],e),b}function gz(a){let b={};if(void 0!==fc(a,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");let c=fc(a,["imageBytes"]);null!=c&&fb(b,["bytesBase64Encoded"],fd(c));let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}function gA(a){let b={},c=fc(a,["gcsUri"]);null!=c&&fb(b,["gcsUri"],c);let d=fc(a,["imageBytes"]);null!=d&&fb(b,["bytesBase64Encoded"],fd(d));let e=fc(a,["mimeType"]);return null!=e&&fb(b,["mimeType"],e),b}function gB(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["name"],c);let d=fc(a,["displayName"]);null!=d&&fb(b,["displayName"],d);let e=fc(a,["description"]);null!=e&&fb(b,["description"],e);let f=fc(a,["version"]);null!=f&&fb(b,["version"],f);let g=fc(a,["_self"]);null!=g&&fb(b,["tunedModelInfo"],function(a){let b={},c=fc(a,["baseModel"]);null!=c&&fb(b,["baseModel"],c);let d=fc(a,["createTime"]);null!=d&&fb(b,["createTime"],d);let e=fc(a,["updateTime"]);return null!=e&&fb(b,["updateTime"],e),b}(g));let h=fc(a,["inputTokenLimit"]);null!=h&&fb(b,["inputTokenLimit"],h);let i=fc(a,["outputTokenLimit"]);null!=i&&fb(b,["outputTokenLimit"],i);let j=fc(a,["supportedGenerationMethods"]);null!=j&&fb(b,["supportedActions"],j);let k=fc(a,["temperature"]);null!=k&&fb(b,["temperature"],k);let l=fc(a,["maxTemperature"]);null!=l&&fb(b,["maxTemperature"],l);let m=fc(a,["topP"]);null!=m&&fb(b,["topP"],m);let o=fc(a,["topK"]);null!=o&&fb(b,["topK"],o);let p=fc(a,["thinking"]);return null!=p&&fb(b,["thinking"],p),b}function gC(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["name"],c);let d=fc(a,["displayName"]);null!=d&&fb(b,["displayName"],d);let e=fc(a,["description"]);null!=e&&fb(b,["description"],e);let f=fc(a,["versionId"]);null!=f&&fb(b,["version"],f);let g=fc(a,["deployedModels"]);if(null!=g){let a=g;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["endpoint"]);null!=c&&fb(b,["name"],c);let d=fc(a,["deployedModelId"]);return null!=d&&fb(b,["deployedModelId"],d),b})(a))),fb(b,["endpoints"],a)}let h=fc(a,["labels"]);null!=h&&fb(b,["labels"],h);let i=fc(a,["_self"]);null!=i&&fb(b,["tunedModelInfo"],function(a){let b={},c=fc(a,["labels","google-vertex-llm-tuning-base-model-id"]);null!=c&&fb(b,["baseModel"],c);let d=fc(a,["createTime"]);null!=d&&fb(b,["createTime"],d);let e=fc(a,["updateTime"]);return null!=e&&fb(b,["updateTime"],e),b}(i));let j=fc(a,["defaultCheckpointId"]);null!=j&&fb(b,["defaultCheckpointId"],j);let k=fc(a,["checkpoints"]);if(null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["checkpoints"],a)}return b}function gD(a){let b={},c=fc(a,["safetyAttributes","categories"]);null!=c&&fb(b,["categories"],c);let d=fc(a,["safetyAttributes","scores"]);null!=d&&fb(b,["scores"],d);let e=fc(a,["contentType"]);return null!=e&&fb(b,["contentType"],e),b}function gE(a){let b={},c=fc(a,["safetyAttributes","categories"]);null!=c&&fb(b,["categories"],c);let d=fc(a,["safetyAttributes","scores"]);null!=d&&fb(b,["scores"],d);let e=fc(a,["contentType"]);return null!=e&&fb(b,["contentType"],e),b}function gF(a){let b={},c=fc(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==fc(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=fc(a,["description"]);null!=c&&fb(b,["description"],c);let d=fc(a,["name"]);null!=d&&fb(b,["name"],d);let e=fc(a,["parameters"]);null!=e&&fb(b,["parameters"],e);let f=fc(a,["parametersJsonSchema"]);null!=f&&fb(b,["parametersJsonSchema"],f);let g=fc(a,["response"]);null!=g&&fb(b,["response"],g);let h=fc(a,["responseJsonSchema"]);return null!=h&&fb(b,["responseJsonSchema"],h),b})(a))),fb(b,["functionDeclarations"],a)}let d=fc(a,["retrieval"]);null!=d&&fb(b,["retrieval"],d);let e=fc(a,["googleSearchRetrieval"]);null!=e&&fb(b,["googleSearchRetrieval"],e);let f=fc(a,["computerUse"]);if(null!=f&&fb(b,["computerUse"],f),void 0!==fc(a,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let g=fc(a,["codeExecution"]);null!=g&&fb(b,["codeExecution"],g);let h=fc(a,["enterpriseWebSearch"]);null!=h&&fb(b,["enterpriseWebSearch"],h);let i=fc(a,["googleMaps"]);null!=i&&fb(b,["googleMaps"],i);let j=fc(a,["googleSearch"]);null!=j&&fb(b,["googleSearch"],j);let k=fc(a,["urlContext"]);return null!=k&&fb(b,["urlContext"],k),b}function gG(a){let b={},c=fc(a,["uri"]);null!=c&&fb(b,["uri"],c);let d=fc(a,["videoBytes"]);null!=d&&fb(b,["encodedVideo"],fd(d));let e=fc(a,["mimeType"]);return null!=e&&fb(b,["encoding"],e),b}function gH(a){let b={},c=fc(a,["uri"]);null!=c&&fb(b,["gcsUri"],c);let d=fc(a,["videoBytes"]);null!=d&&fb(b,["bytesBase64Encoded"],fd(d));let e=fc(a,["mimeType"]);return null!=e&&fb(b,["mimeType"],e),b}function gI(a,b){let c=fc(a,["mimeType"]);void 0!==b&&null!=c&&fb(b,["mimeType"],c);let d=fc(a,["displayName"]);void 0!==b&&null!=d&&fb(b,["displayName"],d);let e=fc(a,["customMetadata"]);if(void 0!==b&&null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["customMetadata"],a)}let f=fc(a,["chunkingConfig"]);return void 0!==b&&null!=f&&fb(b,["chunkingConfig"],f),{}}let gJ="x-goog-api-client";class gK{constructor(a){var b,c;this.clientOptions=Object.assign(Object.assign({},a),{project:a.project,location:a.location,apiKey:a.apiKey,vertexai:a.vertexai});let d={};this.clientOptions.vertexai?(d.apiVersion=null!=(b=this.clientOptions.apiVersion)?b:"v1beta1",d.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(d.apiVersion=null!=(c=this.clientOptions.apiVersion)?c:"v1beta",d.baseUrl="https://generativelanguage.googleapis.com/"),d.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=d,a.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(d,a.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&"global"!==this.clientOptions.location?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var a;return null!=(a=this.clientOptions.vertexai)&&a}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){let a=new Headers;return await this.clientOptions.auth.addAuthHeaders(a),a}getApiVersion(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.apiVersion)return this.clientOptions.httpOptions.apiVersion;throw Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.baseUrl)return this.clientOptions.httpOptions.baseUrl;throw Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&void 0!==this.clientOptions.httpOptions.headers)return this.clientOptions.httpOptions.headers;throw Error("Headers are not set.")}getRequestUrlInternal(a){if(!a||void 0===a.baseUrl||void 0===a.apiVersion)throw Error("HTTP options are not correctly set.");let b=[a.baseUrl.endsWith("/")?a.baseUrl.slice(0,-1):a.baseUrl];return a.apiVersion&&""!==a.apiVersion&&b.push(a.apiVersion),b.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){let a=new URL(this.getBaseUrl());return a.protocol="http:"==a.protocol?"ws":"wss",a.toString()}setBaseUrl(a){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=a;else throw Error("HTTP options are not correctly set.")}constructUrl(a,b,c){let d=[this.getRequestUrlInternal(b)];return c&&d.push(this.getBaseResourcePath()),""!==a&&d.push(a),new URL(`${d.join("/")}`)}shouldPrependVertexProjectPath(a){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||a.path.startsWith("projects/")||"GET"===a.httpMethod&&a.path.startsWith("publishers/google/models"))}async request(a){let b=this.clientOptions.httpOptions;a.httpOptions&&(b=this.patchHttpOptions(this.clientOptions.httpOptions,a.httpOptions));let c=this.shouldPrependVertexProjectPath(a),d=this.constructUrl(a.path,b,c);if(a.queryParams)for(let[b,c]of Object.entries(a.queryParams))d.searchParams.append(b,String(c));let e={};if("GET"===a.httpMethod){if(a.body&&"{}"!==a.body)throw Error("Request body should be empty for GET request, but got non empty request body")}else e.body=a.body;return e=await this.includeExtraHttpOptionsToRequestInit(e,b,d.toString(),a.abortSignal),this.unaryApiCall(d,e,a.httpMethod)}patchHttpOptions(a,b){let c=JSON.parse(JSON.stringify(a));for(let[a,d]of Object.entries(b))"object"==typeof d?c[a]=Object.assign(Object.assign({},c[a]),d):void 0!==d&&(c[a]=d);return c}async requestStream(a){let b=this.clientOptions.httpOptions;a.httpOptions&&(b=this.patchHttpOptions(this.clientOptions.httpOptions,a.httpOptions));let c=this.shouldPrependVertexProjectPath(a),d=this.constructUrl(a.path,b,c);d.searchParams.has("alt")&&"sse"===d.searchParams.get("alt")||d.searchParams.set("alt","sse");let e={};return e.body=a.body,e=await this.includeExtraHttpOptionsToRequestInit(e,b,d.toString(),a.abortSignal),this.streamApiCall(d,e,a.httpMethod)}async includeExtraHttpOptionsToRequestInit(a,b,c,d){if(b&&b.timeout||d){let c=new AbortController,e=c.signal;if(b.timeout&&(null==b?void 0:b.timeout)>0){let a=setTimeout(()=>c.abort(),b.timeout);a&&"function"==typeof a.unref&&a.unref()}d&&d.addEventListener("abort",()=>{c.abort()}),a.signal=e}return b&&null!==b.extraBody&&function(a,b){if(!b||0===Object.keys(b).length)return;if(a.body instanceof Blob)return console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");let c={};if("string"==typeof a.body&&a.body.length>0)try{let b=JSON.parse(a.body);if("object"!=typeof b||null===b||Array.isArray(b))return void console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");c=b}catch(a){console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}a.body=JSON.stringify(function a(b,c){let d=Object.assign({},b);for(let b in c)if(Object.prototype.hasOwnProperty.call(c,b)){let e=c[b],f=d[b];e&&"object"==typeof e&&!Array.isArray(e)&&f&&"object"==typeof f&&!Array.isArray(f)?d[b]=a(f,e):(f&&e&&typeof f!=typeof e&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${b}". Original type: ${typeof f}, New type: ${typeof e}. Overwriting.`),d[b]=e)}return d}(c,b))}(a,b.extraBody),a.headers=await this.getHeadersInternal(b,c),a}async unaryApiCall(a,b,c){return this.apiCall(a.toString(),Object.assign(Object.assign({},b),{method:c})).then(async a=>(await gL(a),new ff(a))).catch(a=>{if(a instanceof Error)throw a;throw Error(JSON.stringify(a))})}async streamApiCall(a,b,c){return this.apiCall(a.toString(),Object.assign(Object.assign({},b),{method:c})).then(async a=>(await gL(a),this.processStreamResponse(a))).catch(a=>{if(a instanceof Error)throw a;throw Error(JSON.stringify(a))})}processStreamResponse(a){return gj(this,arguments,function*(){var b;let c=null==(b=null==a?void 0:a.body)?void 0:b.getReader(),d=new TextDecoder("utf-8");if(!c)throw Error("Response body is empty");try{let b="",e="data:",f=["\n\n","\r\r","\r\n\r\n"];for(;;){let{done:g,value:h}=yield gi(c.read());if(g){if(b.trim().length>0)throw Error("Incomplete JSON segment at the end");break}let i=d.decode(h,{stream:!0});try{let a=JSON.parse(i);if("error"in a){let b=JSON.parse(JSON.stringify(a.error)),c=b.status,d=b.code,e=`got status: ${c}. ${JSON.stringify(a)}`;if(d>=400&&d<600)throw new gp({message:e,status:d})}}catch(a){if("ApiError"===a.name)throw a}b+=i;let j=-1,k=0;for(;;){for(let a of(j=-1,k=0,f)){let c=b.indexOf(a);-1!==c&&(-1===j||c<j)&&(j=c,k=a.length)}if(-1===j)break;let c=b.substring(0,j);b=b.substring(j+k);let d=c.trim();if(d.startsWith(e)){let b=d.substring(e.length).trim();try{let c=new Response(b,{headers:null==a?void 0:a.headers,status:null==a?void 0:a.status,statusText:null==a?void 0:a.statusText});yield yield gi(new ff(c))}catch(a){throw Error(`exception parsing stream chunk ${b}. ${a}`)}}}}}finally{c.releaseLock()}})}async apiCall(a,b){return fetch(a,b).catch(a=>{throw Error(`exception ${a} sending request`)})}getDefaultHeaders(){let a={},b="google-genai-sdk/1.34.0 "+this.clientOptions.userAgentExtra;return a["User-Agent"]=b,a[gJ]=b,a["Content-Type"]="application/json",a}async getHeadersInternal(a,b){let c=new Headers;if(a&&a.headers){for(let[b,d]of Object.entries(a.headers))c.append(b,d);a.timeout&&a.timeout>0&&c.append("X-Server-Timeout",String(Math.ceil(a.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(c,b),c}getFileName(a){var b;let c="";return"string"==typeof a&&(c=null!=(b=(c=a.replace(/[/\\]+$/,"")).split(/[/\\]/).pop())?b:""),c}async uploadFile(a,b){var c;let d={};null!=b&&(d.mimeType=b.mimeType,d.name=b.name,d.displayName=b.displayName),d.name&&!d.name.startsWith("files/")&&(d.name=`files/${d.name}`);let e=this.clientOptions.uploader,f=await e.stat(a);d.sizeBytes=String(f.size);let g=null!=(c=null==b?void 0:b.mimeType)?c:f.type;if(void 0===g||""===g)throw Error("Can not determine mimeType. Please provide mimeType in the config.");d.mimeType=g;let h={file:d},i=this.getFileName(a),j=fa("upload/v1beta/files",h._url),k=await this.fetchUploadUrl(j,d.sizeBytes,d.mimeType,i,h,null==b?void 0:b.httpOptions);return e.upload(a,k,this)}async uploadFileToFileSearchStore(a,b,c){var d;let e=this.clientOptions.uploader,f=await e.stat(b),g=String(f.size),h=null!=(d=null==c?void 0:c.mimeType)?d:f.type;if(void 0===h||""===h)throw Error("Can not determine mimeType. Please provide mimeType in the config.");let i=`upload/v1beta/${a}:uploadToFileSearchStore`,j=this.getFileName(b),k={};null!=c&&gI(c,k);let l=await this.fetchUploadUrl(i,g,h,j,k,null==c?void 0:c.httpOptions);return e.uploadToFileSearchStore(b,l,this)}async downloadFile(a){let b=this.clientOptions.downloader;await b.download(a,this)}async fetchUploadUrl(a,b,c,d,e,f){var g;let h={};h=f||{apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${b}`,"X-Goog-Upload-Header-Content-Type":`${c}`},d?{"X-Goog-Upload-File-Name":d}:{})};let i=await this.request({path:a,body:JSON.stringify(e),httpMethod:"POST",httpOptions:h});if(!i||!(null==i?void 0:i.headers))throw Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");let j=null==(g=null==i?void 0:i.headers)?void 0:g["x-goog-upload-url"];if(void 0===j)throw Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return j}}async function gL(a){var b;if(void 0===a)throw Error("response is undefined");if(!a.ok){let c=a.status,d=JSON.stringify((null==(b=a.headers.get("content-type"))?void 0:b.includes("application/json"))?await a.json():{error:{message:await a.text(),code:a.status,status:a.statusText}});if(c>=400&&c<600)throw new gp({message:d,status:c});throw Error(d)}}function gM(a){for(let c of a){var b;if(null!==(b=c)&&"object"==typeof b&&b instanceof gO||"object"==typeof c&&"inputSchema"in c)return!0}return!1}function gN(a){var b;let c=null!=(b=a[gJ])?b:"";a[gJ]=(c+" mcp_used/unknown").trimStart()}class gO{constructor(a=[],b){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=a,this.config=b}static create(a,b){return new gO(a,b)}async initialize(){var a,b,c,d;if(this.mcpTools.length>0)return;let e={},f=[];for(let j of this.mcpClients)try{for(var g,h=!0,i=(b=void 0,gk(function(a){return gj(this,arguments,function*(a,b=100){let c,d=0;for(;d<b;){let b=yield gi(a.listTools({cursor:c}));for(let a of b.tools)yield yield gi(a),d++;if(!b.nextCursor)break;c=b.nextCursor}})}(j)));!(a=(g=await i.next()).done);h=!0){d=g.value,h=!1,f.push(d);let a=d.name;if(e[a])throw Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);e[a]=j}}catch(a){b={error:a}}finally{try{!h&&!a&&(c=i.return)&&await c.call(i)}finally{if(b)throw b.error}}this.mcpTools=f,this.functionNameToMcpClient=e}async tool(){return await this.initialize(),function(a,b={}){let c=[],d=new Set;for(let e of a){let a=e.name;if(d.has(a))throw Error(`Duplicate function name ${a} found in MCP tools. Please ensure function names are unique.`);d.add(a);let f=function(a,b={}){let c={name:a.name,description:a.description,parametersJsonSchema:a.inputSchema};return a.outputSchema&&(c.responseJsonSchema=a.outputSchema),b.behavior&&(c.behavior=b.behavior),{functionDeclarations:[c]}}(e,b);f.functionDeclarations&&c.push(...f.functionDeclarations)}return{functionDeclarations:c}}(this.mcpTools,this.config)}async callTool(a){await this.initialize();let b=[];for(let c of a)if(c.name in this.functionNameToMcpClient){let a,d=this.functionNameToMcpClient[c.name];this.config.timeout&&(a={timeout:this.config.timeout});let e=await d.callTool({name:c.name,arguments:c.args},void 0,a);b.push({functionResponse:{name:c.name,response:e.isError?{error:e}:e}})}return b}}async function gP(a,b,c){let d=new fF;Object.assign(d,c.data instanceof Blob?JSON.parse(await c.data.text()):JSON.parse(c.data)),b(d)}class gQ{constructor(a,b,c){this.apiClient=a,this.auth=b,this.webSocketFactory=c}async connect(a){var b,c;if(this.apiClient.isVertexAI())throw Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");let d=this.apiClient.getWebsocketBaseUrl(),e=this.apiClient.getApiVersion(),f=function(a){let b=new Headers;for(let[c,d]of Object.entries(a))b.append(c,d);return b}(this.apiClient.getDefaultHeaders()),g=this.apiClient.getApiKey(),h=`${d}/ws/google.ai.generativelanguage.${e}.GenerativeService.BidiGenerateMusic?key=${g}`,i=()=>{},j=new Promise(a=>{i=a}),k=a.callbacks,l=this.apiClient,m={onopen:function(){i({})},onmessage:a=>{gP(l,k.onmessage,a)},onerror:null!=(b=null==k?void 0:k.onerror)?b:function(a){},onclose:null!=(c=null==k?void 0:k.onclose)?c:function(a){}},o=this.webSocketFactory.create(h,function(a){let b={};return a.forEach((a,c)=>{b[c]=a}),b}(f),m);o.connect(),await j;let p=fH(this.apiClient,a.model);return o.send(JSON.stringify({setup:{model:p}})),new gR(o,this.apiClient)}}class gR{constructor(a,b){this.conn=a,this.apiClient=b}async setWeightedPrompts(a){if(!a.weightedPrompts||0===Object.keys(a.weightedPrompts).length)throw Error("Weighted prompts must be set and contain at least one entry.");let b=function(a){let b={},c=fc(a,["weightedPrompts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["weightedPrompts"],a)}return b}(a);this.conn.send(JSON.stringify({clientContent:b}))}async setMusicGenerationConfig(a){a.musicGenerationConfig||(a.musicGenerationConfig={});let b=function(a){let b={},c=fc(a,["musicGenerationConfig"]);return null!=c&&fb(b,["musicGenerationConfig"],c),b}(a);this.conn.send(JSON.stringify(b))}sendPlaybackControl(a){this.conn.send(JSON.stringify({playbackControl:a}))}play(){this.sendPlaybackControl(aC.PLAY)}pause(){this.sendPlaybackControl(aC.PAUSE)}stop(){this.sendPlaybackControl(aC.STOP)}resetContext(){this.sendPlaybackControl(aC.RESET_CONTEXT)}close(){this.conn.close()}}async function gS(a,b,c){let d=new fE,e=JSON.parse(c.data instanceof Blob?await c.data.text():c.data instanceof ArrayBuffer?new TextDecoder().decode(c.data):c.data);a.isVertexAI()?Object.assign(d,function(a){let b={},c=fc(a,["setupComplete"]);null!=c&&fb(b,["setupComplete"],c);let d=fc(a,["serverContent"]);null!=d&&fb(b,["serverContent"],d);let e=fc(a,["toolCall"]);null!=e&&fb(b,["toolCall"],e);let f=fc(a,["toolCallCancellation"]);null!=f&&fb(b,["toolCallCancellation"],f);let g=fc(a,["usageMetadata"]);null!=g&&fb(b,["usageMetadata"],function(a){let b={},c=fc(a,["promptTokenCount"]);null!=c&&fb(b,["promptTokenCount"],c);let d=fc(a,["cachedContentTokenCount"]);null!=d&&fb(b,["cachedContentTokenCount"],d);let e=fc(a,["candidatesTokenCount"]);null!=e&&fb(b,["responseTokenCount"],e);let f=fc(a,["toolUsePromptTokenCount"]);null!=f&&fb(b,["toolUsePromptTokenCount"],f);let g=fc(a,["thoughtsTokenCount"]);null!=g&&fb(b,["thoughtsTokenCount"],g);let h=fc(a,["totalTokenCount"]);null!=h&&fb(b,["totalTokenCount"],h);let i=fc(a,["promptTokensDetails"]);if(null!=i){let a=i;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["promptTokensDetails"],a)}let j=fc(a,["cacheTokensDetails"]);if(null!=j){let a=j;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["cacheTokensDetails"],a)}let k=fc(a,["candidatesTokensDetails"]);if(null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["responseTokensDetails"],a)}let l=fc(a,["toolUsePromptTokensDetails"]);if(null!=l){let a=l;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["toolUsePromptTokensDetails"],a)}let m=fc(a,["trafficType"]);return null!=m&&fb(b,["trafficType"],m),b}(g));let h=fc(a,["goAway"]);null!=h&&fb(b,["goAway"],h);let i=fc(a,["sessionResumptionUpdate"]);null!=i&&fb(b,["sessionResumptionUpdate"],i);let j=fc(a,["voiceActivityDetectionSignal"]);return null!=j&&fb(b,["voiceActivityDetectionSignal"],j),b}(e)):Object.assign(d,e),b(d)}class gT{constructor(a,b,c){this.apiClient=a,this.auth=b,this.webSocketFactory=c,this.music=new gQ(this.apiClient,this.auth,this.webSocketFactory)}async connect(a){var b,c,d,e,f,g;let h;if(a.config&&a.config.httpOptions)throw Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");let i=this.apiClient.getWebsocketBaseUrl(),j=this.apiClient.getApiVersion(),k=this.apiClient.getHeaders();a.config&&a.config.tools&&gM(a.config.tools)&&gN(k);let l=function(a){let b=new Headers;for(let[c,d]of Object.entries(a))b.append(c,d);return b}(k);if(this.apiClient.isVertexAI())h=`${i}/ws/google.cloud.aiplatform.${j}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(l,h);else{let a=this.apiClient.getApiKey(),b="BidiGenerateContent",c="key";(null==a?void 0:a.startsWith("auth_tokens/"))&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),"v1alpha"!==j&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),b="BidiGenerateContentConstrained",c="access_token"),h=`${i}/ws/google.ai.generativelanguage.${j}.GenerativeService.${b}?${c}=${a}`}let m=()=>{},o=new Promise(a=>{m=a}),p=a.callbacks,q=this.apiClient,r={onopen:function(){var a;null==(a=null==p?void 0:p.onopen)||a.call(p),m({})},onmessage:a=>{gS(q,p.onmessage,a)},onerror:null!=(b=null==p?void 0:p.onerror)?b:function(a){},onclose:null!=(c=null==p?void 0:p.onclose)?c:function(a){}},s=this.webSocketFactory.create(h,function(a){let b={};return a.forEach((a,c)=>{b[c]=a}),b}(l),r);s.connect(),await o;let t=fH(this.apiClient,a.model);if(this.apiClient.isVertexAI()&&t.startsWith("publishers/")){let a=this.apiClient.getProject(),b=this.apiClient.getLocation();t=`projects/${a}/locations/${b}/`+t}let u={};this.apiClient.isVertexAI()&&(null==(d=a.config)?void 0:d.responseModalities)===void 0&&(void 0===a.config?a.config={responseModalities:[U.AUDIO]}:a.config.responseModalities=[U.AUDIO]),(null==(e=a.config)?void 0:e.generationConfig)&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");let v=null!=(g=null==(f=a.config)?void 0:f.tools)?g:[],w=[];for(let a of v)this.isCallableTool(a)?w.push(await a.tool()):w.push(a);w.length>0&&(a.config.tools=w);let x={model:t,config:a.config,callbacks:a.callbacks};return u=this.apiClient.isVertexAI()?function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["setup","model"],fH(a,d));let e=fc(b,["config"]);return null!=e&&fb(c,["config"],function(a,b){let c=fc(a,["generationConfig"]);void 0!==b&&null!=c&&fb(b,["setup","generationConfig"],function(a){let b={},c=fc(a,["modelSelectionConfig"]);null!=c&&fb(b,["modelConfig"],c);let d=fc(a,["responseJsonSchema"]);null!=d&&fb(b,["responseJsonSchema"],d);let e=fc(a,["audioTimestamp"]);null!=e&&fb(b,["audioTimestamp"],e);let f=fc(a,["candidateCount"]);null!=f&&fb(b,["candidateCount"],f);let g=fc(a,["enableAffectiveDialog"]);null!=g&&fb(b,["enableAffectiveDialog"],g);let h=fc(a,["frequencyPenalty"]);null!=h&&fb(b,["frequencyPenalty"],h);let i=fc(a,["logprobs"]);null!=i&&fb(b,["logprobs"],i);let j=fc(a,["maxOutputTokens"]);null!=j&&fb(b,["maxOutputTokens"],j);let k=fc(a,["mediaResolution"]);null!=k&&fb(b,["mediaResolution"],k);let l=fc(a,["presencePenalty"]);null!=l&&fb(b,["presencePenalty"],l);let m=fc(a,["responseLogprobs"]);null!=m&&fb(b,["responseLogprobs"],m);let o=fc(a,["responseMimeType"]);null!=o&&fb(b,["responseMimeType"],o);let p=fc(a,["responseModalities"]);null!=p&&fb(b,["responseModalities"],p);let q=fc(a,["responseSchema"]);null!=q&&fb(b,["responseSchema"],q);let r=fc(a,["routingConfig"]);null!=r&&fb(b,["routingConfig"],r);let s=fc(a,["seed"]);null!=s&&fb(b,["seed"],s);let t=fc(a,["speechConfig"]);null!=t&&fb(b,["speechConfig"],t);let u=fc(a,["stopSequences"]);null!=u&&fb(b,["stopSequences"],u);let v=fc(a,["temperature"]);null!=v&&fb(b,["temperature"],v);let w=fc(a,["thinkingConfig"]);null!=w&&fb(b,["thinkingConfig"],w);let x=fc(a,["topK"]);null!=x&&fb(b,["topK"],x);let y=fc(a,["topP"]);if(null!=y&&fb(b,["topP"],y),void 0!==fc(a,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return b}(c));let d=fc(a,["responseModalities"]);void 0!==b&&null!=d&&fb(b,["setup","generationConfig","responseModalities"],d);let e=fc(a,["temperature"]);void 0!==b&&null!=e&&fb(b,["setup","generationConfig","temperature"],e);let f=fc(a,["topP"]);void 0!==b&&null!=f&&fb(b,["setup","generationConfig","topP"],f);let g=fc(a,["topK"]);void 0!==b&&null!=g&&fb(b,["setup","generationConfig","topK"],g);let h=fc(a,["maxOutputTokens"]);void 0!==b&&null!=h&&fb(b,["setup","generationConfig","maxOutputTokens"],h);let i=fc(a,["mediaResolution"]);void 0!==b&&null!=i&&fb(b,["setup","generationConfig","mediaResolution"],i);let j=fc(a,["seed"]);void 0!==b&&null!=j&&fb(b,["setup","generationConfig","seed"],j);let k=fc(a,["speechConfig"]);void 0!==b&&null!=k&&fb(b,["setup","generationConfig","speechConfig"],fX(k));let l=fc(a,["thinkingConfig"]);void 0!==b&&null!=l&&fb(b,["setup","generationConfig","thinkingConfig"],l);let m=fc(a,["enableAffectiveDialog"]);void 0!==b&&null!=m&&fb(b,["setup","generationConfig","enableAffectiveDialog"],m);let o=fc(a,["systemInstruction"]);void 0!==b&&null!=o&&fb(b,["setup","systemInstruction"],fS(o));let p=fc(a,["tools"]);if(void 0!==b&&null!=p){let a=fZ(p);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={};if(void 0!==fc(a,["behavior"]))throw Error("behavior parameter is not supported in Vertex AI.");let c=fc(a,["description"]);null!=c&&fb(b,["description"],c);let d=fc(a,["name"]);null!=d&&fb(b,["name"],d);let e=fc(a,["parameters"]);null!=e&&fb(b,["parameters"],e);let f=fc(a,["parametersJsonSchema"]);null!=f&&fb(b,["parametersJsonSchema"],f);let g=fc(a,["response"]);null!=g&&fb(b,["response"],g);let h=fc(a,["responseJsonSchema"]);return null!=h&&fb(b,["responseJsonSchema"],h),b})(a))),fb(b,["functionDeclarations"],a)}let d=fc(a,["retrieval"]);null!=d&&fb(b,["retrieval"],d);let e=fc(a,["googleSearchRetrieval"]);null!=e&&fb(b,["googleSearchRetrieval"],e);let f=fc(a,["computerUse"]);if(null!=f&&fb(b,["computerUse"],f),void 0!==fc(a,["fileSearch"]))throw Error("fileSearch parameter is not supported in Vertex AI.");let g=fc(a,["codeExecution"]);null!=g&&fb(b,["codeExecution"],g);let h=fc(a,["enterpriseWebSearch"]);null!=h&&fb(b,["enterpriseWebSearch"],h);let i=fc(a,["googleMaps"]);null!=i&&fb(b,["googleMaps"],i);let j=fc(a,["googleSearch"]);null!=j&&fb(b,["googleSearch"],j);let k=fc(a,["urlContext"]);return null!=k&&fb(b,["urlContext"],k),b})(fY(a)))),fb(b,["setup","tools"],a)}let q=fc(a,["sessionResumption"]);void 0!==b&&null!=q&&fb(b,["setup","sessionResumption"],q);let r=fc(a,["inputAudioTranscription"]);void 0!==b&&null!=r&&fb(b,["setup","inputAudioTranscription"],r);let s=fc(a,["outputAudioTranscription"]);void 0!==b&&null!=s&&fb(b,["setup","outputAudioTranscription"],s);let t=fc(a,["realtimeInputConfig"]);void 0!==b&&null!=t&&fb(b,["setup","realtimeInputConfig"],t);let u=fc(a,["contextWindowCompression"]);void 0!==b&&null!=u&&fb(b,["setup","contextWindowCompression"],u);let v=fc(a,["proactivity"]);void 0!==b&&null!=v&&fb(b,["setup","proactivity"],v);let w=fc(a,["explicitVadSignal"]);return void 0!==b&&null!=w&&fb(b,["setup","explicitVadSignal"],w),{}}(e,c)),c}(this.apiClient,x):function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["setup","model"],fH(a,d));let e=fc(b,["config"]);return null!=e&&fb(c,["config"],function(a,b){let c=fc(a,["generationConfig"]);void 0!==b&&null!=c&&fb(b,["setup","generationConfig"],c);let d=fc(a,["responseModalities"]);void 0!==b&&null!=d&&fb(b,["setup","generationConfig","responseModalities"],d);let e=fc(a,["temperature"]);void 0!==b&&null!=e&&fb(b,["setup","generationConfig","temperature"],e);let f=fc(a,["topP"]);void 0!==b&&null!=f&&fb(b,["setup","generationConfig","topP"],f);let g=fc(a,["topK"]);void 0!==b&&null!=g&&fb(b,["setup","generationConfig","topK"],g);let h=fc(a,["maxOutputTokens"]);void 0!==b&&null!=h&&fb(b,["setup","generationConfig","maxOutputTokens"],h);let i=fc(a,["mediaResolution"]);void 0!==b&&null!=i&&fb(b,["setup","generationConfig","mediaResolution"],i);let j=fc(a,["seed"]);void 0!==b&&null!=j&&fb(b,["setup","generationConfig","seed"],j);let k=fc(a,["speechConfig"]);void 0!==b&&null!=k&&fb(b,["setup","generationConfig","speechConfig"],fX(k));let l=fc(a,["thinkingConfig"]);void 0!==b&&null!=l&&fb(b,["setup","generationConfig","thinkingConfig"],l);let m=fc(a,["enableAffectiveDialog"]);void 0!==b&&null!=m&&fb(b,["setup","generationConfig","enableAffectiveDialog"],m);let o=fc(a,["systemInstruction"]);void 0!==b&&null!=o&&fb(b,["setup","systemInstruction"],function(a){let b={},c=fc(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["mediaResolution"]);null!=c&&fb(b,["mediaResolution"],c);let d=fc(a,["codeExecutionResult"]);null!=d&&fb(b,["codeExecutionResult"],d);let e=fc(a,["executableCode"]);null!=e&&fb(b,["executableCode"],e);let f=fc(a,["fileData"]);null!=f&&fb(b,["fileData"],function(a){let b={};if(void 0!==fc(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=fc(a,["fileUri"]);null!=c&&fb(b,["fileUri"],c);let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}(f));let g=fc(a,["functionCall"]);null!=g&&fb(b,["functionCall"],function(a){let b={},c=fc(a,["id"]);null!=c&&fb(b,["id"],c);let d=fc(a,["args"]);null!=d&&fb(b,["args"],d);let e=fc(a,["name"]);if(null!=e&&fb(b,["name"],e),void 0!==fc(a,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==fc(a,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return b}(g));let h=fc(a,["functionResponse"]);null!=h&&fb(b,["functionResponse"],h);let i=fc(a,["inlineData"]);null!=i&&fb(b,["inlineData"],gr(i));let j=fc(a,["text"]);null!=j&&fb(b,["text"],j);let k=fc(a,["thought"]);null!=k&&fb(b,["thought"],k);let l=fc(a,["thoughtSignature"]);null!=l&&fb(b,["thoughtSignature"],l);let m=fc(a,["videoMetadata"]);return null!=m&&fb(b,["videoMetadata"],m),b})(a))),fb(b,["parts"],a)}let d=fc(a,["role"]);return null!=d&&fb(b,["role"],d),b}(fS(o)));let p=fc(a,["tools"]);if(void 0!==b&&null!=p){let a=fZ(p);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["functionDeclarations"],a)}if(void 0!==fc(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=fc(a,["googleSearchRetrieval"]);null!=d&&fb(b,["googleSearchRetrieval"],d);let e=fc(a,["computerUse"]);null!=e&&fb(b,["computerUse"],e);let f=fc(a,["fileSearch"]);null!=f&&fb(b,["fileSearch"],f);let g=fc(a,["codeExecution"]);if(null!=g&&fb(b,["codeExecution"],g),void 0!==fc(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let h=fc(a,["googleMaps"]);null!=h&&fb(b,["googleMaps"],function(a){let b={};if(void 0!==fc(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=fc(a,["enableWidget"]);return null!=c&&fb(b,["enableWidget"],c),b}(h));let i=fc(a,["googleSearch"]);null!=i&&fb(b,["googleSearch"],function(a){let b={};if(void 0!==fc(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==fc(a,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let c=fc(a,["timeRangeFilter"]);return null!=c&&fb(b,["timeRangeFilter"],c),b}(i));let j=fc(a,["urlContext"]);return null!=j&&fb(b,["urlContext"],j),b})(fY(a)))),fb(b,["setup","tools"],a)}let q=fc(a,["sessionResumption"]);void 0!==b&&null!=q&&fb(b,["setup","sessionResumption"],function(a){let b={},c=fc(a,["handle"]);if(null!=c&&fb(b,["handle"],c),void 0!==fc(a,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return b}(q));let r=fc(a,["inputAudioTranscription"]);void 0!==b&&null!=r&&fb(b,["setup","inputAudioTranscription"],r);let s=fc(a,["outputAudioTranscription"]);void 0!==b&&null!=s&&fb(b,["setup","outputAudioTranscription"],s);let t=fc(a,["realtimeInputConfig"]);void 0!==b&&null!=t&&fb(b,["setup","realtimeInputConfig"],t);let u=fc(a,["contextWindowCompression"]);void 0!==b&&null!=u&&fb(b,["setup","contextWindowCompression"],u);let v=fc(a,["proactivity"]);if(void 0!==b&&null!=v&&fb(b,["setup","proactivity"],v),void 0!==fc(a,["explicitVadSignal"]))throw Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}(e,c)),c}(this.apiClient,x),delete u.config,s.send(JSON.stringify(u)),new gV(s,this.apiClient)}isCallableTool(a){return"callTool"in a&&"function"==typeof a.callTool}}let gU={turnComplete:!0};class gV{constructor(a,b){this.conn=a,this.apiClient=b}tLiveClientContent(a,b){if(null!==b.turns&&void 0!==b.turns){let c=[];try{c=fU(b.turns),a.isVertexAI()||(c=c.map(a=>gs(a)))}catch(a){throw Error(`Failed to parse client content "turns", type: '${typeof b.turns}'`)}return{clientContent:{turns:c,turnComplete:b.turnComplete}}}return{clientContent:{turnComplete:b.turnComplete}}}tLiveClienttToolResponse(a,b){let c=[];if(null==b.functionResponses||0===(c=Array.isArray(b.functionResponses)?b.functionResponses:[b.functionResponses]).length)throw Error("functionResponses is required.");for(let b of c){if("object"!=typeof b||null===b||!("name"in b)||!("response"in b))throw Error(`Could not parse function response, type '${typeof b}'.`);if(!a.isVertexAI()&&!("id"in b))throw Error("FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.")}return{toolResponse:{functionResponses:c}}}sendClientContent(a){a=Object.assign(Object.assign({},gU),a);let b=this.tLiveClientContent(this.apiClient,a);this.conn.send(JSON.stringify(b))}sendRealtimeInput(a){let b={};b=this.apiClient.isVertexAI()?{realtimeInput:function(a){let b={},c=fc(a,["media"]);if(null!=c){let a=fJ(c);Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["mediaChunks"],a)}let d=fc(a,["audio"]);null!=d&&fb(b,["audio"],fM(d));let e=fc(a,["audioStreamEnd"]);null!=e&&fb(b,["audioStreamEnd"],e);let f=fc(a,["video"]);null!=f&&fb(b,["video"],fL(f));let g=fc(a,["text"]);null!=g&&fb(b,["text"],g);let h=fc(a,["activityStart"]);null!=h&&fb(b,["activityStart"],h);let i=fc(a,["activityEnd"]);return null!=i&&fb(b,["activityEnd"],i),b}(a)}:{realtimeInput:function(a){let b={},c=fc(a,["media"]);if(null!=c){let a=fJ(c);Array.isArray(a)&&(a=a.map(a=>gr(a))),fb(b,["mediaChunks"],a)}let d=fc(a,["audio"]);null!=d&&fb(b,["audio"],gr(fM(d)));let e=fc(a,["audioStreamEnd"]);null!=e&&fb(b,["audioStreamEnd"],e);let f=fc(a,["video"]);null!=f&&fb(b,["video"],gr(fL(f)));let g=fc(a,["text"]);null!=g&&fb(b,["text"],g);let h=fc(a,["activityStart"]);null!=h&&fb(b,["activityStart"],h);let i=fc(a,["activityEnd"]);return null!=i&&fb(b,["activityEnd"],i),b}(a)},this.conn.send(JSON.stringify(b))}sendToolResponse(a){if(null==a.functionResponses)throw Error("Tool response parameters are required.");let b=this.tLiveClienttToolResponse(this.apiClient,a);this.conn.send(JSON.stringify(b))}close(){this.conn.close()}}function gW(a){var b,c,d;if(null==(b=null==a?void 0:a.automaticFunctionCalling)?void 0:b.disable)return!0;let e=!1;for(let b of null!=(c=null==a?void 0:a.tools)?c:[])if(gX(b)){e=!0;break}if(!e)return!0;let f=null==(d=null==a?void 0:a.automaticFunctionCalling)?void 0:d.maximumRemoteCalls;return(!(!f||!(f<0)&&Number.isInteger(f))||0==f)&&(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",f),!0)}function gX(a){return"callTool"in a&&"function"==typeof a.callTool}function gY(a){var b;let c=[];return(null==(b=null==a?void 0:a.config)?void 0:b.tools)&&a.config.tools.forEach((a,b)=>{!gX(a)&&a.functionDeclarations&&a.functionDeclarations.length>0&&c.push(b)}),c}function gZ(a){var b;return!(null==(b=null==a?void 0:a.automaticFunctionCalling)?void 0:b.ignoreCallHistory)}class g$ extends e9{constructor(a){super(),this.apiClient=a,this.generateContent=async a=>{var b,c,d,e,f;let g,h,i=await this.processParamsMaybeAddMcpUsage(a);if(this.maybeMoveToResponseJsonSchem(a),!function(a){var b,c,d;return null!=(d=null==(c=null==(b=a.config)?void 0:b.tools)?void 0:c.some(a=>gX(a)))&&d}(a)||gW(a.config))return await this.generateContentInternal(i);let j=gY(a);if(j.length>0){let a=j.map(a=>`tools[${a}]`).join(", ");throw Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${a}.`)}let k=fU(i.contents),l=null!=(d=null==(c=null==(b=i.config)?void 0:b.automaticFunctionCalling)?void 0:c.maximumRemoteCalls)?d:10,m=0;for(;m<l&&(g=await this.generateContentInternal(i)).functionCalls&&0!==g.functionCalls.length;){let b=g.candidates[0].content,c=[];for(let b of null!=(f=null==(e=a.config)?void 0:e.tools)?f:[])if(gX(b)){let a=await b.callTool(g.functionCalls);c.push(...a)}m++,h={role:"user",parts:c},i.contents=fU(i.contents),i.contents.push(b),i.contents.push(h),gZ(i.config)&&(k.push(b),k.push(h))}return gZ(i.config)&&(g.automaticFunctionCallingHistory=k),g},this.generateContentStream=async a=>{var b,c,d,e,f;if(this.maybeMoveToResponseJsonSchem(a),gW(a.config)){let b=await this.processParamsMaybeAddMcpUsage(a);return await this.generateContentStreamInternal(b)}let g=gY(a);if(g.length>0){let a=g.map(a=>`tools[${a}]`).join(", ");throw Error(`Incompatible tools found at ${a}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}let h=null==(d=null==(c=null==(b=null==a?void 0:a.config)?void 0:b.toolConfig)?void 0:c.functionCallingConfig)?void 0:d.streamFunctionCallArguments,i=null==(f=null==(e=null==a?void 0:a.config)?void 0:e.automaticFunctionCalling)?void 0:f.disable;if(h&&!i)throw Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(a)},this.generateImages=async a=>await this.generateImagesInternal(a).then(a=>{var b;let c,d=[];if(null==a?void 0:a.generatedImages)for(let e of a.generatedImages)e&&(null==e?void 0:e.safetyAttributes)&&(null==(b=null==e?void 0:e.safetyAttributes)?void 0:b.contentType)==="Positive Prompt"?c=null==e?void 0:e.safetyAttributes:d.push(e);return c?{generatedImages:d,positivePromptSafetyAttributes:c,sdkHttpResponse:a.sdkHttpResponse}:{generatedImages:d,sdkHttpResponse:a.sdkHttpResponse}}),this.list=async a=>{var b;let c={config:Object.assign(Object.assign({},{queryBase:!0}),null==a?void 0:a.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase)if(null==(b=c.config)?void 0:b.filter)throw Error("Filtering tuned models list for Vertex AI is not currently supported");else c.config.filter="labels.tune-type:*";return new gd(aD.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(c),c)},this.editImage=async a=>{let b={model:a.model,prompt:a.prompt,referenceImages:[],config:a.config};return a.referenceImages&&a.referenceImages&&(b.referenceImages=a.referenceImages.map(a=>a.toReferenceImageAPI())),await this.editImageInternal(b)},this.upscaleImage=async a=>{let b={numberOfImages:1,mode:"upscale"};a.config&&(b=Object.assign(Object.assign({},b),a.config));let c={model:a.model,image:a.image,upscaleFactor:a.upscaleFactor,config:b};return await this.upscaleImageInternal(c)},this.generateVideos=async a=>{var b,c,d,e,f,g;if((a.prompt||a.image||a.video)&&a.source)throw Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return!this.apiClient.isVertexAI()&&((null==(b=a.video)?void 0:b.uri)&&(null==(c=a.video)?void 0:c.videoBytes)?a.video={uri:a.video.uri,mimeType:a.video.mimeType}:(null==(e=null==(d=a.source)?void 0:d.video)?void 0:e.uri)&&(null==(g=null==(f=a.source)?void 0:f.video)?void 0:g.videoBytes)&&(a.source.video={uri:a.source.video.uri,mimeType:a.source.video.mimeType})),await this.generateVideosInternal(a)}}maybeMoveToResponseJsonSchem(a){a.config&&a.config.responseSchema&&!a.config.responseJsonSchema&&Object.keys(a.config.responseSchema).includes("$schema")&&(a.config.responseJsonSchema=a.config.responseSchema,delete a.config.responseSchema)}async processParamsMaybeAddMcpUsage(a){var b,c,d;let e=null==(b=a.config)?void 0:b.tools;if(!e)return a;let f=await Promise.all(e.map(async a=>gX(a)?await a.tool():a)),g={model:a.model,contents:a.contents,config:Object.assign(Object.assign({},a.config),{tools:f})};if(g.config.tools=f,a.config&&a.config.tools&&gM(a.config.tools)){let b=Object.assign({},null!=(d=null==(c=a.config.httpOptions)?void 0:c.headers)?d:{});0===Object.keys(b).length&&(b=this.apiClient.getDefaultHeaders()),gN(b),g.config.httpOptions=Object.assign(Object.assign({},a.config.httpOptions),{headers:b})}return g}async initAfcToolsMap(a){var b,c,d;let e=new Map;for(let f of null!=(c=null==(b=a.config)?void 0:b.tools)?c:[])if(gX(f))for(let a of null!=(d=(await f.tool()).functionDeclarations)?d:[]){if(!a.name)throw Error("Function declaration name is required.");if(e.has(a.name))throw Error(`Duplicate tool declaration name: ${a.name}`);e.set(a.name,f)}return e}async processAfcStream(a){var b,c,d;let e=null!=(d=null==(c=null==(b=a.config)?void 0:b.automaticFunctionCalling)?void 0:c.maximumRemoteCalls)?d:10,f=!1,g=0;return function(a,b,c){return gj(this,arguments,function*(){for(;g<e;){f&&(g++,f=!1);let q=yield gi(a.processParamsMaybeAddMcpUsage(c)),r=yield gi(a.generateContentStreamInternal(q)),s=[],t=[];try{for(var d,h,i,j,k,l,m,o=!0,p=(h=void 0,gk(r));!(d=(m=yield gi(p.next())).done);o=!0)if(j=m.value,o=!1,yield yield gi(j),j.candidates&&(null==(k=j.candidates[0])?void 0:k.content)){for(let a of(t.push(j.candidates[0].content),null!=(l=j.candidates[0].content.parts)?l:[]))if(g<e&&a.functionCall){if(!a.functionCall.name)throw Error("Function call name was not returned by the model.");if(b.has(a.functionCall.name)){let c=yield gi(b.get(a.functionCall.name).callTool([a.functionCall]));s.push(...c)}else throw Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${b.keys()}, mising tool: ${a.functionCall.name}`)}}}catch(a){h={error:a}}finally{try{!o&&!d&&(i=p.return)&&(yield gi(i.call(p)))}finally{if(h)throw h.error}}if(s.length>0){f=!0;let a=new fg;a.candidates=[{content:{role:"user",parts:s}}],yield yield gi(a);let b=[];b.push(...t),b.push({role:"user",parts:s});let d=fU(c.contents).concat(b);c.contents=d}else break}})}(this,await this.initAfcToolsMap(a),a)}async generateContentInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=gu(this.apiClient,a);return f=fa("{model}:generateContent",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=gw(a),c=new fg;return Object.assign(c,b),c})}{let b=gt(this.apiClient,a);return f=fa("{model}:generateContent",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=gv(a),c=new fg;return Object.assign(c,b),c})}}async generateContentStreamInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=gu(this.apiClient,a);return f=fa("{model}:streamGenerateContent?alt=sse",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(function(a){return gj(this,arguments,function*(){var b,c,d,e;try{for(var f,g=!0,h=gk(a);!(b=(f=yield gi(h.next())).done);g=!0){e=f.value,g=!1;let a=gw((yield gi(e.json())));a.sdkHttpResponse={headers:e.headers};let b=new fg;Object.assign(b,a),yield yield gi(b)}}catch(a){c={error:a}}finally{try{!g&&!b&&(d=h.return)&&(yield gi(d.call(h)))}finally{if(c)throw c.error}}})})}{let b=gt(this.apiClient,a);return f=fa("{model}:streamGenerateContent?alt=sse",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.requestStream({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(function(a){return gj(this,arguments,function*(){var b,c,d,e;try{for(var f,g=!0,h=gk(a);!(b=(f=yield gi(h.next())).done);g=!0){e=f.value,g=!1;let a=gv((yield gi(e.json())));a.sdkHttpResponse={headers:e.headers};let b=new fg;Object.assign(b,a),yield yield gi(b)}}catch(a){c={error:a}}finally{try{!g&&!b&&(d=h.return)&&(yield gi(d.call(h)))}finally{if(c)throw c.error}}})})}}async embedContent(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["contents"]);if(null!=e){let b=fT(a,e);Array.isArray(b)&&(b=b.map(a=>a)),fb(c,["instances[]","content"],b)}let f=fc(b,["config"]);return null!=f&&function(a,b){let c=fc(a,["taskType"]);void 0!==b&&null!=c&&fb(b,["instances[]","task_type"],c);let d=fc(a,["title"]);void 0!==b&&null!=d&&fb(b,["instances[]","title"],d);let e=fc(a,["outputDimensionality"]);void 0!==b&&null!=e&&fb(b,["parameters","outputDimensionality"],e);let f=fc(a,["mimeType"]);void 0!==b&&null!=f&&fb(b,["instances[]","mimeType"],f);let g=fc(a,["autoTruncate"]);void 0!==b&&null!=g&&fb(b,["parameters","autoTruncate"],g)}(f,c),c}(this.apiClient,a);return f=fa("{model}:predict",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["predictions[]","embeddings"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["values"]);null!=c&&fb(b,["values"],c);let d=fc(a,["statistics"]);return null!=d&&fb(b,["statistics"],function(a){let b={},c=fc(a,["truncated"]);null!=c&&fb(b,["truncated"],c);let d=fc(a,["token_count"]);return null!=d&&fb(b,["tokenCount"],d),b}(d)),b})(a))),fb(b,["embeddings"],a)}let e=fc(a,["metadata"]);return null!=e&&fb(b,["metadata"],e),b}(a),c=new fh;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["contents"]);if(null!=e){let b=fT(a,e);Array.isArray(b)&&(b=b.map(a=>a)),fb(c,["requests[]","content"],b)}let f=fc(b,["config"]);null!=f&&function(a,b){let c=fc(a,["taskType"]);void 0!==b&&null!=c&&fb(b,["requests[]","taskType"],c);let d=fc(a,["title"]);void 0!==b&&null!=d&&fb(b,["requests[]","title"],d);let e=fc(a,["outputDimensionality"]);if(void 0!==b&&null!=e&&fb(b,["requests[]","outputDimensionality"],e),void 0!==fc(a,["mimeType"]))throw Error("mimeType parameter is not supported in Gemini API.");if(void 0!==fc(a,["autoTruncate"]))throw Error("autoTruncate parameter is not supported in Gemini API.")}(f,c);let g=fc(b,["model"]);return void 0!==g&&fb(c,["requests[]","model"],fH(a,g)),c}(this.apiClient,a);return f=fa("{model}:batchEmbedContents",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["embeddings"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["embeddings"],a)}let e=fc(a,["metadata"]);return null!=e&&fb(b,["metadata"],e),b}(a),c=new fh;return Object.assign(c,b),c})}}async generateImagesInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["prompt"]);null!=e&&fb(c,["instances[0]","prompt"],e);let f=fc(b,["config"]);return null!=f&&function(a,b){let c=fc(a,["outputGcsUri"]);void 0!==b&&null!=c&&fb(b,["parameters","storageUri"],c);let d=fc(a,["negativePrompt"]);void 0!==b&&null!=d&&fb(b,["parameters","negativePrompt"],d);let e=fc(a,["numberOfImages"]);void 0!==b&&null!=e&&fb(b,["parameters","sampleCount"],e);let f=fc(a,["aspectRatio"]);void 0!==b&&null!=f&&fb(b,["parameters","aspectRatio"],f);let g=fc(a,["guidanceScale"]);void 0!==b&&null!=g&&fb(b,["parameters","guidanceScale"],g);let h=fc(a,["seed"]);void 0!==b&&null!=h&&fb(b,["parameters","seed"],h);let i=fc(a,["safetyFilterLevel"]);void 0!==b&&null!=i&&fb(b,["parameters","safetySetting"],i);let j=fc(a,["personGeneration"]);void 0!==b&&null!=j&&fb(b,["parameters","personGeneration"],j);let k=fc(a,["includeSafetyAttributes"]);void 0!==b&&null!=k&&fb(b,["parameters","includeSafetyAttributes"],k);let l=fc(a,["includeRaiReason"]);void 0!==b&&null!=l&&fb(b,["parameters","includeRaiReason"],l);let m=fc(a,["language"]);void 0!==b&&null!=m&&fb(b,["parameters","language"],m);let o=fc(a,["outputMimeType"]);void 0!==b&&null!=o&&fb(b,["parameters","outputOptions","mimeType"],o);let p=fc(a,["outputCompressionQuality"]);void 0!==b&&null!=p&&fb(b,["parameters","outputOptions","compressionQuality"],p);let q=fc(a,["addWatermark"]);void 0!==b&&null!=q&&fb(b,["parameters","addWatermark"],q);let r=fc(a,["labels"]);void 0!==b&&null!=r&&fb(b,["labels"],r);let s=fc(a,["imageSize"]);void 0!==b&&null!=s&&fb(b,["parameters","sampleImageSize"],s);let t=fc(a,["enhancePrompt"]);void 0!==b&&null!=t&&fb(b,["parameters","enhancePrompt"],t)}(f,c),c}(this.apiClient,a);return f=fa("{model}:predict",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>gx(a))),fb(b,["generatedImages"],a)}let e=fc(a,["positivePromptSafetyAttributes"]);return null!=e&&fb(b,["positivePromptSafetyAttributes"],gE(e)),b}(a),c=new fi;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["prompt"]);null!=e&&fb(c,["instances[0]","prompt"],e);let f=fc(b,["config"]);return null!=f&&function(a,b){if(void 0!==fc(a,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==fc(a,["negativePrompt"]))throw Error("negativePrompt parameter is not supported in Gemini API.");let c=fc(a,["numberOfImages"]);void 0!==b&&null!=c&&fb(b,["parameters","sampleCount"],c);let d=fc(a,["aspectRatio"]);void 0!==b&&null!=d&&fb(b,["parameters","aspectRatio"],d);let e=fc(a,["guidanceScale"]);if(void 0!==b&&null!=e&&fb(b,["parameters","guidanceScale"],e),void 0!==fc(a,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let f=fc(a,["safetyFilterLevel"]);void 0!==b&&null!=f&&fb(b,["parameters","safetySetting"],f);let g=fc(a,["personGeneration"]);void 0!==b&&null!=g&&fb(b,["parameters","personGeneration"],g);let h=fc(a,["includeSafetyAttributes"]);void 0!==b&&null!=h&&fb(b,["parameters","includeSafetyAttributes"],h);let i=fc(a,["includeRaiReason"]);void 0!==b&&null!=i&&fb(b,["parameters","includeRaiReason"],i);let j=fc(a,["language"]);void 0!==b&&null!=j&&fb(b,["parameters","language"],j);let k=fc(a,["outputMimeType"]);void 0!==b&&null!=k&&fb(b,["parameters","outputOptions","mimeType"],k);let l=fc(a,["outputCompressionQuality"]);if(void 0!==b&&null!=l&&fb(b,["parameters","outputOptions","compressionQuality"],l),void 0!==fc(a,["addWatermark"]))throw Error("addWatermark parameter is not supported in Gemini API.");if(void 0!==fc(a,["labels"]))throw Error("labels parameter is not supported in Gemini API.");let m=fc(a,["imageSize"]);if(void 0!==b&&null!=m&&fb(b,["parameters","sampleImageSize"],m),void 0!==fc(a,["enhancePrompt"]))throw Error("enhancePrompt parameter is not supported in Gemini API.")}(f,c),c}(this.apiClient,a);return f=fa("{model}:predict",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["_self"]);null!=c&&fb(b,["image"],function(a){let b={},c=fc(a,["bytesBase64Encoded"]);null!=c&&fb(b,["imageBytes"],fd(c));let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}(c));let d=fc(a,["raiFilteredReason"]);null!=d&&fb(b,["raiFilteredReason"],d);let e=fc(a,["_self"]);return null!=e&&fb(b,["safetyAttributes"],gD(e)),b})(a))),fb(b,["generatedImages"],a)}let e=fc(a,["positivePromptSafetyAttributes"]);return null!=e&&fb(b,["positivePromptSafetyAttributes"],gD(e)),b}(a),c=new fi;return Object.assign(c,b),c})}}async editImageInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["prompt"]);null!=e&&fb(c,["instances[0]","prompt"],e);let f=fc(b,["referenceImages"]);if(null!=f){let a=f;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["referenceImage"]);null!=c&&fb(b,["referenceImage"],gA(c));let d=fc(a,["referenceId"]);null!=d&&fb(b,["referenceId"],d);let e=fc(a,["referenceType"]);null!=e&&fb(b,["referenceType"],e);let f=fc(a,["maskImageConfig"]);null!=f&&fb(b,["maskImageConfig"],function(a){let b={},c=fc(a,["maskMode"]);null!=c&&fb(b,["maskMode"],c);let d=fc(a,["segmentationClasses"]);null!=d&&fb(b,["maskClasses"],d);let e=fc(a,["maskDilation"]);return null!=e&&fb(b,["dilation"],e),b}(f));let g=fc(a,["controlImageConfig"]);null!=g&&fb(b,["controlImageConfig"],function(a){let b={},c=fc(a,["controlType"]);null!=c&&fb(b,["controlType"],c);let d=fc(a,["enableControlImageComputation"]);return null!=d&&fb(b,["computeControl"],d),b}(g));let h=fc(a,["styleImageConfig"]);null!=h&&fb(b,["styleImageConfig"],h);let i=fc(a,["subjectImageConfig"]);return null!=i&&fb(b,["subjectImageConfig"],i),b})(a))),fb(c,["instances[0]","referenceImages"],a)}let g=fc(b,["config"]);return null!=g&&function(a,b){let c=fc(a,["outputGcsUri"]);void 0!==b&&null!=c&&fb(b,["parameters","storageUri"],c);let d=fc(a,["negativePrompt"]);void 0!==b&&null!=d&&fb(b,["parameters","negativePrompt"],d);let e=fc(a,["numberOfImages"]);void 0!==b&&null!=e&&fb(b,["parameters","sampleCount"],e);let f=fc(a,["aspectRatio"]);void 0!==b&&null!=f&&fb(b,["parameters","aspectRatio"],f);let g=fc(a,["guidanceScale"]);void 0!==b&&null!=g&&fb(b,["parameters","guidanceScale"],g);let h=fc(a,["seed"]);void 0!==b&&null!=h&&fb(b,["parameters","seed"],h);let i=fc(a,["safetyFilterLevel"]);void 0!==b&&null!=i&&fb(b,["parameters","safetySetting"],i);let j=fc(a,["personGeneration"]);void 0!==b&&null!=j&&fb(b,["parameters","personGeneration"],j);let k=fc(a,["includeSafetyAttributes"]);void 0!==b&&null!=k&&fb(b,["parameters","includeSafetyAttributes"],k);let l=fc(a,["includeRaiReason"]);void 0!==b&&null!=l&&fb(b,["parameters","includeRaiReason"],l);let m=fc(a,["language"]);void 0!==b&&null!=m&&fb(b,["parameters","language"],m);let o=fc(a,["outputMimeType"]);void 0!==b&&null!=o&&fb(b,["parameters","outputOptions","mimeType"],o);let p=fc(a,["outputCompressionQuality"]);void 0!==b&&null!=p&&fb(b,["parameters","outputOptions","compressionQuality"],p);let q=fc(a,["addWatermark"]);void 0!==b&&null!=q&&fb(b,["parameters","addWatermark"],q);let r=fc(a,["labels"]);void 0!==b&&null!=r&&fb(b,["labels"],r);let s=fc(a,["editMode"]);void 0!==b&&null!=s&&fb(b,["parameters","editMode"],s);let t=fc(a,["baseSteps"]);void 0!==b&&null!=t&&fb(b,["parameters","editConfig","baseSteps"],t)}(g,c),c}(this.apiClient,a);return d=fa("{model}:predict",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>gx(a))),fb(b,["generatedImages"],a)}return b}(a),c=new fj;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["image"]);null!=e&&fb(c,["instances[0]","image"],gA(e));let f=fc(b,["upscaleFactor"]);null!=f&&fb(c,["parameters","upscaleConfig","upscaleFactor"],f);let g=fc(b,["config"]);return null!=g&&function(a,b){let c=fc(a,["outputGcsUri"]);void 0!==b&&null!=c&&fb(b,["parameters","storageUri"],c);let d=fc(a,["safetyFilterLevel"]);void 0!==b&&null!=d&&fb(b,["parameters","safetySetting"],d);let e=fc(a,["personGeneration"]);void 0!==b&&null!=e&&fb(b,["parameters","personGeneration"],e);let f=fc(a,["includeRaiReason"]);void 0!==b&&null!=f&&fb(b,["parameters","includeRaiReason"],f);let g=fc(a,["outputMimeType"]);void 0!==b&&null!=g&&fb(b,["parameters","outputOptions","mimeType"],g);let h=fc(a,["outputCompressionQuality"]);void 0!==b&&null!=h&&fb(b,["parameters","outputOptions","compressionQuality"],h);let i=fc(a,["enhanceInputImage"]);void 0!==b&&null!=i&&fb(b,["parameters","upscaleConfig","enhanceInputImage"],i);let j=fc(a,["imagePreservationFactor"]);void 0!==b&&null!=j&&fb(b,["parameters","upscaleConfig","imagePreservationFactor"],j);let k=fc(a,["labels"]);void 0!==b&&null!=k&&fb(b,["labels"],k);let l=fc(a,["numberOfImages"]);void 0!==b&&null!=l&&fb(b,["parameters","sampleCount"],l);let m=fc(a,["mode"]);void 0!==b&&null!=m&&fb(b,["parameters","mode"],m)}(g,c),c}(this.apiClient,a);return d=fa("{model}:predict",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["predictions"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>gx(a))),fb(b,["generatedImages"],a)}return b}(a),c=new fk;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async recontextImage(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["source"]);null!=e&&function(a,b){let c=fc(a,["prompt"]);void 0!==b&&null!=c&&fb(b,["instances[0]","prompt"],c);let d=fc(a,["personImage"]);void 0!==b&&null!=d&&fb(b,["instances[0]","personImage","image"],gA(d));let e=fc(a,["productImages"]);if(void 0!==b&&null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["productImage"]);return null!=c&&fb(b,["image"],gA(c)),b})(a))),fb(b,["instances[0]","productImages"],a)}}(e,c);let f=fc(b,["config"]);return null!=f&&function(a,b){let c=fc(a,["numberOfImages"]);void 0!==b&&null!=c&&fb(b,["parameters","sampleCount"],c);let d=fc(a,["baseSteps"]);void 0!==b&&null!=d&&fb(b,["parameters","baseSteps"],d);let e=fc(a,["outputGcsUri"]);void 0!==b&&null!=e&&fb(b,["parameters","storageUri"],e);let f=fc(a,["seed"]);void 0!==b&&null!=f&&fb(b,["parameters","seed"],f);let g=fc(a,["safetyFilterLevel"]);void 0!==b&&null!=g&&fb(b,["parameters","safetySetting"],g);let h=fc(a,["personGeneration"]);void 0!==b&&null!=h&&fb(b,["parameters","personGeneration"],h);let i=fc(a,["addWatermark"]);void 0!==b&&null!=i&&fb(b,["parameters","addWatermark"],i);let j=fc(a,["outputMimeType"]);void 0!==b&&null!=j&&fb(b,["parameters","outputOptions","mimeType"],j);let k=fc(a,["outputCompressionQuality"]);void 0!==b&&null!=k&&fb(b,["parameters","outputOptions","compressionQuality"],k);let l=fc(a,["enhancePrompt"]);void 0!==b&&null!=l&&fb(b,["parameters","enhancePrompt"],l);let m=fc(a,["labels"]);void 0!==b&&null!=m&&fb(b,["labels"],m)}(f,c),c}(this.apiClient,a);return d=fa("{model}:predict",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=fc(a,["predictions"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>gx(a))),fb(b,["generatedImages"],a)}return b}(a),c=new fl;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async segmentImage(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["source"]);null!=e&&function(a,b){let c=fc(a,["prompt"]);void 0!==b&&null!=c&&fb(b,["instances[0]","prompt"],c);let d=fc(a,["image"]);void 0!==b&&null!=d&&fb(b,["instances[0]","image"],gA(d));let e=fc(a,["scribbleImage"]);void 0!==b&&null!=e&&fb(b,["instances[0]","scribble"],function(a){let b={},c=fc(a,["image"]);return null!=c&&fb(b,["image"],gA(c)),b}(e))}(e,c);let f=fc(b,["config"]);return null!=f&&function(a,b){let c=fc(a,["mode"]);void 0!==b&&null!=c&&fb(b,["parameters","mode"],c);let d=fc(a,["maxPredictions"]);void 0!==b&&null!=d&&fb(b,["parameters","maxPredictions"],d);let e=fc(a,["confidenceThreshold"]);void 0!==b&&null!=e&&fb(b,["parameters","confidenceThreshold"],e);let f=fc(a,["maskDilation"]);void 0!==b&&null!=f&&fb(b,["parameters","maskDilation"],f);let g=fc(a,["binaryColorThreshold"]);void 0!==b&&null!=g&&fb(b,["parameters","binaryColorThreshold"],g);let h=fc(a,["labels"]);void 0!==b&&null!=h&&fb(b,["labels"],h)}(f,c),c}(this.apiClient,a);return d=fa("{model}:predict",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=fc(a,["predictions"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["_self"]);null!=c&&fb(b,["mask"],gy(c));let d=fc(a,["labels"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["labels"],a)}return b})(a))),fb(b,["generatedMasks"],a)}return b}(a),c=new fm;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async get(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["model"]);return null!=d&&fb(c,["_url","name"],fH(a,d)),c}(this.apiClient,a);return f=fa("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>gC(a))}{let b=function(a,b){let c={},d=fc(b,["model"]);return null!=d&&fb(c,["_url","name"],fH(a,d)),c}(this.apiClient,a);return f=fa("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>gB(a))}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["config"]);return null!=d&&function(a,b,c){let d=fc(b,["pageSize"]);void 0!==c&&null!=d&&fb(c,["_query","pageSize"],d);let e=fc(b,["pageToken"]);void 0!==c&&null!=e&&fb(c,["_query","pageToken"],e);let f=fc(b,["filter"]);void 0!==c&&null!=f&&fb(c,["_query","filter"],f);let g=fc(b,["queryBase"]);void 0!==c&&null!=g&&fb(c,["_url","models_url"],f3(a,g))}(a,d,c),c}(this.apiClient,a);return f=fa("{models_url}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["nextPageToken"]);null!=d&&fb(b,["nextPageToken"],d);let e=fc(a,["_self"]);if(null!=e){let a=f4(e);Array.isArray(a)&&(a=a.map(a=>gC(a))),fb(b,["models"],a)}return b}(a),c=new fn;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=fc(b,["config"]);return null!=d&&function(a,b,c){let d=fc(b,["pageSize"]);void 0!==c&&null!=d&&fb(c,["_query","pageSize"],d);let e=fc(b,["pageToken"]);void 0!==c&&null!=e&&fb(c,["_query","pageToken"],e);let f=fc(b,["filter"]);void 0!==c&&null!=f&&fb(c,["_query","filter"],f);let g=fc(b,["queryBase"]);void 0!==c&&null!=g&&fb(c,["_url","models_url"],f3(a,g))}(a,d,c),c}(this.apiClient,a);return f=fa("{models_url}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["nextPageToken"]);null!=d&&fb(b,["nextPageToken"],d);let e=fc(a,["_self"]);if(null!=e){let a=f4(e);Array.isArray(a)&&(a=a.map(a=>gB(a))),fb(b,["models"],a)}return b}(a),c=new fn;return Object.assign(c,b),c})}}async update(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["config"]);return null!=e&&function(a,b){let c=fc(a,["displayName"]);void 0!==b&&null!=c&&fb(b,["displayName"],c);let d=fc(a,["description"]);void 0!==b&&null!=d&&fb(b,["description"],d);let e=fc(a,["defaultCheckpointId"]);void 0!==b&&null!=e&&fb(b,["defaultCheckpointId"],e)}(e,c),c}(this.apiClient,a);return f=fa("{model}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>gC(a))}{let b=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","name"],fH(a,d));let e=fc(b,["config"]);return null!=e&&function(a,b){let c=fc(a,["displayName"]);void 0!==b&&null!=c&&fb(b,["displayName"],c);let d=fc(a,["description"]);void 0!==b&&null!=d&&fb(b,["description"],d);let e=fc(a,["defaultCheckpointId"]);void 0!==b&&null!=e&&fb(b,["defaultCheckpointId"],e)}(e,c),c}(this.apiClient,a);return f=fa("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"PATCH",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>gB(a))}}async delete(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["model"]);return null!=d&&fb(c,["_url","name"],fH(a,d)),c}(this.apiClient,a);return f=fa("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);return null!=c&&fb(b,["sdkHttpResponse"],c),b}(a),c=new fo;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=fc(b,["model"]);return null!=d&&fb(c,["_url","name"],fH(a,d)),c}(this.apiClient,a);return f=fa("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"DELETE",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);return null!=c&&fb(b,["sdkHttpResponse"],c),b}(a),c=new fo;return Object.assign(c,b),c})}}async countTokens(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["contents"]);if(null!=e){let a=fU(e);Array.isArray(a)&&(a=a.map(a=>a)),fb(c,["contents"],a)}let f=fc(b,["config"]);return null!=f&&function(a,b){let c=fc(a,["systemInstruction"]);void 0!==b&&null!=c&&fb(b,["systemInstruction"],fS(c));let d=fc(a,["tools"]);if(void 0!==b&&null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>gF(a))),fb(b,["tools"],a)}let e=fc(a,["generationConfig"]);void 0!==b&&null!=e&&fb(b,["generationConfig"],function(a){let b={},c=fc(a,["modelSelectionConfig"]);null!=c&&fb(b,["modelConfig"],c);let d=fc(a,["responseJsonSchema"]);null!=d&&fb(b,["responseJsonSchema"],d);let e=fc(a,["audioTimestamp"]);null!=e&&fb(b,["audioTimestamp"],e);let f=fc(a,["candidateCount"]);null!=f&&fb(b,["candidateCount"],f);let g=fc(a,["enableAffectiveDialog"]);null!=g&&fb(b,["enableAffectiveDialog"],g);let h=fc(a,["frequencyPenalty"]);null!=h&&fb(b,["frequencyPenalty"],h);let i=fc(a,["logprobs"]);null!=i&&fb(b,["logprobs"],i);let j=fc(a,["maxOutputTokens"]);null!=j&&fb(b,["maxOutputTokens"],j);let k=fc(a,["mediaResolution"]);null!=k&&fb(b,["mediaResolution"],k);let l=fc(a,["presencePenalty"]);null!=l&&fb(b,["presencePenalty"],l);let m=fc(a,["responseLogprobs"]);null!=m&&fb(b,["responseLogprobs"],m);let o=fc(a,["responseMimeType"]);null!=o&&fb(b,["responseMimeType"],o);let p=fc(a,["responseModalities"]);null!=p&&fb(b,["responseModalities"],p);let q=fc(a,["responseSchema"]);null!=q&&fb(b,["responseSchema"],q);let r=fc(a,["routingConfig"]);null!=r&&fb(b,["routingConfig"],r);let s=fc(a,["seed"]);null!=s&&fb(b,["seed"],s);let t=fc(a,["speechConfig"]);null!=t&&fb(b,["speechConfig"],t);let u=fc(a,["stopSequences"]);null!=u&&fb(b,["stopSequences"],u);let v=fc(a,["temperature"]);null!=v&&fb(b,["temperature"],v);let w=fc(a,["thinkingConfig"]);null!=w&&fb(b,["thinkingConfig"],w);let x=fc(a,["topK"]);null!=x&&fb(b,["topK"],x);let y=fc(a,["topP"]);if(null!=y&&fb(b,["topP"],y),void 0!==fc(a,["enableEnhancedCivicAnswers"]))throw Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return b}(e))}(f,c),c}(this.apiClient,a);return f=fa("{model}:countTokens",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["totalTokens"]);return null!=d&&fb(b,["totalTokens"],d),b}(a),c=new fp;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["contents"]);if(null!=e){let a=fU(e);Array.isArray(a)&&(a=a.map(a=>gs(a))),fb(c,["contents"],a)}let f=fc(b,["config"]);return null!=f&&function(a){if(void 0!==fc(a,["systemInstruction"]))throw Error("systemInstruction parameter is not supported in Gemini API.");if(void 0!==fc(a,["tools"]))throw Error("tools parameter is not supported in Gemini API.");if(void 0!==fc(a,["generationConfig"]))throw Error("generationConfig parameter is not supported in Gemini API.")}(f),c}(this.apiClient,a);return f=fa("{model}:countTokens",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["totalTokens"]);null!=d&&fb(b,["totalTokens"],d);let e=fc(a,["cachedContentTokenCount"]);return null!=e&&fb(b,["cachedContentTokenCount"],e),b}(a),c=new fp;return Object.assign(c,b),c})}}async computeTokens(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["contents"]);if(null!=e){let a=fU(e);Array.isArray(a)&&(a=a.map(a=>a)),fb(c,["contents"],a)}return c}(this.apiClient,a);return d=fa("{model}:computeTokens",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["tokensInfo"]);if(null!=d){let a=d;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["tokensInfo"],a)}return b}(a),c=new fq;return Object.assign(c,b),c})}throw Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["prompt"]);null!=e&&fb(c,["instances[0]","prompt"],e);let f=fc(b,["image"]);null!=f&&fb(c,["instances[0]","image"],gA(f));let g=fc(b,["video"]);null!=g&&fb(c,["instances[0]","video"],gH(g));let h=fc(b,["source"]);null!=h&&function(a,b){let c=fc(a,["prompt"]);void 0!==b&&null!=c&&fb(b,["instances[0]","prompt"],c);let d=fc(a,["image"]);void 0!==b&&null!=d&&fb(b,["instances[0]","image"],gA(d));let e=fc(a,["video"]);void 0!==b&&null!=e&&fb(b,["instances[0]","video"],gH(e))}(h,c);let i=fc(b,["config"]);return null!=i&&function(a,b){let c=fc(a,["numberOfVideos"]);void 0!==b&&null!=c&&fb(b,["parameters","sampleCount"],c);let d=fc(a,["outputGcsUri"]);void 0!==b&&null!=d&&fb(b,["parameters","storageUri"],d);let e=fc(a,["fps"]);void 0!==b&&null!=e&&fb(b,["parameters","fps"],e);let f=fc(a,["durationSeconds"]);void 0!==b&&null!=f&&fb(b,["parameters","durationSeconds"],f);let g=fc(a,["seed"]);void 0!==b&&null!=g&&fb(b,["parameters","seed"],g);let h=fc(a,["aspectRatio"]);void 0!==b&&null!=h&&fb(b,["parameters","aspectRatio"],h);let i=fc(a,["resolution"]);void 0!==b&&null!=i&&fb(b,["parameters","resolution"],i);let j=fc(a,["personGeneration"]);void 0!==b&&null!=j&&fb(b,["parameters","personGeneration"],j);let k=fc(a,["pubsubTopic"]);void 0!==b&&null!=k&&fb(b,["parameters","pubsubTopic"],k);let l=fc(a,["negativePrompt"]);void 0!==b&&null!=l&&fb(b,["parameters","negativePrompt"],l);let m=fc(a,["enhancePrompt"]);void 0!==b&&null!=m&&fb(b,["parameters","enhancePrompt"],m);let o=fc(a,["generateAudio"]);void 0!==b&&null!=o&&fb(b,["parameters","generateAudio"],o);let p=fc(a,["lastFrame"]);void 0!==b&&null!=p&&fb(b,["instances[0]","lastFrame"],gA(p));let q=fc(a,["referenceImages"]);if(void 0!==b&&null!=q){let a=q;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["image"]);null!=c&&fb(b,["image"],gA(c));let d=fc(a,["referenceType"]);return null!=d&&fb(b,["referenceType"],d),b})(a))),fb(b,["instances[0]","referenceImages"],a)}let r=fc(a,["mask"]);void 0!==b&&null!=r&&fb(b,["instances[0]","mask"],function(a){let b={},c=fc(a,["image"]);null!=c&&fb(b,["_self"],gA(c));let d=fc(a,["maskMode"]);return null!=d&&fb(b,["maskMode"],d),b}(r));let s=fc(a,["compressionQuality"]);void 0!==b&&null!=s&&fb(b,["parameters","compressionQuality"],s)}(i,c),c}(this.apiClient,a);return f=fa("{model}:predictLongRunning",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["name"],c);let d=fc(a,["metadata"]);null!=d&&fb(b,["metadata"],d);let e=fc(a,["done"]);null!=e&&fb(b,["done"],e);let f=fc(a,["error"]);null!=f&&fb(b,["error"],f);let g=fc(a,["response"]);return null!=g&&fb(b,["response"],function(a){let b={},c=fc(a,["videos"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["_self"]);return null!=c&&fb(b,["video"],function(a){let b={},c=fc(a,["gcsUri"]);null!=c&&fb(b,["uri"],c);let d=fc(a,["bytesBase64Encoded"]);null!=d&&fb(b,["videoBytes"],fd(d));let e=fc(a,["mimeType"]);return null!=e&&fb(b,["mimeType"],e),b}(c)),b})(a))),fb(b,["generatedVideos"],a)}let d=fc(a,["raiMediaFilteredCount"]);null!=d&&fb(b,["raiMediaFilteredCount"],d);let e=fc(a,["raiMediaFilteredReasons"]);return null!=e&&fb(b,["raiMediaFilteredReasons"],e),b}(g)),b}(a),c=new fr;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["_url","model"],fH(a,d));let e=fc(b,["prompt"]);null!=e&&fb(c,["instances[0]","prompt"],e);let f=fc(b,["image"]);null!=f&&fb(c,["instances[0]","image"],gz(f));let g=fc(b,["video"]);null!=g&&fb(c,["instances[0]","video"],gG(g));let h=fc(b,["source"]);null!=h&&function(a,b){let c=fc(a,["prompt"]);void 0!==b&&null!=c&&fb(b,["instances[0]","prompt"],c);let d=fc(a,["image"]);void 0!==b&&null!=d&&fb(b,["instances[0]","image"],gz(d));let e=fc(a,["video"]);void 0!==b&&null!=e&&fb(b,["instances[0]","video"],gG(e))}(h,c);let i=fc(b,["config"]);return null!=i&&function(a,b){let c=fc(a,["numberOfVideos"]);if(void 0!==b&&null!=c&&fb(b,["parameters","sampleCount"],c),void 0!==fc(a,["outputGcsUri"]))throw Error("outputGcsUri parameter is not supported in Gemini API.");if(void 0!==fc(a,["fps"]))throw Error("fps parameter is not supported in Gemini API.");let d=fc(a,["durationSeconds"]);if(void 0!==b&&null!=d&&fb(b,["parameters","durationSeconds"],d),void 0!==fc(a,["seed"]))throw Error("seed parameter is not supported in Gemini API.");let e=fc(a,["aspectRatio"]);void 0!==b&&null!=e&&fb(b,["parameters","aspectRatio"],e);let f=fc(a,["resolution"]);void 0!==b&&null!=f&&fb(b,["parameters","resolution"],f);let g=fc(a,["personGeneration"]);if(void 0!==b&&null!=g&&fb(b,["parameters","personGeneration"],g),void 0!==fc(a,["pubsubTopic"]))throw Error("pubsubTopic parameter is not supported in Gemini API.");let h=fc(a,["negativePrompt"]);void 0!==b&&null!=h&&fb(b,["parameters","negativePrompt"],h);let i=fc(a,["enhancePrompt"]);if(void 0!==b&&null!=i&&fb(b,["parameters","enhancePrompt"],i),void 0!==fc(a,["generateAudio"]))throw Error("generateAudio parameter is not supported in Gemini API.");let j=fc(a,["lastFrame"]);void 0!==b&&null!=j&&fb(b,["instances[0]","lastFrame"],gz(j));let k=fc(a,["referenceImages"]);if(void 0!==b&&null!=k){let a=k;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["image"]);null!=c&&fb(b,["image"],gz(c));let d=fc(a,["referenceType"]);return null!=d&&fb(b,["referenceType"],d),b})(a))),fb(b,["instances[0]","referenceImages"],a)}if(void 0!==fc(a,["mask"]))throw Error("mask parameter is not supported in Gemini API.");if(void 0!==fc(a,["compressionQuality"]))throw Error("compressionQuality parameter is not supported in Gemini API.")}(i,c),c}(this.apiClient,a);return f=fa("{model}:predictLongRunning",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["name"],c);let d=fc(a,["metadata"]);null!=d&&fb(b,["metadata"],d);let e=fc(a,["done"]);null!=e&&fb(b,["done"],e);let f=fc(a,["error"]);null!=f&&fb(b,["error"],f);let g=fc(a,["response","generateVideoResponse"]);return null!=g&&fb(b,["response"],function(a){let b={},c=fc(a,["generatedSamples"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["video"]);return null!=c&&fb(b,["video"],function(a){let b={},c=fc(a,["uri"]);null!=c&&fb(b,["uri"],c);let d=fc(a,["encodedVideo"]);null!=d&&fb(b,["videoBytes"],fd(d));let e=fc(a,["encoding"]);return null!=e&&fb(b,["mimeType"],e),b}(c)),b})(a))),fb(b,["generatedVideos"],a)}let d=fc(a,["raiMediaFilteredCount"]);null!=d&&fb(b,["raiMediaFilteredCount"],d);let e=fc(a,["raiMediaFilteredReasons"]);return null!=e&&fb(b,["raiMediaFilteredReasons"],e),b}(g)),b}(a),c=new fr;return Object.assign(c,b),c})}}}class g_ extends e9{constructor(a){super(),this.apiClient=a}async getVideosOperation(a){let b=a.operation,c=a.config;if(void 0===b.name||""===b.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let a,d=b.name.split("/operations/")[0];c&&"httpOptions"in c&&(a=c.httpOptions);let e=await this.fetchPredictVideosOperationInternal({operationName:b.name,resourceName:d,config:{httpOptions:a}});return b._fromAPIResponse({apiResponse:e,_isVertexAI:!0})}{let a=await this.getVideosOperationInternal({operationName:b.name,config:c});return b._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async get(a){let b=a.operation,c=a.config;if(void 0===b.name||""===b.name)throw Error("Operation name is required.");if(this.apiClient.isVertexAI()){let a,d=b.name.split("/operations/")[0];c&&"httpOptions"in c&&(a=c.httpOptions);let e=await this.fetchPredictVideosOperationInternal({operationName:b.name,resourceName:d,config:{httpOptions:a}});return b._fromAPIResponse({apiResponse:e,_isVertexAI:!0})}{let a=await this.getVideosOperationInternal({operationName:b.name,config:c});return b._fromAPIResponse({apiResponse:a,_isVertexAI:!1})}}async getVideosOperationInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a){let b={},c=fc(a,["operationName"]);return null!=c&&fb(b,["_url","operationName"],c),b}(a);return f=fa("{operationName}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json())}{let b=function(a){let b={},c=fc(a,["operationName"]);return null!=c&&fb(b,["_url","operationName"],c),b}(a);return f=fa("{operationName}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json())}}async fetchPredictVideosOperationInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a){let b={},c=fc(a,["operationName"]);null!=c&&fb(b,["operationName"],c);let d=fc(a,["resourceName"]);return null!=d&&fb(b,["_url","resourceName"],d),b}(a);return d=fa("{resourceName}:fetchPredictOperation",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json())}throw Error("This method is only supported by the Vertex AI.")}}class g0 extends e9{constructor(a){super(),this.apiClient=a}async create(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("The client.tokens.create method is only supported by the Gemini Developer API.");{let f=function(a,b){let c={},d=fc(b,["config"]);return null!=d&&fb(c,["config"],function(a,b,c){let d=fc(b,["expireTime"]);void 0!==c&&null!=d&&fb(c,["expireTime"],d);let e=fc(b,["newSessionExpireTime"]);void 0!==c&&null!=e&&fb(c,["newSessionExpireTime"],e);let f=fc(b,["uses"]);void 0!==c&&null!=f&&fb(c,["uses"],f);let g=fc(b,["liveConnectConstraints"]);void 0!==c&&null!=g&&fb(c,["bidiGenerateContentSetup"],function(a,b){let c={},d=fc(b,["model"]);null!=d&&fb(c,["setup","model"],fH(a,d));let e=fc(b,["config"]);return null!=e&&fb(c,["config"],function(a,b){let c=fc(a,["generationConfig"]);void 0!==b&&null!=c&&fb(b,["setup","generationConfig"],c);let d=fc(a,["responseModalities"]);void 0!==b&&null!=d&&fb(b,["setup","generationConfig","responseModalities"],d);let e=fc(a,["temperature"]);void 0!==b&&null!=e&&fb(b,["setup","generationConfig","temperature"],e);let f=fc(a,["topP"]);void 0!==b&&null!=f&&fb(b,["setup","generationConfig","topP"],f);let g=fc(a,["topK"]);void 0!==b&&null!=g&&fb(b,["setup","generationConfig","topK"],g);let h=fc(a,["maxOutputTokens"]);void 0!==b&&null!=h&&fb(b,["setup","generationConfig","maxOutputTokens"],h);let i=fc(a,["mediaResolution"]);void 0!==b&&null!=i&&fb(b,["setup","generationConfig","mediaResolution"],i);let j=fc(a,["seed"]);void 0!==b&&null!=j&&fb(b,["setup","generationConfig","seed"],j);let k=fc(a,["speechConfig"]);void 0!==b&&null!=k&&fb(b,["setup","generationConfig","speechConfig"],fX(k));let l=fc(a,["thinkingConfig"]);void 0!==b&&null!=l&&fb(b,["setup","generationConfig","thinkingConfig"],l);let m=fc(a,["enableAffectiveDialog"]);void 0!==b&&null!=m&&fb(b,["setup","generationConfig","enableAffectiveDialog"],m);let o=fc(a,["systemInstruction"]);void 0!==b&&null!=o&&fb(b,["setup","systemInstruction"],function(a){let b={},c=fc(a,["parts"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["mediaResolution"]);null!=c&&fb(b,["mediaResolution"],c);let d=fc(a,["codeExecutionResult"]);null!=d&&fb(b,["codeExecutionResult"],d);let e=fc(a,["executableCode"]);null!=e&&fb(b,["executableCode"],e);let f=fc(a,["fileData"]);null!=f&&fb(b,["fileData"],function(a){let b={};if(void 0!==fc(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let c=fc(a,["fileUri"]);null!=c&&fb(b,["fileUri"],c);let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}(f));let g=fc(a,["functionCall"]);null!=g&&fb(b,["functionCall"],function(a){let b={},c=fc(a,["id"]);null!=c&&fb(b,["id"],c);let d=fc(a,["args"]);null!=d&&fb(b,["args"],d);let e=fc(a,["name"]);if(null!=e&&fb(b,["name"],e),void 0!==fc(a,["partialArgs"]))throw Error("partialArgs parameter is not supported in Gemini API.");if(void 0!==fc(a,["willContinue"]))throw Error("willContinue parameter is not supported in Gemini API.");return b}(g));let h=fc(a,["functionResponse"]);null!=h&&fb(b,["functionResponse"],h);let i=fc(a,["inlineData"]);null!=i&&fb(b,["inlineData"],function(a){let b={},c=fc(a,["data"]);if(null!=c&&fb(b,["data"],c),void 0!==fc(a,["displayName"]))throw Error("displayName parameter is not supported in Gemini API.");let d=fc(a,["mimeType"]);return null!=d&&fb(b,["mimeType"],d),b}(i));let j=fc(a,["text"]);null!=j&&fb(b,["text"],j);let k=fc(a,["thought"]);null!=k&&fb(b,["thought"],k);let l=fc(a,["thoughtSignature"]);null!=l&&fb(b,["thoughtSignature"],l);let m=fc(a,["videoMetadata"]);return null!=m&&fb(b,["videoMetadata"],m),b})(a))),fb(b,["parts"],a)}let d=fc(a,["role"]);return null!=d&&fb(b,["role"],d),b}(fS(o)));let p=fc(a,["tools"]);if(void 0!==b&&null!=p){let a=fZ(p);Array.isArray(a)&&(a=a.map(a=>(function(a){let b={},c=fc(a,["functionDeclarations"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["functionDeclarations"],a)}if(void 0!==fc(a,["retrieval"]))throw Error("retrieval parameter is not supported in Gemini API.");let d=fc(a,["googleSearchRetrieval"]);null!=d&&fb(b,["googleSearchRetrieval"],d);let e=fc(a,["computerUse"]);null!=e&&fb(b,["computerUse"],e);let f=fc(a,["fileSearch"]);null!=f&&fb(b,["fileSearch"],f);let g=fc(a,["codeExecution"]);if(null!=g&&fb(b,["codeExecution"],g),void 0!==fc(a,["enterpriseWebSearch"]))throw Error("enterpriseWebSearch parameter is not supported in Gemini API.");let h=fc(a,["googleMaps"]);null!=h&&fb(b,["googleMaps"],function(a){let b={};if(void 0!==fc(a,["authConfig"]))throw Error("authConfig parameter is not supported in Gemini API.");let c=fc(a,["enableWidget"]);return null!=c&&fb(b,["enableWidget"],c),b}(h));let i=fc(a,["googleSearch"]);null!=i&&fb(b,["googleSearch"],function(a){let b={};if(void 0!==fc(a,["excludeDomains"]))throw Error("excludeDomains parameter is not supported in Gemini API.");if(void 0!==fc(a,["blockingConfidence"]))throw Error("blockingConfidence parameter is not supported in Gemini API.");let c=fc(a,["timeRangeFilter"]);return null!=c&&fb(b,["timeRangeFilter"],c),b}(i));let j=fc(a,["urlContext"]);return null!=j&&fb(b,["urlContext"],j),b})(fY(a)))),fb(b,["setup","tools"],a)}let q=fc(a,["sessionResumption"]);void 0!==b&&null!=q&&fb(b,["setup","sessionResumption"],function(a){let b={},c=fc(a,["handle"]);if(null!=c&&fb(b,["handle"],c),void 0!==fc(a,["transparent"]))throw Error("transparent parameter is not supported in Gemini API.");return b}(q));let r=fc(a,["inputAudioTranscription"]);void 0!==b&&null!=r&&fb(b,["setup","inputAudioTranscription"],r);let s=fc(a,["outputAudioTranscription"]);void 0!==b&&null!=s&&fb(b,["setup","outputAudioTranscription"],s);let t=fc(a,["realtimeInputConfig"]);void 0!==b&&null!=t&&fb(b,["setup","realtimeInputConfig"],t);let u=fc(a,["contextWindowCompression"]);void 0!==b&&null!=u&&fb(b,["setup","contextWindowCompression"],u);let v=fc(a,["proactivity"]);if(void 0!==b&&null!=v&&fb(b,["setup","proactivity"],v),void 0!==fc(a,["explicitVadSignal"]))throw Error("explicitVadSignal parameter is not supported in Gemini API.");return{}}(e,c)),c}(a,g));let h=fc(b,["lockAdditionalFields"]);return void 0!==c&&null!=h&&fb(c,["fieldMask"],h),{}}(a,d,c)),c}(this.apiClient,a);d=fa("auth_tokens",f._url),e=f._query,delete f.config,delete f._url,delete f._query;let g=function(a,b){let c=null,d=a.bidiGenerateContentSetup;if("object"==typeof d&&null!==d&&"setup"in d){let b=d.setup;"object"==typeof b&&null!==b?(a.bidiGenerateContentSetup=b,c=b):delete a.bidiGenerateContentSetup}else void 0!==d&&delete a.bidiGenerateContentSetup;let e=a.fieldMask;if(c){let d=function(a){let b=[];for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)){let d=a[c];if("object"==typeof d&&null!=d&&Object.keys(d).length>0){let a=Object.keys(d).map(a=>`${c}.${a}`);b.push(...a)}else b.push(c)}return b.join(",")}(c);if(Array.isArray(null==b?void 0:b.lockAdditionalFields)&&(null==b?void 0:b.lockAdditionalFields.length)===0)d?a.fieldMask=d:delete a.fieldMask;else if((null==b?void 0:b.lockAdditionalFields)&&b.lockAdditionalFields.length>0&&null!==e&&Array.isArray(e)&&e.length>0){let b=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"],c=[];e.length>0&&(c=e.map(a=>b.includes(a)?`generationConfig.${a}`:a));let f=[];d&&f.push(d),c.length>0&&f.push(...c),f.length>0?a.fieldMask=f.join(","):delete a.fieldMask}else delete a.fieldMask}else null!==e&&Array.isArray(e)&&e.length>0?a.fieldMask=e.join(","):delete a.fieldMask;return a}(f,a.config);return this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(g),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}}class g1 extends e9{constructor(a){super(),this.apiClient=a,this.list=async a=>new gd(aD.PAGED_ITEM_DOCUMENTS,b=>this.listInternal({parent:a.parent,config:b.config}),await this.listInternal(a),a)}async get(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["name"]);return null!=c&&fb(b,["_url","name"],c),b}(a);return d=fa("{name}",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}async delete(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["_url","name"],c);let d=fc(a,["config"]);return null!=d&&function(a,b){let c=fc(a,["force"]);void 0!==b&&null!=c&&fb(b,["_query","force"],c)}(d,b),b}(a);d=fa("{name}",f._url),e=f._query,delete f._url,delete f._query,await this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal})}}async listInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["parent"]);null!=c&&fb(b,["_url","parent"],c);let d=fc(a,["config"]);return null!=d&&function(a,b){let c=fc(a,["pageSize"]);void 0!==b&&null!=c&&fb(b,["_query","pageSize"],c);let d=fc(a,["pageToken"]);void 0!==b&&null!=d&&fb(b,["_query","pageToken"],d)}(d,b),b}(a);return d=fa("{parent}/documents",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["nextPageToken"]);null!=d&&fb(b,["nextPageToken"],d);let e=fc(a,["documents"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["documents"],a)}return b}(a),c=new fw;return Object.assign(c,b),c})}}}class g2 extends e9{constructor(a,b=new g1(a)){super(),this.apiClient=a,this.documents=b,this.list=async(a={})=>new gd(aD.PAGED_ITEM_FILE_SEARCH_STORES,a=>this.listInternal(a),await this.listInternal(a),a)}async uploadToFileSearchStore(a){if(this.apiClient.isVertexAI())throw Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(a.fileSearchStoreName,a.file,a.config)}async create(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["config"]);return null!=c&&function(a,b){let c=fc(a,["displayName"]);void 0!==b&&null!=c&&fb(b,["displayName"],c)}(c,b),b}(a);return d=fa("fileSearchStores",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}async get(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["name"]);return null!=c&&fb(b,["_url","name"],c),b}(a);return d=fa("{name}",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>a)}}async delete(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["_url","name"],c);let d=fc(a,["config"]);return null!=d&&function(a,b){let c=fc(a,["force"]);void 0!==b&&null!=c&&fb(b,["_query","force"],c)}(d,b),b}(a);d=fa("{name}",f._url),e=f._query,delete f._url,delete f._query,await this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal})}}async listInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["config"]);return null!=c&&function(a,b){let c=fc(a,["pageSize"]);void 0!==b&&null!=c&&fb(b,["_query","pageSize"],c);let d=fc(a,["pageToken"]);void 0!==b&&null!=d&&fb(b,["_query","pageToken"],d)}(c,b),b}(a);return d=fa("fileSearchStores",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["nextPageToken"]);null!=d&&fb(b,["nextPageToken"],d);let e=fc(a,["fileSearchStores"]);if(null!=e){let a=e;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["fileSearchStores"],a)}return b}(a),c=new fx;return Object.assign(c,b),c})}}async uploadToFileSearchStoreInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["fileSearchStoreName"]);null!=c&&fb(b,["_url","file_search_store_name"],c);let d=fc(a,["config"]);return null!=d&&gI(d,b),b}(a);return d=fa("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=fc(a,["sdkHttpResponse"]);return null!=c&&fb(b,["sdkHttpResponse"],c),b}(a),c=new fy;return Object.assign(c,b),c})}}async importFile(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a){let b={},c=fc(a,["fileSearchStoreName"]);null!=c&&fb(b,["_url","file_search_store_name"],c);let d=fc(a,["fileName"]);null!=d&&fb(b,["fileName"],d);let e=fc(a,["config"]);return null!=e&&function(a,b){let c=fc(a,["customMetadata"]);if(void 0!==b&&null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),fb(b,["customMetadata"],a)}let d=fc(a,["chunkingConfig"]);void 0!==b&&null!=d&&fb(b,["chunkingConfig"],d)}(e,b),b}(a);return d=fa("{file_search_store_name}:importFile",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json()).then(a=>{let b=function(a){let b={},c=fc(a,["name"]);null!=c&&fb(b,["name"],c);let d=fc(a,["metadata"]);null!=d&&fb(b,["metadata"],d);let e=fc(a,["done"]);null!=e&&fb(b,["done"],e);let f=fc(a,["error"]);null!=f&&fb(b,["error"],f);let g=fc(a,["response"]);return null!=g&&fb(b,["response"],function(a){let b={},c=fc(a,["sdkHttpResponse"]);null!=c&&fb(b,["sdkHttpResponse"],c);let d=fc(a,["parent"]);null!=d&&fb(b,["parent"],d);let e=fc(a,["documentName"]);return null!=e&&fb(b,["documentName"],e),b}(g)),b}(a),c=new fz;return Object.assign(c,b),c})}}}let g3=function(){let{crypto:a}=globalThis;if(null==a?void 0:a.randomUUID)return g3=a.randomUUID.bind(a),a.randomUUID();let b=new Uint8Array(1),c=a?()=>a.getRandomValues(b)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,a=>(a^c()&15>>a/4).toString(16))};function g4(a){return"object"==typeof a&&null!==a&&("name"in a&&"AbortError"===a.name||"message"in a&&String(a.message).includes("FetchRequestCanceledException"))}let g5=a=>{if(a instanceof Error)return a;if("object"==typeof a&&null!==a){try{if("[object Error]"===Object.prototype.toString.call(a)){let b=Error(a.message,a.cause?{cause:a.cause}:{});return a.stack&&(b.stack=a.stack),a.cause&&!b.cause&&(b.cause=a.cause),a.name&&(b.name=a.name),b}}catch(a){}try{return Error(JSON.stringify(a))}catch(a){}}return Error(a)};class g6 extends Error{}class g7 extends g6{constructor(a,b,c,d){super(`${g7.makeMessage(a,b,c)}`),this.status=a,this.headers=d,this.error=b}static makeMessage(a,b,c){let d=(null==b?void 0:b.message)?"string"==typeof b.message?b.message:JSON.stringify(b.message):b?JSON.stringify(b):c;return a&&d?`${a} ${d}`:a?`${a} status code (no body)`:d||"(no status code or body)"}static generate(a,b,c,d){return a&&d?400===a?new hb(a,b,c,d):401===a?new hc(a,b,c,d):403===a?new hd(a,b,c,d):404===a?new he(a,b,c,d):409===a?new hf(a,b,c,d):422===a?new hg(a,b,c,d):429===a?new hh(a,b,c,d):a>=500?new hi(a,b,c,d):new g7(a,b,c,d):new g9({message:c,cause:g5(b)})}}class g8 extends g7{constructor({message:a}={}){super(void 0,void 0,a||"Request was aborted.",void 0)}}class g9 extends g7{constructor({message:a,cause:b}){super(void 0,void 0,a||"Connection error.",void 0),b&&(this.cause=b)}}class ha extends g9{constructor({message:a}={}){super({message:null!=a?a:"Request timed out."})}}class hb extends g7{}class hc extends g7{}class hd extends g7{}class he extends g7{}class hf extends g7{}class hg extends g7{}class hh extends g7{}class hi extends g7{}let hj=/^[a-z][a-z0-9+.-]*:/i,hk=a=>(hk=Array.isArray)(a),hl=hk,hm="0.0.1",hn=a=>"x32"===a?"x32":"x86_64"===a||"x64"===a?"x64":"arm"===a?"arm":"aarch64"===a||"arm64"===a?"arm64":a?`other:${a}`:"unknown",ho=a=>(a=a.toLowerCase()).includes("ios")?"iOS":"android"===a?"Android":"darwin"===a?"MacOS":"win32"===a?"Windows":"freebsd"===a?"FreeBSD":"openbsd"===a?"OpenBSD":"linux"===a?"Linux":a?`Other:${a}`:"Unknown";function hp(...a){let b=globalThis.ReadableStream;if(void 0===b)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new b(...a)}function hq(a){if(a[Symbol.asyncIterator])return a;let b=a.getReader();return{async next(){try{let a=await b.read();return(null==a?void 0:a.done)&&b.releaseLock(),a}catch(a){throw b.releaseLock(),a}},async return(){let a=b.cancel();return b.releaseLock(),await a,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function hr(a){var b,c;if(null===a||"object"!=typeof a)return;if(a[Symbol.asyncIterator])return void await (null==(c=(b=a[Symbol.asyncIterator]()).return)?void 0:c.call(b));let d=a.getReader(),e=d.cancel();d.releaseLock(),await e}let hs=({headers:a,body:b})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(b)}),ht=()=>{var a;if("undefined"==typeof File){let{process:b}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof(null==(a=null==b?void 0:b.versions)?void 0:a.node)&&20>parseInt(b.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function hu(a,b,c){return ht(),new File(a,null!=b?b:"unknown_file",c)}let hv=a=>null!=a&&"object"==typeof a&&"number"==typeof a.size&&"string"==typeof a.type&&"function"==typeof a.text&&"function"==typeof a.slice&&"function"==typeof a.arrayBuffer;async function hw(a,b,c){var d;let e,f;if(ht(),null!=(e=a=await a)&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&hv(e))return a instanceof File?a:hu([await a.arrayBuffer()],a.name);if(null!=(f=a)&&"object"==typeof f&&"string"==typeof f.url&&"function"==typeof f.blob){let d=await a.blob();return b||(b=new URL(a.url).pathname.split(/[\\/]/).pop()),hu(await hx(d),b,c)}let g=await hx(a);if(b||(b=("object"==typeof(d=a)&&null!==d&&("name"in d&&d.name&&String(d.name)||"url"in d&&d.url&&String(d.url)||"filename"in d&&d.filename&&String(d.filename)||"path"in d&&d.path&&String(d.path))||"").split(/[\\/]/).pop()||void 0),!(null==c?void 0:c.type)){let a=g.find(a=>"object"==typeof a&&"type"in a&&a.type);"string"==typeof a&&(c=Object.assign(Object.assign({},c),{type:a}))}return hu(g,b,c)}async function hx(a){let b=[];if("string"==typeof a||ArrayBuffer.isView(a)||a instanceof ArrayBuffer)b.push(a);else if(hv(a))b.push(a instanceof Blob?a:await a.arrayBuffer());else if(null!=a&&"object"==typeof a&&"function"==typeof a[Symbol.asyncIterator])try{for(var c,d,e,f,g,h,i=!0,j=gk(a);!(c=(h=await j.next()).done);i=!0)f=h.value,i=!1,b.push(...await hx(f))}catch(a){d={error:a}}finally{try{!i&&!c&&(e=j.return)&&await e.call(j)}finally{if(d)throw d.error}}else{let b=null==(g=null==a?void 0:a.constructor)?void 0:g.name;throw Error(`Unexpected data type: ${typeof a}${b?`; constructor: ${b}`:""}${function(a){if("object"!=typeof a||null===a)return"";let b=Object.getOwnPropertyNames(a);return`; props: [${b.map(a=>`"${a}"`).join(", ")}]`}(a)}`)}return b}class hy{constructor(a){this._client=a}}function hz(a){return a.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}hy._key=[];let hA=Object.freeze(Object.create(null)),hB=((a=hz)=>function(b,...c){let d;if(1===b.length)return b[0];let e=!1,f=[],g=b.reduce((b,d,g)=>{var h,i,j;/[?#]/.test(d)&&(e=!0);let k=c[g],l=(e?encodeURIComponent:a)(""+k);return g!==c.length&&(null==k||"object"==typeof k&&k.toString===(null==(j=Object.getPrototypeOf(null!=(i=Object.getPrototypeOf(null!=(h=k.hasOwnProperty)?h:hA))?i:hA))?void 0:j.toString))&&(l=k+"",f.push({start:b.length+d.length,length:l.length,error:`Value of type ${Object.prototype.toString.call(k).slice(8,-1)} is not a valid path parameter`})),b+d+(g===c.length?"":l)},""),h=g.split(/[?#]/,1)[0],i=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(d=i.exec(h));)f.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(f.sort((a,b)=>a.start-b.start),f.length>0){let a=0,b=f.reduce((b,c)=>{let d=" ".repeat(c.start-a),e="^".repeat(c.length);return a=c.start+c.length,b+d+e},"");throw new g6(`Path parameters result in path with invalid segments:
${f.map(a=>a.error).join("\n")}
${g}
${b}`)}return g})(hz);class hC extends hy{create(a,b){var c;let{api_version:d=this._client.apiVersion}=a,e=gh(a,["api_version"]);if("model"in e&&"agent_config"in e)throw new g6("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in e&&"generation_config"in e)throw new g6("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(hB`/${d}/interactions`,Object.assign(Object.assign({body:e},b),{stream:null!=(c=a.stream)&&c}))}delete(a,b={},c){let{api_version:d=this._client.apiVersion}=null!=b?b:{};return this._client.delete(hB`/${d}/interactions/${a}`,c)}cancel(a,b={},c){let{api_version:d=this._client.apiVersion}=null!=b?b:{};return this._client.post(hB`/${d}/interactions/${a}/cancel`,c)}get(a,b={},c){var d;let e=null!=b?b:{},{api_version:f=this._client.apiVersion}=e,g=gh(e,["api_version"]);return this._client.get(hB`/${f}/interactions/${a}`,Object.assign(Object.assign({query:g},c),{stream:null!=(d=null==b?void 0:b.stream)&&d}))}}hC._key=Object.freeze(["interactions"]);class hD extends hC{}function hE(a){let b;return(null!=g?g:g=(b=new globalThis.TextEncoder).encode.bind(b))(a)}function hF(a){let b;return(null!=h?h:h=(b=new globalThis.TextDecoder).decode.bind(b))(a)}class hG{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(a){let b;if(null==a)return[];let c=a instanceof ArrayBuffer?new Uint8Array(a):"string"==typeof a?hE(a):a;this.buffer=function(a){let b=0;for(let c of a)b+=c.length;let c=new Uint8Array(b),d=0;for(let b of a)c.set(b,d),d+=b.length;return c}([this.buffer,c]);let d=[];for(;null!=(b=function(a,b){for(let c=null!=b?b:0;c<a.length;c++){if(10===a[c])return{preceding:c,index:c+1,carriage:!1};if(13===a[c])return{preceding:c,index:c+1,carriage:!0}}return null}(this.buffer,this.carriageReturnIndex));){if(b.carriage&&null==this.carriageReturnIndex){this.carriageReturnIndex=b.index;continue}if(null!=this.carriageReturnIndex&&(b.index!==this.carriageReturnIndex+1||b.carriage)){d.push(hF(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}let a=null!==this.carriageReturnIndex?b.preceding-1:b.preceding,c=hF(this.buffer.subarray(0,a));d.push(c),this.buffer=this.buffer.subarray(b.index),this.carriageReturnIndex=null}return d}flush(){return this.buffer.length?this.decode("\n"):[]}}hG.NEWLINE_CHARS=new Set(["\n","\r"]),hG.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let hH={off:0,error:200,warn:300,info:400,debug:500},hI=(a,b,c)=>{if(a){if(Object.prototype.hasOwnProperty.call(hH,a))return a;hN(c).warn(`${b} was set to ${JSON.stringify(a)}, expected one of ${JSON.stringify(Object.keys(hH))}`)}};function hJ(){}function hK(a,b,c){return!b||hH[a]>hH[c]?hJ:b[a].bind(b)}let hL={error:hJ,warn:hJ,info:hJ,debug:hJ},hM=new WeakMap;function hN(a){var b;let c=a.logger,d=null!=(b=a.logLevel)?b:"off";if(!c)return hL;let e=hM.get(c);if(e&&e[0]===d)return e[1];let f={error:hK("error",c,d),warn:hK("warn",c,d),info:hK("info",c,d),debug:hK("debug",c,d)};return hM.set(c,[d,f]),f}let hO=a=>(a.options&&(a.options=Object.assign({},a.options),delete a.options.headers),a.headers&&(a.headers=Object.fromEntries((a.headers instanceof Headers?[...a.headers]:Object.entries(a.headers)).map(([a,b])=>[a,"x-goog-api-key"===a.toLowerCase()||"authorization"===a.toLowerCase()||"cookie"===a.toLowerCase()||"set-cookie"===a.toLowerCase()?"***":b]))),"retryOfRequestLogID"in a&&(a.retryOfRequestLogID&&(a.retryOf=a.retryOfRequestLogID),delete a.retryOfRequestLogID),a);class hP{constructor(a,b,c){this.iterator=a,this.controller=b,this.client=c}static fromSSEResponse(a,b,c){let d=!1,e=c?hN(c):console;return new hP(function(){return gj(this,arguments,function*(){var c,f,g,h;if(d)throw new g6("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");d=!0;let i=!1;try{try{for(var j,k=!0,l=gk(function(a,b){return gj(this,arguments,function*(){var c,d,e,f;if(!a.body){if(b.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new g6("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new g6("Attempted to iterate over a response with no body")}let g=new hQ,h=new hG,i=hq(a.body);try{for(var j,k=!0,l=gk(function(a){return gj(this,arguments,function*(){var b,c,d,e;let f=new Uint8Array;try{for(var g,h=!0,i=gk(a);!(b=(g=yield gi(i.next())).done);h=!0){let a;if(e=g.value,h=!1,null==e)continue;let b=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?hE(e):e,c=new Uint8Array(f.length+b.length);for(c.set(f),c.set(b,f.length),f=c;-1!==(a=function(a){for(let b=0;b<a.length-1;b++){if(10===a[b]&&10===a[b+1]||13===a[b]&&13===a[b+1])return b+2;if(13===a[b]&&10===a[b+1]&&b+3<a.length&&13===a[b+2]&&10===a[b+3])return b+4}return -1}(f));)yield yield gi(f.slice(0,a)),f=f.slice(a)}}catch(a){c={error:a}}finally{try{!h&&!b&&(d=i.return)&&(yield gi(d.call(i)))}finally{if(c)throw c.error}}f.length>0&&(yield yield gi(f))})}(i));!(c=(j=yield gi(l.next())).done);k=!0)for(let a of(f=j.value,k=!1,h.decode(f))){let b=g.decode(a);b&&(yield yield gi(b))}}catch(a){d={error:a}}finally{try{!k&&!c&&(e=l.return)&&(yield gi(e.call(l)))}finally{if(d)throw d.error}}for(let a of h.flush()){let b=g.decode(a);b&&(yield yield gi(b))}})}(a,b));!(c=(j=yield gi(l.next())).done);k=!0)if(h=j.value,k=!1,!i)if(h.data.startsWith("[DONE]")){i=!0;continue}else try{yield yield gi(JSON.parse(h.data))}catch(a){throw e.error("Could not parse message into JSON:",h.data),e.error("From chunk:",h.raw),a}}catch(a){f={error:a}}finally{try{!k&&!c&&(g=l.return)&&(yield gi(g.call(l)))}finally{if(f)throw f.error}}i=!0}catch(a){if(g4(a))return yield gi(void 0);throw a}finally{i||b.abort()}})},b,c)}static fromReadableStream(a,b,c){let d=!1;return new hP(function(){return gj(this,arguments,function*(){var c,e,f,g;if(d)throw new g6("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");d=!0;let h=!1;try{try{for(var i,j=!0,k=gk(function(){return gj(this,arguments,function*(){var b,c,d,e;let f=new hG,g=hq(a);try{for(var h,i=!0,j=gk(g);!(b=(h=yield gi(j.next())).done);i=!0)for(let a of(e=h.value,i=!1,f.decode(e)))yield yield gi(a)}catch(a){c={error:a}}finally{try{!i&&!b&&(d=j.return)&&(yield gi(d.call(j)))}finally{if(c)throw c.error}}for(let a of f.flush())yield yield gi(a)})}());!(c=(i=yield gi(k.next())).done);j=!0)g=i.value,j=!1,!h&&g&&(yield yield gi(JSON.parse(g)))}catch(a){e={error:a}}finally{try{!j&&!c&&(f=k.return)&&(yield gi(f.call(k)))}finally{if(e)throw e.error}}h=!0}catch(a){if(g4(a))return yield gi(void 0);throw a}finally{h||b.abort()}})},b,c)}[Symbol.asyncIterator](){return this.iterator()}tee(){let a=[],b=[],c=this.iterator(),d=d=>({next:()=>{if(0===d.length){let d=c.next();a.push(d),b.push(d)}return d.shift()}});return[new hP(()=>d(a),this.controller,this.client),new hP(()=>d(b),this.controller,this.client)]}toReadableStream(){let a,b=this;return hp({async start(){a=b[Symbol.asyncIterator]()},async pull(b){try{let{value:c,done:d}=await a.next();if(d)return b.close();let e=hE(JSON.stringify(c)+"\n");b.enqueue(e)}catch(a){b.error(a)}},async cancel(){var b;await (null==(b=a.return)?void 0:b.call(a))}})}}class hQ{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(a){if(a.endsWith("\r")&&(a=a.substring(0,a.length-1)),!a){if(!this.event&&!this.data.length)return null;let a={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(a),a.startsWith(":"))return null;let[b,c,d]=function(a,b){let c=a.indexOf(":");return -1!==c?[a.substring(0,c),b,a.substring(c+b.length)]:[a,"",""]}(a,":");return d.startsWith(" ")&&(d=d.substring(1)),"event"===b?this.event=d:"data"===b&&this.data.push(d),null}}async function hR(a,b){let{response:c,requestLogID:d,retryOfRequestLogID:e,startTime:f}=b,g=await (async()=>{var d;if(b.options.stream)return(hN(a).debug("response",c.status,c.url,c.headers,c.body),b.options.__streamClass)?b.options.__streamClass.fromSSEResponse(c,b.controller,a):hP.fromSSEResponse(c,b.controller,a);if(204===c.status)return null;if(b.options.__binaryResponse)return c;let e=c.headers.get("content-type"),f=null==(d=null==e?void 0:e.split(";")[0])?void 0:d.trim();return(null==f?void 0:f.includes("application/json"))||(null==f?void 0:f.endsWith("+json"))?await c.json():await c.text()})();return hN(a).debug(`[${d}] response parsed`,hO({retryOfRequestLogID:e,url:c.url,status:c.status,body:g,durationMs:Date.now()-f})),g}class hS extends Promise{constructor(a,b,c=hR){super(a=>{a(null)}),this.responsePromise=b,this.parseResponse=c,this.client=a}_thenUnwrap(a){return new hS(this.client,this.responsePromise,async(b,c)=>a(await this.parseResponse(b,c),c))}asResponse(){return this.responsePromise.then(a=>a.response)}async withResponse(){let[a,b]=await Promise.all([this.parse(),this.asResponse()]);return{data:a,response:b}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(a=>this.parseResponse(this.client,a))),this.parsedPromise}then(a,b){return this.parse().then(a,b)}catch(a){return this.parse().catch(a)}finally(a){return this.parse().finally(a)}}let hT=Symbol("brand.privateNullableHeaders"),hU=a=>{let b=new Headers,c=new Set;for(let d of a){let a=new Set;for(let[e,f]of function*(a){let b;if(!a)return;if(hT in a){let{values:b,nulls:c}=a;for(let a of(yield*b.entries(),c))yield[a,null];return}let c=!1;for(let d of(a instanceof Headers?b=a.entries():hl(a)?b=a:(c=!0,b=Object.entries(null!=a?a:{})),b)){let a=d[0];if("string"!=typeof a)throw TypeError("expected header name to be a string");let b=hl(d[1])?d[1]:[d[1]],e=!1;for(let d of b)void 0!==d&&(c&&!e&&(e=!0,yield[a,null]),yield[a,d])}}(d)){let d=e.toLowerCase();a.has(d)||(b.delete(e),a.add(d)),null===f?(b.delete(e),c.add(d)):(b.append(e,f),c.delete(d))}}return{[hT]:!0,values:b,nulls:c}},hV=a=>{var b,c,d,e,f,g;return void 0!==globalThis.process?null!=(d=null==(c=null==(b=globalThis.process.env)?void 0:b[a])?void 0:c.trim())?d:void 0:void 0!==globalThis.Deno?null==(g=null==(f=null==(e=globalThis.Deno.env)?void 0:e.get)?void 0:f.call(e,a))?void 0:g.trim():void 0};class hW{constructor(a){var b,c,d,e,f,g,h,{baseURL:i=hV("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:j=null!=(b=hV("GEMINI_API_KEY"))?b:null,apiVersion:k="v1beta"}=a;let l=Object.assign(Object.assign({apiKey:j,apiVersion:k},gh(a,["baseURL","apiKey","apiVersion"])),{baseURL:i||"https://generativelanguage.googleapis.com"});this.baseURL=l.baseURL,this.timeout=null!=(c=l.timeout)?c:hW.DEFAULT_TIMEOUT,this.logger=null!=(d=l.logger)?d:console;let m="warn";this.logLevel=m,this.logLevel=null!=(f=null!=(e=hI(l.logLevel,"ClientOptions.logLevel",this))?e:hI(hV("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))?f:m,this.fetchOptions=l.fetchOptions,this.maxRetries=null!=(g=l.maxRetries)?g:2,this.fetch=null!=(h=l.fetch)?h:function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),this.encoder=hs,this._options=l,this.apiKey=j,this.apiVersion=k,this.clientAdapter=l.clientAdapter}withOptions(a){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),a))}baseURLOverridden(){return"https://generativelanguage.googleapis.com"!==this.baseURL}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:a,nulls:b}){if(!(a.has("authorization")||a.has("x-goog-api-key")||this.apiKey&&a.get("x-goog-api-key"))&&!b.has("x-goog-api-key"))throw Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(a){let b=hU([a.headers]);if(!(b.values.has("authorization")||b.values.has("x-goog-api-key"))){if(this.apiKey)return hU([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return hU([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(a){return Object.entries(a).filter(([a,b])=>void 0!==b).map(([a,b])=>{if("string"==typeof b||"number"==typeof b||"boolean"==typeof b)return`${encodeURIComponent(a)}=${encodeURIComponent(b)}`;if(null===b)return`${encodeURIComponent(a)}=`;throw new g6(`Cannot stringify type ${typeof b}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${hm}`}defaultIdempotencyKey(){return`stainless-node-retry-${g3()}`}makeStatusError(a,b,c,d){return g7.generate(a,b,c,d)}buildURL(a,b,c){let d=!this.baseURLOverridden()&&c||this.baseURL,e=new URL(hj.test(a)?a:d+(d.endsWith("/")&&a.startsWith("/")?a.slice(1):a)),f=this.defaultQuery();return!function(a){if(!a)return!0;for(let b in a)return!1;return!0}(f)&&(b=Object.assign(Object.assign({},f),b)),"object"==typeof b&&b&&!Array.isArray(b)&&(e.search=this.stringifyQuery(b)),e.toString()}async prepareOptions(a){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!a.path.startsWith(`/${this.apiVersion}/projects/`)){let b=a.path.slice(this.apiVersion.length+1);a.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${b}`}}async prepareRequest(a,{url:b,options:c}){}get(a,b){return this.methodRequest("get",a,b)}post(a,b){return this.methodRequest("post",a,b)}patch(a,b){return this.methodRequest("patch",a,b)}put(a,b){return this.methodRequest("put",a,b)}delete(a,b){return this.methodRequest("delete",a,b)}methodRequest(a,b,c){return this.request(Promise.resolve(c).then(c=>Object.assign({method:a,path:b},c)))}request(a,b=null){return new hS(this,this.makeRequest(a,b,void 0))}async makeRequest(a,b,c){var d,e,f;let g=await a,h=null!=(d=g.maxRetries)?d:this.maxRetries;null==b&&(b=h),await this.prepareOptions(g);let{req:i,url:j,timeout:k}=await this.buildRequest(g,{retryCount:h-b});await this.prepareRequest(i,{url:j,options:g});let l="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),m=void 0===c?"":`, retryOf: ${c}`,o=Date.now();if(hN(this).debug(`[${l}] sending request`,hO({retryOfRequestLogID:c,method:g.method,url:j,options:g,headers:i.headers})),null==(e=g.signal)?void 0:e.aborted)throw new g8;let p=new AbortController,q=await this.fetchWithTimeout(j,i,k,p).catch(g5),r=Date.now();if(q instanceof globalThis.Error){let a=`retrying, ${b} attempts remaining`;if(null==(f=g.signal)?void 0:f.aborted)throw new g8;let d=g4(q)||/timed? ?out/i.test(String(q)+("cause"in q?String(q.cause):""));if(b)return hN(this).info(`[${l}] connection ${d?"timed out":"failed"} - ${a}`),hN(this).debug(`[${l}] connection ${d?"timed out":"failed"} (${a})`,hO({retryOfRequestLogID:c,url:j,durationMs:r-o,message:q.message})),this.retryRequest(g,b,null!=c?c:l);if(hN(this).info(`[${l}] connection ${d?"timed out":"failed"} - error; no more retries left`),hN(this).debug(`[${l}] connection ${d?"timed out":"failed"} (error; no more retries left)`,hO({retryOfRequestLogID:c,url:j,durationMs:r-o,message:q.message})),d)throw new ha;throw new g9({cause:q})}let s=`[${l}${m}] ${i.method} ${j} ${q.ok?"succeeded":"failed"} with status ${q.status} in ${r-o}ms`;if(!q.ok){let a=await this.shouldRetry(q);if(b&&a){let a=`retrying, ${b} attempts remaining`;return await hr(q.body),hN(this).info(`${s} - ${a}`),hN(this).debug(`[${l}] response error (${a})`,hO({retryOfRequestLogID:c,url:q.url,status:q.status,headers:q.headers,durationMs:r-o})),this.retryRequest(g,b,null!=c?c:l,q.headers)}let d=a?"error; no more retries left":"error; not retryable";hN(this).info(`${s} - ${d}`);let e=await q.text().catch(a=>g5(a).message),f=(a=>{try{return JSON.parse(a)}catch(a){return}})(e),h=f?void 0:e;throw hN(this).debug(`[${l}] response error (${d})`,hO({retryOfRequestLogID:c,url:q.url,status:q.status,headers:q.headers,message:h,durationMs:Date.now()-o})),this.makeStatusError(q.status,f,h,q.headers)}return hN(this).info(s),hN(this).debug(`[${l}] response start`,hO({retryOfRequestLogID:c,url:q.url,status:q.status,headers:q.headers,durationMs:r-o})),{response:q,options:g,controller:p,requestLogID:l,retryOfRequestLogID:c,startTime:o}}async fetchWithTimeout(a,b,c,d){let e=b||{},{signal:f,method:g}=e,h=gh(e,["signal","method"]);f&&f.addEventListener("abort",()=>d.abort());let i=setTimeout(()=>d.abort(),c),j=globalThis.ReadableStream&&h.body instanceof globalThis.ReadableStream||"object"==typeof h.body&&null!==h.body&&Symbol.asyncIterator in h.body,k=Object.assign(Object.assign(Object.assign({signal:d.signal},j?{duplex:"half"}:{}),{method:"GET"}),h);g&&(k.method=g.toUpperCase());try{return await this.fetch.call(void 0,a,k)}finally{clearTimeout(i)}}async shouldRetry(a){let b=a.headers.get("x-should-retry");return"true"===b||"false"!==b&&(408===a.status||409===a.status||429===a.status||!!(a.status>=500))}async retryRequest(a,b,c,d){var e;let f,g,h=null==d?void 0:d.get("retry-after-ms");if(h){let a=parseFloat(h);Number.isNaN(a)||(f=a)}let i=null==d?void 0:d.get("retry-after");if(i&&!f){let a=parseFloat(i);f=Number.isNaN(a)?Date.parse(i)-Date.now():1e3*a}if(!(f&&0<=f&&f<6e4)){let c=null!=(e=a.maxRetries)?e:this.maxRetries;f=this.calculateDefaultRetryTimeoutMillis(b,c)}return await (g=f,new Promise(a=>setTimeout(a,g))),this.makeRequest(a,b-1,c)}calculateDefaultRetryTimeoutMillis(a,b){return Math.min(.5*Math.pow(2,b-a),8)*(1-.25*Math.random())*1e3}async buildRequest(a,{retryCount:b=0}={}){var c,d,e;let f=Object.assign({},a),{method:g,path:h,query:i,defaultBaseURL:j}=f,k=this.buildURL(h,i,j);"timeout"in f&&((a,b)=>{if("number"!=typeof b||!Number.isInteger(b))throw new g6(`${a} must be an integer`);if(b<0)throw new g6(`${a} must be a positive integer`)})("timeout",f.timeout),f.timeout=null!=(c=f.timeout)?c:this.timeout;let{bodyHeaders:l,body:m}=this.buildBody({options:f}),o=await this.buildHeaders({options:a,method:g,bodyHeaders:l,retryCount:b});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:g,headers:o},f.signal&&{signal:f.signal}),globalThis.ReadableStream&&m instanceof globalThis.ReadableStream&&{duplex:"half"}),m&&{body:m}),null!=(d=this.fetchOptions)?d:{}),null!=(e=f.fetchOptions)?e:{}),url:k,timeout:f.timeout}}async buildHeaders({options:a,method:b,bodyHeaders:c,retryCount:d}){let e={};this.idempotencyHeader&&"get"!==b&&(a.idempotencyKey||(a.idempotencyKey=this.defaultIdempotencyKey()),e[this.idempotencyHeader]=a.idempotencyKey);let g=await this.authHeaders(a),h=hU([e,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(d)},a.timeout?{"X-Stainless-Timeout":String(Math.trunc(a.timeout/1e3))}:{}),null!=f?f:f=(()=>{var a,b,c,d,e;let f="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===f)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":hm,"X-Stainless-OS":ho(Deno.build.os),"X-Stainless-Arch":hn(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:null!=(b=null==(a=Deno.version)?void 0:a.deno)?b:"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":hm,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===f)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":hm,"X-Stainless-OS":ho(null!=(c=globalThis.process.platform)?c:"unknown"),"X-Stainless-Arch":hn(null!=(d=globalThis.process.arch)?d:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":null!=(e=globalThis.process.version)?e:"unknown"};let g=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:a,pattern:b}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let c=b.exec(navigator.userAgent);if(c){let b=c[1]||0,d=c[2]||0,e=c[3]||0;return{browser:a,version:`${b}.${d}.${e}`}}}return null}();return g?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":hm,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${g.browser}`,"X-Stainless-Runtime-Version":g.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":hm,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),this._options.defaultHeaders,c,a.headers,g]);return this.validateHeaders(h),h.values}buildBody({options:{body:a,headers:b}}){let c;if(!a)return{bodyHeaders:void 0,body:void 0};let d=hU([b]);if(ArrayBuffer.isView(a)||a instanceof ArrayBuffer||a instanceof DataView||"string"==typeof a&&d.values.has("content-type")||globalThis.Blob&&a instanceof globalThis.Blob||a instanceof FormData||a instanceof URLSearchParams||globalThis.ReadableStream&&a instanceof globalThis.ReadableStream)return{bodyHeaders:void 0,body:a};if("object"!=typeof a||!(Symbol.asyncIterator in a)&&(!(Symbol.iterator in a)||!("next"in a)||"function"!=typeof a.next))return this.encoder({body:a,headers:d});return{bodyHeaders:void 0,body:(c=Symbol.asyncIterator in a?a[Symbol.asyncIterator]():a[Symbol.iterator](),hp({start(){},async pull(a){let{done:b,value:d}=await c.next();b?a.close():a.enqueue(d)},async cancel(){var a;await (null==(a=c.return)?void 0:a.call(c))}}))}}}hW.DEFAULT_TIMEOUT=6e4;class hX extends hW{constructor(){super(...arguments),this.interactions=new hD(this)}}hX.GeminiNextGenAPIClient=hX,hX.GeminiNextGenAPIClientError=g6,hX.APIError=g7,hX.APIConnectionError=g9,hX.APIConnectionTimeoutError=ha,hX.APIUserAbortError=g8,hX.NotFoundError=he,hX.ConflictError=hf,hX.RateLimitError=hh,hX.BadRequestError=hb,hX.AuthenticationError=hc,hX.InternalServerError=hi,hX.PermissionDeniedError=hd,hX.UnprocessableEntityError=hg,hX.toFile=hw,hX.Interactions=hD;let hY="x-goog-api-key",hZ="https://www.googleapis.com/auth/cloud-platform";class h${constructor(a){if(void 0!==a.apiKey){this.apiKey=a.apiKey;return}let b=function(a){let b;if(!a)return{scopes:[hZ]};if((b=a).scopes){if("string"==typeof b.scopes&&b.scopes!==hZ||Array.isArray(b.scopes)&&0>b.scopes.indexOf(hZ))throw Error(`Invalid auth scopes. Scopes must include: ${hZ}`)}else b.scopes=[hZ];return b}(a.googleAuthOptions);this.googleAuth=new e2.kF(b)}async addAuthHeaders(a,b){if(void 0!==this.apiKey){if(this.apiKey.startsWith("auth_tokens/"))throw Error("Ephemeral tokens are only supported by the live API.");this.addKeyHeader(a);return}return this.addGoogleAuthHeaders(a,b)}addKeyHeader(a){if(null===a.get(hY)){if(void 0===this.apiKey)throw Error("Trying to set API key header but apiKey is not set");a.append(hY,this.apiKey)}}async addGoogleAuthHeaders(a,b){if(void 0===this.googleAuth)throw Error("Trying to set google-auth headers but googleAuth is unset");for(let[c,d]of(await this.googleAuth.getRequestHeaders(b)))null===a.get(c)&&a.append(c,d)}}class h_{async download(a,b){if(a.downloadPath){let c=await h0(a,b);if(c instanceof ff){let b=(0,e3.createWriteStream)(a.downloadPath);e5.Readable.fromWeb(c.responseInternal.body).pipe(b),await (0,e6.finished)(b)}else try{await (0,e4.writeFile)(a.downloadPath,c,{encoding:"base64"})}catch(b){throw Error(`Failed to write file to ${a.downloadPath}: ${b}`)}}}}async function h0(a,b){var c,d,e;let f=f2(a.file);if(void 0!==f)return await b.request({path:`files/${f}:download`,httpMethod:"GET",queryParams:{alt:"media"},httpOptions:null==(c=a.config)?void 0:c.httpOptions,abortSignal:null==(d=a.config)?void 0:d.abortSignal});if(f0(a.file)){let b=null==(e=a.file.video)?void 0:e.videoBytes;if("string"==typeof b)return b;throw Error("Failed to download generated video, Uri or videoBytes not found.")}if(f1(a.file)){let b=a.file.videoBytes;if("string"==typeof b)return b;throw Error("Failed to download video, Uri or videoBytes not found.")}throw Error("Unsupported file type")}class h1{create(a,b,c){return new h2(a,b,c)}}class h2{constructor(a,b,c){this.url=a,this.headers=b,this.callbacks=c}connect(){this.ws=new e7(this.url,{headers:this.headers}),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(a){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.send(a)}close(){if(void 0===this.ws)throw Error("WebSocket is not connected");this.ws.close()}}function h3(a,b){let c={},d=fc(a,["sdkHttpResponse"]);null!=d&&fb(c,["sdkHttpResponse"],d);let e=fc(a,["name"]);null!=e&&fb(c,["name"],e);let f=fc(a,["state"]);null!=f&&fb(c,["state"],f_(f));let g=fc(a,["createTime"]);null!=g&&fb(c,["createTime"],g);let h=fc(a,["tuningTask","startTime"]);null!=h&&fb(c,["startTime"],h);let i=fc(a,["tuningTask","completeTime"]);null!=i&&fb(c,["endTime"],i);let j=fc(a,["updateTime"]);null!=j&&fb(c,["updateTime"],j);let k=fc(a,["description"]);null!=k&&fb(c,["description"],k);let l=fc(a,["baseModel"]);null!=l&&fb(c,["baseModel"],l);let m=fc(a,["_self"]);return null!=m&&fb(c,["tunedModel"],function(a,b){let c={},d=fc(a,["name"]);null!=d&&fb(c,["model"],d);let e=fc(a,["name"]);return null!=e&&fb(c,["endpoint"],e),c}(m)),c}function h4(a,b){let c={},d=fc(a,["sdkHttpResponse"]);null!=d&&fb(c,["sdkHttpResponse"],d);let e=fc(a,["name"]);null!=e&&fb(c,["name"],e);let f=fc(a,["state"]);null!=f&&fb(c,["state"],f_(f));let g=fc(a,["createTime"]);null!=g&&fb(c,["createTime"],g);let h=fc(a,["startTime"]);null!=h&&fb(c,["startTime"],h);let i=fc(a,["endTime"]);null!=i&&fb(c,["endTime"],i);let j=fc(a,["updateTime"]);null!=j&&fb(c,["updateTime"],j);let k=fc(a,["error"]);null!=k&&fb(c,["error"],k);let l=fc(a,["description"]);null!=l&&fb(c,["description"],l);let m=fc(a,["baseModel"]);null!=m&&fb(c,["baseModel"],m);let o=fc(a,["tunedModel"]);null!=o&&fb(c,["tunedModel"],o);let p=fc(a,["preTunedModel"]);null!=p&&fb(c,["preTunedModel"],p);let q=fc(a,["supervisedTuningSpec"]);null!=q&&fb(c,["supervisedTuningSpec"],q);let r=fc(a,["preferenceOptimizationSpec"]);null!=r&&fb(c,["preferenceOptimizationSpec"],r);let s=fc(a,["tuningDataStats"]);null!=s&&fb(c,["tuningDataStats"],s);let t=fc(a,["encryptionSpec"]);null!=t&&fb(c,["encryptionSpec"],t);let u=fc(a,["partnerModelTuningSpec"]);null!=u&&fb(c,["partnerModelTuningSpec"],u);let v=fc(a,["customBaseModel"]);null!=v&&fb(c,["customBaseModel"],v);let w=fc(a,["experiment"]);null!=w&&fb(c,["experiment"],w);let x=fc(a,["labels"]);null!=x&&fb(c,["labels"],x);let y=fc(a,["outputUri"]);null!=y&&fb(c,["outputUri"],y);let z=fc(a,["pipelineJob"]);null!=z&&fb(c,["pipelineJob"],z);let A=fc(a,["serviceAccount"]);null!=A&&fb(c,["serviceAccount"],A);let B=fc(a,["tunedModelDisplayName"]);null!=B&&fb(c,["tunedModelDisplayName"],B);let C=fc(a,["veoTuningSpec"]);return null!=C&&fb(c,["veoTuningSpec"],C),c}function h5(a,b){let c={},d=fc(a,["gcsUri"]);null!=d&&fb(c,["validationDatasetUri"],d);let e=fc(a,["vertexDatasetResource"]);return null!=e&&fb(c,["validationDatasetUri"],e),c}class h6 extends e9{constructor(a){super(),this.apiClient=a,this.list=async(a={})=>new gd(aD.PAGED_ITEM_TUNING_JOBS,a=>this.listInternal(a),await this.listInternal(a),a),this.get=async a=>await this.getInternal(a),this.tune=async a=>{var b;if(this.apiClient.isVertexAI())if(a.baseModel.startsWith("projects/")){let c={tunedModelName:a.baseModel};(null==(b=a.config)?void 0:b.preTunedModelCheckpointId)&&(c.checkpointId=a.config.preTunedModelCheckpointId);let d=Object.assign(Object.assign({},a),{preTunedModel:c});return d.baseModel=void 0,await this.tuneInternal(d)}else{let b=Object.assign({},a);return await this.tuneInternal(b)}{let b=Object.assign({},a),c=await this.tuneMldevInternal(b),d="";return void 0!==c.metadata&&void 0!==c.metadata.tunedModel?d=c.metadata.tunedModel:void 0!==c.name&&c.name.includes("/operations/")&&(d=c.name.split("/operations/")[0]),{name:d,state:Y.JOB_STATE_QUEUED}}}}async getInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(a,["name"]);return null!=d&&fb(c,["_url","name"],d),c}(a);return f=fa("{name}",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>h4(a))}{let b=function(a,b){let c={},d=fc(a,["name"]);return null!=d&&fb(c,["_url","name"],d),c}(a);return f=fa("{name}",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>h3(a))}}async listInternal(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(a,["config"]);return null!=d&&function(a,b,c){let d=fc(a,["pageSize"]);void 0!==b&&null!=d&&fb(b,["_query","pageSize"],d);let e=fc(a,["pageToken"]);void 0!==b&&null!=e&&fb(b,["_query","pageToken"],e);let f=fc(a,["filter"]);void 0!==b&&null!=f&&fb(b,["_query","filter"],f)}(d,c),c}(a);return f=fa("tuningJobs",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"GET",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a,b){let c={},d=fc(a,["sdkHttpResponse"]);null!=d&&fb(c,["sdkHttpResponse"],d);let e=fc(a,["nextPageToken"]);null!=e&&fb(c,["nextPageToken"],e);let f=fc(a,["tuningJobs"]);if(null!=f){let a=f;Array.isArray(a)&&(a=a.map(a=>h4(a))),fb(c,["tuningJobs"],a)}return c}(a),c=new fs;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=fc(a,["config"]);return null!=d&&function(a,b,c){let d=fc(a,["pageSize"]);void 0!==b&&null!=d&&fb(b,["_query","pageSize"],d);let e=fc(a,["pageToken"]);void 0!==b&&null!=e&&fb(b,["_query","pageToken"],e);let f=fc(a,["filter"]);void 0!==b&&null!=f&&fb(b,["_query","filter"],f)}(d,c),c}(a);return f=fa("tunedModels",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"GET",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a,b){let c={},d=fc(a,["sdkHttpResponse"]);null!=d&&fb(c,["sdkHttpResponse"],d);let e=fc(a,["nextPageToken"]);null!=e&&fb(c,["nextPageToken"],e);let f=fc(a,["tunedModels"]);if(null!=f){let a=f;Array.isArray(a)&&(a=a.map(a=>h3(a))),fb(c,["tuningJobs"],a)}return c}(a),c=new fs;return Object.assign(c,b),c})}}async cancel(a){var b,c,d,e;let f="",g={};if(this.apiClient.isVertexAI()){let d=function(a,b){let c={},d=fc(a,["name"]);return null!=d&&fb(c,["_url","name"],d),c}(a);return f=fa("{name}:cancel",d._url),g=d._query,delete d._url,delete d._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(d),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a,b){let c={},d=fc(a,["sdkHttpResponse"]);return null!=d&&fb(c,["sdkHttpResponse"],d),c}(a),c=new ft;return Object.assign(c,b),c})}{let b=function(a,b){let c={},d=fc(a,["name"]);return null!=d&&fb(c,["_url","name"],d),c}(a);return f=fa("{name}:cancel",b._url),g=b._query,delete b._url,delete b._query,this.apiClient.request({path:f,queryParams:g,body:JSON.stringify(b),httpMethod:"POST",httpOptions:null==(d=a.config)?void 0:d.httpOptions,abortSignal:null==(e=a.config)?void 0:e.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>{let b=function(a,b){let c={},d=fc(a,["sdkHttpResponse"]);return null!=d&&fb(c,["sdkHttpResponse"],d),c}(a),c=new ft;return Object.assign(c,b),c})}}async tuneInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI()){let f=function(a,b){let c={},d=fc(a,["baseModel"]);null!=d&&fb(c,["baseModel"],d);let e=fc(a,["preTunedModel"]);null!=e&&fb(c,["preTunedModel"],e);let f=fc(a,["trainingDataset"]);null!=f&&function(a,b,c){let d=fc(c,["config","method"]);if(void 0===d&&(d="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===d){let c=fc(a,["gcsUri"]);void 0!==b&&null!=c&&fb(b,["supervisedTuningSpec","trainingDatasetUri"],c)}else if("PREFERENCE_TUNING"===d){let c=fc(a,["gcsUri"]);void 0!==b&&null!=c&&fb(b,["preferenceOptimizationSpec","trainingDatasetUri"],c)}let e=fc(c,["config","method"]);if(void 0===e&&(e="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===e){let c=fc(a,["vertexDatasetResource"]);void 0!==b&&null!=c&&fb(b,["supervisedTuningSpec","trainingDatasetUri"],c)}else if("PREFERENCE_TUNING"===e){let c=fc(a,["vertexDatasetResource"]);void 0!==b&&null!=c&&fb(b,["preferenceOptimizationSpec","trainingDatasetUri"],c)}if(void 0!==fc(a,["examples"]))throw Error("examples parameter is not supported in Vertex AI.")}(f,c,b);let g=fc(a,["config"]);return null!=g&&function(a,b,c){let d=fc(c,["config","method"]);if(void 0===d&&(d="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===d){let c=fc(a,["validationDataset"]);void 0!==b&&null!=c&&fb(b,["supervisedTuningSpec"],h5(c))}else if("PREFERENCE_TUNING"===d){let c=fc(a,["validationDataset"]);void 0!==b&&null!=c&&fb(b,["preferenceOptimizationSpec"],h5(c))}let e=fc(a,["tunedModelDisplayName"]);void 0!==b&&null!=e&&fb(b,["tunedModelDisplayName"],e);let f=fc(a,["description"]);void 0!==b&&null!=f&&fb(b,["description"],f);let g=fc(c,["config","method"]);if(void 0===g&&(g="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===g){let c=fc(a,["epochCount"]);void 0!==b&&null!=c&&fb(b,["supervisedTuningSpec","hyperParameters","epochCount"],c)}else if("PREFERENCE_TUNING"===g){let c=fc(a,["epochCount"]);void 0!==b&&null!=c&&fb(b,["preferenceOptimizationSpec","hyperParameters","epochCount"],c)}let h=fc(c,["config","method"]);if(void 0===h&&(h="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===h){let c=fc(a,["learningRateMultiplier"]);void 0!==b&&null!=c&&fb(b,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c)}else if("PREFERENCE_TUNING"===h){let c=fc(a,["learningRateMultiplier"]);void 0!==b&&null!=c&&fb(b,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],c)}let i=fc(c,["config","method"]);if(void 0===i&&(i="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===i){let c=fc(a,["exportLastCheckpointOnly"]);void 0!==b&&null!=c&&fb(b,["supervisedTuningSpec","exportLastCheckpointOnly"],c)}else if("PREFERENCE_TUNING"===i){let c=fc(a,["exportLastCheckpointOnly"]);void 0!==b&&null!=c&&fb(b,["preferenceOptimizationSpec","exportLastCheckpointOnly"],c)}let j=fc(c,["config","method"]);if(void 0===j&&(j="SUPERVISED_FINE_TUNING"),"SUPERVISED_FINE_TUNING"===j){let c=fc(a,["adapterSize"]);void 0!==b&&null!=c&&fb(b,["supervisedTuningSpec","hyperParameters","adapterSize"],c)}else if("PREFERENCE_TUNING"===j){let c=fc(a,["adapterSize"]);void 0!==b&&null!=c&&fb(b,["preferenceOptimizationSpec","hyperParameters","adapterSize"],c)}if(void 0!==fc(a,["batchSize"]))throw Error("batchSize parameter is not supported in Vertex AI.");if(void 0!==fc(a,["learningRate"]))throw Error("learningRate parameter is not supported in Vertex AI.");let k=fc(a,["labels"]);void 0!==b&&null!=k&&fb(b,["labels"],k);let l=fc(a,["beta"]);void 0!==b&&null!=l&&fb(b,["preferenceOptimizationSpec","hyperParameters","beta"],l)}(g,c,b),c}(a,a);return d=fa("tuningJobs",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>h4(a))}throw Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(a){var b,c;let d="",e={};if(this.apiClient.isVertexAI())throw Error("This method is only supported by the Gemini Developer API.");{let f=function(a,b){let c={},d=fc(a,["baseModel"]);null!=d&&fb(c,["baseModel"],d);let e=fc(a,["preTunedModel"]);null!=e&&fb(c,["preTunedModel"],e);let f=fc(a,["trainingDataset"]);null!=f&&function(a,b){if(void 0!==fc(a,["gcsUri"]))throw Error("gcsUri parameter is not supported in Gemini API.");if(void 0!==fc(a,["vertexDatasetResource"]))throw Error("vertexDatasetResource parameter is not supported in Gemini API.");let c=fc(a,["examples"]);if(null!=c){let a=c;Array.isArray(a)&&(a=a.map(a=>a)),fb({},["examples","examples"],a)}}(f);let g=fc(a,["config"]);return null!=g&&function(a,b,c){if(void 0!==fc(a,["validationDataset"]))throw Error("validationDataset parameter is not supported in Gemini API.");let d=fc(a,["tunedModelDisplayName"]);if(void 0!==b&&null!=d&&fb(b,["displayName"],d),void 0!==fc(a,["description"]))throw Error("description parameter is not supported in Gemini API.");let e=fc(a,["epochCount"]);void 0!==b&&null!=e&&fb(b,["tuningTask","hyperparameters","epochCount"],e);let f=fc(a,["learningRateMultiplier"]);if(null!=f&&fb({},["tuningTask","hyperparameters","learningRateMultiplier"],f),void 0!==fc(a,["exportLastCheckpointOnly"]))throw Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(void 0!==fc(a,["preTunedModelCheckpointId"]))throw Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(void 0!==fc(a,["adapterSize"]))throw Error("adapterSize parameter is not supported in Gemini API.");let g=fc(a,["batchSize"]);void 0!==b&&null!=g&&fb(b,["tuningTask","hyperparameters","batchSize"],g);let h=fc(a,["learningRate"]);if(void 0!==b&&null!=h&&fb(b,["tuningTask","hyperparameters","learningRate"],h),void 0!==fc(a,["labels"]))throw Error("labels parameter is not supported in Gemini API.");if(void 0!==fc(a,["beta"]))throw Error("beta parameter is not supported in Gemini API.")}(g,c),c}(a);return d=fa("tunedModels",f._url),e=f._query,delete f._url,delete f._query,this.apiClient.request({path:d,queryParams:e,body:JSON.stringify(f),httpMethod:"POST",httpOptions:null==(b=a.config)?void 0:b.httpOptions,abortSignal:null==(c=a.config)?void 0:c.abortSignal}).then(a=>a.json().then(b=>(b.sdkHttpResponse={headers:a.headers},b))).then(a=>(function(a,b){let c={},d=fc(a,["sdkHttpResponse"]);null!=d&&fb(c,["sdkHttpResponse"],d);let e=fc(a,["name"]);null!=e&&fb(c,["name"],e);let f=fc(a,["metadata"]);null!=f&&fb(c,["metadata"],f);let g=fc(a,["done"]);null!=g&&fb(c,["done"],g);let h=fc(a,["error"]);return null!=h&&fb(c,["error"],h),c})(a))}}}let h7="x-goog-upload-status";async function h8(a,b,c){var d;let e=await ia(a,b,c),f=await (null==e?void 0:e.json());if((null==(d=null==e?void 0:e.headers)?void 0:d[h7])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return f.file}async function h9(a,b,c){var d;let e=await ia(a,b,c),f=await (null==e?void 0:e.json());if((null==(d=null==e?void 0:e.headers)?void 0:d[h7])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");let g=fe(f),h=new fG;return Object.assign(h,g),h}async function ia(a,b,c){var d,e;let f=0,g=0,h=new ff(new Response),i="upload";for(f=a.size;g<f;){let j=Math.min(8388608,f-g),k=a.slice(g,g+j);g+j>=f&&(i+=", finalize");let l=0,m=1e3;for(;l<3&&(null==(d=null==(h=await c.request({path:"",body:k,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:b,headers:{"X-Goog-Upload-Command":i,"X-Goog-Upload-Offset":String(g),"Content-Length":String(j)}}}))?void 0:h.headers)||!d[h7]);)l++,await ic(m),m*=2;if(g+=j,(null==(e=null==h?void 0:h.headers)?void 0:e[h7])!=="active")break;if(f<=g)throw Error("All content has been uploaded, but the upload status is not finalized.")}return h}async function ib(a){return{size:a.size,type:a.type}}function ic(a){return new Promise(b=>setTimeout(b,a))}class id{async stat(a){let b={size:0,type:void 0};return"string"==typeof a?(b.size=(await e4.stat(a)).size,b.type=this.inferMimeType(a),b):await ib(a)}async upload(a,b,c){return"string"==typeof a?await this.uploadFileFromPath(a,b,c):h8(a,b,c)}async uploadToFileSearchStore(a,b,c){return"string"==typeof a?await this.uploadFileToFileSearchStoreFromPath(a,b,c):h9(a,b,c)}inferMimeType(a){return({aac:"audio/aac",abw:"application/x-abiword",arc:"application/x-freearc",avi:"video/x-msvideo",azw:"application/vnd.amazon.ebook",bin:"application/octet-stream",bmp:"image/bmp",bz:"application/x-bzip",bz2:"application/x-bzip2",csh:"application/x-csh",css:"text/css",csv:"text/csv",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",eot:"application/vnd.ms-fontobject",epub:"application/epub+zip",gz:"application/gzip",gif:"image/gif",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",ics:"text/calendar",jar:"application/java-archive",jpeg:"image/jpeg",jpg:"image/jpeg",js:"text/javascript",json:"application/json",jsonld:"application/ld+json",kml:"application/vnd.google-earth.kml+xml",kmz:"application/vnd.google-earth.kmz+xml",mjs:"text/javascript",mp3:"audio/mpeg",mp4:"video/mp4",mpeg:"video/mpeg",mpkg:"application/vnd.apple.installer+xml",odt:"application/vnd.oasis.opendocument.text",oga:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",opus:"audio/opus",otf:"font/otf",png:"image/png",pdf:"application/pdf",php:"application/x-httpd-php",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",sh:"application/x-sh",svg:"image/svg+xml",swf:"application/x-shockwave-flash",tar:"application/x-tar",tif:"image/tiff",tiff:"image/tiff",ts:"video/mp2t",ttf:"font/ttf",txt:"text/plain",vsd:"application/vnd.visio",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webp:"image/webp",woff:"font/woff",woff2:"font/woff2",xhtml:"application/xhtml+xml",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xml:"application/xml",xul:"application/vnd.mozilla.xul+xml",zip:"application/zip","3gp":"video/3gpp","3g2":"video/3gpp2","7z":"application/x-7z-compressed"})[a.slice(a.lastIndexOf(".")+1).toLowerCase()]}async uploadFileFromPath(a,b,c){var d;let e=await this.uploadFileFromPathInternal(a,b,c),f=await (null==e?void 0:e.json());if((null==(d=null==e?void 0:e.headers)?void 0:d[h7])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");return f.file}async uploadFileToFileSearchStoreFromPath(a,b,c){var d;let e=await this.uploadFileFromPathInternal(a,b,c),f=await (null==e?void 0:e.json());if((null==(d=null==e?void 0:e.headers)?void 0:d[h7])!=="final")throw Error("Failed to upload file: Upload status is not finalized.");let g=fe(f),h=new fG;return Object.assign(h,g),h}async uploadFileFromPathInternal(a,b,c){var d,e;let f,g=0,h=0,i=new ff(new Response),j="upload",k=e8.basename(a);try{if(!(f=await e4.open(a,"r")))throw Error("Failed to open file");for(g=(await f.stat()).size;h<g;){let a=Math.min(8388608,g-h);h+a>=g&&(j+=", finalize");let l=new Uint8Array(a),{bytesRead:m}=await f.read(l,0,a,h);if(m!==a)throw Error(`Failed to read ${a} bytes from file at offset ${h}. bytes actually read: ${m}`);let o=new Blob([l]),p=0,q=1e3;for(;p<3&&(null==(d=null==(i=await c.request({path:"",body:o,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:b,headers:{"X-Goog-Upload-Command":j,"X-Goog-Upload-Offset":String(h),"Content-Length":String(m),"X-Goog-Upload-File-Name":k}}}))?void 0:i.headers)||!d[h7]);)p++,await ic(q),q*=2;if(h+=m,(null==(e=null==i?void 0:i.headers)?void 0:e[h7])!=="active")break;if(g<=h)throw Error("All content has been uploaded, but the upload status is not finalized.")}return i}finally{f&&await f.close()}}}class ie{get interactions(){if(void 0!==this._interactions)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");let a=this.httpOptions;(null==a?void 0:a.extraBody)&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");let b=new hX({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:null==a?void 0:a.timeout});return this._interactions=b.interactions,this._interactions}constructor(a){var b,c,d,e,f,g;if((a.project||a.location)&&a.apiKey)throw Error("Project/location and API key are mutually exclusive in the client initializer.");this.vertexai=null!=(c=null!=(b=a.vertexai)?b:function(a){var b;return void 0!==(b=ig(a))&&"true"===b.toLowerCase()}("GOOGLE_GENAI_USE_VERTEXAI"))&&c;let h=function(){let a=ig("GOOGLE_API_KEY"),b=ig("GEMINI_API_KEY");return a&&b&&console.warn("Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY."),a||b||void 0}(),i=ig("GOOGLE_CLOUD_PROJECT"),l=ig("GOOGLE_CLOUD_LOCATION");this.apiKey=null!=(d=a.apiKey)?d:h,this.project=null!=(e=a.project)?e:i,this.location=null!=(f=a.location)?f:l,a.vertexai&&((null==(g=a.googleAuthOptions)?void 0:g.credentials)&&(console.debug("The user provided Google Cloud credentials will take precedence over the API key from the environment variable."),this.apiKey=void 0),(i||l)&&a.apiKey?(console.debug("The user provided Vertex AI API key will take precedence over the project/location from the environment variables."),this.project=void 0,this.location=void 0):(a.project||a.location)&&h?(console.debug("The user provided project/location will take precedence over the API key from the environment variables."),this.apiKey=void 0):(i||l)&&h&&(console.debug("The project/location from the environment variables will take precedence over the API key from the environment variables."),this.apiKey=void 0),this.location||this.apiKey||(this.location="global"));let m=function(a,b,c,d){return(null==a?void 0:a.baseUrl)?a.baseUrl:b?null!=k?k:c:null!=j?j:d}(a.httpOptions,a.vertexai,ig("GOOGLE_VERTEX_BASE_URL"),ig("GOOGLE_GEMINI_BASE_URL"));m&&(a.httpOptions?a.httpOptions.baseUrl=m:a.httpOptions={baseUrl:m}),this.apiVersion=a.apiVersion,this.httpOptions=a.httpOptions;let o=new h$({apiKey:this.apiKey,googleAuthOptions:a.googleAuthOptions});this.apiClient=new gK({auth:o,project:this.project,location:this.location,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:"gl-node/"+process.version,uploader:new id,downloader:new h_}),this.models=new g$(this.apiClient),this.live=new gT(this.apiClient,o,new h1),this.batches=new ge(this.apiClient),this.chats=new gn(this.models,this.apiClient),this.caches=new gg(this.apiClient),this.files=new gq(this.apiClient),this.operations=new g_(this.apiClient),this.authTokens=new g0(this.apiClient),this.tunings=new h6(this.apiClient),this.fileSearchStores=new g2(this.apiClient)}}function ig(a){var b,c,d;return null!=(d=null==(c=null==(b=null==process?void 0:process.env)?void 0:b[a])?void 0:c.trim())?d:void 0}let ih=eJ.gemini,ii=new ie({apiKey:eF.gemini.apiKey});async function ij(a){ih.info({displayName:a},"Creating File Search store");try{let b=await ii.fileSearchStores.create({config:{displayName:a}});return ih.info({storeName:b.name,displayName:a},"File Search store created"),{name:b.name,displayName:b.displayName??a,createTime:b.createTime,updateTime:b.updateTime}}catch(c){let b=c instanceof Error?c.message:"Unknown error";throw ih.error({displayName:a,error:b},"Failed to create store"),Error(`Failed to create File Search store: ${b}`)}}var ik=c(55511);function il(a){var b;return b=a.replace(/\r\n/g,"\n").replace(/\r/g,"\n").replace(/\n{3,}/g,"\n\n").split("\n").map(a=>a.trim()).join("\n").trim().toLowerCase(),(0,ik.createHash)("sha256").update(b,"utf8").digest("hex")}function im(a){try{return new URL(a).hostname}catch{let b=a.match(/^(?:https?:\/\/)?([^\/\?#]+)/i);return b?.[1]??a}}function io(a){let b=a.toLowerCase().trim();return b.startsWith("www.")?b.substring(4):b}function ip(a){try{return new URL(a).pathname}catch{return"/"}}function iq(a){try{let b=new URL(a);b.hostname=b.hostname.toLowerCase(),b.hash="";let c=b.toString();return"/"!==b.pathname&&c.endsWith("/")&&(c=c.slice(0,-1)),c}catch{if(!a.startsWith("http://")&&!a.startsWith("https://"))return`https://${a}`;return a}}let ir=eJ.ingestion;async function is(a){let b=io(im(iq(a))),c=await eO(b);return{exists:!!c,website:c,domain:b,action:c?"sync":"ingest"}}async function it(a,b){try{a=eA().min(1,"URL or domain is required").refine(a=>{try{let b=new URL(a.startsWith("http")?a:`https://${a}`);return b.hostname.length>0&&b.hostname.includes(".")}catch{return/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(a)}},{message:"Input must be a valid URL or domain (e.g., https://example.com or example.com)"}).parse(a),b&&(b=eA().min(1,"Display name cannot be empty").max(512,"Display name must be 512 characters or less").parse(b))}catch(d){let c=d instanceof Error?d.message:"Invalid input";throw ir.error({seedUrl:a,displayName:b,error:c},"Input validation failed"),Error(`Invalid ingestion input: ${c}`)}let c=iq(a),d=im(c),e=io(d),f=b??e,g=[];ir.info({seedUrl:c,extractedDomain:d,baseDomain:e},"Starting website ingestion");let h=await eO(e);if(h){ir.info({baseDomain:e,websiteId:h.id,existingDisplayName:h.display_name,existingDomain:h.domain},"Website already exists - checking for stuck ingestion jobs");let a=await eX(h.id,{processType:"ingestion",limit:1});if(a.length>0){let b=a[0],c=Date.now()-new Date(b.started_at).getTime();if("running"===b.status&&c>6e4){ir.info({ingestionJobId:b.id,jobAge:Math.round(c/1e3)+"s"},"Found stuck ingestion job for existing website - attempting recovery");let a=await iu(b.id);if(a.recovered&&"completed"===a.status&&a.result)return ir.info({ingestionJobId:b.id},"Successfully recovered stuck ingestion job"),a.result;if("still_running"===a.status)throw ir.info({ingestionJobId:b.id},"Ingestion job is still running in FireCrawl - will continue monitoring"),Error(`Ingestion is already in progress for this website. Job ID: ${b.id}. FireCrawl batch is still running. Please wait for it to complete.`);ir.warn({ingestionJobId:b.id,recoveryStatus:a.status,error:a.error},"Recovery failed or job was already failed - will start new ingestion")}else if("completed"===b.status){ir.info({ingestionJobId:b.id},"Last ingestion job was already completed for this website");let a=await eR(h.id);return{websiteId:h.id,domain:h.domain,geminiStoreId:h.gemini_store_id??"",pagesDiscovered:b.urls_discovered??0,pagesIndexed:a.filter(a=>"ready_for_indexing"===a.status||"active"===a.status).length,errors:b.errors??[],ingestionJobId:b.id}}}ir.info({websiteId:h.id},"Website exists but no active ingestion job - proceeding with new ingestion")}let i=h;if(!i){ir.info({baseDomain:e},"Creating Gemini File Search store");let a=`website-${e.replace(/\./g,"-")}-${Date.now()}`,b=await ij(a);ir.info({baseDomain:e,storeId:b.name},"Creating website record with store"),i=await eM({seed_url:c,domain:e,display_name:f,gemini_store_id:b.name,gemini_store_name:b.displayName}),ir.info({websiteId:i.id},"Checking for stuck ingestion jobs for newly created website");let d=await eX(i.id,{processType:"ingestion",limit:1});if(d.length>0){let a=d[0],b=Date.now()-new Date(a.started_at).getTime();if("running"===a.status&&b>6e4){ir.info({ingestionJobId:a.id,jobAge:Math.round(b/1e3)+"s"},"Found stuck ingestion job - attempting recovery");let c=await iu(a.id);if(c.recovered&&"completed"===c.status&&c.result)return ir.info({ingestionJobId:a.id},"Successfully recovered stuck ingestion job"),c.result;if("still_running"===c.status)throw ir.info({ingestionJobId:a.id},"Ingestion job is still running in FireCrawl - will continue monitoring"),Error(`Ingestion is already in progress for this website. Job ID: ${a.id}. FireCrawl batch is still running. Please wait for it to complete.`);ir.warn({ingestionJobId:a.id,recoveryStatus:c.status,error:c.error},"Recovery failed or job was already failed - will start new ingestion")}else if("completed"===a.status){ir.info({ingestionJobId:a.id},"Last ingestion job was already completed - returning existing result");let b=await eR(i.id);return{websiteId:i.id,domain:i.domain,geminiStoreId:i.gemini_store_id??"",pagesDiscovered:a.urls_discovered??0,pagesIndexed:b.filter(a=>"ready_for_indexing"===a.status||"active"===a.status).length,errors:a.errors??[],ingestionJobId:a.id}}}}let j=await eU({website_id:i.id,process_type:"ingestion",status:"running"});await eP(i.id,{created_by_ingestion_id:j.id});try{var k;ir.info({seedUrl:c},"Mapping website");let a=await e$(c);if(!a.success)throw Error(`Failed to map website: ${a.error}`);ir.info({totalLinks:a.links.length,baseDomain:e,sampleLinks:a.links.slice(0,5)},"FireCrawl mapping result");let b=(k=a.links,k.filter(a=>{var b,c;return b=a,c=e,io(im(b).toLowerCase())===io(c)}));ir.info({beforeFilter:a.links.length,afterFilter:b.length,baseDomain:e,sampleFiltered:b.slice(0,5)},"URL filtering result");let d=[...new Set(b.map(iq))];if(ir.info({urlCount:d.length,baseDomain:e},"URLs discovered after normalization"),0===d.length)throw Error("No URLs discovered during mapping");ir.info({urlCount:d.length},"Starting batch scrape");let f=await e_(d);if(!f.success)throw Error(`Batch scrape start failed: ${f.error}`);let h=f.jobId;ir.info({batchJobId:h},"Batch scrape job started"),await eV(j.id,{firecrawl_batch_ids:[h]}),ir.info({batchJobId:h,ingestionJobId:j.id},"Batch job ID stored in process_job");let l=Date.now(),m=await e1(h,{pollIntervalMs:5e3,maxWaitMs:6e5,onProgress:async(a,b)=>{ir.debug({completed:a,total:b},"Scrape progress");let c=Date.now();if(c-l>=3e4){l=c;let d=b>0?Math.round(a/b*100):0;await eV(j.id,{metadata:{progress:{completed:a,total:b,percentage:d}}}),ir.info({ingestionJobId:j.id,completed:a,total:b,percentage:d},"Updated ingestion progress in database")}}});if(!m.success||!m.data)throw Error(`Batch scrape failed: ${m.error||"Unknown error"}`);ir.info({completed:m.completed,total:m.total},"Batch scrape complete");let o=0,p=new Date().toISOString(),q=m.data??[];for(let a of q){if(!a)continue;let b=a.metadata?.sourceURL;if(!b){ir.warn({pageData:a},"Page missing sourceURL, skipping (discarded)");continue}if(!a.markdown||"string"!=typeof a.markdown){ir.warn({url:b},"Page missing markdown or invalid type, skipping (discarded)"),g.push({url:b,error:"Missing or invalid markdown content",timestamp:p});continue}let c=a.markdown.trim();if(0===c.length){ir.warn({url:b},"Empty markdown content after trim, skipping (discarded)"),g.push({url:b,error:"Empty content after scraping",timestamp:p});continue}let d=il(a.markdown),e=ip(b),f=a.metadata?.statusCode??null;try{await eQ({website_id:i.id,url:b,path:e,title:a.metadata?.title,status:"ready_for_indexing",content_hash:d,markdown_content:a.markdown,http_status_code:f,firecrawl_scrape_count:1,last_seen:p,metadata:{title:a.metadata?.title,description:a.metadata?.description,og_image:a.metadata?.ogImage,language:a.metadata?.language},created_by_ingestion_id:j.id,firecrawl_batch_id:h}),++o%10==0&&ir.info({pagesWritten:o,total:q.length},"Pages written to DB")}catch(c){let a=c instanceof Error?c.message:"Unknown error";ir.error({url:b,error:a},"Failed to write page to DB"),g.push({url:b,error:a,timestamp:p})}}return ir.info({discovered:d.length,scraped:m.completed,written:o,discarded:q.length-o},"Ingestion scraping phase complete"),await eV(j.id,{completed_at:p,urls_discovered:d.length,urls_updated:o,urls_errored:g.length,firecrawl_batch_ids:[h],errors:g,status:"completed"}),await eP(i.id,{last_full_crawl:p}),ir.info({websiteId:i.id,baseDomain:e,pagesDiscovered:d.length,pagesScraped:o,errors:g.length},"Ingestion complete - pages ready for indexing"),{websiteId:i.id,domain:e,geminiStoreId:i.gemini_store_id??"",pagesDiscovered:d.length,pagesIndexed:o,errors:g,ingestionJobId:j.id}}catch(c){let b=c instanceof Error?c.message:"Unknown error";throw await eV(j.id,{completed_at:new Date().toISOString(),errors:[...g,{url:a,error:b,timestamp:new Date().toISOString()}],status:"failed"}),ir.error({websiteId:i.id,error:b},"Ingestion failed"),c}}async function iu(a){ir.info({ingestionJobId:a},"Attempting to recover ingestion job");let b=await eW(a);if(!b)return{recovered:!1,status:"cannot_recover",error:"Ingestion job not found"};if("running"!==b.status)return ir.info({ingestionJobId:a,status:b.status},"Job is not stuck, no recovery needed"),{recovered:!1,status:"completed"===b.status?"completed":"failed",error:`Job is already ${b.status}`};let c=b.firecrawl_batch_ids?.[0];if(!c)return ir.error({ingestionJobId:a},"No batch job ID found - cannot recover"),await eV(a,{status:"failed",completed_at:new Date().toISOString(),errors:[{url:"",error:"No batch job ID found - cannot recover from crash",timestamp:new Date().toISOString()}]}),{recovered:!1,status:"cannot_recover",error:"No batch job ID found - cannot recover"};ir.info({ingestionJobId:a,batchJobId:c},"Found batch job ID, checking FireCrawl status");let d=await e0(c);if(!d.success)return ir.error({ingestionJobId:a,batchJobId:c,error:d.error},"FireCrawl status check failed"),await eV(a,{status:"failed",completed_at:new Date().toISOString(),errors:[{url:"",error:d.error||"Failed to check FireCrawl status",timestamp:new Date().toISOString()}]}),{recovered:!1,status:"failed",error:d.error||"Failed to check FireCrawl status"};if("completed"===d.status&&d.data){ir.info({ingestionJobId:a,batchJobId:c,completed:d.completed,total:d.total},"FireCrawl batch completed - processing results");let e=await eN(b.website_id);if(!e)return{recovered:!1,status:"cannot_recover",error:"Website not found"};let f=[],g=0,h=new Date().toISOString(),i=d.data??[];for(let b of i){if(!b)continue;let d=b.metadata?.sourceURL;if(!d){ir.warn({pageData:b},"Page missing sourceURL, skipping");continue}if(!b.markdown||"string"!=typeof b.markdown){ir.warn({url:d},"Page missing markdown, skipping"),f.push({url:d,error:"Missing or invalid markdown content",timestamp:h});continue}if(0===b.markdown.trim().length){ir.warn({url:d},"Empty markdown content, skipping"),f.push({url:d,error:"Empty content after scraping",timestamp:h});continue}let i=il(b.markdown),j=ip(d),k=b.metadata?.statusCode??null;try{await eQ({website_id:e.id,url:d,path:j,title:b.metadata?.title,status:"ready_for_indexing",content_hash:i,markdown_content:b.markdown,http_status_code:k,firecrawl_scrape_count:1,last_seen:h,metadata:{title:b.metadata?.title,description:b.metadata?.description,og_image:b.metadata?.ogImage,language:b.metadata?.language},created_by_ingestion_id:a,firecrawl_batch_id:c}),g++}catch(b){let a=b instanceof Error?b.message:"Unknown error";ir.error({url:d,error:a},"Failed to write page to DB during recovery"),f.push({url:d,error:a,timestamp:h})}}return await eV(a,{completed_at:h,urls_discovered:i.length,urls_updated:g,urls_errored:f.length,firecrawl_batch_ids:[c],errors:f,status:"completed"}),await eP(e.id,{last_full_crawl:h}),ir.info({ingestionJobId:a,websiteId:e.id,pagesWritten:g,errors:f.length},"Ingestion job recovered successfully"),{recovered:!0,status:"completed",result:{websiteId:e.id,domain:e.domain,geminiStoreId:e.gemini_store_id??"",pagesDiscovered:i.length,pagesIndexed:g,errors:f,ingestionJobId:a}}}return"failed"===d.status?(ir.error({ingestionJobId:a,batchJobId:c,error:d.error},"FireCrawl batch failed"),await eV(a,{status:"failed",completed_at:new Date().toISOString(),errors:[{url:"",error:d.error||"Batch scrape failed",timestamp:new Date().toISOString()}]}),{recovered:!1,status:"failed",error:d.error||"Batch scrape failed"}):(ir.info({ingestionJobId:a,batchJobId:c,completed:d.completed,total:d.total},"FireCrawl batch still in progress - updating progress"),await eV(a,{metadata:{progress:{completed:d.completed,total:d.total,percentage:d.total>0?Math.round(d.completed/d.total*100):0}}}),{recovered:!1,status:"still_running",error:"Batch scrape is still in progress"})}let iv=eJ.gemini,iw="https://generativelanguage.googleapis.com",ix=`${iw}/v1beta`,iy=`${iw}/upload/v1beta`;function iz(){return{"x-goog-api-key":eF.gemini.apiKey,"Content-Type":"application/json"}}async function iA(a){iv.info({documentName:a},"Getting document");try{let b=(a.startsWith("fileSearchStores/"),a),c=`${ix}/${b}`,d=await fetch(c,{method:"GET",headers:iz()});if(404===d.status)throw Error(`Document not found: ${a}`);if(!d.ok){let a=await d.text();throw Error(`Failed to get document: ${d.status} ${a}`)}let e=await d.json();return{name:e.name||b,displayName:e.displayName,mimeType:e.mimeType,sizeBytes:e.sizeBytes,createTime:e.createTime,updateTime:e.updateTime,state:e.state}}catch(c){let b=c instanceof Error?c.message:"Unknown error";throw iv.error({documentName:a,error:b},"Failed to get document"),Error(`Failed to get document: ${b}`)}}async function iB(a){iv.info({documentName:a},"Deleting document");try{let b=(a.startsWith("fileSearchStores/"),a),c=`${ix}/${b}`,d=await fetch(c,{method:"DELETE",headers:iz()});if(404===d.status)return void iv.warn({documentName:a},"Document not found, already deleted");if(!d.ok){let a=await d.text();throw Error(`Failed to delete document: ${d.status} ${a}`)}iv.info({documentName:a},"Document deleted")}catch(c){let b=c instanceof Error?c.message:"Unknown error";throw iv.error({documentName:a,error:b},"Failed to delete document"),Error(`Failed to delete document: ${b}`)}}async function iC(a){try{let b=`${ix}/${a}`,c=await fetch(b,{method:"GET",headers:iz()});if(!c.ok){let a=await c.text();throw Error(`Failed to get operation: ${c.status} ${a}`)}return await c.json()}catch(c){let b=c instanceof Error?c.message:"Unknown error";throw iv.error({operationName:a,error:b},"Failed to get operation"),Error(`Failed to get operation: ${b}`)}}async function iD(a,b){let c=b?.pollIntervalMs||2e3,d=b?.maxWaitMs||3e5,e=Date.now();for(iv.info({operationName:a},"Polling operation");Date.now()-e<d;){let b=await iC(a);if(b.done){if(b.error)throw iv.error({operationName:a,error:b.error},"Operation failed"),Error(`Operation failed: ${JSON.stringify(b.error)}`);return iv.info({operationName:a,elapsed:`${((Date.now()-e)/1e3).toFixed(1)}s`},"Operation completed"),b}await new Promise(a=>setTimeout(a,c))}let f=((Date.now()-e)/1e3).toFixed(1);throw Error(`Operation timed out after ${f}s: ${a}`)}async function iE(a){iv.info({displayName:a},"Creating File Search store");try{let b=`${ix}/fileSearchStores`,c=await fetch(b,{method:"POST",headers:iz(),body:JSON.stringify({displayName:a})});if(!c.ok){let a=await c.text();throw Error(`Failed to create store: ${c.status} ${a}`)}let d=await c.json();return iv.info({storeName:d.name,displayName:a},"File Search store created"),{name:d.name||"",displayName:d.displayName||a,createTime:d.createTime,updateTime:d.updateTime}}catch(c){let b=c instanceof Error?c.message:"Unknown error";throw iv.error({displayName:a,error:b},"Failed to create store"),Error(`Failed to create File Search store: ${b}`)}}async function iF(a,b,c){let d=b.length,e=(d/1024).toFixed(2);iv.info({storeName:a,url:c.url,contentSize:`${e} KB`,title:c.title},"Uploading to File Search store (HTTP)");try{let f=a.startsWith("fileSearchStores/")?a:`fileSearchStores/${a}`,g=`${c.url.replace(/^https?:\/\//,"").replace(/[^a-zA-Z0-9-_]/g,"_").slice(0,100)}.md`,h="==============="+Date.now()+"===============",i=JSON.stringify({displayName:c.title||c.url}),j=[`--${h}`,"Content-Type: application/json",'Content-Disposition: form-data; name="metadata"',"",i,`--${h}`,"Content-Type: text/markdown",`Content-Disposition: form-data; name="file"; filename="${g}"`,"",b,`--${h}--`].join("\r\n"),k=`${iy}/${f}:uploadToFileSearchStore`;iv.debug({url:k,fileName:g,contentSize:`${e} KB`},"Starting upload");let l=Date.now(),m=await fetch(k,{method:"POST",headers:{"x-goog-api-key":eF.gemini.apiKey,"Content-Type":`multipart/form-data; boundary=${h}`},body:j}),o=((Date.now()-l)/1e3).toFixed(2);if(!m.ok){let a=await m.text();throw Error(`Upload failed: ${m.status} ${a}`)}let p=await m.json();iv.debug({operationName:p.name,done:!!p.response,uploadTime:`${o}s`},"Upload operation initiated");let q=p.response?.documentName||p.name||"";if(p.response)return iv.info({documentName:q,uploadTime:`${o}s`},"Upload completed immediately"),{name:q,displayName:c.title,mimeType:p.response.mimeType||"text/markdown",sizeBytes:p.response.sizeBytes||String(d),createTime:new Date().toISOString(),state:"ACTIVE"};if(p.name){let a=await iD(p.name,{pollIntervalMs:2e3,maxWaitMs:3e5});if(a.error)throw Error(`Operation failed: ${JSON.stringify(a.error)}`);let b=a.response;return{name:b?.documentName||p.name,displayName:c.title,mimeType:"text/markdown",sizeBytes:String(d),createTime:new Date().toISOString(),state:"ACTIVE"}}return{name:q,displayName:c.title,mimeType:"text/markdown",sizeBytes:String(d),createTime:new Date().toISOString(),state:"PENDING"}}catch(d){let b=d instanceof Error?d.message:"Unknown error";throw iv.error({storeName:a,url:c.url,contentSize:`${e} KB`,error:b},"Upload failed"),Error(`Failed to upload to File Search store: ${b}`)}}let iG={BATCH_SIZE:5,RATE_LIMIT_BACKOFF_MS:2e3},iH=eJ.ingestion;async function iI(a,b){let{ingestionJobId:c,syncJobId:d,autoCreateStore:e=!0}=b??{},f=[],g=d||c,h=d?"sync":"ingestion";iH.info({websiteId:a,ingestionJobId:c,syncJobId:d,parentJobType:h},"Starting website indexing");let i=await eN(a);if(!i)throw Error("Website not found");let j=await eU({website_id:a,process_type:"indexing",status:"running",metadata:{...d?{syncJobId:d}:{},...c?{ingestionJobId:c}:{},documentStates:{}}});try{let b=i.gemini_store_id;if(!b)if(e){iH.info({websiteId:a},"Creating Gemini File Search store");let c=`website-${i.domain.replace(/\./g,"-")}-${Date.now()}`,d=await iE(c);b=d.name,await eP(a,{gemini_store_id:d.name,gemini_store_name:d.displayName})}else throw Error("Website has no Gemini store and autoCreateStore is false");let d=await eS(a,{processJobId:g,limit:200});if(iH.info({websiteId:a,pagesToIndex:d.length},"Pages to index"),0===d.length)return iH.info({websiteId:a},"No pages to index"),await eV(j.id,{status:"completed",urls_updated:0,completed_at:new Date().toISOString()}),{indexingJobId:j.id,websiteId:a,pagesIndexed:0,errors:[]};let h=new Date().toISOString(),k=d.filter(a=>a.markdown_content).map(a=>({id:a.id,content:a.markdown_content,metadata:{url:a.url,title:a.title??a.url,path:a.path??ip(a.url),lastUpdated:h}}));if(0===k.length)return iH.info({websiteId:a},"No pages with content to index"),await eV(j.id,{status:"completed",urls_updated:0,completed_at:new Date().toISOString()}),{indexingJobId:j.id,websiteId:a,pagesIndexed:0,errors:[]};iH.info({websiteId:a,totalPages:k.length,batchSize:iG.BATCH_SIZE},"Starting batch upload to Gemini (5 parallel API calls per batch, updating DB after each batch)");let l=0,m=new Map(d.map(a=>[a.id,a])),o=iG.BATCH_SIZE,p={};for(let a=0;a<k.length;a+=o){let c=k.slice(a,a+o),d=Math.floor(a/o)+1,e=Math.ceil(k.length/o);iH.info({batchNumber:d,totalBatches:e,batchItems:c.length},"Processing upload batch");let g=c.map(async a=>{try{let c=await iF(b,a.content,a.metadata);return{id:a.id,success:!0,result:c}}catch(d){let c=d instanceof Error?d.message:"Unknown error";if(c.includes("429")||c.includes("rate limit")||c.includes("quota")){iH.warn({itemId:a.id},"Rate limited, will retry"),await new Promise(a=>setTimeout(a,iG.RATE_LIMIT_BACKOFF_MS));try{let c=await iF(b,a.content,a.metadata);return{id:a.id,success:!0,result:c}}catch(c){let b=c instanceof Error?c.message:"Unknown error";return{id:a.id,success:!1,error:b}}}return{id:a.id,success:!1,error:c}}}),i=await Promise.all(g);for(let a of i){let b=m.get(a.id);if(b)if(a.success&&a.result){let c="PROCESSING",d="ready_for_indexing",e=!1;try{let b=await iA(a.result.name),f=b.state?.toUpperCase();"ACTIVE"===f||"STATE_ACTIVE"===f?(c="ACTIVE",d="active",e=!1):(c="FAILED"===f||"STATE_FAILED"===f?"FAILED":"PROCESSING",d="ready_for_indexing",e=!0)}catch(f){iH.warn({url:b.url,documentName:a.result.name,error:f},"Could not verify document state, deleting and will retry next run"),c="PROCESSING",d="ready_for_indexing",e=!0}if(e)try{iH.info({url:b.url,documentName:a.result.name,state:c},"Deleting incomplete document from Gemini to avoid duplication on retry"),await iB(a.result.name)}catch(c){iH.warn({url:b.url,documentName:a.result.name,error:c},"Failed to delete incomplete document (may already be deleted)")}p[b.id]=c;let f={status:d,last_scraped:new Date().toISOString(),error_message:"FAILED"===c?"Document processing failed in Gemini, will retry":void 0};"active"===d&&(f.gemini_file_id=a.result.name,f.gemini_file_name=a.result.displayName??void 0),await eT(b.id,f),"active"===d?l++:iH.debug({url:b.url,documentState:c,note:"Document uploaded but not active, deleted and will retry next run"},"Document not yet active, deleted to avoid duplication")}else{let c=a.error||"Unknown upload error";iH.error({url:b.url,error:c},"Failed to upload page to Gemini"),f.push({url:b.url,error:c,timestamp:h}),await eT(b.id,{error_message:c})}}iH.info({batchNumber:d,totalBatches:e,batchCompleted:i.length,totalIndexed:l,totalProcessed:a+c.length},"Batch completed and saved to database"),a+o<k.length&&await new Promise(a=>setTimeout(a,500))}return await eV(j.id,{status:"completed",urls_updated:l,urls_errored:f.length,errors:f,completed_at:new Date().toISOString(),metadata:{ingestionJobId:c,documentStates:p,activeCount:Object.values(p).filter(a=>"ACTIVE"===a).length,processingCount:Object.values(p).filter(a=>"PROCESSING"===a).length,failedCount:Object.values(p).filter(a=>"FAILED"===a).length}}),iH.info({indexingJobId:j.id,websiteId:a,pagesIndexed:l,errors:f.length},"Indexing complete"),{indexingJobId:j.id,websiteId:a,pagesIndexed:l,errors:f}}catch(b){let a=b instanceof Error?b.message:"Unknown error";throw await eV(j.id,{status:"failed",errors:[...f,{url:i.seed_url,error:a,timestamp:new Date().toISOString()}],completed_at:new Date().toISOString()}),iH.error({indexingJobId:j.id,error:a},"Indexing failed"),b}}async function iJ(a){try{let b=await is(a);return{success:!0,data:b}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error occurred"}}}async function iK(a,b){try{let c=await it(a,b);return{success:!0,data:c,jobId:c.ingestionJobId}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error occurred"}}}async function iL(a){try{let b=await eX(a,{processType:"ingestion",limit:1});if(0===b.length)return{success:!1,error:"No ingestion job found for this website"};let c=b[0],d=(c.metadata||{}).progress;return{success:!0,data:{jobId:c.id,status:c.status,progress:d?{completed:d.completed??0,total:d.total??0,percentage:d.percentage??0}:void 0,urlsDiscovered:c.urls_discovered??void 0,urlsUpdated:c.urls_updated??void 0,urlsErrored:c.urls_errored??void 0,errors:c.errors??void 0,completedAt:c.completed_at??void 0}}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error occurred"}}}async function iM(a,b){try{let c=await iI(a,{ingestionJobId:b});return{success:!0,data:{websiteId:c.websiteId,pagesIndexed:c.pagesIndexed,errors:c.errors}}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Unknown error occurred"}}}(0,c(18337).D)([iJ,iK,iL,iM]),(0,aE.A)(iJ,"40622ed279d917b6463604c69302242b45356ef24b",null),(0,aE.A)(iK,"60d306fda615a5dc15be3c0235749ca6d4859c5b62",null),(0,aE.A)(iL,"40e068f070ee0c87ce95f28eee71a4e4ab2ad0f669",null),(0,aE.A)(iM,"6059c8a6b5b82ffc7a1d5d100ac4868c75861c3a08",null)},9362:(a,b,c)=>{"use strict";let d=Symbol.for("pino.metadata"),{DEFAULT_LEVELS:e}=c(21258),f=e.info;function g(a,b){return a.level-b.level}a.exports=function(a,b){a=a||[],b=b||{dedupe:!1};let c=Object.create(e);c.silent=1/0,b.levels&&"object"==typeof b.levels&&Object.keys(b.levels).forEach(a=>{c[a]=b.levels[a]});let h={write:i,add:l,remove:m,emit:j,flushSync:k,end:function(){for(let{stream:a}of this.streams)"function"==typeof a.flushSync&&a.flushSync(),a.end()},minLevel:0,lastId:0,streams:[],clone:function a(b){let c=Array(this.streams.length);for(let a=0;a<c.length;a++)c[a]={level:b,stream:this.streams[a].stream};return{write:i,add:l,remove:m,minLevel:b,streams:c,clone:a,emit:j,flushSync:k,[d]:!0}},[d]:!0,streamLevels:c};return Array.isArray(a)?a.forEach(l,h):l.call(h,a),a=null,h;function i(a){var c,e,f,g;let h,i,j=this.lastLevel,{streams:k}=this,l=0;for(let m=(c=k.length,b.dedupe?c-1:0);e=m,f=k.length,b.dedupe?e>=0:e<f;g=m,m=b.dedupe?g-1:g+1)if((h=k[m]).level<=j){if(0!==l&&l!==h.level)break;if((i=h.stream)[d]){let{lastTime:a,lastMsg:b,lastObj:c,lastLogger:d}=this;i.lastLevel=j,i.lastTime=a,i.lastMsg=b,i.lastObj=c,i.lastLogger=d}i.write(a),b.dedupe&&(l=h.level)}else if(!b.dedupe)break}function j(...a){for(let{stream:b}of this.streams)"function"==typeof b.emit&&b.emit(...a)}function k(){for(let{stream:a}of this.streams)"function"==typeof a.flushSync&&a.flushSync()}function l(a){if(!a)return h;let b="function"==typeof a.write||a.stream,c=a.write?a:a.stream;if(!b)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");let{streams:d,streamLevels:e}=this,i={stream:c,level:"number"==typeof a.levelVal?a.levelVal:"string"==typeof a.level?e[a.level]:"number"==typeof a.level?a.level:f,levelVal:void 0,id:++h.lastId};return d.unshift(i),d.sort(g),this.minLevel=d[0].level,h}function m(a){let{streams:b}=this,c=b.findIndex(b=>b.id===a);return c>=0&&(b.splice(c,1),b.sort(g),this.minLevel=b.length>0?b[0].level:-1),h}}},9612:(a,b,c)=>{"use strict";let{Writable:d}=c(27910),e=c(7775),{BINARY_TYPES:f,EMPTY_BUFFER:g,kStatusCode:h,kWebSocket:i}=c(40826),{concat:j,toArrayBuffer:k,unmask:l}=c(65158),{isValidStatusCode:m,isValidUTF8:o}=c(83170),p=Buffer[Symbol.species];class q extends d{constructor(a={}){super(),this._allowSynchronousEvents=void 0===a.allowSynchronousEvents||a.allowSynchronousEvents,this._binaryType=a.binaryType||f[0],this._extensions=a.extensions||{},this._isServer=!!a.isServer,this._maxPayload=0|a.maxPayload,this._skipUTF8Validation=!!a.skipUTF8Validation,this[i]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=0}_write(a,b,c){if(8===this._opcode&&0==this._state)return c();this._bufferedBytes+=a.length,this._buffers.push(a),this.startLoop(c)}consume(a){if(this._bufferedBytes-=a,a===this._buffers[0].length)return this._buffers.shift();if(a<this._buffers[0].length){let b=this._buffers[0];return this._buffers[0]=new p(b.buffer,b.byteOffset+a,b.length-a),new p(b.buffer,b.byteOffset,a)}let b=Buffer.allocUnsafe(a);do{let c=this._buffers[0],d=b.length-a;a>=c.length?b.set(this._buffers.shift(),d):(b.set(new Uint8Array(c.buffer,c.byteOffset,a),d),this._buffers[0]=new p(c.buffer,c.byteOffset+a,c.length-a)),a-=c.length}while(a>0);return b}startLoop(a){this._loop=!0;do switch(this._state){case 0:this.getInfo(a);break;case 1:this.getPayloadLength16(a);break;case 2:this.getPayloadLength64(a);break;case 3:this.getMask();break;case 4:this.getData(a);break;case 5:case 6:this._loop=!1;return}while(this._loop);this._errored||a()}getInfo(a){if(this._bufferedBytes<2){this._loop=!1;return}let b=this.consume(2);if((48&b[0])!=0)return void a(this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3"));let c=(64&b[0])==64;if(c&&!this._extensions[e.extensionName])return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._fin=(128&b[0])==128,this._opcode=15&b[0],this._payloadLength=127&b[1],0===this._opcode){if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(!this._fragmented)return void a(this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE"));this._opcode=this._fragmented}else if(1===this._opcode||2===this._opcode){if(this._fragmented)return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));this._compressed=c}else{if(!(this._opcode>7)||!(this._opcode<11))return void a(this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE"));if(!this._fin)return void a(this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN"));if(c)return void a(this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1"));if(this._payloadLength>125||8===this._opcode&&1===this._payloadLength)return void a(this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH"))}if(this._fin||this._fragmented||(this._fragmented=this._opcode),this._masked=(128&b[1])==128,this._isServer){if(!this._masked)return void a(this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK"))}else if(this._masked)return void a(this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK"));126===this._payloadLength?this._state=1:127===this._payloadLength?this._state=2:this.haveLength(a)}getPayloadLength16(a){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(a)}getPayloadLength64(a){if(this._bufferedBytes<8){this._loop=!1;return}let b=this.consume(8),c=b.readUInt32BE(0);if(c>2097151)return void a(this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH"));this._payloadLength=0x100000000*c+b.readUInt32BE(4),this.haveLength(a)}haveLength(a){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0))return void a(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._masked?this._state=3:this._state=4}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=4}getData(a){let b=g;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}b=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!=0&&l(b,this._mask)}if(this._opcode>7)return void this.controlMessage(b,a);if(this._compressed){this._state=5,this.decompress(b,a);return}b.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(b)),this.dataMessage(a)}decompress(a,b){this._extensions[e.extensionName].decompress(a,this._fin,(a,c)=>{if(a)return b(a);if(c.length){if(this._messageLength+=c.length,this._messageLength>this._maxPayload&&this._maxPayload>0)return void b(this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH"));this._fragments.push(c)}this.dataMessage(b),0===this._state&&this.startLoop(b)})}dataMessage(a){if(!this._fin){this._state=0;return}let b=this._messageLength,c=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],2===this._opcode){let d;d="nodebuffer"===this._binaryType?j(c,b):"arraybuffer"===this._binaryType?k(j(c,b)):"blob"===this._binaryType?new Blob(c):c,this._allowSynchronousEvents?(this.emit("message",d,!0),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!0),this._state=0,this.startLoop(a)}))}else{let d=j(c,b);if(!this._skipUTF8Validation&&!o(d))return void a(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));5===this._state||this._allowSynchronousEvents?(this.emit("message",d,!1),this._state=0):(this._state=6,setImmediate(()=>{this.emit("message",d,!1),this._state=0,this.startLoop(a)}))}}controlMessage(a,b){if(8===this._opcode){if(0===a.length)this._loop=!1,this.emit("conclude",1005,g),this.end();else{let c=a.readUInt16BE(0);if(!m(c))return void b(this.createError(RangeError,`invalid status code ${c}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE"));let d=new p(a.buffer,a.byteOffset+2,a.length-2);if(!this._skipUTF8Validation&&!o(d))return void b(this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8"));this._loop=!1,this.emit("conclude",c,d),this.end()}this._state=0;return}this._allowSynchronousEvents?(this.emit(9===this._opcode?"ping":"pong",a),this._state=0):(this._state=6,setImmediate(()=>{this.emit(9===this._opcode?"ping":"pong",a),this._state=0,this.startLoop(b)}))}createError(a,b,c,d,e){this._loop=!1,this._errored=!0;let f=new a(c?`Invalid WebSocket frame: ${b}`:b);return Error.captureStackTrace(f,this.createError),f.code=e,f[h]=d,f}}a.exports=q},10006:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.AwsClient=void 0;let d=c(98704),e=c(8011),f=c(33758),g=c(21827),h=c(15921);class i extends e.BaseExternalAccountClient{environmentId;awsSecurityCredentialsSupplier;regionalCredVerificationUrl;awsRequestSigner;region;static #c="https://sts.{region}.amazonaws.com?Action=GetCallerIdentity&Version=2011-06-15";static AWS_EC2_METADATA_IPV4_ADDRESS="169.254.169.254";static AWS_EC2_METADATA_IPV6_ADDRESS="fd00:ec2::254";constructor(a){super(a);let b=(0,g.originalOrCamelOptions)(a),c=b.get("credential_source"),d=b.get("aws_security_credentials_supplier");if(!c&&!d)throw Error("A credential source or AWS security credentials supplier must be specified.");if(c&&d)throw Error("Only one of credential source or AWS security credentials supplier can be specified.");if(d)this.awsSecurityCredentialsSupplier=d,this.regionalCredVerificationUrl=i.#c,this.credentialSourceType="programmatic";else{let a=(0,g.originalOrCamelOptions)(c);this.environmentId=a.get("environment_id");let b=a.get("region_url"),d=a.get("url"),e=a.get("imdsv2_session_token_url");this.awsSecurityCredentialsSupplier=new f.DefaultAwsSecurityCredentialsSupplier({regionUrl:b,securityCredentialsUrl:d,imdsV2SessionTokenUrl:e}),this.regionalCredVerificationUrl=a.get("regional_cred_verification_url"),this.credentialSourceType="aws",this.validateEnvironmentId()}this.awsRequestSigner=null,this.region=""}validateEnvironmentId(){let a=this.environmentId?.match(/^(aws)(\d+)$/);if(a&&this.regionalCredVerificationUrl){if(1!==parseInt(a[2],10))throw Error(`aws version "${a[2]}" is not supported in the current build.`)}else throw Error('No valid AWS "credential_source" provided')}async retrieveSubjectToken(){this.awsRequestSigner||(this.region=await this.awsSecurityCredentialsSupplier.getAwsRegion(this.supplierContext),this.awsRequestSigner=new d.AwsRequestSigner(async()=>this.awsSecurityCredentialsSupplier.getAwsSecurityCredentials(this.supplierContext),this.region));let a=await this.awsRequestSigner.getRequestOptions({...i.RETRY_CONFIG,url:this.regionalCredVerificationUrl.replace("{region}",this.region),method:"POST"}),b=[];return h.Gaxios.mergeHeaders({"x-goog-cloud-target-resource":this.audience},a.headers).forEach((a,c)=>b.push({key:c,value:a})),encodeURIComponent(JSON.stringify({url:a.url,method:a.method,headers:b}))}}b.AwsClient=i},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11095:(a,b,c)=>{"use strict";let d=c(29021),e=c(94735),f=c(28354).inherits,g=c(33873),h=c(21540),i=c(12412),j=Buffer.allocUnsafe(0),k="buffer",l="utf8",[m,o]=(process.versions.node||"0.0").split(".").map(Number),p=m>=22&&o>=7;function q(a,b){function c(c,d){if(c){b._reopening=!1,b._writing=!1,b._opening=!1,b.sync?process.nextTick(()=>{b.listenerCount("error")>0&&b.emit("error",c)}):b.emit("error",c);return}let e=b._reopening;b.fd=d,b.file=a,b._reopening=!1,b._opening=!1,b._writing=!1,b.sync?process.nextTick(()=>b.emit("ready")):b.emit("ready"),!b.destroyed&&(!b._writing&&b._len>b.minLength||b._flushPending?b._actualWrite():e&&process.nextTick(()=>b.emit("drain")))}b._opening=!0,b._writing=!0,b._asyncDrainScheduled=!1;let e=b.append?"a":"w",f=b.mode;if(b.sync)try{b.mkdir&&d.mkdirSync(g.dirname(a),{recursive:!0});let h=d.openSync(a,e,f);c(null,h)}catch(a){throw c(a),a}else b.mkdir?d.mkdir(g.dirname(a),{recursive:!0},b=>{if(b)return c(b);d.open(a,e,f,c)}):d.open(a,e,f,c)}function r(a){let b,c;if(!(this instanceof r))return new r(a);let{fd:e,dest:f,minLength:g,maxLength:i,maxWrite:m,periodicFlush:o,sync:p,append:u=!0,mkdir:x,retryEAGAIN:F,fsync:G,contentMode:H,mode:I}=a||{};if(e=e||f,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=!1,this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._flushPending=!1,this._hwm=Math.max(g||0,16387),this.file=null,this.destroyed=!1,this.minLength=g||0,this.maxLength=i||0,this.maxWrite=m||16384,this._periodicFlush=o||0,this._periodicFlushTimer=void 0,this.sync=p||!1,this.writable=!0,this._fsync=G||!1,this.append=u||!1,this.mode=I,this.retryEAGAIN=F||(()=>!0),this.mkdir=x||!1,H===k)this._writingBuf=j,this.write=w,this.flush=z,this.flushSync=B,this._actualWrite=D,b=()=>d.writeSync(this.fd,this._writingBuf),c=()=>d.write(this.fd,this._writingBuf,this.release);else if(void 0===H||H===l)this._writingBuf="",this.write=v,this.flush=y,this.flushSync=A,this._actualWrite=C,b=()=>d.writeSync(this.fd,this._writingBuf,"utf8"),c=()=>d.write(this.fd,this._writingBuf,"utf8",this.release);else throw Error(`SonicBoom supports "${l}" and "${k}", but passed ${H}`);if("number"==typeof e)this.fd=e,process.nextTick(()=>this.emit("ready"));else if("string"==typeof e)q(e,this);else throw Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(a,e)=>{if(a){if(("EAGAIN"===a.code||"EBUSY"===a.code)&&this.retryEAGAIN(a,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{h(100),this.release(void 0,0)}catch(a){this.release(a)}else setTimeout(c,100);else this._writing=!1,this.emit("error",a);return}this.emit("write",e);let f=s(this._writingBuf,this._len,e);if(this._len=f.len,this._writingBuf=f.writingBuf,this._writingBuf.length){if(!this.sync)return void c();try{do{let a=b(),c=s(this._writingBuf,this._len,a);this._len=c.len,this._writingBuf=c.writingBuf}while(this._writingBuf.length)}catch(a){this.release(a);return}}this._fsync&&d.fsyncSync(this.fd);let g=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):g>this.minLength?this._actualWrite():this._ending?g>0?this._actualWrite():(this._writing=!1,E(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(t,this)):this.emit("drain"))},this.on("newListener",function(a){"drain"===a&&(this._asyncDrainScheduled=!1)}),0!==this._periodicFlush&&(this._periodicFlushTimer=setInterval(()=>this.flush(null),this._periodicFlush),this._periodicFlushTimer.unref())}function s(a,b,c){return"string"==typeof a&&Buffer.byteLength(a)!==c&&(c=Buffer.from(a).subarray(0,c).toString().length),b=Math.max(b-c,0),{writingBuf:a=a.slice(c),len:b}}function t(a){a.listenerCount("drain")>0&&(a._asyncDrainScheduled=!1,a.emit("drain"))}function u(a,b){return 0===a.length?j:1===a.length?a[0]:Buffer.concat(a,b)}function v(a){if(this.destroyed)throw Error("SonicBoom destroyed");let b=this._len+a.length,c=this._bufs;return this.maxLength&&b>this.maxLength?this.emit("drop",a):(0===c.length||c[c.length-1].length+a.length>this.maxWrite?c.push(""+a):c[c.length-1]+=a,this._len=b,!this._writing&&this._len>=this.minLength&&this._actualWrite()),this._len<this._hwm}function w(a){if(this.destroyed)throw Error("SonicBoom destroyed");let b=this._len+a.length,c=this._bufs,d=this._lens;return this.maxLength&&b>this.maxLength?this.emit("drop",a):(0===c.length||d[d.length-1]+a.length>this.maxWrite?(c.push([a]),d.push(a.length)):(c[c.length-1].push(a),d[d.length-1]+=a.length),this._len=b,!this._writing&&this._len>=this.minLength&&this._actualWrite()),this._len<this._hwm}function x(a){this._flushPending=!0;let b=()=>{if(this._fsync)this._flushPending=!1,a();else try{d.fsync(this.fd,b=>{this._flushPending=!1,a(b)})}catch(b){a(b)}this.off("error",c)},c=c=>{this._flushPending=!1,a(c),this.off("drain",b)};this.once("drain",b),this.once("error",c)}function y(a){if(null!=a&&"function"!=typeof a)throw Error("flush cb must be a function");if(this.destroyed){let b=Error("SonicBoom destroyed");if(a)return void a(b);throw b}if(this.minLength<=0)return void a?.();a&&x.call(this,a),this._writing||(0===this._bufs.length&&this._bufs.push(""),this._actualWrite())}function z(a){if(null!=a&&"function"!=typeof a)throw Error("flush cb must be a function");if(this.destroyed){let b=Error("SonicBoom destroyed");if(a)return void a(b);throw b}if(this.minLength<=0)return void a?.();a&&x.call(this,a),this._writing||(0===this._bufs.length&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite())}function A(){if(this.destroyed)throw Error("SonicBoom destroyed");if(this.fd<0)throw Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let a="";for(;this._bufs.length||a;){a.length<=0&&(a=this._bufs[0]);try{let b=d.writeSync(this.fd,a,"utf8"),c=s(a,this._len,b);a=c.writingBuf,this._len=c.len,a.length<=0&&this._bufs.shift()}catch(b){if(("EAGAIN"===b.code||"EBUSY"===b.code)&&!this.retryEAGAIN(b,a.length,this._len-a.length))throw b;h(100)}}try{d.fsyncSync(this.fd)}catch{}}function B(){if(this.destroyed)throw Error("SonicBoom destroyed");if(this.fd<0)throw Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=j);let a=j;for(;this._bufs.length||a.length;){a.length<=0&&(a=u(this._bufs[0],this._lens[0]));try{let b=d.writeSync(this.fd,a);a=a.subarray(b),this._len=Math.max(this._len-b,0),a.length<=0&&(this._bufs.shift(),this._lens.shift())}catch(b){if(("EAGAIN"===b.code||"EBUSY"===b.code)&&!this.retryEAGAIN(b,a.length,this._len-a.length))throw b;h(100)}}}function C(){let a=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf||this._bufs.shift()||"",this.sync)try{let b=d.writeSync(this.fd,this._writingBuf,"utf8");a(null,b)}catch(b){a(b)}else d.write(this.fd,this._writingBuf,"utf8",a)}function D(){let a=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:u(this._bufs.shift(),this._lens.shift()),this.sync)try{let b=d.writeSync(this.fd,this._writingBuf);a(null,b)}catch(b){a(b)}else p&&(this._writingBuf=Buffer.from(this._writingBuf)),d.write(this.fd,this._writingBuf,a)}function E(a){if(-1===a.fd)return void a.once("ready",E.bind(null,a));void 0!==a._periodicFlushTimer&&clearInterval(a._periodicFlushTimer),a.destroyed=!0,a._bufs=[],a._lens=[],i("number"==typeof a.fd,`sonic.fd must be a number, got ${typeof a.fd}`);try{d.fsync(a.fd,function(){1!==a.fd&&2!==a.fd?d.close(a.fd,b):b()})}catch{}function b(b){if(b)return void a.emit("error",b);a._ending&&!a._writing&&a.emit("finish"),a.emit("close")}}f(r,e),r.prototype.reopen=function(a){if(this.destroyed)throw Error("SonicBoom destroyed");if(this._opening)return void this.once("ready",()=>{this.reopen(a)});if(this._ending)return;if(!this.file)throw Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(a&&(this.file=a),this._reopening=!0,this._writing)return;let b=this.fd;this.once("ready",()=>{b!==this.fd&&d.close(b,a=>{if(a)return this.emit("error",a)})}),q(this.file,this)},r.prototype.end=function(){if(this.destroyed)throw Error("SonicBoom destroyed");if(this._opening)return void this.once("ready",()=>{this.end()});!this._ending&&(this._ending=!0,this._writing||(this._len>0&&this.fd>=0?this._actualWrite():E(this)))},r.prototype.destroy=function(){this.destroyed||E(this)},r.SonicBoom=r,r.default=r,a.exports=r},11157:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.GoogleToken=void 0;var d=i(c(29021)),e=c(15921),f=i(c(52302)),g=i(c(33873)),h=c(28354);function i(a,b){if("function"==typeof WeakMap)var c=new WeakMap,d=new WeakMap;return(i=function(a,b){if(!b&&a&&a.__esModule)return a;var e,f,g={__proto__:null,default:a};if(null===a||"object"!=j(a)&&"function"!=typeof a)return g;if(e=b?d:c){if(e.has(a))return e.get(a);e.set(a,g)}for(var h in a)"default"!==h&&({}).hasOwnProperty.call(a,h)&&((f=(e=Object.defineProperty)&&Object.getOwnPropertyDescriptor(a,h))&&(f.get||f.set)?e(g,h,f):g[h]=a[h]);return g})(a,b)}function j(a){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a})(a)}function k(a,b){if(b.has(a))throw TypeError("Cannot initialize the same private elements twice on an object")}function l(a,b,c){return a.set(m(a,b),c),c}function m(a,b,c){if("function"==typeof a?a===b:a.has(b))return arguments.length<3?b:c;throw TypeError("Private element is not present on this object")}function o(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,w(d.key),d)}}function p(a,b,c){return b&&o(a.prototype,b),c&&o(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function q(a,b){if(!(a instanceof b))throw TypeError("Cannot call a class as a function")}function r(a){var b="function"==typeof Map?new Map:void 0;return(r=function(a){if(null===a||!function(a){try{return -1!==Function.toString.call(a).indexOf("[native code]")}catch(b){return"function"==typeof a}}(a))return a;if("function"!=typeof a)throw TypeError("Super expression must either be null or a function");if(void 0!==b){if(b.has(a))return b.get(a);b.set(a,c)}function c(){return function(a,b,c){if(s())return Reflect.construct.apply(null,arguments);var d=[null];d.push.apply(d,b);var e=new(a.bind.apply(a,d));return c&&t(e,c.prototype),e}(a,arguments,u(this).constructor)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),t(c,a)})(a)}function s(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(a){}return(s=function(){return!!a})()}function t(a,b){return(t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,b){return a.__proto__=b,a})(a,b)}function u(a){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function v(a,b,c){return(b=w(b))in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function w(a){var b=function(a,b){if("object"!=j(a)||!a)return a;var c=a[Symbol.toPrimitive];if(void 0!==c){var d=c.call(a,b||"default");if("object"!=j(d))return d;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}(a,"string");return"symbol"==j(b)?b:b+""}function x(){var a,b,c="function"==typeof Symbol?Symbol:{},d=c.iterator||"@@iterator",e=c.toStringTag||"@@toStringTag";function f(c,d,e,f){var i=Object.create((d&&d.prototype instanceof h?d:h).prototype);return y(i,"_invoke",function(c,d,e){var f,h,i,j=0,k=e||[],l=!1,m={p:0,n:0,v:a,a:o,f:o.bind(a,4),d:function(b,c){return f=b,h=0,i=a,m.n=c,g}};function o(c,d){for(h=c,i=d,b=0;!l&&j&&!e&&b<k.length;b++){var e,f=k[b],o=m.p,p=f[2];c>3?(e=p===d)&&(i=f[(h=f[4])?5:(h=3,3)],f[4]=f[5]=a):f[0]<=o&&((e=c<2&&o<f[1])?(h=0,m.v=d,m.n=f[1]):o<p&&(e=c<3||f[0]>d||d>p)&&(f[4]=c,f[5]=d,m.n=p,h=0))}if(e||c>1)return g;throw l=!0,d}return function(e,k,p){if(j>1)throw TypeError("Generator is already running");for(l&&1===k&&o(k,p),h=k,i=p;(b=h<2?a:i)||!l;){f||(h?h<3?(h>1&&(m.n=-1),o(h,i)):m.n=i:m.v=i);try{if(j=2,f){if(h||(e="next"),b=f[e]){if(!(b=b.call(f,i)))throw TypeError("iterator result is not an object");if(!b.done)return b;i=b.value,h<2&&(h=0)}else 1===h&&(b=f.return)&&b.call(f),h<2&&(i=TypeError("The iterator does not provide a '"+e+"' method"),h=1);f=a}else if((b=(l=m.n<0)?i:c.call(d,m))!==g)break}catch(b){f=a,h=1,i=b}finally{j=1}}return{value:b,done:l}}}(c,e,f),!0),i}var g={};function h(){}function i(){}function j(){}b=Object.getPrototypeOf;var k=j.prototype=h.prototype=Object.create([][d]?b(b([][d]())):(y(b={},d,function(){return this}),b));function l(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,j):(a.__proto__=j,y(a,e,"GeneratorFunction")),a.prototype=Object.create(k),a}return i.prototype=j,y(k,"constructor",j),y(j,"constructor",i),i.displayName="GeneratorFunction",y(j,e,"GeneratorFunction"),y(k),y(k,e,"Generator"),y(k,d,function(){return this}),y(k,"toString",function(){return"[object Generator]"}),(x=function(){return{w:f,m:l}})()}function y(a,b,c,d){var e=Object.defineProperty;try{e({},"",{})}catch(a){e=0}(y=function(a,b,c,d){if(b)e?e(a,b,{value:c,enumerable:!d,configurable:!d,writable:!d}):a[b]=c;else{var f=function(b,c){y(a,b,function(a){return this._invoke(b,c,a)})};f("next",0),f("throw",1),f("return",2)}})(a,b,c,d)}function z(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function A(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){z(f,d,e,g,h,"next",a)}function h(a){z(f,d,e,g,h,"throw",a)}g(void 0)})}}var B=d.readFile?(0,h.promisify)(d.readFile):A(x().m(function a(){return x().w(function(a){for(;;)switch(a.n){case 0:throw new D("use key rather than keyFile.","MISSING_CREDENTIALS");case 1:return a.a(2)}},a)})),C="https://oauth2.googleapis.com/token",D=function(a){function b(a,c){var d,e,f;return q(this,b),e=b,f=[a],e=u(e),v(d=function(a,b){if(b&&("object"==j(b)||"function"==typeof b))return b;if(void 0!==b)throw TypeError("Derived constructors may only return object or undefined");var c=a;if(void 0===c)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return c}(this,s()?Reflect.construct(e,f||[],u(this).constructor):e.apply(this,f)),"code",void 0),d.code=c,d}if("function"!=typeof a&&null!==a)throw TypeError("Super expression must either be null or a function");return b.prototype=Object.create(a&&a.prototype,{constructor:{value:b,writable:!0,configurable:!0}}),Object.defineProperty(b,"prototype",{writable:!1}),a&&t(b,a),p(b)}(r(Error)),E=new WeakMap,F=new WeakSet;function G(a){return H.apply(this,arguments)}function H(){return(H=A(x().m(function a(b){return x().w(function(a){for(;;)switch(a.n){case 0:if(!E.get(m(E,this))||b.forceRefresh){a.n=1;break}return a.a(2,E.get(m(E,this)));case 1:return a.p=1,a.n=2,l(E,this,m(F,this,I).call(this,b));case 2:return a.a(2,a.v);case 3:return a.p=3,l(E,this,void 0),a.f(3);case 4:return a.a(2)}},a,this,[[1,,3,4]])}))).apply(this,arguments)}function I(a){return J.apply(this,arguments)}function J(){return(J=A(x().m(function a(b){var c;return x().w(function(a){for(;;)switch(a.n){case 0:if(!1!==this.isTokenExpiring()||!1!==b.forceRefresh){a.n=1;break}return a.a(2,Promise.resolve(this.rawToken));case 1:if(!(!this.key&&!this.keyFile)){a.n=2;break}throw Error("No key or keyFile set.");case 2:if(!(!this.key&&this.keyFile)){a.n=4;break}return a.n=3,this.getCredentials(this.keyFile);case 3:c=a.v,this.key=c.privateKey,this.iss=c.clientEmail||this.iss,c.clientEmail||m(F,this,K).call(this);case 4:return a.a(2,m(F,this,O).call(this))}},a,this)}))).apply(this,arguments)}function K(){if(!this.iss)throw new D("email is required.","MISSING_CREDENTIALS")}function L(){return M.apply(this,arguments)}function M(){return(M=A(x().m(function a(){var b;return x().w(function(a){for(;;)switch(a.n){case 0:if(this.accessToken){a.n=1;break}throw Error("No token to revoke.");case 1:return b="https://oauth2.googleapis.com/revoke?token="+this.accessToken,a.n=2,this.transporter.request({url:b,retry:!0});case 2:m(F,this,N).call(this,{email:this.iss,sub:this.sub,key:this.key,keyFile:this.keyFile,scope:this.scope,additionalClaims:this.additionalClaims});case 3:return a.a(2)}},a,this)}))).apply(this,arguments)}function N(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.keyFile=a.keyFile,this.key=a.key,this.rawToken=void 0,this.iss=a.email||a.iss,this.sub=a.sub,this.additionalClaims=a.additionalClaims,"object"===j(a.scope)?this.scope=a.scope.join(" "):this.scope=a.scope,this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis,a.transporter&&(this.transporter=a.transporter)}function O(){return P.apply(this,arguments)}function P(){return(P=A(x().m(function a(){var b,c,d,e,g,h,i,j,k,l;return x().w(function(a){for(;;)switch(a.n){case 0:return b=Math.floor(new Date().getTime()/1e3),c=this.additionalClaims||{},d=Object.assign({iss:this.iss,scope:this.scope,aud:C,exp:b+3600,iat:b,sub:this.sub},c),e=f.sign({header:{alg:"RS256"},payload:d,secret:this.key}),a.p=1,a.n=2,this.transporter.request({method:"POST",url:C,data:new URLSearchParams({grant_type:"urn:ietf:params:oauth:grant-type:jwt-bearer",assertion:e}),responseType:"json",retryConfig:{httpMethodsToRetry:["POST"]}});case 2:return g=a.v,this.rawToken=g.data,this.expiresAt=null===g.data.expires_in||void 0===g.data.expires_in?void 0:(b+g.data.expires_in)*1e3,a.a(2,this.rawToken);case 3:throw a.p=3,l=a.v,this.rawToken=void 0,this.tokenExpires=void 0,(j=l.response&&null!=(h=l.response)&&h.data?null==(i=l.response)?void 0:i.data:{}).error&&(k=j.error_description?": ".concat(j.error_description):"",l.message="".concat(j.error).concat(k)),l;case 4:return a.a(2)}},a,this,[[1,3]])}))).apply(this,arguments)}b.GoogleToken=function(){var a;return p(function a(b){q(this,a),k(this,F),F.add(this),v(this,"expiresAt",void 0),v(this,"key",void 0),v(this,"keyFile",void 0),v(this,"iss",void 0),v(this,"sub",void 0),v(this,"scope",void 0),v(this,"rawToken",void 0),v(this,"tokenExpires",void 0),v(this,"email",void 0),v(this,"additionalClaims",void 0),v(this,"eagerRefreshThresholdMillis",void 0),v(this,"transporter",{request:function(a){return(0,e.request)(a)}}),k(this,E),E.set(this,void 0),m(F,this,N).call(this,b)},[{key:"accessToken",get:function(){return this.rawToken?this.rawToken.access_token:void 0}},{key:"idToken",get:function(){return this.rawToken?this.rawToken.id_token:void 0}},{key:"tokenType",get:function(){return this.rawToken?this.rawToken.token_type:void 0}},{key:"refreshToken",get:function(){return this.rawToken?this.rawToken.refresh_token:void 0}},{key:"hasExpired",value:function(){var a=new Date().getTime();return!this.rawToken||!this.expiresAt||a>=this.expiresAt}},{key:"isTokenExpiring",value:function(){var a,b=new Date().getTime(),c=null!=(a=this.eagerRefreshThresholdMillis)?a:0;return!this.rawToken||!this.expiresAt||this.expiresAt<=b+c}},{key:"getToken",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===j(a)&&(b=a,a=void 0),b=Object.assign({forceRefresh:!1},b),a){var c=a;m(F,this,G).call(this,b).then(function(a){return c(null,a)},a);return}return m(F,this,G).call(this,b)}},{key:"getCredentials",value:(a=A(x().m(function a(b){var c,d,e,f,h;return x().w(function(a){for(;;)switch(a.n){case 0:a.n=".json"===(h=g.extname(b))?1:".der"===h||".crt"===h||".pem"===h?4:".p12"===h||".pfx"===h?6:7;break;case 1:return a.n=2,B(b,"utf8");case 2:if(d=(c=JSON.parse(a.v)).private_key,e=c.client_email,!(!d||!e)){a.n=3;break}throw new D("private_key and client_email are required.","MISSING_CREDENTIALS");case 3:return a.a(2,{privateKey:d,clientEmail:e});case 4:return a.n=5,B(b,"utf8");case 5:return f=a.v,a.a(2,{privateKey:f});case 6:throw new D("*.p12 certificates are not supported after v6.1.2. Consider utilizing *.json format or converting *.p12 to *.pem using the OpenSSL CLI.","UNKNOWN_CERTIFICATE_TYPE");case 7:throw new D("Unknown certificate type. Type is determined based on file extension. Current supported extensions are *.json, and *.pem.","UNKNOWN_CERTIFICATE_TYPE");case 8:return a.a(2)}},a)})),function(b){return a.apply(this,arguments)})},{key:"revokeToken",value:function(a){return a?void m(F,this,L).call(this).then(function(){return a()},a):m(F,this,L).call(this)}}])}()},11723:a=>{"use strict";a.exports=require("querystring")},12412:a=>{"use strict";a.exports=require("assert")},12544:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.fromArrayBufferToHex=function(a){return Array.from(new Uint8Array(a)).map(a=>a.toString(16).padStart(2,"0")).join("")}},14325:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>E.a,__next_app__:()=>K,handler:()=>M,pages:()=>J,routeModule:()=>L,tree:()=>I});var d=c(64073),e=c(11966),f=c(58062),g=c(4863),h=c(8725),i=c(78653),j=c(2084),k=c(61317),l=c(92885),m=c(68303),o=c(82715),p=c(41932),q=c(1738),r=c(31719),s=c(261),t=c(38030),u=c(97411),v=c(26713),w=c(75391),x=c(72012),y=c(20288),z=c(77809),A=c(36951),B=c(2717),C=c(86439),D=c(40003),E=c.n(D),F=c(86943),G=c(84798),H={};for(let a in F)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(H[a]=()=>F[a]);c.d(b,H);let I=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,61618)),"C:\\Users\\chira\\Downloads\\Local - HQ - Master\\Coding\\website-data-mcp-server-project-gemini-file-search\\apps\\web\\app\\page.tsx"]}]},{layout:[()=>Promise.resolve().then(c.bind(c,65485)),"C:\\Users\\chira\\Downloads\\Local - HQ - Master\\Coding\\website-data-mcp-server-project-gemini-file-search\\apps\\web\\app\\layout.tsx"],error:[()=>Promise.resolve().then(c.bind(c,73181)),"C:\\Users\\chira\\Downloads\\Local - HQ - Master\\Coding\\website-data-mcp-server-project-gemini-file-search\\apps\\web\\app\\error.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,40003,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.bind(c,75623)),"C:\\Users\\chira\\Downloads\\Local - HQ - Master\\Coding\\website-data-mcp-server-project-gemini-file-search\\apps\\web\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,96270,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,37929,23)),"next/dist/client/components/builtin/unauthorized.js"]}],J=["C:\\Users\\chira\\Downloads\\Local - HQ - Master\\Coding\\website-data-mcp-server-project-gemini-file-search\\apps\\web\\app\\page.tsx"],K={require:c,loadChunk:()=>Promise.resolve()},L=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:I},distDir:".next",relativeProjectDir:""});async function M(a,b,d){var D;let H="/page";"/index"===H&&(H="/");let N=(0,h.getRequestMeta)(a,"postponed"),O=(0,h.getRequestMeta)(a,"minimalMode"),P=await L.prepare(a,b,{srcPage:H,multiZoneDraftMode:!1});if(!P)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:Q,query:R,params:S,parsedUrl:T,pageIsDynamic:U,buildManifest:V,nextFontManifest:W,reactLoadableManifest:X,serverActionsManifest:Y,clientReferenceManifest:Z,subresourceIntegrityManifest:$,prerenderManifest:_,isDraftMode:aa,resolvedPathname:ab,revalidateOnlyGenerated:ac,routerServerContext:ad,nextConfig:ae,interceptionRoutePatterns:af}=P,ag=T.pathname||"/",ah=(0,s.normalizeAppPath)(H),{isOnDemandRevalidate:ai}=P,aj=L.match(ag,_),ak=!!_.routes[ab],al=!!(aj||ak||_.routes[ah]),am=a.headers["user-agent"]||"",an=(0,v.getBotType)(am),ao=(0,q.isHtmlBotRequest)(a),ap=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[u.NEXT_ROUTER_PREFETCH_HEADER],aq=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[u.RSC_HEADER],ar=(0,t.getIsPossibleServerAction)(a),as=(0,m.checkIsAppPPREnabled)(ae.experimental.ppr)&&(null==(D=_.routes[ah]??_.dynamicRoutes[ah])?void 0:D.renderingMode)==="PARTIALLY_STATIC",at=!1,au=!1,av=as?N:void 0,aw=as&&aq&&!ap,ax=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ay=!am||(0,q.shouldServeStreamingMetadata)(am,ae.htmlLimitedBots);ao&&as&&(al=!1,ay=!1);let az=!0===L.isDev||!al||"string"==typeof N||aw,aA=ao&&as,aB=null;aa||!al||az||ar||av||aw||(aB=ab);let aC=aB;!aC&&L.isDev&&(aC=ab),L.isDev||aa||!al||!aq||aw||(0,k.d)(a.headers);let aD={...F,tree:I,pages:J,GlobalError:E(),handler:M,routeModule:L,__next_app__:K};Y&&Z&&(0,p.setReferenceManifestsSingleton)({page:H,clientReferenceManifest:Z,serverActionsManifest:Y,serverModuleMap:(0,r.createServerModuleMap)({serverActionsManifest:Y})});let aE=a.method||"GET",aF=(0,g.getTracer)(),aG=aF.getActiveScopeSpan();try{let f=L.getVaryHeader(ab,af);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return L.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aF.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aE} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aE} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:R,params:S,page:ah,sharedContext:{buildId:Q},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aD,Component:(0,j.T)(aD),params:S,routeModule:L,page:H,postponed:f,shouldWaitOnAllReady:aA,serveStreamingMetadata:ay,supportsDynamicResponse:"string"==typeof f||az,buildManifest:V,nextFontManifest:W,reactLoadableManifest:X,subresourceIntegrityManifest:$,serverActionsManifest:Y,clientReferenceManifest:Z,setIsrStatus:null==ad?void 0:ad.setIsrStatus,dir:c(33873).join(process.cwd(),L.relativeProjectDir),isDraftMode:aa,isRevalidate:al&&!f&&!aw,botType:an,isOnDemandRevalidate:ai,isPossibleServerAction:ar,assetPrefix:ae.assetPrefix,nextConfigOutput:ae.output,crossOrigin:ae.crossOrigin,trailingSlash:ae.trailingSlash,previewProps:_.preview,deploymentId:ae.deploymentId,enableTainting:ae.experimental.taint,htmlLimitedBots:ae.htmlLimitedBots,devtoolSegmentExplorer:ae.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ae.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ae.experimental.cacheLife,basePath:ae.basePath,serverActions:ae.experimental.serverActions,...at?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:at}:{},experimental:{isRoutePPREnabled:as,expireTime:ae.expireTime,staleTimes:ae.experimental.staleTimes,cacheComponents:!!ae.experimental.cacheComponents,clientSegmentCache:!!ae.experimental.clientSegmentCache,clientParamParsing:!!ae.experimental.clientParamParsing,dynamicOnHover:!!ae.experimental.dynamicOnHover,inlineCss:!!ae.experimental.inlineCss,authInterrupts:!!ae.experimental.authInterrupts,clientTraceMetadata:ae.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>L.onRequestError(a,b,d,ad),err:(0,h.getRequestMeta)(a,"invokeError"),dev:L.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:o,headers:p={},fetchTags:q}=m;if(q&&(p[z.NEXT_CACHE_TAGS_HEADER]=q),a.fetchMetrics=m.fetchMetrics,al&&(null==o?void 0:o.revalidate)===0&&!L.isDev&&!as){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${ab}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:w.CachedRouteKind.APP_PAGE,html:l,headers:p,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:o}},p=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===L.isDev,l=c||b.writableEnded;if(ai&&ac&&!f&&!O)return(null==ad?void 0:ad.render404)?await ad.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(aj&&(j=(0,x.parseFallbackField)(aj.fallback)),j===x.FallbackMode.PRERENDER&&(0,v.isBot)(am)&&(!as||ao)&&(j=x.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ai=!0),ai&&(j!==x.FallbackMode.NOT_FOUND||f)&&(j=x.FallbackMode.BLOCKING_STATIC_RENDER),!O&&j!==x.FallbackMode.BLOCKING_STATIC_RENDER&&aC&&!l&&!aa&&U&&(k||!ak)){let b;if((k||aj)&&j===x.FallbackMode.NOT_FOUND)throw new C.NoFallbackError;if(as&&!aq){let c="string"==typeof(null==aj?void 0:aj.fallback)?aj.fallback:k?ah:null;if(b=await L.handleResponse({cacheKey:c,req:a,nextConfig:ae,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:_,isRoutePPREnabled:as,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||au?(0,o.u)(ah):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let p=ai||g||!av?void 0:av;if(at&&void 0!==p)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:w.CachedRouteKind.PAGES,html:y.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let q=U&&as&&((0,h.getRequestMeta)(a,"renderFallbackShell")||au)?(0,o.u)(ag):null;return m({span:i,postponed:p,fallbackRouteParams:q})},q=async c=>{var f,g,i,j,k;let l,o=await L.handleResponse({cacheKey:aB,responseGenerator:a=>p({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ai,isRoutePPREnabled:as,req:a,nextConfig:ae,prerenderManifest:_,waitUntil:d.waitUntil});if(aa&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),L.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!o){if(aB)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=o.value)?void 0:f.kind)!==w.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=o.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let q="string"==typeof o.value.postponed;al&&!aw&&(!q||ap)&&(O||b.setHeader("x-nextjs-cache",ai?"REVALIDATED":o.isMiss?"MISS":o.isStale?"STALE":"HIT"),b.setHeader(u.NEXT_IS_PRERENDER_HEADER,"1"));let{value:r}=o;if(av)l={revalidate:0,expire:void 0};else if(O&&aq&&!ap&&as)l={revalidate:0,expire:void 0};else if(!L.isDev)if(aa)l={revalidate:0,expire:void 0};else if(al){if(o.cacheControl)if("number"==typeof o.cacheControl.revalidate){if(o.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${o.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:o.cacheControl.revalidate,expire:(null==(j=o.cacheControl)?void 0:j.expire)??ae.expireTime}}else l={revalidate:z.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(o.cacheControl=l,"string"==typeof ax&&(null==r?void 0:r.kind)===w.CachedRouteKind.APP_PAGE&&r.segmentData){b.setHeader(u.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=r.headers)?void 0:k[z.NEXT_CACHE_TAGS_HEADER];O&&al&&c&&"string"==typeof c&&b.setHeader(z.NEXT_CACHE_TAGS_HEADER,c);let d=r.segmentData.get(ax);return void 0!==d?(0,B.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:y.default.fromStatic(d,u.RSC_CONTENT_TYPE_HEADER),cacheControl:o.cacheControl}):(b.statusCode=204,(0,B.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:y.default.EMPTY,cacheControl:o.cacheControl}))}let s=(0,h.getRequestMeta)(a,"onCacheEntry");if(s&&await s({...o,value:{...o.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(q&&av)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(r.headers){let a={...r.headers};for(let[c,d]of(O&&al||delete a[z.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let t=null==(g=r.headers)?void 0:g[z.NEXT_CACHE_TAGS_HEADER];if(O&&al&&t&&"string"==typeof t&&b.setHeader(z.NEXT_CACHE_TAGS_HEADER,t),!r.status||aq&&as||(b.statusCode=r.status),!O&&r.status&&G.RedirectStatusCode[r.status]&&aq&&(b.statusCode=200),q&&b.setHeader(u.NEXT_DID_POSTPONE_HEADER,"1"),aq&&!aa){if(void 0===r.rscData){if(r.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,B.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:r.html,cacheControl:aw?{revalidate:0,expire:void 0}:o.cacheControl})}return(0,B.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:y.default.fromStatic(r.rscData,u.RSC_CONTENT_TYPE_HEADER),cacheControl:o.cacheControl})}let v=r.html;if(!q||O||aq)return(0,B.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:v,cacheControl:o.cacheControl});if(at)return v.push(new ReadableStream({start(a){a.enqueue(A.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,B.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}});let x=new TransformStream;return v.push(x.readable),m({span:c,postponed:r.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==w.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(x.writable)}).catch(a=>{x.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,B.sendRenderResult)({req:a,res:b,generateEtags:ae.generateEtags,poweredByHeader:ae.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}})};if(!aG)return await aF.withPropagatedContext(a.headers,()=>aF.trace(i.BaseServerSpan.handleRequest,{spanName:`${aE} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aE,"http.target":a.url}},q));await q(aG)}catch(b){throw b instanceof C.NoFallbackError||await L.onRequestError(a,b,{routerKind:"App Router",routePath:H,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:al,isOnDemandRevalidate:ai})},ad),b}}},15168:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.InvalidSubjectTokenError=b.InvalidMessageFieldError=b.InvalidCodeFieldError=b.InvalidTokenTypeFieldError=b.InvalidExpirationTimeFieldError=b.InvalidSuccessFieldError=b.InvalidVersionFieldError=b.ExecutableResponseError=b.ExecutableResponse=void 0;let c="urn:ietf:params:oauth:token-type:saml2",d="urn:ietf:params:oauth:token-type:id_token",e="urn:ietf:params:oauth:token-type:jwt";class f{version;success;expirationTime;tokenType;errorCode;errorMessage;subjectToken;constructor(a){if(!a.version)throw new h("Executable response must contain a 'version' field.");if(void 0===a.success)throw new i("Executable response must contain a 'success' field.");if(this.version=a.version,this.success=a.success,this.success){if(this.expirationTime=a.expiration_time,this.tokenType=a.token_type,this.tokenType!==c&&this.tokenType!==d&&this.tokenType!==e)throw new k(`Executable response must contain a 'token_type' field when successful and it must be one of ${d}, ${e}, or ${c}.`);if(this.tokenType===c){if(!a.saml_response)throw new o(`Executable response must contain a 'saml_response' field when token_type=${c}.`);this.subjectToken=a.saml_response}else{if(!a.id_token)throw new o(`Executable response must contain a 'id_token' field when token_type=${d} or ${e}.`);this.subjectToken=a.id_token}}else{if(!a.code)throw new l("Executable response must contain a 'code' field when unsuccessful.");if(!a.message)throw new m("Executable response must contain a 'message' field when unsuccessful.");this.errorCode=a.code,this.errorMessage=a.message}}isValid(){return!this.isExpired()&&this.success}isExpired(){return void 0!==this.expirationTime&&this.expirationTime<Math.round(Date.now()/1e3)}}b.ExecutableResponse=f;class g extends Error{constructor(a){super(a),Object.setPrototypeOf(this,new.target.prototype)}}b.ExecutableResponseError=g;class h extends g{}b.InvalidVersionFieldError=h;class i extends g{}b.InvalidSuccessFieldError=i;class j extends g{}b.InvalidExpirationTimeFieldError=j;class k extends g{}b.InvalidTokenTypeFieldError=k;class l extends g{}b.InvalidCodeFieldError=l;class m extends g{}b.InvalidMessageFieldError=m;class o extends g{}b.InvalidSubjectTokenError=o},15218:a=>{"use strict";let b=Symbol("circular-ref-tag"),c=Symbol("pino-raw-err-ref"),d=Object.create({},{type:{enumerable:!0,writable:!0,value:void 0},message:{enumerable:!0,writable:!0,value:void 0},stack:{enumerable:!0,writable:!0,value:void 0},aggregateErrors:{enumerable:!0,writable:!0,value:void 0},raw:{enumerable:!1,get:function(){return this[c]},set:function(a){this[c]=a}}});Object.defineProperty(d,c,{writable:!0,value:{}}),a.exports={pinoErrProto:d,pinoErrorSymbols:{seen:b,rawSymbol:c}}},15400:function(a,b,c){"use strict";let d;var e,f=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),g=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),h=this&&this.__importStar||(e=function(a){return(e=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b})(a)},function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c=e(a),d=0;d<c.length;d++)"default"!==c[d]&&f(b,a,c[d]);return g(b,a),b}),i=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||f(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),b.gcpResidencyCache=b.METADATA_SERVER_DETECTION=b.HEADERS=b.HEADER_VALUE=b.HEADER_NAME=b.SECONDARY_HOST_ADDRESS=b.HOST_ADDRESS=b.BASE_PATH=void 0,b.instance=function(a){return q("instance",a)},b.project=function(a){return q("project",a)},b.universe=function(a){return q("universe",a)},b.bulk=s,b.isAvailable=t,b.resetIsAvailableCache=function(){d=void 0},b.getGCPResidency=u,b.setGCPResidency=v,b.requestTimeout=w;let j=c(15921),k=c(50094),l=c(46905),m=h(c(86588));b.BASE_PATH="/computeMetadata/v1",b.HOST_ADDRESS="http://169.254.169.254",b.SECONDARY_HOST_ADDRESS="http://metadata.google.internal.",b.HEADER_NAME="Metadata-Flavor",b.HEADER_VALUE="Google",b.HEADERS=Object.freeze({[b.HEADER_NAME]:b.HEADER_VALUE});let o=m.log("gcp-metadata");function p(a){return a||(a=process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST||b.HOST_ADDRESS),/^https?:\/\//.test(a)||(a=`http://${a}`),new URL(b.BASE_PATH,a).href}async function q(a,c={},d=3,e=!1){let f=new Headers(b.HEADERS),g="",h={};("object"==typeof a?(new Headers(a.headers).forEach((a,b)=>f.set(b,a)),g=a.metadataKey,h=a.params||h,d=a.noResponseRetries||d,e=a.fastFail||e):g=a,"string"==typeof c)?g+=`/${c}`:(Object.keys(c).forEach(a=>{switch(a){case"params":case"property":case"headers":break;case"qs":throw Error("'qs' is not a valid configuration option. Please use 'params' instead.");default:throw Error(`'${a}' is not a valid configuration option.`)}}),c.property&&(g+=`/${c.property}`),new Headers(c.headers).forEach((a,b)=>f.set(b,a)),h=c.params||h);let i=e?r:j.request,l={url:`${p()}/${g}`,headers:f,retryConfig:{noResponseRetries:d},params:h,responseType:"text",timeout:w()};o.info("instance request %j",l);let m=await i(l);o.info("instance metadata is %s",m.data);let s=m.headers.get(b.HEADER_NAME);if(s!==b.HEADER_VALUE)throw RangeError(`Invalid response from metadata service: incorrect ${b.HEADER_NAME} header. Expected '${b.HEADER_VALUE}', got ${s?`'${s}'`:"no header"}`);if("string"==typeof m.data)try{return k.parse(m.data)}catch{}return m.data}async function r(a){let c={...a,url:a.url?.toString().replace(p(),p(b.SECONDARY_HOST_ADDRESS))};return Promise.any([(0,j.request)(a),(0,j.request)(c)])}async function s(a){let b={};return await Promise.all(a.map(a=>(async()=>{let c=await q(a);b[a.metadataKey]=c})())),b}async function t(){if(process.env.METADATA_SERVER_DETECTION){let a=process.env.METADATA_SERVER_DETECTION.trim().toLocaleLowerCase();if(!(a in b.METADATA_SERVER_DETECTION))throw RangeError(`Unknown \`METADATA_SERVER_DETECTION\` env variable. Got \`${a}\`, but it should be \`${Object.keys(b.METADATA_SERVER_DETECTION).join("`, `")}\`, or unset`);switch(a){case"assume-present":return!0;case"none":return!1;case"bios-only":return u()}}try{return void 0===d&&(d=q("instance",void 0,process.env.DETECT_GCP_RETRIES?Number(process.env.DETECT_GCP_RETRIES):0,!(process.env.GCE_METADATA_IP||process.env.GCE_METADATA_HOST))),await d,!0}catch(a){if(process.env.DEBUG_AUTH&&console.info(a),"request-timeout"===a.type||a.response&&404===a.response.status)return!1;if(!(a.response&&404===a.response.status)&&(!a.code||!["EHOSTDOWN","EHOSTUNREACH","ENETUNREACH","ENOENT","ENOTFOUND","ECONNREFUSED"].includes(a.code.toString()))){let b="UNKNOWN";a.code&&(b=a.code.toString()),process.emitWarning(`received unexpected error = ${a.message} code = ${b}`,"MetadataLookupWarning")}return!1}}function u(){return null===b.gcpResidencyCache&&v(),b.gcpResidencyCache}function v(a=null){b.gcpResidencyCache=null!==a?a:(0,l.detectGCPResidency)()}function w(){return 3e3*!u()}b.METADATA_SERVER_DETECTION=Object.freeze({"assume-present":"don't try to ping the metadata server, but assume it's present",none:"don't try to ping the metadata server, but don't try to use it either","bios-only":"treat the result of a BIOS probe as canonical (don't fall back to pinging)","ping-only":"skip the BIOS probe, and go straight to pinging"}),b.gcpResidencyCache=null,i(c(46905),b)},15921:function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),b.instance=b.Gaxios=b.GaxiosError=void 0,b.request=h;let f=c(81952);Object.defineProperty(b,"Gaxios",{enumerable:!0,get:function(){return f.Gaxios}});var g=c(73048);async function h(a){return b.instance.request(a)}Object.defineProperty(b,"GaxiosError",{enumerable:!0,get:function(){return g.GaxiosError}}),e(c(64360),b),b.instance=new f.Gaxios},18337:(a,b)=>{"use strict";function c(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(b,"D",{enumerable:!0,get:function(){return c}})},18761:(a,b,c)=>{"use strict";var d=c(79428).Buffer,e=c(79428).SlowBuffer;function f(a,b){if(!d.isBuffer(a)||!d.isBuffer(b)||a.length!==b.length)return!1;for(var c=0,e=0;e<a.length;e++)c|=a[e]^b[e];return 0===c}a.exports=f,f.install=function(){d.prototype.equal=e.prototype.equal=function(a){return f(this,a)}};var g=d.prototype.equal,h=e.prototype.equal;f.restore=function(){d.prototype.equal=g,e.prototype.equal=h}},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19182:(a,b,c)=>{let d=c(29021),e=c(33873),f=c(21820),g=c(55511),h=c(69620).version,i=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function j(a){console.log(`[dotenv@${h}][DEBUG] ${a}`)}function k(a){console.log(`[dotenv@${h}] ${a}`)}function l(a){return a&&a.DOTENV_KEY&&a.DOTENV_KEY.length>0?a.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function m(a){let b=null;if(a&&a.path&&a.path.length>0)if(Array.isArray(a.path))for(let c of a.path)d.existsSync(c)&&(b=c.endsWith(".vault")?c:`${c}.vault`);else b=a.path.endsWith(".vault")?a.path:`${a.path}.vault`;else b=e.resolve(process.cwd(),".env.vault");return d.existsSync(b)?b:null}function o(a){return"~"===a[0]?e.join(f.homedir(),a.slice(1)):a}let p={configDotenv:function(a){let b,c=e.resolve(process.cwd(),".env"),f="utf8",g=!!(a&&a.debug),h=!a||!("quiet"in a)||a.quiet;a&&a.encoding?f=a.encoding:g&&j("No encoding is specified. UTF-8 is used by default");let i=[c];if(a&&a.path)if(Array.isArray(a.path))for(let b of(i=[],a.path))i.push(o(b));else i=[o(a.path)];let l={};for(let c of i)try{let b=p.parse(d.readFileSync(c,{encoding:f}));p.populate(l,b,a)}catch(a){g&&j(`Failed to load ${c} ${a.message}`),b=a}let m=process.env;if(a&&null!=a.processEnv&&(m=a.processEnv),p.populate(m,l,a),g||!h){let a=Object.keys(l).length,c=[];for(let a of i)try{let b=e.relative(process.cwd(),a);c.push(b)}catch(c){g&&j(`Failed to load ${a} ${c.message}`),b=c}k(`injecting env (${a}) from ${c.join(",")}`)}return b?{parsed:l,error:b}:{parsed:l}},_configVault:function(a){let b=!!(a&&a.debug),c=!a||!("quiet"in a)||a.quiet;(b||!c)&&k("Loading env from encrypted .env.vault");let d=p._parseVault(a),e=process.env;return a&&null!=a.processEnv&&(e=a.processEnv),p.populate(e,d,a),{parsed:d}},_parseVault:function(a){let b,c=m(a=a||{});a.path=c;let d=p.configDotenv(a);if(!d.parsed){let a=Error(`MISSING_DATA: Cannot parse ${c} for an unknown reason`);throw a.code="MISSING_DATA",a}let e=l(a).split(","),f=e.length;for(let a=0;a<f;a++)try{let c=e[a].trim(),f=function(a,b){let c;try{c=new URL(b)}catch(a){if("ERR_INVALID_URL"===a.code){let a=Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenvx.com/vault/.env.vault?environment=development");throw a.code="INVALID_DOTENV_KEY",a}throw a}let d=c.password;if(!d){let a=Error("INVALID_DOTENV_KEY: Missing key part");throw a.code="INVALID_DOTENV_KEY",a}let e=c.searchParams.get("environment");if(!e){let a=Error("INVALID_DOTENV_KEY: Missing environment part");throw a.code="INVALID_DOTENV_KEY",a}let f=`DOTENV_VAULT_${e.toUpperCase()}`,g=a.parsed[f];if(!g){let a=Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${f} in your .env.vault file.`);throw a.code="NOT_FOUND_DOTENV_ENVIRONMENT",a}return{ciphertext:g,key:d}}(d,c);b=p.decrypt(f.ciphertext,f.key);break}catch(b){if(a+1>=f)throw b}return p.parse(b)},config:function(a){if(0===l(a).length)return p.configDotenv(a);let b=m(a);if(!b){var c;return c=`You set DOTENV_KEY but you are missing a .env.vault file at ${b}. Did you forget to build it?`,console.log(`[dotenv@${h}][WARN] ${c}`),p.configDotenv(a)}return p._configVault(a)},decrypt:function(a,b){let c=Buffer.from(b.slice(-64),"hex"),d=Buffer.from(a,"base64"),e=d.subarray(0,12),f=d.subarray(-16);d=d.subarray(12,-16);try{let a=g.createDecipheriv("aes-256-gcm",c,e);return a.setAuthTag(f),`${a.update(d)}${a.final()}`}catch(d){let a=d instanceof RangeError,b="Invalid key length"===d.message,c="Unsupported state or unable to authenticate data"===d.message;if(a||b){let a=Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw a.code="INVALID_DOTENV_KEY",a}if(c){let a=Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw a.code="DECRYPTION_FAILED",a}throw d}},parse:function(a){let b,c={},d=a.toString();for(d=d.replace(/\r\n?/mg,"\n");null!=(b=i.exec(d));){let a=b[1],d=b[2]||"",e=(d=d.trim())[0];d=d.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),'"'===e&&(d=(d=d.replace(/\\n/g,"\n")).replace(/\\r/g,"\r")),c[a]=d}return c},populate:function(a,b,c={}){let d=!!(c&&c.debug),e=!!(c&&c.override);if("object"!=typeof b){let a=Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw a.code="OBJECT_REQUIRED",a}for(let c of Object.keys(b))Object.prototype.hasOwnProperty.call(a,c)?(!0===e&&(a[c]=b[c]),d&&(!0===e?j(`"${c}" is already defined and WAS overwritten`):j(`"${c}" is already defined and was NOT overwritten`))):a[c]=b[c]}};a.exports.configDotenv=p.configDotenv,a.exports._configVault=p._configVault,a.exports._parseVault=p._parseVault,a.exports.config=p.config,a.exports.decrypt=p.decrypt,a.exports.parse=p.parse,a.exports.populate=p.populate,a.exports=p},19737:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,94429,23)),Promise.resolve().then(c.t.bind(c,7748,23)),Promise.resolve().then(c.t.bind(c,52202,23)),Promise.resolve().then(c.t.bind(c,20589,23)),Promise.resolve().then(c.t.bind(c,96185,23)),Promise.resolve().then(c.t.bind(c,19873,23)),Promise.resolve().then(c.t.bind(c,65035,23)),Promise.resolve().then(c.t.bind(c,25716,23)),Promise.resolve().then(c.bind(c,44025))},19771:a=>{"use strict";a.exports=require("process")},20989:a=>{"use strict";function b(a){let b=[],c="",d=!1,e=!1,f="";for(let g=0;g<a.length;g++){let h=a[g];d||"."!==h?"["===h?(c&&(b.push(c),c=""),d=!0):"]"===h&&d?(b.push(c),c="",d=!1,e=!1):('"'===h||"'"===h)&&d?e?h===f?(e=!1,f=""):c+=h:(e=!0,f=h):c+=h:c&&(b.push(c),c="")}return c&&b.push(c),b}function c(a,b,c){let d=a;for(let a=0;a<b.length-1;a++){let c=b[a];if("object"!=typeof d||null===d||!(c in d)||"object"!=typeof d[c]||null===d[c])return!1;d=d[c]}let e=b[b.length-1];if("*"===e){if(Array.isArray(d))for(let a=0;a<d.length;a++)d[a]=c;else if("object"==typeof d&&null!==d)for(let a in d)Object.prototype.hasOwnProperty.call(d,a)&&(d[a]=c)}else"object"==typeof d&&null!==d&&e in d&&Object.prototype.hasOwnProperty.call(d,e)&&(d[e]=c);return!0}function d(a,b){let c=a;for(let a=0;a<b.length-1;a++){let d=b[a];if("object"!=typeof c||null===c||!(d in c)||"object"!=typeof c[d]||null===c[d])return!1;c=c[d]}let d=b[b.length-1];if("*"===d){if(Array.isArray(c))for(let a=0;a<c.length;a++)c[a]=void 0;else if("object"==typeof c&&null!==c)for(let a in c)Object.prototype.hasOwnProperty.call(c,a)&&delete c[a]}else"object"==typeof c&&null!==c&&d in c&&Object.prototype.hasOwnProperty.call(c,d)&&delete c[d];return!0}let e=Symbol("PATH_NOT_FOUND");a.exports=function(a={}){let{paths:f=[],censor:g="[REDACTED]",serialize:h=JSON.stringify,strict:i=!0,remove:j=!1}=a;if(!Array.isArray(f))throw TypeError("paths must be an array");for(let a of f)!function(a){if("string"!=typeof a)throw Error("Paths must be (non-empty) strings");if(""===a)throw Error("Invalid redaction path ()");if(a.includes("..")||a.includes(","))throw Error(`Invalid redaction path (${a})`);let b=0,c=!1,d="";for(let e=0;e<a.length;e++){let f=a[e];if(('"'===f||"'"===f)&&b>0)c?f===d&&(c=!1,d=""):(c=!0,d=f);else if("["!==f||c){if("]"===f&&!c&&--b<0)throw Error(`Invalid redaction path (${a})`)}else b++}if(0!==b)throw Error(`Invalid redaction path (${a})`)}(a);let k=function(a){if(0===a.length)return null;let c=new Map;for(let d of a){let a=b(d),e=c;for(let b=0;b<a.length;b++){let c=a[b];e.has(c)||e.set(c,new Map),e=e.get(c)}}return c}(f);return function(a){if(i&&(null===a||"object"!=typeof a)&&(null==a||"object"!=typeof a))return h?h(a):a;let l=k?function a(b,c,d=0){if(!c||0===c.size||null===b||"object"!=typeof b)return b;if(b instanceof Date)return new Date(b.getTime());if(Array.isArray(b)){let d=[];for(let e=0;e<b.length;e++){let f=e.toString();c.has(f)||c.has("*")?d[e]=a(b[e],c.get(f)||c.get("*")):d[e]=b[e]}return d}let e=Object.create(Object.getPrototypeOf(b));for(let d in b)Object.prototype.hasOwnProperty.call(b,d)&&(c.has(d)||c.has("*")?e[d]=a(b[d],c.get(d)||c.get("*")):e[d]=b[d]);return e}(a,k):a,m=g;return("function"==typeof g&&(m=g),!function(a,f,g,h=!1){for(let i of f){let f=b(i);if(f.includes("*"))!function a(b,e,f,g,h=!1){let i=e.indexOf("*");if(i===e.length-1){let a=e.slice(0,-1),c=b;for(let b of a){if(null==c||"object"!=typeof c||null===c)return;c=c[b]}if(Array.isArray(c))if(h)for(let a=0;a<c.length;a++)c[a]=void 0;else for(let b=0;b<c.length;b++){let d=[...a,b.toString()],e="function"==typeof f?f(c[b],d):f;c[b]=e}else if("object"==typeof c&&null!==c)if(h){let a=[];for(let b in c)Object.prototype.hasOwnProperty.call(c,b)&&a.push(b);for(let b of a)delete c[b]}else for(let b in c){let d=[...a,b],e="function"==typeof f?f(c[b],d):f;c[b]=e}}else!function(b,e,f,g,h,i=!1){let j=e.slice(0,g),k=e.slice(g+1),l=[];function m(b,e){if(e===j.length){if(Array.isArray(b))for(let a=0;a<b.length;a++)l[e]=a.toString(),m(b[a],e+1);else if("object"==typeof b&&null!==b)for(let a in b)l[e]=a,m(b[a],e+1)}else if(e<j.length){let a=j[e];b&&"object"==typeof b&&null!==b&&a in b&&(l[e]=a,m(b[a],e+1))}else if(k.includes("*"))a(b,k,"function"==typeof f?(a,b)=>f(a,[...l.slice(0,e),...b]):f,h,i);else if(i)d(b,k);else{let a="function"==typeof f?f(function(a,b){let c=a;for(let a of b){if(null==c||"object"!=typeof c||null===c)return;c=c[a]}return c}(b,k),[...l.slice(0,e),...k]):f;c(b,k,a)}}if(0===j.length)m(b,0);else{let a=b;for(let b=0;b<j.length;b++){let c=j[b];if(null==a||"object"!=typeof a||null===a)return;a=a[c],l[b]=c}null!=a&&m(a,j.length)}}(b,e,f,i,g,h)}(a,f,g,i,h);else if(h)d(a,f);else{let b=function(a,b){let c=a;for(let a of b){if(null==c||"object"!=typeof c||null===c||!(a in c))return e;c=c[a]}return c}(a,f);if(b===e)continue;let d="function"==typeof g?g(b,f):g;c(a,f,d)}}}(l,f,m,j),!1===h)?(l.restore=function(){return function a(b){if(null===b||"object"!=typeof b)return b;if(b instanceof Date)return new Date(b.getTime());if(b instanceof Array){let c=[];for(let d=0;d<b.length;d++)c[d]=a(b[d]);return c}if("object"==typeof b){let c=Object.create(Object.getPrototypeOf(b));for(let d in b)Object.prototype.hasOwnProperty.call(b,d)&&(c[d]=a(b[d]));return c}return b}(a)},l):"function"==typeof h?h(l):JSON.stringify(l)}}},21101:(a,b,c)=>{"use strict";let{kForOnEventAttribute:d,kListener:e}=c(40826),f=Symbol("kCode"),g=Symbol("kData"),h=Symbol("kError"),i=Symbol("kMessage"),j=Symbol("kReason"),k=Symbol("kTarget"),l=Symbol("kType"),m=Symbol("kWasClean");class o{constructor(a){this[k]=null,this[l]=a}get target(){return this[k]}get type(){return this[l]}}Object.defineProperty(o.prototype,"target",{enumerable:!0}),Object.defineProperty(o.prototype,"type",{enumerable:!0});class p extends o{constructor(a,b={}){super(a),this[f]=void 0===b.code?0:b.code,this[j]=void 0===b.reason?"":b.reason,this[m]=void 0!==b.wasClean&&b.wasClean}get code(){return this[f]}get reason(){return this[j]}get wasClean(){return this[m]}}Object.defineProperty(p.prototype,"code",{enumerable:!0}),Object.defineProperty(p.prototype,"reason",{enumerable:!0}),Object.defineProperty(p.prototype,"wasClean",{enumerable:!0});class q extends o{constructor(a,b={}){super(a),this[h]=void 0===b.error?null:b.error,this[i]=void 0===b.message?"":b.message}get error(){return this[h]}get message(){return this[i]}}Object.defineProperty(q.prototype,"error",{enumerable:!0}),Object.defineProperty(q.prototype,"message",{enumerable:!0});class r extends o{constructor(a,b={}){super(a),this[g]=void 0===b.data?null:b.data}get data(){return this[g]}}function s(a,b,c){"object"==typeof a&&a.handleEvent?a.handleEvent.call(a,c):a.call(b,c)}Object.defineProperty(r.prototype,"data",{enumerable:!0}),a.exports={CloseEvent:p,ErrorEvent:q,Event:o,EventTarget:{addEventListener(a,b,c={}){let f;for(let f of this.listeners(a))if(!c[d]&&f[e]===b&&!f[d])return;if("message"===a)f=function(a,c){let d=new r("message",{data:c?a:a.toString()});d[k]=this,s(b,this,d)};else if("close"===a)f=function(a,c){let d=new p("close",{code:a,reason:c.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});d[k]=this,s(b,this,d)};else if("error"===a)f=function(a){let c=new q("error",{error:a,message:a.message});c[k]=this,s(b,this,c)};else{if("open"!==a)return;f=function(){let a=new o("open");a[k]=this,s(b,this,a)}}f[d]=!!c[d],f[e]=b,c.once?this.once(a,f):this.on(a,f)},removeEventListener(a,b){for(let c of this.listeners(a))if(c[e]===b&&!c[d]){this.removeListener(a,c);break}}},MessageEvent:r}},21258:a=>{a.exports={DEFAULT_LEVELS:{trace:10,debug:20,info:30,warn:40,error:50,fatal:60},SORTING_ORDER:{ASC:"ASC",DESC:"DESC"}}},21280:(a,b,c)=>{"use strict";let d=c(94735),e=c(81630),{Duplex:f}=c(27910),{createHash:g}=c(55511),h=c(75690),i=c(7775),j=c(37143),k=c(41596),{GUID:l,kWebSocket:m}=c(40826),o=/^[+/0-9A-Za-z]{22}==$/;class p extends d{constructor(a,b){if(super(),null==(a={allowSynchronousEvents:!0,autoPong:!0,maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:k,...a}).port&&!a.server&&!a.noServer||null!=a.port&&(a.server||a.noServer)||a.server&&a.noServer)throw TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(null!=a.port?(this._server=e.createServer((a,b)=>{let c=e.STATUS_CODES[426];b.writeHead(426,{"Content-Length":c.length,"Content-Type":"text/plain"}),b.end(c)}),this._server.listen(a.port,a.host,a.backlog,b)):a.server&&(this._server=a.server),this._server){let a=this.emit.bind(this,"connection");this._removeListeners=function(a,b){for(let c of Object.keys(b))a.on(c,b[c]);return function(){for(let c of Object.keys(b))a.removeListener(c,b[c])}}(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(b,c,d)=>{this.handleUpgrade(b,c,d,a)}})}!0===a.perMessageDeflate&&(a.perMessageDeflate={}),a.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=a,this._state=0}address(){if(this.options.noServer)throw Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(a){if(2===this._state){a&&this.once("close",()=>{a(Error("The server is not running"))}),process.nextTick(q,this);return}if(a&&this.once("close",a),1!==this._state)if(this._state=1,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients&&this.clients.size?this._shouldEmitClose=!0:process.nextTick(q,this);else{let a=this._server;this._removeListeners(),this._removeListeners=this._server=null,a.close(()=>{q(this)})}}shouldHandle(a){if(this.options.path){let b=a.url.indexOf("?");if((-1!==b?a.url.slice(0,b):a.url)!==this.options.path)return!1}return!0}handleUpgrade(a,b,c,d){b.on("error",r);let e=a.headers["sec-websocket-key"],f=a.headers.upgrade,g=+a.headers["sec-websocket-version"];if("GET"!==a.method)return void t(this,a,b,405,"Invalid HTTP method");if(void 0===f||"websocket"!==f.toLowerCase())return void t(this,a,b,400,"Invalid Upgrade header");if(void 0===e||!o.test(e))return void t(this,a,b,400,"Missing or invalid Sec-WebSocket-Key header");if(13!==g&&8!==g)return void t(this,a,b,400,"Missing or invalid Sec-WebSocket-Version header",{"Sec-WebSocket-Version":"13, 8"});if(!this.shouldHandle(a))return void s(b,400);let k=a.headers["sec-websocket-protocol"],l=new Set;if(void 0!==k)try{l=j.parse(k)}catch(c){t(this,a,b,400,"Invalid Sec-WebSocket-Protocol header");return}let m=a.headers["sec-websocket-extensions"],p={};if(this.options.perMessageDeflate&&void 0!==m){let c=new i(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let a=h.parse(m);a[i.extensionName]&&(c.accept(a[i.extensionName]),p[i.extensionName]=c)}catch(c){t(this,a,b,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let f={origin:a.headers[`${8===g?"sec-websocket-origin":"origin"}`],secure:!!(a.socket.authorized||a.socket.encrypted),req:a};if(2===this.options.verifyClient.length)return void this.options.verifyClient(f,(f,g,h,i)=>{if(!f)return s(b,g||401,h,i);this.completeUpgrade(p,e,l,a,b,c,d)});if(!this.options.verifyClient(f))return s(b,401)}this.completeUpgrade(p,e,l,a,b,c,d)}completeUpgrade(a,b,c,d,e,f,j){if(!e.readable||!e.writable)return e.destroy();if(e[m])throw Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>0)return s(e,503);let k=g("sha1").update(b+l).digest("base64"),o=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${k}`],p=new this.options.WebSocket(null,void 0,this.options);if(c.size){let a=this.options.handleProtocols?this.options.handleProtocols(c,d):c.values().next().value;a&&(o.push(`Sec-WebSocket-Protocol: ${a}`),p._protocol=a)}if(a[i.extensionName]){let b=a[i.extensionName].params,c=h.format({[i.extensionName]:[b]});o.push(`Sec-WebSocket-Extensions: ${c}`),p._extensions=a}this.emit("headers",o,d),e.write(o.concat("\r\n").join("\r\n")),e.removeListener("error",r),p.setSocket(e,f,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(p),p.on("close",()=>{this.clients.delete(p),this._shouldEmitClose&&!this.clients.size&&process.nextTick(q,this)})),j(p,d)}}function q(a){a._state=2,a.emit("close")}function r(){this.destroy()}function s(a,b,c,d){c=c||e.STATUS_CODES[b],d={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(c),...d},a.once("finish",a.destroy),a.end(`HTTP/1.1 ${b} ${e.STATUS_CODES[b]}\r
`+Object.keys(d).map(a=>`${a}: ${d[a]}`).join("\r\n")+"\r\n\r\n"+c)}function t(a,b,c,d,e,f){if(a.listenerCount("wsClientError")){let d=Error(e);Error.captureStackTrace(d,t),a.emit("wsClientError",d,c,b)}else s(c,d,e,f)}a.exports=p},21469:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.IdentityPoolClient=void 0;let d=c(8011),e=c(21827),f=c(2585),g=c(99476),h=c(61410),i=c(88706),j=c(15921);class k extends d.BaseExternalAccountClient{subjectTokenSupplier;constructor(a){super(a);let b=(0,e.originalOrCamelOptions)(a),c=b.get("credential_source"),d=b.get("subject_token_supplier");if(!c&&!d)throw Error("A credential source or subject token supplier must be specified.");if(c&&d)throw Error("Only one of credential source or subject token supplier can be specified.");if(d)this.subjectTokenSupplier=d,this.credentialSourceType="programmatic";else{let a=(0,e.originalOrCamelOptions)(c),b=(0,e.originalOrCamelOptions)(a.get("format")),d=b.get("type")||"text",i=b.get("subject_token_field_name");if("json"!==d&&"text"!==d)throw Error(`Invalid credential_source format "${d}"`);if("json"===d&&!i)throw Error("Missing subject_token_field_name for JSON credential_source format");let j=a.get("file"),l=a.get("url"),m=a.get("certificate"),o=a.get("headers");if(j&&l||l&&m||j&&m)throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.');if(j)this.credentialSourceType="file",this.subjectTokenSupplier=new f.FileSubjectTokenSupplier({filePath:j,formatType:d,subjectTokenFieldName:i});else if(l)this.credentialSourceType="url",this.subjectTokenSupplier=new g.UrlSubjectTokenSupplier({url:l,formatType:d,subjectTokenFieldName:i,headers:o,additionalGaxiosOptions:k.RETRY_CONFIG});else if(m){this.credentialSourceType="certificate";let a=new h.CertificateSubjectTokenSupplier({useDefaultCertificateConfig:m.use_default_certificate_config,certificateConfigLocation:m.certificate_config_location,trustChainPath:m.trust_chain_path});this.subjectTokenSupplier=a}else throw Error('No valid Identity Pool "credential_source" provided, must be either file, url, or certificate.')}}async retrieveSubjectToken(){let a=await this.subjectTokenSupplier.getSubjectToken(this.supplierContext);if(this.subjectTokenSupplier instanceof h.CertificateSubjectTokenSupplier){let a=await this.subjectTokenSupplier.createMtlsHttpsAgent();this.stsCredential=new i.StsCredentials({tokenExchangeEndpoint:this.getTokenUrl(),clientAuthentication:this.clientAuth,transporter:new j.Gaxios({agent:a})}),this.transporter=new j.Gaxios({...this.transporter.defaults||{},agent:a})}return a}}b.IdentityPoolClient=k},21540:a=>{"use strict";if("undefined"!=typeof SharedArrayBuffer&&"undefined"!=typeof Atomics){let b=new Int32Array(new SharedArrayBuffer(4));a.exports=function(a){if(!1==(a>0&&a<1/0)){if("number"!=typeof a&&"bigint"!=typeof a)throw TypeError("sleep: ms must be a number");throw RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")}Atomics.wait(b,0,0,Number(a))}}else a.exports=function(a){if(!1==(a>0&&a<1/0)){if("number"!=typeof a&&"bigint"!=typeof a)throw TypeError("sleep: ms must be a number");throw RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")}let b=Date.now()+Number(a);for(;b>Date.now(););}},21820:a=>{"use strict";a.exports=require("os")},21827:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.LRUCache=void 0,b.snakeToCamel=h,b.originalOrCamelOptions=function(a){return{get:function(b){let c=a||{};return c[b]??c[h(b)]}}},b.removeUndefinedValuesInObject=function(a){return Object.entries(a).forEach(([b,c])=>{(void 0===c||"undefined"===c)&&delete a[b]}),a},b.isValidFile=j,b.getWellKnownCertificateConfigFileLocation=function(){let a=process.env.CLOUDSDK_CONFIG||(e.platform().startsWith("win")?f.join(process.env.APPDATA||"",g):f.join(process.env.HOME||"",".config",g));return f.join(a,"certificate_config.json")};let d=c(29021),e=c(21820),f=c(33873),g="gcloud";function h(a){return a.replace(/([_][^_])/g,a=>a.slice(1).toUpperCase())}class i{capacity;#d=new Map;maxAge;constructor(a){this.capacity=a.capacity,this.maxAge=a.maxAge}#e(a,b){this.#d.delete(a),this.#d.set(a,{value:b,lastAccessed:Date.now()})}set(a,b){this.#e(a,b),this.#f()}get(a){let b=this.#d.get(a);if(b)return this.#e(a,b.value),this.#f(),b.value}#f(){let a=this.maxAge?Date.now()-this.maxAge:0,b=this.#d.entries().next();for(;!b.done&&(this.#d.size>this.capacity||b.value[1].lastAccessed<a);)this.#d.delete(b.value[0]),b=this.#d.entries().next()}}async function j(a){try{return(await d.promises.lstat(a)).isFile()}catch(a){return!1}}b.LRUCache=i},22782:a=>{"use strict";let b=Symbol("pino.setLevel"),c=Symbol("pino.getLevel"),d=Symbol("pino.levelVal"),e=Symbol("pino.levelComp"),f=Symbol("pino.useLevelLabels"),g=Symbol("pino.useOnlyCustomLevels"),h=Symbol("pino.mixin"),i=Symbol("pino.lsCache"),j=Symbol("pino.chindings"),k=Symbol("pino.asJson"),l=Symbol("pino.write"),m=Symbol("pino.redactFmt"),o=Symbol("pino.time"),p=Symbol("pino.timeSliceIndex"),q=Symbol("pino.stream"),r=Symbol("pino.stringify"),s=Symbol("pino.stringifySafe"),t=Symbol("pino.stringifiers"),u=Symbol("pino.end"),v=Symbol("pino.formatOpts"),w=Symbol("pino.messageKey"),x=Symbol("pino.errorKey"),y=Symbol("pino.nestedKey"),z=Symbol("pino.nestedKeyStr"),A=Symbol("pino.mixinMergeStrategy"),B=Symbol("pino.msgPrefix"),C=Symbol("pino.wildcardFirst"),D=Symbol.for("pino.serializers"),E=Symbol.for("pino.formatters"),F=Symbol.for("pino.hooks");a.exports={setLevelSym:b,getLevelSym:c,levelValSym:d,levelCompSym:e,useLevelLabelsSym:f,mixinSym:h,lsCacheSym:i,chindingsSym:j,asJsonSym:k,writeSym:l,serializersSym:D,redactFmtSym:m,timeSym:o,timeSliceIndexSym:p,streamSym:q,stringifySym:r,stringifySafeSym:s,stringifiersSym:t,endSym:u,formatOptsSym:v,messageKeySym:w,errorKeySym:x,nestedKeySym:y,wildcardFirstSym:C,needsMetadataGsym:Symbol.for("pino.metadata"),useOnlyCustomLevelsSym:g,formattersSym:E,hooksSym:F,nestedKeyStrSym:z,mixinMergeStrategySym:A,msgPrefixSym:B}},22948:(a,b)=>{"use strict";b.byteLength=function(a){var b=i(a),c=b[0],d=b[1];return(c+d)*3/4-d},b.toByteArray=function(a){var b,c,f=i(a),g=f[0],h=f[1],j=new e((g+h)*3/4-h),k=0,l=h>0?g-4:g;for(c=0;c<l;c+=4)b=d[a.charCodeAt(c)]<<18|d[a.charCodeAt(c+1)]<<12|d[a.charCodeAt(c+2)]<<6|d[a.charCodeAt(c+3)],j[k++]=b>>16&255,j[k++]=b>>8&255,j[k++]=255&b;return 2===h&&(b=d[a.charCodeAt(c)]<<2|d[a.charCodeAt(c+1)]>>4,j[k++]=255&b),1===h&&(b=d[a.charCodeAt(c)]<<10|d[a.charCodeAt(c+1)]<<4|d[a.charCodeAt(c+2)]>>2,j[k++]=b>>8&255,j[k++]=255&b),j},b.fromByteArray=function(a){for(var b,d=a.length,e=d%3,f=[],g=0,h=d-e;g<h;g+=16383)f.push(function(a,b,d){for(var e,f=[],g=b;g<d;g+=3)e=(a[g]<<16&0xff0000)+(a[g+1]<<8&65280)+(255&a[g+2]),f.push(c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]);return f.join("")}(a,g,g+16383>h?h:g+16383));return 1===e?f.push(c[(b=a[d-1])>>2]+c[b<<4&63]+"=="):2===e&&f.push(c[(b=(a[d-2]<<8)+a[d-1])>>10]+c[b>>4&63]+c[b<<2&63]+"="),f.join("")};for(var c=[],d=[],e="undefined"!=typeof Uint8Array?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=0,h=f.length;g<h;++g)c[g]=f[g],d[f.charCodeAt(g)]=g;function i(a){var b=a.length;if(b%4>0)throw Error("Invalid string. Length must be a multiple of 4");var c=a.indexOf("=");-1===c&&(c=b);var d=c===b?0:4-c%4;return[c,d]}d[45]=62,d[95]=63},23669:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{normalizeAppPath:function(){return f},normalizeRscURL:function(){return g}});let d=c(51466),e=c(67390);function f(a){return(0,d.ensureLeadingSlash)(a.split("/").reduce((a,b,c,d)=>!b||(0,e.isGroupSegment)(b)||"@"===b[0]||("page"===b||"route"===b)&&c===d.length-1?a:a+"/"+b,""))}function g(a){return a.replace(/\.rsc($|\?)/,"$1")}},24482:(a,b,c)=>{"use strict";let{createRequire:d}=c(8086),e=c(8050),{join:f,isAbsolute:g,sep:h}=c(76760),i=c(21540),j=c(3608),k=c(99893);function l(a){a.ref(),a.flushSync(),a.end(),a.once("close",function(){a.unref()})}function m(a){a.flushSync()}a.exports=function(a){let{pipeline:b,targets:c,levels:o,dedupe:p,worker:q={},caller:r=e(),sync:s=!1}=a,t={...a.options},u="string"==typeof r?[r]:r,v="__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{},w=a.target;if(w&&c)throw Error("only one of target or targets can be specified");c?(w=v["pino-worker"]||f(__dirname,"worker.js"),t.targets=c.filter(a=>a.target).map(a=>({...a,target:z(a.target)})),t.pipelines=c.filter(a=>a.pipeline).map(a=>a.pipeline.map(b=>({...b,level:a.level,target:z(b.target)})))):b&&(w=v["pino-worker"]||f(__dirname,"worker.js"),t.pipelines=[b.map(a=>({...a,target:z(a.target)}))]),o&&(t.levels=o),p&&(t.dedupe=p),t.pinoWillSendConfig=!0;let x=new k({filename:z(w),workerData:t,workerOpts:q,sync:s});function y(){x.closed||(x.flushSync(),i(100),x.end())}return x.on("ready",function(){process.removeListener("exit",y),x.unref(),!1!==q.autoEnd&&(j.register(x,l),j.registerBeforeExit(x,m),x.on("close",function(){j.unregister(x)}))}),x.on("close",function(){process.removeListener("exit",y)}),process.on("exit",y),x;function z(a){let b;if(g(a=v[a]||a)||0===a.indexOf("file://"))return a;if("pino/file"===a)return f(__dirname,"..","file.js");for(let c of u)try{let e="node:repl"===c?process.cwd()+h:c;b=d(e).resolve(a);break}catch(a){continue}if(!b)throw Error(`unable to determine transport target for "${a}"`);return b}}},24582:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{DOC_PREFETCH_RANGE_HEADER_VALUE:function(){return d},doesExportedHtmlMatchBuildId:function(){return g},insertBuildIdComment:function(){return f}});let c="<!DOCTYPE html>",d="bytes=0-63";function e(a){return a.slice(0,24).replace(/-/g,"_")}function f(a,b){return b.includes("--\x3e")||!a.startsWith(c)?a:a.replace(c,c+"\x3c!--"+e(b)+"--\x3e")}function g(a,b){return a.startsWith(c+"\x3c!--"+e(b)+"--\x3e")}},26020:a=>{"use strict";a.exports=JSON.parse('{"name":"google-auth-library","version":"10.5.0","author":"Google Inc.","description":"Google APIs Authentication Client Library for Node.js","engines":{"node":">=18"},"main":"./build/src/index.js","types":"./build/src/index.d.ts","repository":"googleapis/google-auth-library-nodejs.git","keywords":["google","api","google apis","client","client library"],"dependencies":{"base64-js":"^1.3.0","ecdsa-sig-formatter":"^1.0.11","gaxios":"^7.0.0","gcp-metadata":"^8.0.0","google-logging-utils":"^1.0.0","gtoken":"^8.0.0","jws":"^4.0.0"},"devDependencies":{"@types/base64-js":"^1.2.5","@types/jws":"^3.1.0","@types/mocha":"^10.0.10","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^22.0.0","@types/sinon":"^17.0.0","assert-rejects":"^1.0.0","c8":"^10.0.0","codecov":"^3.0.2","gts":"^6.0.0","is-docker":"^3.0.0","jsdoc":"^4.0.0","jsdoc-fresh":"^5.0.0","jsdoc-region-tag":"^4.0.0","karma":"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.1","keypair":"^1.0.4","mocha":"^11.1.0","mv":"^2.1.1","ncp":"^2.0.0","nock":"^14.0.5","null-loader":"^4.0.0","puppeteer":"^24.0.0","sinon":"^21.0.0","ts-loader":"^8.0.0","typescript":"5.8.2","webpack":"^5.21.2","webpack-cli":"^4.0.0"},"files":["build/src","!build/src/**/*.map"],"scripts":{"test":"c8 mocha build/test","clean":"gts clean","prepare":"npm run compile","lint":"gts check --no-inline-config","compile":"tsc -p .","fix":"gts fix","pretest":"npm run compile -- --sourceMap","docs":"jsdoc -c .jsdoc.js","samples-setup":"cd samples/ && npm link ../ && npm run setup && cd ../","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","system-test":"mocha build/system-test --timeout 60000","presystem-test":"npm run compile -- --sourceMap","webpack":"webpack","browser-test":"karma start","docs-test":"echo \'disabled until linkinator is fixed\'","predocs-test":"npm run docs","prelint":"cd samples; npm link ../; npm install"},"license":"Apache-2.0"}')},26193:(a,b,c)=>{var d=c(35883),e=a.exports;!function(){"use strict";var a,b,c,f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function h(a){return f.lastIndex=0,f.test(a)?'"'+a.replace(f,function(a){var b=g[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}"function"!=typeof e.stringify&&(e.stringify=function(e,f,g){var i;if(a="",b="","number"==typeof g)for(i=0;i<g;i+=1)b+=" ";else"string"==typeof g&&(b=g);if(c=f,f&&"function"!=typeof f&&("object"!=typeof f||"number"!=typeof f.length))throw Error("JSON.stringify");return function e(f,g){var i,j,k,l,m,o=a,p=g[f],q=null!=p&&(p instanceof d||d.isBigNumber(p));switch(p&&"object"==typeof p&&"function"==typeof p.toJSON&&(p=p.toJSON(f)),"function"==typeof c&&(p=c.call(g,f,p)),typeof p){case"string":if(q)return p;return h(p);case"number":return isFinite(p)?String(p):"null";case"boolean":case"null":case"bigint":return String(p);case"object":if(!p)return"null";if(a+=b,m=[],"[object Array]"===Object.prototype.toString.apply(p)){for(i=0,l=p.length;i<l;i+=1)m[i]=e(i,p)||"null";return k=0===m.length?"[]":a?"[\n"+a+m.join(",\n"+a)+"\n"+o+"]":"["+m.join(",")+"]",a=o,k}if(c&&"object"==typeof c)for(i=0,l=c.length;i<l;i+=1)"string"==typeof c[i]&&(k=e(j=c[i],p))&&m.push(h(j)+(a?": ":":")+k);else Object.keys(p).forEach(function(b){var c=e(b,p);c&&m.push(h(b)+(a?": ":":")+c)});return k=0===m.length?"{}":a?"{\n"+a+m.join(",\n"+a)+"\n"+o+"}":"{"+m.join(",")+"}",a=o,k}}("",{"":e})})}()},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},26768:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"ENCODED_TAGS",{enumerable:!0,get:function(){return c}});let c={OPENING:{HTML:new Uint8Array([60,104,116,109,108]),BODY:new Uint8Array([60,98,111,100,121])},CLOSED:{HEAD:new Uint8Array([60,47,104,101,97,100,62]),BODY:new Uint8Array([60,47,98,111,100,121,62]),HTML:new Uint8Array([60,47,104,116,109,108,62]),BODY_AND_HTML:new Uint8Array([60,47,98,111,100,121,62,60,47,104,116,109,108,62])},META:{ICON_MARK:new Uint8Array([60,109,101,116,97,32,110,97,109,101,61,34,194,171,110,120,116,45,105,99,111,110,194,187,34])}}},27910:a=>{"use strict";a.exports=require("stream")},28189:()=>{},28354:a=>{"use strict";a.exports=require("util")},28552:(a,b,c)=>{"use strict";a.exports=c(64073).vendored["react-rsc"].ReactDOM},28962:(a,b,c)=>{"use strict";a.exports=function a(b){if(!d(b))return b;b[g]=void 0;let c=Object.create(e);for(let e in c.type="[object Function]"===h.call(b.constructor)?b.constructor.name:b.name,c.message=b.message,c.stack=b.stack,Array.isArray(b.errors)&&(c.aggregateErrors=b.errors.map(b=>a(b))),d(b.cause)&&!Object.prototype.hasOwnProperty.call(b.cause,g)&&(c.cause=a(b.cause)),b)if(void 0===c[e]){let f=b[e];d(f)?Object.prototype.hasOwnProperty.call(f,g)||(c[e]=a(f)):c[e]=f}return delete b[g],c.raw=b,c};let{isErrorLike:d}=c(46279),{pinoErrProto:e,pinoErrorSymbols:f}=c(15218),{seen:g}=f,{toString:h}=Object.prototype},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29315:a=>{"use strict";function b(a){return(a/8|0)+ +(a%8!=0)}var c={ES256:b(256),ES384:b(384),ES512:b(521)};a.exports=function(a){var b=c[a];if(b)return b;throw Error('Unknown algorithm "'+a+'"')}},30251:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.IdTokenClient=void 0;let d=c(76748);class e extends d.OAuth2Client{targetAudience;idTokenProvider;constructor(a){super(a),this.targetAudience=a.targetAudience,this.idTokenProvider=a.idTokenProvider}async getRequestMetadataAsync(){if(!this.credentials.id_token||!this.credentials.expiry_date||this.isTokenExpiring()){let a=await this.idTokenProvider.fetchIdToken(this.targetAudience);this.credentials={id_token:a,expiry_date:this.getIdTokenExpiryDate(a)}}return{headers:new Headers({authorization:"Bearer "+this.credentials.id_token})}}getIdTokenExpiryDate(a){let b=a.split(".")[1];if(b)return 1e3*JSON.parse(Buffer.from(b,"base64").toString("ascii")).exp}}b.IdTokenClient=e},32953:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{decryptActionBoundArgs:function(){return t},encryptActionBoundArgs:function(){return s}}),c(28189);let d=c(37304),e=c(66447),f=c(39538),g=c(68573),h=c(63033),i=c(99410),j=function(a){return a&&a.__esModule?a:{default:a}}(c(76247)),k=new TextEncoder,l=new TextDecoder,m=void 0,o=void 0;async function p(a,b){let c=await (0,g.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=atob(b),e=d.slice(0,16),f=d.slice(16),h=l.decode(await (0,g.decrypt)(c,(0,g.stringToUint8Array)(e),(0,g.stringToUint8Array)(f)));if(!h.startsWith(a))throw Object.defineProperty(Error("Invalid Server Action payload: failed to decrypt."),"__NEXT_ERROR_CODE",{value:"E191",enumerable:!1,configurable:!0});return h.slice(a.length)}async function q(a,b){let c=await (0,g.getActionEncryptionKey)();if(void 0===c)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let d=new Uint8Array(16);h.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(d));let e=(0,g.arrayBufferToString)(d.buffer),f=await (0,g.encrypt)(c,d,k.encode(a+b));return btoa(e+(0,g.arrayBufferToString)(f))}var r=function(a){return a[a.Ready=0]="Ready",a[a.Pending=1]="Pending",a[a.Complete=2]="Complete",a}(r||{});let s=j.default.cache(async function a(b,...c){let e=h.workUnitAsyncStorage.getStore(),j=e?(0,h.getCacheSignal)(e):void 0,{clientModules:k}=(0,g.getClientReferenceManifestForRsc)(),l=Error();Error.captureStackTrace(l,a);let o=!1,p=e?(0,i.createHangingInputAbortSignal)(e):void 0,r=0;function s(){0===r&&(r=1,null==j||j.beginRead())}function t(){1===r&&(null==j||j.endRead()),r=2}p&&j&&p.addEventListener("abort",s,{once:!0});let u=await (0,f.streamToString)((0,d.renderToReadableStream)(c,k,{filterStackFrame:m,signal:p,onError(a){(null==p||!p.aborted)&&(o||(o=!0,l.message=a instanceof Error?a.message:String(a)))}}),p);if(o)throw t(),l;if(!e)return q(b,u);s();let v=(0,h.getPrerenderResumeDataCache)(e),w=(0,h.getRenderResumeDataCache)(e),x=b+u,y=(null==v?void 0:v.encryptedBoundArgs.get(x))??(null==w?void 0:w.encryptedBoundArgs.get(x));if(y)return y;let z=await q(b,u);return t(),null==v||v.encryptedBoundArgs.set(x,z),z});async function t(a,b){let c,d=await b,f=h.workUnitAsyncStorage.getStore();if(f){let b=(0,h.getCacheSignal)(f),e=(0,h.getPrerenderResumeDataCache)(f),g=(0,h.getRenderResumeDataCache)(f);(c=(null==e?void 0:e.decryptedBoundArgs.get(d))??(null==g?void 0:g.decryptedBoundArgs.get(d)))||(null==b||b.beginRead(),c=await p(a,d),null==b||b.endRead(),null==e||e.decryptedBoundArgs.set(d,c))}else c=await p(a,d);let{edgeRscModuleMapping:i,rscModuleMapping:j}=(0,g.getClientReferenceManifestForRsc)();return await (0,e.createFromReadableStream)(new ReadableStream({start(a){switch(a.enqueue(k.encode(c)),null==f?void 0:f.type){case"prerender":case"prerender-runtime":f.renderSignal.aborted?a.close():f.renderSignal.addEventListener("abort",()=>a.close(),{once:!0});break;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":case void 0:return a.close()}}}),{findSourceMapURL:o,serverConsumerManifest:{moduleLoading:null,moduleMap:j,serverModuleMap:(0,g.getServerModuleMap)()}})}},33758:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.DefaultAwsSecurityCredentialsSupplier=void 0;let d=c(62783);class e{regionUrl;securityCredentialsUrl;imdsV2SessionTokenUrl;additionalGaxiosOptions;constructor(a){this.regionUrl=a.regionUrl,this.securityCredentialsUrl=a.securityCredentialsUrl,this.imdsV2SessionTokenUrl=a.imdsV2SessionTokenUrl,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getAwsRegion(a){if(this.#g)return this.#g;let b=new Headers;if(!this.#g&&this.imdsV2SessionTokenUrl&&b.set("x-aws-ec2-metadata-token",await this.#h(a.transporter)),!this.regionUrl)throw RangeError('Unable to determine AWS region due to missing "options.credential_source.region_url"');let c={...this.additionalGaxiosOptions,url:this.regionUrl,method:"GET",headers:b};d.AuthClient.setMethodName(c,"getAwsRegion");let e=await a.transporter.request(c);return e.data.substr(0,e.data.length-1)}async getAwsSecurityCredentials(a){if(this.#i)return this.#i;let b=new Headers;this.imdsV2SessionTokenUrl&&b.set("x-aws-ec2-metadata-token",await this.#h(a.transporter));let c=await this.#j(b,a.transporter),d=await this.#k(c,b,a.transporter);return{accessKeyId:d.AccessKeyId,secretAccessKey:d.SecretAccessKey,token:d.Token}}async #h(a){let b={...this.additionalGaxiosOptions,url:this.imdsV2SessionTokenUrl,method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"300"}};return d.AuthClient.setMethodName(b,"#getImdsV2SessionToken"),(await a.request(b)).data}async #j(a,b){if(!this.securityCredentialsUrl)throw Error('Unable to determine AWS role name due to missing "options.credential_source.url"');let c={...this.additionalGaxiosOptions,url:this.securityCredentialsUrl,method:"GET",headers:a};return d.AuthClient.setMethodName(c,"#getAwsRoleName"),(await b.request(c)).data}async #k(a,b,c){let e={...this.additionalGaxiosOptions,url:`${this.securityCredentialsUrl}/${a}`,headers:b};return d.AuthClient.setMethodName(e,"#retrieveAwsSecurityCredentials"),(await c.request(e)).data}get #g(){return process.env.AWS_REGION||process.env.AWS_DEFAULT_REGION||null}get #i(){return process.env.AWS_ACCESS_KEY_ID&&process.env.AWS_SECRET_ACCESS_KEY?{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY,token:process.env.AWS_SESSION_TOKEN}:null}}b.DefaultAwsSecurityCredentialsSupplier=e},33873:a=>{"use strict";a.exports=require("path")},33874:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Compute=void 0;let d=c(15921),e=c(15400),f=c(76748);class g extends f.OAuth2Client{serviceAccountEmail;scopes;constructor(a={}){super(a),this.credentials={expiry_date:1,refresh_token:"compute-placeholder"},this.serviceAccountEmail=a.serviceAccountEmail||"default",this.scopes=Array.isArray(a.scopes)?a.scopes:a.scopes?[a.scopes]:[]}async refreshTokenNoCache(){let a,b=`service-accounts/${this.serviceAccountEmail}/token`;try{let c={property:b};this.scopes.length>0&&(c.params={scopes:this.scopes.join(",")}),a=await e.instance(c)}catch(a){throw a instanceof d.GaxiosError&&(a.message=`Could not refresh access token: ${a.message}`,this.wrapError(a)),a}let c=a;return a&&a.expires_in&&(c.expiry_date=new Date().getTime()+1e3*a.expires_in,delete c.expires_in),this.emit("tokens",c),{tokens:c,res:null}}async fetchIdToken(a){let b,c=`service-accounts/${this.serviceAccountEmail}/identity?format=full&audience=${a}`;try{b=await e.instance({property:c})}catch(a){throw a instanceof Error&&(a.message=`Could not fetch ID token: ${a.message}`),a}return b}wrapError(a){let b=a.response;b&&b.status&&(a.status=b.status,403===b.status?a.message="A Forbidden error was returned while attempting to retrieve an access token for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have the correct permission scopes specified: "+a.message:404===b.status&&(a.message="A Not Found error was returned while attempting to retrieve an accesstoken for the Compute Engine built-in service account. This may be because the Compute Engine instance does not have any permission scopes specified: "+a.message))}}b.Compute=g},34631:a=>{"use strict";a.exports=require("tls")},35173:(a,b,c)=>{Promise.resolve().then(c.bind(c,37930))},35883:function(a,b,c){var d;!function(e){"use strict";var f,g=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,h=Math.ceil,i=Math.floor,j="[BigNumber Error] ",k=j+"Number primitive has more than 15 significant digits: ",l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13];function m(a){var b=0|a;return a>0||a===b?b:b-1}function o(a){for(var b,c,d=1,e=a.length,f=a[0]+"";d<e;){for(c=14-(b=a[d++]+"").length;c--;b="0"+b);f+=b}for(e=f.length;48===f.charCodeAt(--e););return f.slice(0,e+1||1)}function p(a,b){var c,d,e=a.c,f=b.c,g=a.s,h=b.s,i=a.e,j=b.e;if(!g||!h)return null;if(c=e&&!e[0],d=f&&!f[0],c||d)return c?d?0:-h:g;if(g!=h)return g;if(c=g<0,d=i==j,!e||!f)return d?0:!e^c?1:-1;if(!d)return i>j^c?1:-1;for(g=0,h=(i=e.length)<(j=f.length)?i:j;g<h;g++)if(e[g]!=f[g])return e[g]>f[g]^c?1:-1;return i==j?0:i>j^c?1:-1}function q(a,b,c,d){if(a<b||a>c||a!==i(a))throw Error(j+(d||"Argument")+("number"==typeof a?a<b||a>c?" out of range: ":" not an integer: ":" not a primitive number: ")+String(a))}function r(a){var b=a.c.length-1;return m(a.e/14)==b&&a.c[b]%2!=0}function s(a,b){return(a.length>1?a.charAt(0)+"."+a.slice(1):a)+(b<0?"e":"e+")+b}function t(a,b,c){var d,e;if(b<0){for(e=c+".";++b;e+=c);a=e+a}else if(d=a.length,++b>d){for(e=c,b-=d;--b;e+=c);a+=e}else b<d&&(a=a.slice(0,b)+"."+a.slice(b));return a}(f=function a(b){var c,d,e,f,u,v,w,x,y,z=N.prototype={constructor:N,toString:null,valueOf:null},A=new N(1),B=20,C=4,D=-7,E=21,F=-1e7,G=1e7,H=!1,I=1,J=0,K={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},L="0123456789abcdefghijklmnopqrstuvwxyz",M=!0;function N(a,b){var c,d,e,f,h,j,l,m,o=this;if(!(o instanceof N))return new N(a,b);if(null==b){if(a&&!0===a._isBigNumber){o.s=a.s,!a.c||a.e>G?o.c=o.e=null:a.e<F?o.c=[o.e=0]:(o.e=a.e,o.c=a.c.slice());return}if((j="number"==typeof a)&&0*a==0){if(o.s=1/a<0?(a=-a,-1):1,a===~~a){for(f=0,h=a;h>=10;h/=10,f++);f>G?o.c=o.e=null:(o.e=f,o.c=[a]);return}m=String(a)}else{if(!g.test(m=String(a)))return y(o,m,j);o.s=45==m.charCodeAt(0)?(m=m.slice(1),-1):1}(f=m.indexOf("."))>-1&&(m=m.replace(".","")),(h=m.search(/e/i))>0?(f<0&&(f=h),f+=+m.slice(h+1),m=m.substring(0,h)):f<0&&(f=m.length)}else{if(q(b,2,L.length,"Base"),10==b&&M)return R(o=new N(a),B+o.e+1,C);if(m=String(a),j="number"==typeof a){if(0*a!=0)return y(o,m,j,b);if(o.s=1/a<0?(m=m.slice(1),-1):1,N.DEBUG&&m.replace(/^0\.0*|\./,"").length>15)throw Error(k+a)}else o.s=45===m.charCodeAt(0)?(m=m.slice(1),-1):1;for(c=L.slice(0,b),f=h=0,l=m.length;h<l;h++)if(0>c.indexOf(d=m.charAt(h))){if("."==d){if(h>f){f=l;continue}}else if(!e&&(m==m.toUpperCase()&&(m=m.toLowerCase())||m==m.toLowerCase()&&(m=m.toUpperCase()))){e=!0,h=-1,f=0;continue}return y(o,String(a),j,b)}j=!1,(f=(m=x(m,b,10,o.s)).indexOf("."))>-1?m=m.replace(".",""):f=m.length}for(h=0;48===m.charCodeAt(h);h++);for(l=m.length;48===m.charCodeAt(--l););if(m=m.slice(h,++l)){if(l-=h,j&&N.DEBUG&&l>15&&(a>0x1fffffffffffff||a!==i(a)))throw Error(k+o.s*a);if((f=f-h-1)>G)o.c=o.e=null;else if(f<F)o.c=[o.e=0];else{if(o.e=f,o.c=[],h=(f+1)%14,f<0&&(h+=14),h<l){for(h&&o.c.push(+m.slice(0,h)),l-=14;h<l;)o.c.push(+m.slice(h,h+=14));h=14-(m=m.slice(h)).length}else h-=l;for(;h--;m+="0");o.c.push(+m)}}else o.c=[o.e=0]}function O(a,b,c,d){var e,f,g,h,i;if(null==c?c=C:q(c,0,8),!a.c)return a.toString();if(e=a.c[0],g=a.e,null==b)i=o(a.c),i=1==d||2==d&&(g<=D||g>=E)?s(i,g):t(i,g,"0");else if(f=(a=R(new N(a),b,c)).e,h=(i=o(a.c)).length,1==d||2==d&&(b<=f||f<=D)){for(;h<b;i+="0",h++);i=s(i,f)}else if(b-=g+(2===d&&f>g),i=t(i,f,"0"),f+1>h){if(--b>0)for(i+=".";b--;i+="0");}else if((b+=f-h)>0)for(f+1==h&&(i+=".");b--;i+="0");return a.s<0&&e?"-"+i:i}function P(a,b){for(var c,d,e=1,f=new N(a[0]);e<a.length;e++)(d=new N(a[e])).s&&(c=p(f,d))!==b&&(0!==c||f.s!==b)||(f=d);return f}function Q(a,b,c){for(var d=1,e=b.length;!b[--e];b.pop());for(e=b[0];e>=10;e/=10,d++);return(c=d+14*c-1)>G?a.c=a.e=null:c<F?a.c=[a.e=0]:(a.e=c,a.c=b),a}function R(a,b,c,d){var e,f,g,j,k,m,o,p=a.c;if(p){a:{for(e=1,j=p[0];j>=10;j/=10,e++);if((f=b-e)<0)f+=14,g=b,o=i((k=p[m=0])/l[e-g-1]%10);else if((m=h((f+1)/14))>=p.length)if(d){for(;p.length<=m;p.push(0));k=o=0,e=1,f%=14,g=f-14+1}else break a;else{for(e=1,k=j=p[m];j>=10;j/=10,e++);f%=14,o=(g=f-14+e)<0?0:i(k/l[e-g-1]%10)}if(d=d||b<0||null!=p[m+1]||(g<0?k:k%l[e-g-1]),d=c<4?(o||d)&&(0==c||c==(a.s<0?3:2)):o>5||5==o&&(4==c||d||6==c&&(f>0?g>0?k/l[e-g]:0:p[m-1])%10&1||c==(a.s<0?8:7)),b<1||!p[0])return p.length=0,d?(b-=a.e+1,p[0]=l[(14-b%14)%14],a.e=-b||0):p[0]=a.e=0,a;if(0==f?(p.length=m,j=1,m--):(p.length=m+1,j=l[14-f],p[m]=g>0?i(k/l[e-g]%l[g])*j:0),d)for(;;)if(0==m){for(f=1,g=p[0];g>=10;g/=10,f++);for(g=p[0]+=j,j=1;g>=10;g/=10,j++);f!=j&&(a.e++,1e14==p[0]&&(p[0]=1));break}else{if(p[m]+=j,1e14!=p[m])break;p[m--]=0,j=1}for(f=p.length;0===p[--f];p.pop());}a.e>G?a.c=a.e=null:a.e<F&&(a.c=[a.e=0])}return a}function S(a){var b,c=a.e;return null===c?a.toString():(b=o(a.c),b=c<=D||c>=E?s(b,c):t(b,c,"0"),a.s<0?"-"+b:b)}return N.clone=a,N.ROUND_UP=0,N.ROUND_DOWN=1,N.ROUND_CEIL=2,N.ROUND_FLOOR=3,N.ROUND_HALF_UP=4,N.ROUND_HALF_DOWN=5,N.ROUND_HALF_EVEN=6,N.ROUND_HALF_CEIL=7,N.ROUND_HALF_FLOOR=8,N.EUCLID=9,N.config=N.set=function(a){var b,c;if(null!=a)if("object"==typeof a){if(a.hasOwnProperty(b="DECIMAL_PLACES")&&(q(c=a[b],0,1e9,b),B=c),a.hasOwnProperty(b="ROUNDING_MODE")&&(q(c=a[b],0,8,b),C=c),a.hasOwnProperty(b="EXPONENTIAL_AT")&&((c=a[b])&&c.pop?(q(c[0],-1e9,0,b),q(c[1],0,1e9,b),D=c[0],E=c[1]):(q(c,-1e9,1e9,b),D=-(E=c<0?-c:c))),a.hasOwnProperty(b="RANGE"))if((c=a[b])&&c.pop)q(c[0],-1e9,-1,b),q(c[1],1,1e9,b),F=c[0],G=c[1];else if(q(c,-1e9,1e9,b),c)F=-(G=c<0?-c:c);else throw Error(j+b+" cannot be zero: "+c);if(a.hasOwnProperty(b="CRYPTO"))if(!!(c=a[b])===c)if(c)if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))H=c;else throw H=!c,Error(j+"crypto unavailable");else H=c;else throw Error(j+b+" not true or false: "+c);if(a.hasOwnProperty(b="MODULO_MODE")&&(q(c=a[b],0,9,b),I=c),a.hasOwnProperty(b="POW_PRECISION")&&(q(c=a[b],0,1e9,b),J=c),a.hasOwnProperty(b="FORMAT"))if("object"==typeof(c=a[b]))K=c;else throw Error(j+b+" not an object: "+c);if(a.hasOwnProperty(b="ALPHABET")){if("string"!=typeof(c=a[b])||/^.?$|[+\-.\s]|(.).*\1/.test(c))throw Error(j+b+" invalid: "+c);M="0123456789"==c.slice(0,10),L=c}}else throw Error(j+"Object expected: "+a);return{DECIMAL_PLACES:B,ROUNDING_MODE:C,EXPONENTIAL_AT:[D,E],RANGE:[F,G],CRYPTO:H,MODULO_MODE:I,POW_PRECISION:J,FORMAT:K,ALPHABET:L}},N.isBigNumber=function(a){if(!a||!0!==a._isBigNumber)return!1;if(!N.DEBUG)return!0;var b,c,d=a.c,e=a.e,f=a.s;a:if("[object Array]"==({}).toString.call(d)){if((1===f||-1===f)&&e>=-1e9&&e<=1e9&&e===i(e)){if(0===d[0]){if(0===e&&1===d.length)return!0;break a}if((b=(e+1)%14)<1&&(b+=14),String(d[0]).length==b){for(b=0;b<d.length;b++)if((c=d[b])<0||c>=1e14||c!==i(c))break a;if(0!==c)return!0}}}else if(null===d&&null===e&&(null===f||1===f||-1===f))return!0;throw Error(j+"Invalid BigNumber: "+a)},N.maximum=N.max=function(){return P(arguments,-1)},N.minimum=N.min=function(){return P(arguments,1)},c=0x20000000000000*Math.random()&2097151?function(){return i(0x20000000000000*Math.random())}:function(){return(0x40000000*Math.random()|0)*8388608+(8388608*Math.random()|0)},N.random=function(a){var b,d,e,f,g,k=0,m=[],o=new N(A);if(null==a?a=B:q(a,0,1e9),f=h(a/14),H)if(crypto.getRandomValues){for(b=crypto.getRandomValues(new Uint32Array(f*=2));k<f;)(g=131072*b[k]+(b[k+1]>>>11))>=9e15?(d=crypto.getRandomValues(new Uint32Array(2)),b[k]=d[0],b[k+1]=d[1]):(m.push(g%1e14),k+=2);k=f/2}else if(crypto.randomBytes){for(b=crypto.randomBytes(f*=7);k<f;)(g=(31&b[k])*0x1000000000000+0x10000000000*b[k+1]+0x100000000*b[k+2]+0x1000000*b[k+3]+(b[k+4]<<16)+(b[k+5]<<8)+b[k+6])>=9e15?crypto.randomBytes(7).copy(b,k):(m.push(g%1e14),k+=7);k=f/7}else throw H=!1,Error(j+"crypto unavailable");if(!H)for(;k<f;)(g=c())<9e15&&(m[k++]=g%1e14);for(f=m[--k],a%=14,f&&a&&(g=l[14-a],m[k]=i(f/g)*g);0===m[k];m.pop(),k--);if(k<0)m=[e=0];else{for(e=-1;0===m[0];m.splice(0,1),e-=14);for(k=1,g=m[0];g>=10;g/=10,k++);k<14&&(e-=14-k)}return o.e=e,o.c=m,o},N.sum=function(){for(var a=1,b=arguments,c=new N(b[0]);a<b.length;)c=c.plus(b[a++]);return c},x=function(){var a="0123456789";function b(a,b,c,d){for(var e,f,g=[0],h=0,i=a.length;h<i;){for(f=g.length;f--;g[f]*=b);for(g[0]+=d.indexOf(a.charAt(h++)),e=0;e<g.length;e++)g[e]>c-1&&(null==g[e+1]&&(g[e+1]=0),g[e+1]+=g[e]/c|0,g[e]%=c)}return g.reverse()}return function(c,d,e,f,g){var h,i,j,k,l,m,p,q,r=c.indexOf("."),s=B,u=C;for(r>=0&&(k=J,J=0,c=c.replace(".",""),m=(q=new N(d)).pow(c.length-r),J=k,q.c=b(t(o(m.c),m.e,"0"),10,e,a),q.e=q.c.length),j=k=(p=b(c,d,e,g?(h=L,a):(h=a,L))).length;0==p[--k];p.pop());if(!p[0])return h.charAt(0);if(r<0?--j:(m.c=p,m.e=j,m.s=f,p=(m=w(m,q,s,u,e)).c,l=m.r,j=m.e),r=p[i=j+s+1],k=e/2,l=l||i<0||null!=p[i+1],l=u<4?(null!=r||l)&&(0==u||u==(m.s<0?3:2)):r>k||r==k&&(4==u||l||6==u&&1&p[i-1]||u==(m.s<0?8:7)),i<1||!p[0])c=l?t(h.charAt(1),-s,h.charAt(0)):h.charAt(0);else{if(p.length=i,l)for(--e;++p[--i]>e;)p[i]=0,i||(++j,p=[1].concat(p));for(k=p.length;!p[--k];);for(r=0,c="";r<=k;c+=h.charAt(p[r++]));c=t(c,j,h.charAt(0))}return c}}(),w=function(){function a(a,b,c){var d,e,f,g,h=0,i=a.length,j=b%1e7,k=b/1e7|0;for(a=a.slice();i--;)d=k*(f=a[i]%1e7)+(g=a[i]/1e7|0)*j,h=((e=j*f+d%1e7*1e7+h)/c|0)+(d/1e7|0)+k*g,a[i]=e%c;return h&&(a=[h].concat(a)),a}function b(a,b,c,d){var e,f;if(c!=d)f=c>d?1:-1;else for(e=f=0;e<c;e++)if(a[e]!=b[e]){f=a[e]>b[e]?1:-1;break}return f}function c(a,b,c,d){for(var e=0;c--;)a[c]-=e,e=+(a[c]<b[c]),a[c]=e*d+a[c]-b[c];for(;!a[0]&&a.length>1;a.splice(0,1));}return function(d,e,f,g,h){var j,k,l,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=d.s==e.s?1:-1,D=d.c,E=e.c;if(!D||!D[0]||!E||!E[0])return new N(!d.s||!e.s||(D?E&&D[0]==E[0]:!E)?NaN:D&&0==D[0]||!E?0*C:C/0);for(t=(s=new N(C)).c=[],C=f+(k=d.e-e.e)+1,h||(h=1e14,k=m(d.e/14)-m(e.e/14),C=C/14|0),l=0;E[l]==(D[l]||0);l++);if(E[l]>(D[l]||0)&&k--,C<0)t.push(1),o=!0;else{for(y=D.length,A=E.length,l=0,C+=2,(p=i(h/(E[0]+1)))>1&&(E=a(E,p,h),D=a(D,p,h),A=E.length,y=D.length),x=A,v=(u=D.slice(0,A)).length;v<A;u[v++]=0);B=[0].concat(B=E.slice()),z=E[0],E[1]>=h/2&&z++;do{if(p=0,(j=b(E,u,A,v))<0){if(w=u[0],A!=v&&(w=w*h+(u[1]||0)),(p=i(w/z))>1)for(p>=h&&(p=h-1),r=(q=a(E,p,h)).length,v=u.length;1==b(q,u,r,v);)p--,c(q,A<r?B:E,r,h),r=q.length,j=1;else 0==p&&(j=p=1),r=(q=E.slice()).length;if(r<v&&(q=[0].concat(q)),c(u,q,v,h),v=u.length,-1==j)for(;1>b(E,u,A,v);)p++,c(u,A<v?B:E,v,h),v=u.length}else 0===j&&(p++,u=[0]);t[l++]=p,u[0]?u[v++]=D[x]||0:(u=[D[x]],v=1)}while((x++<y||null!=u[0])&&C--);o=null!=u[0],t[0]||t.splice(0,1)}if(1e14==h){for(l=1,C=t[0];C>=10;C/=10,l++);R(s,f+(s.e=l+14*k-1)+1,g,o)}else s.e=k,s.r=+o;return s}}(),d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,e=/^([^.]+)\.$/,f=/^\.([^.]+)$/,u=/^-?(Infinity|NaN)$/,v=/^\s*\+(?=[\w.])|^\s+|\s+$/g,y=function(a,b,c,g){var h,i=c?b:b.replace(v,"");if(u.test(i))a.s=isNaN(i)?null:i<0?-1:1;else{if(!c&&(i=i.replace(d,function(a,b,c){return h="x"==(c=c.toLowerCase())?16:"b"==c?2:8,g&&g!=h?a:b}),g&&(h=g,i=i.replace(e,"$1").replace(f,"0.$1")),b!=i))return new N(i,h);if(N.DEBUG)throw Error(j+"Not a"+(g?" base "+g:"")+" number: "+b);a.s=null}a.c=a.e=null},z.absoluteValue=z.abs=function(){var a=new N(this);return a.s<0&&(a.s=1),a},z.comparedTo=function(a,b){return p(this,new N(a,b))},z.decimalPlaces=z.dp=function(a,b){var c,d,e;if(null!=a)return q(a,0,1e9),null==b?b=C:q(b,0,8),R(new N(this),a+this.e+1,b);if(!(c=this.c))return null;if(d=((e=c.length-1)-m(this.e/14))*14,e=c[e])for(;e%10==0;e/=10,d--);return d<0&&(d=0),d},z.dividedBy=z.div=function(a,b){return w(this,new N(a,b),B,C)},z.dividedToIntegerBy=z.idiv=function(a,b){return w(this,new N(a,b),0,1)},z.exponentiatedBy=z.pow=function(a,b){var c,d,e,f,g,k,l,m,o,p=this;if((a=new N(a)).c&&!a.isInteger())throw Error(j+"Exponent not an integer: "+S(a));if(null!=b&&(b=new N(b)),k=a.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!a.c||!a.c[0])return o=new N(Math.pow(+S(p),k?a.s*(2-r(a)):+S(a))),b?o.mod(b):o;if(l=a.s<0,b){if(b.c?!b.c[0]:!b.s)return new N(NaN);(d=!l&&p.isInteger()&&b.isInteger())&&(p=p.mod(b))}else{if(a.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||k&&p.c[1]>=24e7:p.c[0]<8e13||k&&p.c[0]<=9999975e7)))return f=p.s<0&&r(a)?-0:0,p.e>-1&&(f=1/f),new N(l?1/f:f);J&&(f=h(J/14+2))}for(k?(c=new N(.5),l&&(a.s=1),m=r(a)):m=(e=Math.abs(+S(a)))%2,o=new N(A);;){if(m){if(!(o=o.times(p)).c)break;f?o.c.length>f&&(o.c.length=f):d&&(o=o.mod(b))}if(e){if(0===(e=i(e/2)))break;m=e%2}else if(R(a=a.times(c),a.e+1,1),a.e>14)m=r(a);else{if(0==(e=+S(a)))break;m=e%2}p=p.times(p),f?p.c&&p.c.length>f&&(p.c.length=f):d&&(p=p.mod(b))}return d?o:(l&&(o=A.div(o)),b?o.mod(b):f?R(o,J,C,g):o)},z.integerValue=function(a){var b=new N(this);return null==a?a=C:q(a,0,8),R(b,b.e+1,a)},z.isEqualTo=z.eq=function(a,b){return 0===p(this,new N(a,b))},z.isFinite=function(){return!!this.c},z.isGreaterThan=z.gt=function(a,b){return p(this,new N(a,b))>0},z.isGreaterThanOrEqualTo=z.gte=function(a,b){return 1===(b=p(this,new N(a,b)))||0===b},z.isInteger=function(){return!!this.c&&m(this.e/14)>this.c.length-2},z.isLessThan=z.lt=function(a,b){return 0>p(this,new N(a,b))},z.isLessThanOrEqualTo=z.lte=function(a,b){return -1===(b=p(this,new N(a,b)))||0===b},z.isNaN=function(){return!this.s},z.isNegative=function(){return this.s<0},z.isPositive=function(){return this.s>0},z.isZero=function(){return!!this.c&&0==this.c[0]},z.minus=function(a,b){var c,d,e,f,g=this.s;if(b=(a=new N(a,b)).s,!g||!b)return new N(NaN);if(g!=b)return a.s=-b,this.plus(a);var h=this.e/14,i=a.e/14,j=this.c,k=a.c;if(!h||!i){if(!j||!k)return j?(a.s=-b,a):new N(k?this:NaN);if(!j[0]||!k[0])return k[0]?(a.s=-b,a):new N(j[0]?this:3==C?-0:0)}if(h=m(h),i=m(i),j=j.slice(),g=h-i){for((f=g<0)?(g=-g,e=j):(i=h,e=k),e.reverse(),b=g;b--;e.push(0));e.reverse()}else for(d=(f=(g=j.length)<(b=k.length))?g:b,g=b=0;b<d;b++)if(j[b]!=k[b]){f=j[b]<k[b];break}if(f&&(e=j,j=k,k=e,a.s=-a.s),(b=(d=k.length)-(c=j.length))>0)for(;b--;j[c++]=0);for(b=1e14-1;d>g;){if(j[--d]<k[d]){for(c=d;c&&!j[--c];j[c]=b);--j[c],j[d]+=1e14}j[d]-=k[d]}for(;0==j[0];j.splice(0,1),--i);return j[0]?Q(a,j,i):(a.s=3==C?-1:1,a.c=[a.e=0],a)},z.modulo=z.mod=function(a,b){var c,d;return(a=new N(a,b),this.c&&a.s&&(!a.c||a.c[0]))?a.c&&(!this.c||this.c[0])?(9==I?(d=a.s,a.s=1,c=w(this,a,0,3),a.s=d,c.s*=d):c=w(this,a,0,I),(a=this.minus(c.times(a))).c[0]||1!=I||(a.s=this.s),a):new N(this):new N(NaN)},z.multipliedBy=z.times=function(a,b){var c,d,e,f,g,h,i,j,k,l,o,p,q,r=this.c,s=(a=new N(a,b)).c;if(!r||!s||!r[0]||!s[0])return this.s&&a.s&&(!r||r[0]||s)&&(!s||s[0]||r)?(a.s*=this.s,r&&s?(a.c=[0],a.e=0):a.c=a.e=null):a.c=a.e=a.s=null,a;for(d=m(this.e/14)+m(a.e/14),a.s*=this.s,(i=r.length)<(l=s.length)&&(q=r,r=s,s=q,e=i,i=l,l=e),e=i+l,q=[];e--;q.push(0));for(e=l;--e>=0;){for(c=0,o=s[e]%1e7,p=s[e]/1e7|0,f=e+(g=i);f>e;)h=p*(j=r[--g]%1e7)+(k=r[g]/1e7|0)*o,c=((j=o*j+h%1e7*1e7+q[f]+c)/1e14|0)+(h/1e7|0)+p*k,q[f--]=j%1e14;q[f]=c}return c?++d:q.splice(0,1),Q(a,q,d)},z.negated=function(){var a=new N(this);return a.s=-a.s||null,a},z.plus=function(a,b){var c,d=this.s;if(b=(a=new N(a,b)).s,!d||!b)return new N(NaN);if(d!=b)return a.s=-b,this.minus(a);var e=this.e/14,f=a.e/14,g=this.c,h=a.c;if(!e||!f){if(!g||!h)return new N(d/0);if(!g[0]||!h[0])return h[0]?a:new N(g[0]?this:0*d)}if(e=m(e),f=m(f),g=g.slice(),d=e-f){for(d>0?(f=e,c=h):(d=-d,c=g),c.reverse();d--;c.push(0));c.reverse()}for((d=g.length)-(b=h.length)<0&&(c=h,h=g,g=c,b=d),d=0;b;)d=(g[--b]=g[b]+h[b]+d)/1e14|0,g[b]=1e14===g[b]?0:g[b]%1e14;return d&&(g=[d].concat(g),++f),Q(a,g,f)},z.precision=z.sd=function(a,b){var c,d,e;if(null!=a&&!!a!==a)return q(a,1,1e9),null==b?b=C:q(b,0,8),R(new N(this),a,b);if(!(c=this.c))return null;if(d=14*(e=c.length-1)+1,e=c[e]){for(;e%10==0;e/=10,d--);for(e=c[0];e>=10;e/=10,d++);}return a&&this.e+1>d&&(d=this.e+1),d},z.shiftedBy=function(a){return q(a,-0x1fffffffffffff,0x1fffffffffffff),this.times("1e"+a)},z.squareRoot=z.sqrt=function(){var a,b,c,d,e,f=this.c,g=this.s,h=this.e,i=B+4,j=new N("0.5");if(1!==g||!f||!f[0])return new N(!g||g<0&&(!f||f[0])?NaN:f?this:1/0);if(0==(g=Math.sqrt(+S(this)))||g==1/0?(((b=o(f)).length+h)%2==0&&(b+="0"),g=Math.sqrt(+b),h=m((h+1)/2)-(h<0||h%2),c=new N(b=g==1/0?"5e"+h:(b=g.toExponential()).slice(0,b.indexOf("e")+1)+h)):c=new N(g+""),c.c[0]){for((g=(h=c.e)+i)<3&&(g=0);;)if(e=c,c=j.times(e.plus(w(this,e,i,1))),o(e.c).slice(0,g)===(b=o(c.c)).slice(0,g)){if(c.e<h&&--g,"9999"!=(b=b.slice(g-3,g+1))&&(d||"4999"!=b)){+b&&(+b.slice(1)||"5"!=b.charAt(0))||(R(c,c.e+B+2,1),a=!c.times(c).eq(this));break}if(!d&&(R(e,e.e+B+2,0),e.times(e).eq(this))){c=e;break}i+=4,g+=4,d=1}}return R(c,c.e+B+1,C,a)},z.toExponential=function(a,b){return null!=a&&(q(a,0,1e9),a++),O(this,a,b,1)},z.toFixed=function(a,b){return null!=a&&(q(a,0,1e9),a=a+this.e+1),O(this,a,b)},z.toFormat=function(a,b,c){var d;if(null==c)null!=a&&b&&"object"==typeof b?(c=b,b=null):a&&"object"==typeof a?(c=a,a=b=null):c=K;else if("object"!=typeof c)throw Error(j+"Argument not an object: "+c);if(d=this.toFixed(a,b),this.c){var e,f=d.split("."),g=+c.groupSize,h=+c.secondaryGroupSize,i=c.groupSeparator||"",k=f[0],l=f[1],m=this.s<0,o=m?k.slice(1):k,p=o.length;if(h&&(e=g,g=h,h=e,p-=e),g>0&&p>0){for(e=p%g||g,k=o.substr(0,e);e<p;e+=g)k+=i+o.substr(e,g);h>0&&(k+=i+o.slice(e)),m&&(k="-"+k)}d=l?k+(c.decimalSeparator||"")+((h=+c.fractionGroupSize)?l.replace(RegExp("\\d{"+h+"}\\B","g"),"$&"+(c.fractionGroupSeparator||"")):l):k}return(c.prefix||"")+d+(c.suffix||"")},z.toFraction=function(a){var b,c,d,e,f,g,h,i,k,m,p,q,r=this.c;if(null!=a&&(!(h=new N(a)).isInteger()&&(h.c||1!==h.s)||h.lt(A)))throw Error(j+"Argument "+(h.isInteger()?"out of range: ":"not an integer: ")+S(h));if(!r)return new N(this);for(b=new N(A),k=c=new N(A),d=i=new N(A),q=o(r),f=b.e=q.length-this.e-1,b.c[0]=l[(g=f%14)<0?14+g:g],a=!a||h.comparedTo(b)>0?f>0?b:k:h,g=G,G=1/0,h=new N(q),i.c[0]=0;m=w(h,b,0,1),1!=(e=c.plus(m.times(d))).comparedTo(a);)c=d,d=e,k=i.plus(m.times(e=k)),i=e,b=h.minus(m.times(e=b)),h=e;return e=w(a.minus(c),d,0,1),i=i.plus(e.times(k)),c=c.plus(e.times(d)),i.s=k.s=this.s,f*=2,p=1>w(k,d,f,C).minus(this).abs().comparedTo(w(i,c,f,C).minus(this).abs())?[k,d]:[i,c],G=g,p},z.toNumber=function(){return+S(this)},z.toPrecision=function(a,b){return null!=a&&q(a,1,1e9),O(this,a,b,2)},z.toString=function(a){var b,c=this,d=c.s,e=c.e;return null===e?d?(b="Infinity",d<0&&(b="-"+b)):b="NaN":(null==a?b=e<=D||e>=E?s(o(c.c),e):t(o(c.c),e,"0"):10===a&&M?b=t(o((c=R(new N(c),B+e+1,C)).c),c.e,"0"):(q(a,2,L.length,"Base"),b=x(t(o(c.c),e,"0"),10,a,d,!0)),d<0&&c.c[0]&&(b="-"+b)),b},z.valueOf=z.toJSON=function(){return S(this)},z._isBigNumber=!0,null!=b&&N.set(b),N}()).default=f.BigNumber=f,void 0===(d=(function(){return f}).call(b,c,b,a))||(a.exports=d)}(0)},36012:a=>{"use strict";a.exports={version:"9.14.0"}},36367:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.LoginTicket=void 0;class c{envelope;payload;constructor(a,b){this.envelope=a,this.payload=b}getEnvelope(){return this.envelope}getPayload(){return this.payload}getUserId(){let a=this.getPayload();return a&&a.sub?a.sub:null}getAttributes(){return{envelope:this.getEnvelope(),payload:this.getPayload()}}}b.LoginTicket=c},37067:a=>{"use strict";a.exports=require("node:http")},37143:(a,b,c)=>{"use strict";let{tokenChars:d}=c(83170);a.exports={parse:function(a){let b=new Set,c=-1,e=-1,f=0;for(;f<a.length;f++){let g=a.charCodeAt(f);if(-1===e&&1===d[g])-1===c&&(c=f);else if(0!==f&&(32===g||9===g))-1===e&&-1!==c&&(e=f);else if(44===g){if(-1===c)throw SyntaxError(`Unexpected character at index ${f}`);-1===e&&(e=f);let d=a.slice(c,e);if(b.has(d))throw SyntaxError(`The "${d}" subprotocol is duplicated`);b.add(d),c=e=-1}else throw SyntaxError(`Unexpected character at index ${f}`)}if(-1===c||-1!==e)throw SyntaxError("Unexpected end of input");let g=a.slice(c,f);if(b.has(g))throw SyntaxError(`The "${g}" subprotocol is duplicated`);return b.add(g),b}}},37304:(a,b,c)=>{"use strict";a.exports=c(64073).vendored["react-rsc"].ReactServerDOMWebpackServer},37830:a=>{"use strict";a.exports=require("node:stream/web")},37930:(a,b,c)=>{"use strict";c.d(b,{IngestionForm:()=>d});let d=(0,c(41119).registerClientReference)(function(){throw Error("Attempted to call IngestionForm() from the server but IngestionForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\chira\\Downloads\\Local - HQ - Master\\Coding\\website-data-mcp-server-project-gemini-file-search\\apps\\web\\app\\components\\IngestionForm.tsx","IngestionForm")},38522:a=>{"use strict";a.exports=require("node:zlib")},39538:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{chainStreams:function(){return o},continueDynamicHTMLResume:function(){return F},continueDynamicPrerender:function(){return D},continueFizzStream:function(){return C},continueStaticPrerender:function(){return E},createBufferedTransformStream:function(){return t},createDocumentClosingStream:function(){return G},createRootLayoutValidatorStream:function(){return B},renderToInitialFizzStream:function(){return v},streamFromBuffer:function(){return q},streamFromString:function(){return p},streamToBuffer:function(){return r},streamToString:function(){return s}});let d=c(80152),e=c(49378),f=c(1773),g=c(79662),h=c(26768),i=c(71823),j=c(83048),k=c(24582);function l(){}let m=new TextEncoder;function o(...a){if(0===a.length)return new ReadableStream({start(a){a.close()}});if(1===a.length)return a[0];let{readable:b,writable:c}=new TransformStream,d=a[0].pipeTo(c,{preventClose:!0}),e=1;for(;e<a.length-1;e++){let b=a[e];d=d.then(()=>b.pipeTo(c,{preventClose:!0}))}let f=a[e];return(d=d.then(()=>f.pipeTo(c))).catch(l),b}function p(a){return new ReadableStream({start(b){b.enqueue(m.encode(a)),b.close()}})}function q(a){return new ReadableStream({start(b){b.enqueue(a),b.close()}})}async function r(a){let b=a.getReader(),c=[];for(;;){let{done:a,value:d}=await b.read();if(a)break;c.push(d)}return Buffer.concat(c)}async function s(a,b){let c=new TextDecoder("utf-8",{fatal:!0}),d="";for await(let e of a){if(null==b?void 0:b.aborted)return d;d+=c.decode(e,{stream:!0})}return d+c.decode()}function t(){let a,b=[],c=0;return new TransformStream({transform(d,e){b.push(d),c+=d.byteLength,(d=>{if(a)return;let e=new f.DetachedPromise;a=e,(0,g.scheduleImmediate)(()=>{try{let a=new Uint8Array(c),e=0;for(let c=0;c<b.length;c++){let d=b[c];a.set(d,e),e+=d.byteLength}b.length=0,c=0,d.enqueue(a)}catch{}finally{a=void 0,e.resolve()}})})(e)},flush(){if(a)return a.promise}})}function u(a,b){let c=!1;return new TransformStream({transform(d,e){if(a&&!c){c=!0;let a=new TextDecoder("utf-8",{fatal:!0}).decode(d,{stream:!0}),f=(0,k.insertBuildIdComment)(a,b);e.enqueue(m.encode(f));return}e.enqueue(d)}})}function v({ReactDOMServer:a,element:b,streamOptions:c}){return(0,d.getTracer)().trace(e.AppRenderSpan.renderToReadableStream,async()=>a.renderToReadableStream(b,c))}function w(a){let b=-1,c=!1;return new TransformStream({async transform(d,e){let f=-1,g=-1;if(b++,c)return void e.enqueue(d);let j=0;if(-1===f){if(-1===(f=(0,i.indexOfUint8Array)(d,h.ENCODED_TAGS.META.ICON_MARK)))return void e.enqueue(d);47===d[f+(j=h.ENCODED_TAGS.META.ICON_MARK.length)]?j+=2:j++}if(0===b){if(g=(0,i.indexOfUint8Array)(d,h.ENCODED_TAGS.CLOSED.HEAD),-1!==f){if(f<g){let a=new Uint8Array(d.length-j);a.set(d.subarray(0,f)),a.set(d.subarray(f+j),f),d=a}else{let b=await a(),c=m.encode(b),e=c.length,g=new Uint8Array(d.length-j+e);g.set(d.subarray(0,f)),g.set(c,f),g.set(d.subarray(f+j),f+e),d=g}c=!0}}else{let b=await a(),e=m.encode(b),g=e.length,h=new Uint8Array(d.length-j+g);h.set(d.subarray(0,f)),h.set(e,f),h.set(d.subarray(f+j),f+g),d=h,c=!0}e.enqueue(d)}})}function x(a){let b=!1,c=!1;return new TransformStream({async transform(d,e){c=!0;let f=await a();if(b){if(f){let a=m.encode(f);e.enqueue(a)}e.enqueue(d)}else{let a=(0,i.indexOfUint8Array)(d,h.ENCODED_TAGS.CLOSED.HEAD);if(-1!==a){if(f){let b=m.encode(f),c=new Uint8Array(d.length+b.length);c.set(d.slice(0,a)),c.set(b,a),c.set(d.slice(a),a+b.length),e.enqueue(c)}else e.enqueue(d);b=!0}else f&&e.enqueue(m.encode(f)),e.enqueue(d),b=!0}},async flush(b){if(c){let c=await a();c&&b.enqueue(m.encode(c))}}})}function y(a,b){let c=!1,d=null,e=!1;function f(a){return d||(d=h(a)),d}async function h(d){let f=a.getReader();b&&await (0,g.atLeastOneTask)();try{for(;;){let{done:a,value:h}=await f.read();if(a){e=!0;return}b||c||await (0,g.atLeastOneTask)(),d.enqueue(h)}}catch(a){d.error(a)}}return new TransformStream({start(a){b||f(a)},transform(a,c){c.enqueue(a),b&&f(c)},flush(a){if(c=!0,!e)return f(a)}})}let z="</body></html>";function A(){let a=!1;return new TransformStream({transform(b,c){if(a)return c.enqueue(b);let d=(0,i.indexOfUint8Array)(b,h.ENCODED_TAGS.CLOSED.BODY_AND_HTML);if(d>-1){if(a=!0,b.length===h.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length)return;let e=b.slice(0,d);if(c.enqueue(e),b.length>h.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length+d){let a=b.slice(d+h.ENCODED_TAGS.CLOSED.BODY_AND_HTML.length);c.enqueue(a)}}else c.enqueue(b)},flush(a){a.enqueue(h.ENCODED_TAGS.CLOSED.BODY_AND_HTML)}})}function B(){let a=!1,b=!1;return new TransformStream({async transform(c,d){!a&&(0,i.indexOfUint8Array)(c,h.ENCODED_TAGS.OPENING.HTML)>-1&&(a=!0),!b&&(0,i.indexOfUint8Array)(c,h.ENCODED_TAGS.OPENING.BODY)>-1&&(b=!0),d.enqueue(c)},flush(c){let d=[];a||d.push("html"),b||d.push("body"),d.length&&c.enqueue(m.encode(`<html id="__next_error__">
            <template
              data-next-error-message="Missing ${d.map(a=>`<${a}>`).join(d.length>1?" and ":"")} tags in the root layout.
Read more at https://nextjs.org/docs/messages/missing-root-layout-tags"
              data-next-error-digest="${j.MISSING_ROOT_TAGS_ERROR}"
              data-next-error-stack=""
            ></template>
          `))}})}async function C(a,{suffix:b,inlinedDataStream:c,isStaticGeneration:d,isBuildTimePrerendering:e,buildId:h,getServerInsertedHTML:i,getServerInsertedMetadata:j,validateRootLayout:k}){let l,o,p=b?b.split(z,1)[0]:null;d&&await a.allReady;var q=[t(),u(e,h),w(j),null!=p&&p.length>0?(o=!1,new TransformStream({transform(a,b){if(b.enqueue(a),!o){o=!0;let a=new f.DetachedPromise;l=a,(0,g.scheduleImmediate)(()=>{try{b.enqueue(m.encode(p))}catch{}finally{l=void 0,a.resolve()}})}},flush(a){if(l)return l.promise;o||a.enqueue(m.encode(p))}})):null,c?y(c,!0):null,k?B():null,A(),x(i)];let r=a;for(let a of q)a&&(r=r.pipeThrough(a));return r}async function D(a,{getServerInsertedHTML:b,getServerInsertedMetadata:c}){return a.pipeThrough(t()).pipeThrough(new TransformStream({transform(a,b){(0,i.isEquivalentUint8Arrays)(a,h.ENCODED_TAGS.CLOSED.BODY_AND_HTML)||(0,i.isEquivalentUint8Arrays)(a,h.ENCODED_TAGS.CLOSED.BODY)||(0,i.isEquivalentUint8Arrays)(a,h.ENCODED_TAGS.CLOSED.HTML)||(a=(0,i.removeFromUint8Array)(a,h.ENCODED_TAGS.CLOSED.BODY),a=(0,i.removeFromUint8Array)(a,h.ENCODED_TAGS.CLOSED.HTML),b.enqueue(a))}})).pipeThrough(x(b)).pipeThrough(w(c))}async function E(a,{inlinedDataStream:b,getServerInsertedHTML:c,getServerInsertedMetadata:d,isBuildTimePrerendering:e,buildId:f}){return a.pipeThrough(t()).pipeThrough(u(e,f)).pipeThrough(x(c)).pipeThrough(w(d)).pipeThrough(y(b,!0)).pipeThrough(A())}async function F(a,{delayDataUntilFirstHtmlChunk:b,inlinedDataStream:c,getServerInsertedHTML:d,getServerInsertedMetadata:e}){return a.pipeThrough(t()).pipeThrough(x(d)).pipeThrough(w(e)).pipeThrough(y(c,b)).pipeThrough(A())}function G(){return p(z)}},40473:(a,b,c)=>{"use strict";b.kF=void 0;let d=c(76587);Object.defineProperty(b,"kF",{enumerable:!0,get:function(){return d.GoogleAuth}}),c(15400),c(15921),c(62783),c(33874),c(6148),c(88587),c(30251),c(47201),c(78062),c(66961),c(76748),c(36367),c(58912),c(10006),c(98704),c(21469),c(84068),c(8011),c(61337),c(52046),c(67533),c(79134),new d.GoogleAuth},40697:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.NodeCrypto=void 0;let d=c(55511);class e{async sha256DigestBase64(a){return d.createHash("sha256").update(a).digest("base64")}randomBytesBase64(a){return d.randomBytes(a).toString("base64")}async verify(a,b,c){let e=d.createVerify("RSA-SHA256");return e.update(b),e.end(),e.verify(a,c,"base64")}async sign(a,b){let c=d.createSign("RSA-SHA256");return c.update(b),c.end(),c.sign(a,"base64")}decodeBase64StringUtf8(a){return Buffer.from(a,"base64").toString("utf-8")}encodeBase64StringUtf8(a){return Buffer.from(a,"utf-8").toString("base64")}async sha256DigestHex(a){return d.createHash("sha256").update(a).digest("hex")}async signWithHmacSha256(a,b){var c,e;let f="string"==typeof a?a:(c=a,Buffer.from(c));return(e=d.createHmac("sha256",f).update(b).digest()).buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}}b.NodeCrypto=e},40826:a=>{"use strict";let b=["nodebuffer","arraybuffer","fragments"],c="undefined"!=typeof Blob;c&&b.push("blob"),a.exports={BINARY_TYPES:b,EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",hasBlob:c,kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},41407:a=>{"use strict";a.exports=JSON.parse('{"name":"gaxios","version":"7.1.3","description":"A simple common HTTP client specifically for Google APIs and services.","main":"build/cjs/src/index.js","types":"build/cjs/src/index.d.ts","files":["build/"],"exports":{".":{"import":{"types":"./build/esm/src/index.d.ts","default":"./build/esm/src/index.js"},"require":{"types":"./build/cjs/src/index.d.ts","default":"./build/cjs/src/index.js"}}},"scripts":{"lint":"gts check --no-inline-config","test":"c8 mocha build/esm/test","presystem-test":"npm run compile","system-test":"mocha build/esm/system-test --timeout 80000","compile":"tsc -b ./tsconfig.json ./tsconfig.cjs.json && node utils/enable-esm.mjs","fix":"gts fix","prepare":"npm run compile","pretest":"npm run compile","webpack":"webpack","prebrowser-test":"npm run compile","browser-test":"node build/browser-test/browser-test-runner.js","docs":"jsdoc -c .jsdoc.js","docs-test":"linkinator docs","predocs-test":"npm run docs","samples-test":"cd samples/ && npm link ../ && npm test && cd ../","prelint":"cd samples; npm link ../; npm install","clean":"gts clean"},"repository":{"type":"git","directory":"packages/gaxios","url":"https://github.com/googleapis/google-cloud-node-core.git"},"keywords":["google"],"engines":{"node":">=18"},"author":"Google, LLC","license":"Apache-2.0","devDependencies":{"@babel/plugin-proposal-private-methods":"^7.18.6","@types/cors":"^2.8.6","@types/express":"^5.0.0","@types/extend":"^3.0.1","@types/mocha":"^10.0.10","@types/multiparty":"4.2.1","@types/mv":"^2.1.0","@types/ncp":"^2.0.1","@types/node":"^22.0.0","@types/sinon":"^17.0.0","@types/tmp":"0.2.6","assert":"^2.0.0","browserify":"^17.0.0","c8":"^10.0.0","cors":"^2.8.5","express":"^5.0.0","gts":"^6.0.0","is-docker":"^3.0.0","jsdoc":"^4.0.0","jsdoc-fresh":"^5.0.0","jsdoc-region-tag":"^4.0.0","karma":"^6.0.0","karma-chrome-launcher":"^3.0.0","karma-coverage":"^2.0.0","karma-firefox-launcher":"^2.0.0","karma-mocha":"^2.0.0","karma-remap-coverage":"^0.1.5","karma-sourcemap-loader":"^0.4.0","karma-webpack":"^5.0.1","linkinator":"^6.1.2","mocha":"^11.1.0","multiparty":"^4.2.1","mv":"^2.1.1","ncp":"^2.0.0","nock":"^14.0.0-beta.13","null-loader":"^4.0.0","pack-n-play":"^4.0.0","puppeteer":"^24.0.0","sinon":"^21.0.0","stream-browserify":"^3.0.0","tmp":"0.2.5","ts-loader":"^9.5.2","typescript":"^5.8.3","webpack":"^5.35.0","webpack-cli":"^6.0.1"},"dependencies":{"extend":"^3.0.2","https-proxy-agent":"^7.0.1","node-fetch":"^3.3.2","rimraf":"^5.0.1"},"homepage":"https://github.com/googleapis/google-cloud-node-core/tree/main/packages/gaxios"}')},41596:(a,b,c)=>{"use strict";let d=c(94735),e=c(55591),f=c(81630),g=c(91645),h=c(34631),{randomBytes:i,createHash:j}=c(55511),{Duplex:k,Readable:l}=c(27910),{URL:m}=c(79551),o=c(7775),p=c(9612),q=c(73280),{isBlob:r}=c(83170),{BINARY_TYPES:s,EMPTY_BUFFER:t,GUID:u,kForOnEventAttribute:v,kListener:w,kStatusCode:x,kWebSocket:y,NOOP:z}=c(40826),{EventTarget:{addEventListener:A,removeEventListener:B}}=c(21101),{format:C,parse:D}=c(75690),{toBuffer:E}=c(65158),F=Symbol("kAborted"),G=[8,13],H=["CONNECTING","OPEN","CLOSING","CLOSED"],I=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/;class J extends d{constructor(a,b,c){super(),this._binaryType=s[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=t,this._closeTimer=null,this._errorEmitted=!1,this._extensions={},this._paused=!1,this._protocol="",this._readyState=J.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,null!==a?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,void 0===b?b=[]:Array.isArray(b)||("object"==typeof b&&null!==b?(c=b,b=[]):b=[b]),function a(b,c,d,g){let h,k,l,p,q={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:G[1],maxPayload:0x6400000,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...g,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(b._autoPong=q.autoPong,!G.includes(q.protocolVersion))throw RangeError(`Unsupported protocol version: ${q.protocolVersion} (supported versions: ${G.join(", ")})`);if(c instanceof m)h=c;else try{h=new m(c)}catch(a){throw SyntaxError(`Invalid URL: ${c}`)}"http:"===h.protocol?h.protocol="ws:":"https:"===h.protocol&&(h.protocol="wss:"),b._url=h.href;let r="wss:"===h.protocol,s="ws+unix:"===h.protocol;if("ws:"===h.protocol||r||s?s&&!h.pathname?k="The URL's pathname is empty":h.hash&&(k="The URL contains a fragment identifier"):k='The URL\'s protocol must be one of "ws:", "wss:", "http:", "https:", or "ws+unix:"',k){let a=SyntaxError(k);if(0!==b._redirects)return void K(b,a);throw a}let t=r?443:80,v=i(16).toString("base64"),w=r?e.request:f.request,x=new Set;if(q.createConnection=q.createConnection||(r?M:L),q.defaultPort=q.defaultPort||t,q.port=h.port||t,q.host=h.hostname.startsWith("[")?h.hostname.slice(1,-1):h.hostname,q.headers={...q.headers,"Sec-WebSocket-Version":q.protocolVersion,"Sec-WebSocket-Key":v,Connection:"Upgrade",Upgrade:"websocket"},q.path=h.pathname+h.search,q.timeout=q.handshakeTimeout,q.perMessageDeflate&&(l=new o(!0!==q.perMessageDeflate?q.perMessageDeflate:{},!1,q.maxPayload),q.headers["Sec-WebSocket-Extensions"]=C({[o.extensionName]:l.offer()})),d.length){for(let a of d){if("string"!=typeof a||!I.test(a)||x.has(a))throw SyntaxError("An invalid or duplicated subprotocol was specified");x.add(a)}q.headers["Sec-WebSocket-Protocol"]=d.join(",")}if(q.origin&&(q.protocolVersion<13?q.headers["Sec-WebSocket-Origin"]=q.origin:q.headers.Origin=q.origin),(h.username||h.password)&&(q.auth=`${h.username}:${h.password}`),s){let a=q.path.split(":");q.socketPath=a[0],q.path=a[1]}if(q.followRedirects){if(0===b._redirects){b._originalIpc=s,b._originalSecure=r,b._originalHostOrSocketPath=s?q.socketPath:h.host;let a=g&&g.headers;if(g={...g,headers:{}},a)for(let[b,c]of Object.entries(a))g.headers[b.toLowerCase()]=c}else if(0===b.listenerCount("redirect")){let a=s?!!b._originalIpc&&q.socketPath===b._originalHostOrSocketPath:!b._originalIpc&&h.host===b._originalHostOrSocketPath;a&&(!b._originalSecure||r)||(delete q.headers.authorization,delete q.headers.cookie,a||delete q.headers.host,q.auth=void 0)}q.auth&&!g.headers.authorization&&(g.headers.authorization="Basic "+Buffer.from(q.auth).toString("base64")),p=b._req=w(q),b._redirects&&b.emit("redirect",b.url,p)}else p=b._req=w(q);q.timeout&&p.on("timeout",()=>{N(b,p,"Opening handshake has timed out")}),p.on("error",a=>{null===p||p[F]||(p=b._req=null,K(b,a))}),p.on("response",e=>{let f=e.headers.location,h=e.statusCode;if(f&&q.followRedirects&&h>=300&&h<400){let e;if(++b._redirects>q.maxRedirects)return void N(b,p,"Maximum redirects exceeded");p.abort();try{e=new m(f,c)}catch(a){K(b,SyntaxError(`Invalid URL: ${f}`));return}a(b,e,d,g)}else b.emit("unexpected-response",p,e)||N(b,p,`Unexpected server response: ${e.statusCode}`)}),p.on("upgrade",(a,c,d)=>{let e;if(b.emit("upgrade",a),b.readyState!==J.CONNECTING)return;p=b._req=null;let f=a.headers.upgrade;if(void 0===f||"websocket"!==f.toLowerCase())return void N(b,c,"Invalid Upgrade header");let g=j("sha1").update(v+u).digest("base64");if(a.headers["sec-websocket-accept"]!==g)return void N(b,c,"Invalid Sec-WebSocket-Accept header");let h=a.headers["sec-websocket-protocol"];if(void 0!==h?x.size?x.has(h)||(e="Server sent an invalid subprotocol"):e="Server sent a subprotocol but none was requested":x.size&&(e="Server sent no subprotocol"),e)return void N(b,c,e);h&&(b._protocol=h);let i=a.headers["sec-websocket-extensions"];if(void 0!==i){let a;if(!l)return void N(b,c,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");try{a=D(i)}catch(a){N(b,c,"Invalid Sec-WebSocket-Extensions header");return}let d=Object.keys(a);if(1!==d.length||d[0]!==o.extensionName)return void N(b,c,"Server indicated an extension that was not requested");try{l.accept(a[o.extensionName])}catch(a){N(b,c,"Invalid Sec-WebSocket-Extensions header");return}b._extensions[o.extensionName]=l}b.setSocket(c,d,{allowSynchronousEvents:q.allowSynchronousEvents,generateMask:q.generateMask,maxPayload:q.maxPayload,skipUTF8Validation:q.skipUTF8Validation})}),q.finishRequest?q.finishRequest(p,b):p.end()}(this,a,b,c)):(this._autoPong=c.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(a){s.includes(a)&&(this._binaryType=a,this._receiver&&(this._receiver._binaryType=a))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(a,b,c){let d=new p({allowSynchronousEvents:c.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:c.maxPayload,skipUTF8Validation:c.skipUTF8Validation}),e=new q(a,this._extensions,c.generateMask);this._receiver=d,this._sender=e,this._socket=a,d[y]=this,e[y]=this,a[y]=this,d.on("conclude",P),d.on("drain",Q),d.on("error",R),d.on("message",T),d.on("ping",U),d.on("pong",V),e.onerror=X,a.setTimeout&&a.setTimeout(0),a.setNoDelay&&a.setNoDelay(),b.length>0&&a.unshift(b),a.on("close",Z),a.on("data",$),a.on("end",_),a.on("error",aa),this._readyState=J.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=J.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[o.extensionName]&&this._extensions[o.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=J.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(a,b){if(this.readyState!==J.CLOSED){if(this.readyState===J.CONNECTING)return void N(this,this._req,"WebSocket was closed before the connection was established");if(this.readyState===J.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=J.CLOSING,this._sender.close(a,b,!this._isServer,a=>{!a&&(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),Y(this)}}pause(){this.readyState!==J.CONNECTING&&this.readyState!==J.CLOSED&&(this._paused=!0,this._socket.pause())}ping(a,b,c){if(this.readyState===J.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==J.OPEN)return void O(this,a,c);void 0===b&&(b=!this._isServer),this._sender.ping(a||t,b,c)}pong(a,b,c){if(this.readyState===J.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof a?(c=a,a=b=void 0):"function"==typeof b&&(c=b,b=void 0),"number"==typeof a&&(a=a.toString()),this.readyState!==J.OPEN)return void O(this,a,c);void 0===b&&(b=!this._isServer),this._sender.pong(a||t,b,c)}resume(){this.readyState!==J.CONNECTING&&this.readyState!==J.CLOSED&&(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(a,b,c){if(this.readyState===J.CONNECTING)throw Error("WebSocket is not open: readyState 0 (CONNECTING)");if("function"==typeof b&&(c=b,b={}),"number"==typeof a&&(a=a.toString()),this.readyState!==J.OPEN)return void O(this,a,c);let d={binary:"string"!=typeof a,mask:!this._isServer,compress:!0,fin:!0,...b};this._extensions[o.extensionName]||(d.compress=!1),this._sender.send(a||t,d,c)}terminate(){if(this.readyState!==J.CLOSED){if(this.readyState===J.CONNECTING)return void N(this,this._req,"WebSocket was closed before the connection was established");this._socket&&(this._readyState=J.CLOSING,this._socket.destroy())}}}function K(a,b){a._readyState=J.CLOSING,a._errorEmitted=!0,a.emit("error",b),a.emitClose()}function L(a){return a.path=a.socketPath,g.connect(a)}function M(a){return a.path=void 0,a.servername||""===a.servername||(a.servername=g.isIP(a.host)?"":a.host),h.connect(a)}function N(a,b,c){a._readyState=J.CLOSING;let d=Error(c);Error.captureStackTrace(d,N),b.setHeader?(b[F]=!0,b.abort(),b.socket&&!b.socket.destroyed&&b.socket.destroy(),process.nextTick(K,a,d)):(b.destroy(d),b.once("error",a.emit.bind(a,"error")),b.once("close",a.emitClose.bind(a)))}function O(a,b,c){if(b){let c=r(b)?b.size:E(b).length;a._socket?a._sender._bufferedBytes+=c:a._bufferedAmount+=c}if(c){let b=Error(`WebSocket is not open: readyState ${a.readyState} (${H[a.readyState]})`);process.nextTick(c,b)}}function P(a,b){let c=this[y];c._closeFrameReceived=!0,c._closeMessage=b,c._closeCode=a,void 0!==c._socket[y]&&(c._socket.removeListener("data",$),process.nextTick(W,c._socket),1005===a?c.close():c.close(a,b))}function Q(){let a=this[y];a.isPaused||a._socket.resume()}function R(a){let b=this[y];void 0!==b._socket[y]&&(b._socket.removeListener("data",$),process.nextTick(W,b._socket),b.close(a[x])),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a))}function S(){this[y].emitClose()}function T(a,b){this[y].emit("message",a,b)}function U(a){let b=this[y];b._autoPong&&b.pong(a,!this._isServer,z),b.emit("ping",a)}function V(a){this[y].emit("pong",a)}function W(a){a.resume()}function X(a){let b=this[y];b.readyState!==J.CLOSED&&(b.readyState===J.OPEN&&(b._readyState=J.CLOSING,Y(b)),this._socket.end(),b._errorEmitted||(b._errorEmitted=!0,b.emit("error",a)))}function Y(a){a._closeTimer=setTimeout(a._socket.destroy.bind(a._socket),3e4)}function Z(){let a,b=this[y];this.removeListener("close",Z),this.removeListener("data",$),this.removeListener("end",_),b._readyState=J.CLOSING,this._readableState.endEmitted||b._closeFrameReceived||b._receiver._writableState.errorEmitted||null===(a=b._socket.read())||b._receiver.write(a),b._receiver.end(),this[y]=void 0,clearTimeout(b._closeTimer),b._receiver._writableState.finished||b._receiver._writableState.errorEmitted?b.emitClose():(b._receiver.on("error",S),b._receiver.on("finish",S))}function $(a){this[y]._receiver.write(a)||this.pause()}function _(){let a=this[y];a._readyState=J.CLOSING,a._receiver.end(),this.end()}function aa(){let a=this[y];this.removeListener("error",aa),this.on("error",z),a&&(a._readyState=J.CLOSING,this.destroy())}Object.defineProperty(J,"CONNECTING",{enumerable:!0,value:H.indexOf("CONNECTING")}),Object.defineProperty(J.prototype,"CONNECTING",{enumerable:!0,value:H.indexOf("CONNECTING")}),Object.defineProperty(J,"OPEN",{enumerable:!0,value:H.indexOf("OPEN")}),Object.defineProperty(J.prototype,"OPEN",{enumerable:!0,value:H.indexOf("OPEN")}),Object.defineProperty(J,"CLOSING",{enumerable:!0,value:H.indexOf("CLOSING")}),Object.defineProperty(J.prototype,"CLOSING",{enumerable:!0,value:H.indexOf("CLOSING")}),Object.defineProperty(J,"CLOSED",{enumerable:!0,value:H.indexOf("CLOSED")}),Object.defineProperty(J.prototype,"CLOSED",{enumerable:!0,value:H.indexOf("CLOSED")}),["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(a=>{Object.defineProperty(J.prototype,a,{enumerable:!0})}),["open","error","close","message"].forEach(a=>{Object.defineProperty(J.prototype,`on${a}`,{enumerable:!0,get(){for(let b of this.listeners(a))if(b[v])return b[w];return null},set(b){for(let b of this.listeners(a))if(b[v]){this.removeListener(a,b);break}"function"==typeof b&&this.addEventListener(a,b,{[v]:!0})}})}),J.prototype.addEventListener=A,J.prototype.removeEventListener=B,a.exports=J},43921:a=>{"use strict";let b=Symbol("kDone"),c=Symbol("kRun");class d{constructor(a){this[b]=()=>{this.pending--,this[c]()},this.concurrency=a||1/0,this.jobs=[],this.pending=0}add(a){this.jobs.push(a),this[c]()}[c](){if(this.pending!==this.concurrency&&this.jobs.length){let a=this.jobs.shift();this.pending++,a(this[b])}}}a.exports=d},44708:a=>{"use strict";a.exports=require("node:https")},45065:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.PluggableAuthHandler=b.ExecutableError=void 0;let d=c(15168),e=c(79646),f=c(29021);class g extends Error{code;constructor(a,b){super(`The executable failed with exit code: ${b} and error message: ${a}.`),this.code=b,Object.setPrototypeOf(this,new.target.prototype)}}b.ExecutableError=g;class h{commandComponents;timeoutMillis;outputFile;constructor(a){if(!a.command)throw Error("No command provided.");if(this.commandComponents=h.parseCommand(a.command),this.timeoutMillis=a.timeoutMillis,!this.timeoutMillis)throw Error("No timeoutMillis provided.");this.outputFile=a.outputFile}retrieveResponseFromExecutable(a){return new Promise((b,c)=>{let f=e.spawn(this.commandComponents[0],this.commandComponents.slice(1),{env:{...process.env,...Object.fromEntries(a)}}),h="";f.stdout.on("data",a=>{h+=a}),f.stderr.on("data",a=>{h+=a});let i=setTimeout(()=>(f.removeAllListeners(),f.kill(),c(Error("The executable failed to finish within the timeout specified."))),this.timeoutMillis);f.on("close",a=>{if(clearTimeout(i),0!==a)return c(new g(h,a.toString()));try{let a=JSON.parse(h),c=new d.ExecutableResponse(a);return b(c)}catch(a){if(a instanceof d.ExecutableResponseError)return c(a);return c(new d.ExecutableResponseError(`The executable returned an invalid response: ${h}`))}})})}async retrieveCachedResponse(){let a;if(!this.outputFile||0===this.outputFile.length)return;try{a=await f.promises.realpath(this.outputFile)}catch{return}if(!(await f.promises.lstat(a)).isFile())return;let b=await f.promises.readFile(a,{encoding:"utf8"});if(""!==b)try{let a=JSON.parse(b);if(new d.ExecutableResponse(a).isValid())return new d.ExecutableResponse(a);return}catch(a){if(a instanceof d.ExecutableResponseError)throw a;throw new d.ExecutableResponseError(`The output file contained an invalid response: ${b}`)}}static parseCommand(a){let b=a.match(/(?:[^\s"]+|"[^"]*")+/g);if(!b)throw Error(`Provided command: "${a}" could not be parsed.`);for(let a=0;a<b.length;a++)'"'===b[a][0]&&'"'===b[a].slice(-1)&&(b[a]=b[a].slice(1,-1));return b}}b.PluggableAuthHandler=h},45351:()=>{},45543:(a,b,c)=>{"use strict";c(41596);let{Duplex:d}=c(27910);function e(a){a.emit("close")}function f(){!this.destroyed&&this._writableState.finished&&this.destroy()}function g(a){this.removeListener("error",g),this.destroy(),0===this.listenerCount("error")&&this.emit("error",a)}a.exports=function(a,b){let c=!0,h=new d({...b,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return a.on("message",function(b,c){let d=!c&&h._readableState.objectMode?b.toString():b;h.push(d)||a.pause()}),a.once("error",function(a){h.destroyed||(c=!1,h.destroy(a))}),a.once("close",function(){h.destroyed||h.push(null)}),h._destroy=function(b,d){if(a.readyState===a.CLOSED){d(b),process.nextTick(e,h);return}let f=!1;a.once("error",function(a){f=!0,d(a)}),a.once("close",function(){f||d(b),process.nextTick(e,h)}),c&&a.terminate()},h._final=function(b){if(a.readyState===a.CONNECTING)return void a.once("open",function(){h._final(b)});null!==a._socket&&(a._socket._writableState.finished?(b(),h._readableState.endEmitted&&h.destroy()):(a._socket.once("finish",function(){b()}),a.close()))},h._read=function(){a.isPaused&&a.resume()},h._write=function(b,c,d){if(a.readyState===a.CONNECTING)return void a.once("open",function(){h._write(b,c,d)});a.send(b,d)},h.on("end",f),h.on("error",g),h}},46279:a=>{"use strict";let b=a=>a&&"string"==typeof a.message,c=a=>{if(!a)return;let c=a.cause;if("function"!=typeof c)return b(c)?c:void 0;{let c=a.cause();return b(c)?c:void 0}},d=(a,e)=>{if(!b(a))return"";let f=a.stack||"";if(e.has(a))return f+"\ncauses have become circular...";let g=c(a);return g?(e.add(a),f+"\ncaused by: "+d(g,e)):f},e=(a,d,f)=>{if(!b(a))return"";let g=f?"":a.message||"";if(d.has(a))return g+": ...";let h=c(a);if(!h)return g;{d.add(a);let b="function"==typeof a.cause;return g+(b?"":": ")+e(h,d,b)}};a.exports={isErrorLike:b,getErrorCause:c,stackWithCauses:a=>d(a,new Set),messageWithCauses:a=>e(a,new Set)}},46905:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.GCE_LINUX_BIOS_PATHS=void 0,b.isGoogleCloudServerless=g,b.isGoogleComputeEngineLinux=h,b.isGoogleComputeEngineMACAddress=i,b.isGoogleComputeEngine=j,b.detectGCPResidency=function(){return g()||j()};let d=c(29021),e=c(21820);b.GCE_LINUX_BIOS_PATHS={BIOS_DATE:"/sys/class/dmi/id/bios_date",BIOS_VENDOR:"/sys/class/dmi/id/bios_vendor"};let f=/^42:01/;function g(){return!!(process.env.CLOUD_RUN_JOB||process.env.FUNCTION_NAME||process.env.K_SERVICE)}function h(){if("linux"!==(0,e.platform)())return!1;try{(0,d.statSync)(b.GCE_LINUX_BIOS_PATHS.BIOS_DATE);let a=(0,d.readFileSync)(b.GCE_LINUX_BIOS_PATHS.BIOS_VENDOR,"utf8");return/Google/.test(a)}catch{return!1}}function i(){for(let a of Object.values((0,e.networkInterfaces)()))if(a){for(let{mac:b}of a)if(f.test(b))return!0}return!1}function j(){return h()||i()}},47201:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.JWTAccess=void 0;let d=c(52302),e=c(21827),f={alg:"RS256",typ:"JWT"};class g{email;key;keyId;projectId;eagerRefreshThresholdMillis;cache=new e.LRUCache({capacity:500,maxAge:36e5});constructor(a,b,c,d){this.email=a,this.key=b,this.keyId=c,this.eagerRefreshThresholdMillis=d??3e5}getCachedKey(a,b){let c=a;if(b&&Array.isArray(b)&&b.length?c=a?`${a}_${b.join("_")}`:`${b.join("_")}`:"string"==typeof b&&(c=a?`${a}_${b}`:b),!c)throw Error("Scopes or url must be provided");return c}getRequestHeaders(a,b,c){let e,h=this.getCachedKey(a,c),i=this.cache.get(h),j=Date.now();if(i&&i.expiration-j>this.eagerRefreshThresholdMillis)return new Headers(i.headers);let k=Math.floor(Date.now()/1e3),l=g.getExpirationTime(k);if(Array.isArray(c)&&(c=c.join(" ")),e=c?{iss:this.email,sub:this.email,scope:c,exp:l,iat:k}:{iss:this.email,sub:this.email,aud:a,exp:l,iat:k},b){for(let a in e)if(b[a])throw Error(`The '${a}' property is not allowed when passing additionalClaims. This claim is included in the JWT by default.`)}let m=this.keyId?{...f,kid:this.keyId}:f,o=Object.assign(e,b),p=d.sign({header:m,payload:o,secret:this.key}),q=new Headers({authorization:`Bearer ${p}`});return this.cache.set(h,{expiration:1e3*l,headers:q}),q}static getExpirationTime(a){return a+3600}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{a||c(Error("Must pass in a stream containing the service account auth settings."));let d="";a.setEncoding("utf8").on("data",a=>d+=a).on("error",c).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}}b.JWTAccess=g},47572:a=>{"use strict";var b=Object.prototype.hasOwnProperty,c=Object.prototype.toString,d=Object.defineProperty,e=Object.getOwnPropertyDescriptor,f=function(a){return"function"==typeof Array.isArray?Array.isArray(a):"[object Array]"===c.call(a)},g=function(a){if(!a||"[object Object]"!==c.call(a))return!1;var d,e=b.call(a,"constructor"),f=a.constructor&&a.constructor.prototype&&b.call(a.constructor.prototype,"isPrototypeOf");if(a.constructor&&!e&&!f)return!1;for(d in a);return void 0===d||b.call(a,d)},h=function(a,b){d&&"__proto__"===b.name?d(a,b.name,{enumerable:!0,configurable:!0,value:b.newValue,writable:!0}):a[b.name]=b.newValue},i=function(a,c){if("__proto__"===c){if(!b.call(a,c))return;else if(e)return e(a,c).value}return a[c]};a.exports=function a(){var b,c,d,e,j,k,l=arguments[0],m=1,o=arguments.length,p=!1;for("boolean"==typeof l&&(p=l,l=arguments[1]||{},m=2),(null==l||"object"!=typeof l&&"function"!=typeof l)&&(l={});m<o;++m)if(b=arguments[m],null!=b)for(c in b)d=i(l,c),l!==(e=i(b,c))&&(p&&e&&(g(e)||(j=f(e)))?(j?(j=!1,k=d&&f(d)?d:[]):k=d&&g(d)?d:{},h(l,{name:c,newValue:a(p,k,e)})):void 0!==e&&h(l,{name:c,newValue:e}));return l}},48161:a=>{"use strict";a.exports=require("node:os")},49378:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{AppRenderSpan:function(){return i},AppRouteRouteHandlersSpan:function(){return l},BaseServerSpan:function(){return c},LoadComponentsSpan:function(){return d},LogSpanAllowList:function(){return q},MiddlewareSpan:function(){return o},NextNodeServerSpan:function(){return f},NextServerSpan:function(){return e},NextVanillaSpanAllowlist:function(){return p},NodeSpan:function(){return k},RenderSpan:function(){return h},ResolveMetadataSpan:function(){return m},RouterSpan:function(){return j},StartServerSpan:function(){return g}});var c=function(a){return a.handleRequest="BaseServer.handleRequest",a.run="BaseServer.run",a.pipe="BaseServer.pipe",a.getStaticHTML="BaseServer.getStaticHTML",a.render="BaseServer.render",a.renderToResponseWithComponents="BaseServer.renderToResponseWithComponents",a.renderToResponse="BaseServer.renderToResponse",a.renderToHTML="BaseServer.renderToHTML",a.renderError="BaseServer.renderError",a.renderErrorToResponse="BaseServer.renderErrorToResponse",a.renderErrorToHTML="BaseServer.renderErrorToHTML",a.render404="BaseServer.render404",a}(c||{}),d=function(a){return a.loadDefaultErrorComponents="LoadComponents.loadDefaultErrorComponents",a.loadComponents="LoadComponents.loadComponents",a}(d||{}),e=function(a){return a.getRequestHandler="NextServer.getRequestHandler",a.getServer="NextServer.getServer",a.getServerRequestHandler="NextServer.getServerRequestHandler",a.createServer="createServer.createServer",a}(e||{}),f=function(a){return a.compression="NextNodeServer.compression",a.getBuildId="NextNodeServer.getBuildId",a.createComponentTree="NextNodeServer.createComponentTree",a.clientComponentLoading="NextNodeServer.clientComponentLoading",a.getLayoutOrPageModule="NextNodeServer.getLayoutOrPageModule",a.generateStaticRoutes="NextNodeServer.generateStaticRoutes",a.generateFsStaticRoutes="NextNodeServer.generateFsStaticRoutes",a.generatePublicRoutes="NextNodeServer.generatePublicRoutes",a.generateImageRoutes="NextNodeServer.generateImageRoutes.route",a.sendRenderResult="NextNodeServer.sendRenderResult",a.proxyRequest="NextNodeServer.proxyRequest",a.runApi="NextNodeServer.runApi",a.render="NextNodeServer.render",a.renderHTML="NextNodeServer.renderHTML",a.imageOptimizer="NextNodeServer.imageOptimizer",a.getPagePath="NextNodeServer.getPagePath",a.getRoutesManifest="NextNodeServer.getRoutesManifest",a.findPageComponents="NextNodeServer.findPageComponents",a.getFontManifest="NextNodeServer.getFontManifest",a.getServerComponentManifest="NextNodeServer.getServerComponentManifest",a.getRequestHandler="NextNodeServer.getRequestHandler",a.renderToHTML="NextNodeServer.renderToHTML",a.renderError="NextNodeServer.renderError",a.renderErrorToHTML="NextNodeServer.renderErrorToHTML",a.render404="NextNodeServer.render404",a.startResponse="NextNodeServer.startResponse",a.route="route",a.onProxyReq="onProxyReq",a.apiResolver="apiResolver",a.internalFetch="internalFetch",a}(f||{}),g=function(a){return a.startServer="startServer.startServer",a}(g||{}),h=function(a){return a.getServerSideProps="Render.getServerSideProps",a.getStaticProps="Render.getStaticProps",a.renderToString="Render.renderToString",a.renderDocument="Render.renderDocument",a.createBodyResult="Render.createBodyResult",a}(h||{}),i=function(a){return a.renderToString="AppRender.renderToString",a.renderToReadableStream="AppRender.renderToReadableStream",a.getBodyResult="AppRender.getBodyResult",a.fetch="AppRender.fetch",a}(i||{}),j=function(a){return a.executeRoute="Router.executeRoute",a}(j||{}),k=function(a){return a.runHandler="Node.runHandler",a}(k||{}),l=function(a){return a.runHandler="AppRouteRouteHandlers.runHandler",a}(l||{}),m=function(a){return a.generateMetadata="ResolveMetadata.generateMetadata",a.generateViewport="ResolveMetadata.generateViewport",a}(m||{}),o=function(a){return a.execute="Middleware.execute",a}(o||{});let p=["Middleware.execute","BaseServer.handleRequest","Render.getServerSideProps","Render.getStaticProps","AppRender.fetch","AppRender.getBodyResult","Render.renderDocument","Node.runHandler","AppRouteRouteHandlers.runHandler","ResolveMetadata.generateMetadata","ResolveMetadata.generateViewport","NextNodeServer.createComponentTree","NextNodeServer.findPageComponents","NextNodeServer.getLayoutOrPageModule","NextNodeServer.startResponse","NextNodeServer.clientComponentLoading"],q=["NextNodeServer.findPageComponents","NextNodeServer.createComponentTree","NextNodeServer.clientComponentLoading"]},50094:(a,b,c)=>{var d=c(26193).stringify,e=c(81063);a.exports=function(a){return{parse:e(a),stringify:d}},a.exports.parse=e(),a.exports.stringify=d},51466:(a,b)=>{"use strict";function c(a){return a.startsWith("/")?a:"/"+a}Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"ensureLeadingSlash",{enumerable:!0,get:function(){return c}})},52046:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.PluggableAuthClient=b.ExecutableError=void 0;let d=c(8011),e=c(15168),f=c(45065);var g=c(45065);Object.defineProperty(b,"ExecutableError",{enumerable:!0,get:function(){return g.ExecutableError}});class h extends d.BaseExternalAccountClient{command;timeoutMillis;outputFile;handler;constructor(a){if(super(a),!a.credential_source.executable||(this.command=a.credential_source.executable.command,!this.command))throw Error('No valid Pluggable Auth "credential_source" provided.');if(void 0===a.credential_source.executable.timeout_millis)this.timeoutMillis=3e4;else if(this.timeoutMillis=a.credential_source.executable.timeout_millis,this.timeoutMillis<5e3||this.timeoutMillis>12e4)throw Error("Timeout must be between 5000120000 milliseconds.");this.outputFile=a.credential_source.executable.output_file,this.handler=new f.PluggableAuthHandler({command:this.command,timeoutMillis:this.timeoutMillis,outputFile:this.outputFile}),this.credentialSourceType="executable"}async retrieveSubjectToken(){let a;if("1"!==process.env.GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES)throw Error("Pluggable Auth executables need to be explicitly allowed to run by setting the GOOGLE_EXTERNAL_ACCOUNT_ALLOW_EXECUTABLES environment Variable to 1.");if(this.outputFile&&(a=await this.handler.retrieveCachedResponse()),!a){let b=new Map;b.set("GOOGLE_EXTERNAL_ACCOUNT_AUDIENCE",this.audience),b.set("GOOGLE_EXTERNAL_ACCOUNT_TOKEN_TYPE",this.subjectTokenType),b.set("GOOGLE_EXTERNAL_ACCOUNT_INTERACTIVE","0"),this.outputFile&&b.set("GOOGLE_EXTERNAL_ACCOUNT_OUTPUT_FILE",this.outputFile);let c=this.getServiceAccountEmail();c&&b.set("GOOGLE_EXTERNAL_ACCOUNT_IMPERSONATED_EMAIL",c),a=await this.handler.retrieveResponseFromExecutable(b)}if(a.version>1)throw Error("Version of executable is not currently supported, maximum supported version is 1.");if(!a.success)throw new f.ExecutableError(a.errorMessage,a.errorCode);if(this.outputFile&&!a.expirationTime)throw new e.InvalidExpirationTimeFieldError("The executable response must contain the `expiration_time` field for successful responses when an output_file has been specified in the configuration.");if(a.isExpired())throw Error("Executable response is expired.");return a.subjectToken}}b.PluggableAuthClient=h},52302:(a,b,c)=>{var d=c(61406),e=c(858);b.ALGORITHMS=["HS256","HS384","HS512","RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"],b.sign=d.sign,b.verify=e.verify,b.decode=e.decode,b.isValid=e.isValid,b.createSign=function(a){return new d(a)},b.createVerify=function(a){return new e(a)}},52506:(a,b,c)=>{var d=c(79428).Buffer;a.exports=function(a){return"string"==typeof a?a:"number"==typeof a||d.isBuffer(a)?a.toString():JSON.stringify(a)}},53053:a=>{"use strict";a.exports=require("node:diagnostics_channel")},54413:(a,b,c)=>{"use strict";Object.defineProperty(b,"A",{enumerable:!0,get:function(){return d.registerServerReference}});let d=c(37304)},54576:a=>{(()=>{"use strict";var b={491:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ContextAPI=void 0;let d=c(223),e=c(172),f=c(930),g="context",h=new d.NoopContextManager;class i{constructor(){}static getInstance(){return this._instance||(this._instance=new i),this._instance}setGlobalContextManager(a){return(0,e.registerGlobal)(g,a,f.DiagAPI.instance())}active(){return this._getContextManager().active()}with(a,b,c,...d){return this._getContextManager().with(a,b,c,...d)}bind(a,b){return this._getContextManager().bind(a,b)}_getContextManager(){return(0,e.getGlobal)(g)||h}disable(){this._getContextManager().disable(),(0,e.unregisterGlobal)(g,f.DiagAPI.instance())}}b.ContextAPI=i},930:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.DiagAPI=void 0;let d=c(56),e=c(912),f=c(957),g=c(172);class h{constructor(){function a(a){return function(...b){let c=(0,g.getGlobal)("diag");if(c)return c[a](...b)}}let b=this;b.setLogger=(a,c={logLevel:f.DiagLogLevel.INFO})=>{var d,h,i;if(a===b){let a=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return b.error(null!=(d=a.stack)?d:a.message),!1}"number"==typeof c&&(c={logLevel:c});let j=(0,g.getGlobal)("diag"),k=(0,e.createLogLevelDiagLogger)(null!=(h=c.logLevel)?h:f.DiagLogLevel.INFO,a);if(j&&!c.suppressOverrideMessage){let a=null!=(i=Error().stack)?i:"<failed to generate stacktrace>";j.warn(`Current logger will be overwritten from ${a}`),k.warn(`Current logger will overwrite one already registered from ${a}`)}return(0,g.registerGlobal)("diag",k,b,!0)},b.disable=()=>{(0,g.unregisterGlobal)("diag",b)},b.createComponentLogger=a=>new d.DiagComponentLogger(a),b.verbose=a("verbose"),b.debug=a("debug"),b.info=a("info"),b.warn=a("warn"),b.error=a("error")}static instance(){return this._instance||(this._instance=new h),this._instance}}b.DiagAPI=h},653:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.MetricsAPI=void 0;let d=c(660),e=c(172),f=c(930),g="metrics";class h{constructor(){}static getInstance(){return this._instance||(this._instance=new h),this._instance}setGlobalMeterProvider(a){return(0,e.registerGlobal)(g,a,f.DiagAPI.instance())}getMeterProvider(){return(0,e.getGlobal)(g)||d.NOOP_METER_PROVIDER}getMeter(a,b,c){return this.getMeterProvider().getMeter(a,b,c)}disable(){(0,e.unregisterGlobal)(g,f.DiagAPI.instance())}}b.MetricsAPI=h},181:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.PropagationAPI=void 0;let d=c(172),e=c(874),f=c(194),g=c(277),h=c(369),i=c(930),j="propagation",k=new e.NoopTextMapPropagator;class l{constructor(){this.createBaggage=h.createBaggage,this.getBaggage=g.getBaggage,this.getActiveBaggage=g.getActiveBaggage,this.setBaggage=g.setBaggage,this.deleteBaggage=g.deleteBaggage}static getInstance(){return this._instance||(this._instance=new l),this._instance}setGlobalPropagator(a){return(0,d.registerGlobal)(j,a,i.DiagAPI.instance())}inject(a,b,c=f.defaultTextMapSetter){return this._getGlobalPropagator().inject(a,b,c)}extract(a,b,c=f.defaultTextMapGetter){return this._getGlobalPropagator().extract(a,b,c)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,d.unregisterGlobal)(j,i.DiagAPI.instance())}_getGlobalPropagator(){return(0,d.getGlobal)(j)||k}}b.PropagationAPI=l},997:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TraceAPI=void 0;let d=c(172),e=c(846),f=c(139),g=c(607),h=c(930),i="trace";class j{constructor(){this._proxyTracerProvider=new e.ProxyTracerProvider,this.wrapSpanContext=f.wrapSpanContext,this.isSpanContextValid=f.isSpanContextValid,this.deleteSpan=g.deleteSpan,this.getSpan=g.getSpan,this.getActiveSpan=g.getActiveSpan,this.getSpanContext=g.getSpanContext,this.setSpan=g.setSpan,this.setSpanContext=g.setSpanContext}static getInstance(){return this._instance||(this._instance=new j),this._instance}setGlobalTracerProvider(a){let b=(0,d.registerGlobal)(i,this._proxyTracerProvider,h.DiagAPI.instance());return b&&this._proxyTracerProvider.setDelegate(a),b}getTracerProvider(){return(0,d.getGlobal)(i)||this._proxyTracerProvider}getTracer(a,b){return this.getTracerProvider().getTracer(a,b)}disable(){(0,d.unregisterGlobal)(i,h.DiagAPI.instance()),this._proxyTracerProvider=new e.ProxyTracerProvider}}b.TraceAPI=j},277:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.deleteBaggage=b.setBaggage=b.getActiveBaggage=b.getBaggage=void 0;let d=c(491),e=(0,c(780).createContextKey)("OpenTelemetry Baggage Key");function f(a){return a.getValue(e)||void 0}b.getBaggage=f,b.getActiveBaggage=function(){return f(d.ContextAPI.getInstance().active())},b.setBaggage=function(a,b){return a.setValue(e,b)},b.deleteBaggage=function(a){return a.deleteValue(e)}},993:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.BaggageImpl=void 0;class c{constructor(a){this._entries=a?new Map(a):new Map}getEntry(a){let b=this._entries.get(a);if(b)return Object.assign({},b)}getAllEntries(){return Array.from(this._entries.entries()).map(([a,b])=>[a,b])}setEntry(a,b){let d=new c(this._entries);return d._entries.set(a,b),d}removeEntry(a){let b=new c(this._entries);return b._entries.delete(a),b}removeEntries(...a){let b=new c(this._entries);for(let c of a)b._entries.delete(c);return b}clear(){return new c}}b.BaggageImpl=c},830:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.baggageEntryMetadataSymbol=void 0,b.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")},369:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.baggageEntryMetadataFromString=b.createBaggage=void 0;let d=c(930),e=c(993),f=c(830),g=d.DiagAPI.instance();b.createBaggage=function(a={}){return new e.BaggageImpl(new Map(Object.entries(a)))},b.baggageEntryMetadataFromString=function(a){return"string"!=typeof a&&(g.error(`Cannot create baggage metadata from unknown type: ${typeof a}`),a=""),{__TYPE__:f.baggageEntryMetadataSymbol,toString:()=>a}}},67:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.context=void 0,b.context=c(491).ContextAPI.getInstance()},223:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NoopContextManager=void 0;let d=c(780);class e{active(){return d.ROOT_CONTEXT}with(a,b,c,...d){return b.call(c,...d)}bind(a,b){return b}enable(){return this}disable(){return this}}b.NoopContextManager=e},780:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ROOT_CONTEXT=b.createContextKey=void 0,b.createContextKey=function(a){return Symbol.for(a)};class c{constructor(a){let b=this;b._currentContext=a?new Map(a):new Map,b.getValue=a=>b._currentContext.get(a),b.setValue=(a,d)=>{let e=new c(b._currentContext);return e._currentContext.set(a,d),e},b.deleteValue=a=>{let d=new c(b._currentContext);return d._currentContext.delete(a),d}}}b.ROOT_CONTEXT=new c},506:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.diag=void 0,b.diag=c(930).DiagAPI.instance()},56:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.DiagComponentLogger=void 0;let d=c(172);class e{constructor(a){this._namespace=a.namespace||"DiagComponentLogger"}debug(...a){return f("debug",this._namespace,a)}error(...a){return f("error",this._namespace,a)}info(...a){return f("info",this._namespace,a)}warn(...a){return f("warn",this._namespace,a)}verbose(...a){return f("verbose",this._namespace,a)}}function f(a,b,c){let e=(0,d.getGlobal)("diag");if(e)return c.unshift(b),e[a](...c)}b.DiagComponentLogger=e},972:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.DiagConsoleLogger=void 0;let c=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];class d{constructor(){for(let a=0;a<c.length;a++)this[c[a].n]=function(a){return function(...b){if(console){let c=console[a];if("function"!=typeof c&&(c=console.log),"function"==typeof c)return c.apply(console,b)}}}(c[a].c)}}b.DiagConsoleLogger=d},912:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.createLogLevelDiagLogger=void 0;let d=c(957);b.createLogLevelDiagLogger=function(a,b){function c(c,d){let e=b[c];return"function"==typeof e&&a>=d?e.bind(b):function(){}}return a<d.DiagLogLevel.NONE?a=d.DiagLogLevel.NONE:a>d.DiagLogLevel.ALL&&(a=d.DiagLogLevel.ALL),b=b||{},{error:c("error",d.DiagLogLevel.ERROR),warn:c("warn",d.DiagLogLevel.WARN),info:c("info",d.DiagLogLevel.INFO),debug:c("debug",d.DiagLogLevel.DEBUG),verbose:c("verbose",d.DiagLogLevel.VERBOSE)}}},957:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.DiagLogLevel=void 0,function(a){a[a.NONE=0]="NONE",a[a.ERROR=30]="ERROR",a[a.WARN=50]="WARN",a[a.INFO=60]="INFO",a[a.DEBUG=70]="DEBUG",a[a.VERBOSE=80]="VERBOSE",a[a.ALL=9999]="ALL"}(b.DiagLogLevel||(b.DiagLogLevel={}))},172:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.unregisterGlobal=b.getGlobal=b.registerGlobal=void 0;let d=c(200),e=c(521),f=c(130),g=e.VERSION.split(".")[0],h=Symbol.for(`opentelemetry.js.api.${g}`),i=d._globalThis;b.registerGlobal=function(a,b,c,d=!1){var f;let g=i[h]=null!=(f=i[h])?f:{version:e.VERSION};if(!d&&g[a]){let b=Error(`@opentelemetry/api: Attempted duplicate registration of API: ${a}`);return c.error(b.stack||b.message),!1}if(g.version!==e.VERSION){let b=Error(`@opentelemetry/api: Registration of version v${g.version} for ${a} does not match previously registered API v${e.VERSION}`);return c.error(b.stack||b.message),!1}return g[a]=b,c.debug(`@opentelemetry/api: Registered a global for ${a} v${e.VERSION}.`),!0},b.getGlobal=function(a){var b,c;let d=null==(b=i[h])?void 0:b.version;if(d&&(0,f.isCompatible)(d))return null==(c=i[h])?void 0:c[a]},b.unregisterGlobal=function(a,b){b.debug(`@opentelemetry/api: Unregistering a global for ${a} v${e.VERSION}.`);let c=i[h];c&&delete c[a]}},130:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.isCompatible=b._makeCompatibilityCheck=void 0;let d=c(521),e=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function f(a){let b=new Set([a]),c=new Set,d=a.match(e);if(!d)return()=>!1;let f={major:+d[1],minor:+d[2],patch:+d[3],prerelease:d[4]};if(null!=f.prerelease)return function(b){return b===a};function g(a){return c.add(a),!1}return function(a){if(b.has(a))return!0;if(c.has(a))return!1;let d=a.match(e);if(!d)return g(a);let h={major:+d[1],minor:+d[2],patch:+d[3],prerelease:d[4]};if(null!=h.prerelease||f.major!==h.major)return g(a);if(0===f.major)return f.minor===h.minor&&f.patch<=h.patch?(b.add(a),!0):g(a);return f.minor<=h.minor?(b.add(a),!0):g(a)}}b._makeCompatibilityCheck=f,b.isCompatible=f(d.VERSION)},886:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.metrics=void 0,b.metrics=c(653).MetricsAPI.getInstance()},901:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ValueType=void 0,function(a){a[a.INT=0]="INT",a[a.DOUBLE=1]="DOUBLE"}(b.ValueType||(b.ValueType={}))},102:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.createNoopMeter=b.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=b.NOOP_OBSERVABLE_GAUGE_METRIC=b.NOOP_OBSERVABLE_COUNTER_METRIC=b.NOOP_UP_DOWN_COUNTER_METRIC=b.NOOP_HISTOGRAM_METRIC=b.NOOP_COUNTER_METRIC=b.NOOP_METER=b.NoopObservableUpDownCounterMetric=b.NoopObservableGaugeMetric=b.NoopObservableCounterMetric=b.NoopObservableMetric=b.NoopHistogramMetric=b.NoopUpDownCounterMetric=b.NoopCounterMetric=b.NoopMetric=b.NoopMeter=void 0;class c{constructor(){}createHistogram(a,c){return b.NOOP_HISTOGRAM_METRIC}createCounter(a,c){return b.NOOP_COUNTER_METRIC}createUpDownCounter(a,c){return b.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(a,c){return b.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(a,c){return b.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(a,c){return b.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(a,b){}removeBatchObservableCallback(a){}}b.NoopMeter=c;class d{}b.NoopMetric=d;class e extends d{add(a,b){}}b.NoopCounterMetric=e;class f extends d{add(a,b){}}b.NoopUpDownCounterMetric=f;class g extends d{record(a,b){}}b.NoopHistogramMetric=g;class h{addCallback(a){}removeCallback(a){}}b.NoopObservableMetric=h;class i extends h{}b.NoopObservableCounterMetric=i;class j extends h{}b.NoopObservableGaugeMetric=j;class k extends h{}b.NoopObservableUpDownCounterMetric=k,b.NOOP_METER=new c,b.NOOP_COUNTER_METRIC=new e,b.NOOP_HISTOGRAM_METRIC=new g,b.NOOP_UP_DOWN_COUNTER_METRIC=new f,b.NOOP_OBSERVABLE_COUNTER_METRIC=new i,b.NOOP_OBSERVABLE_GAUGE_METRIC=new j,b.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new k,b.createNoopMeter=function(){return b.NOOP_METER}},660:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NOOP_METER_PROVIDER=b.NoopMeterProvider=void 0;let d=c(102);class e{getMeter(a,b,c){return d.NOOP_METER}}b.NoopMeterProvider=e,b.NOOP_METER_PROVIDER=new e},200:function(a,b,c){var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c),Object.defineProperty(a,d,{enumerable:!0,get:function(){return b[c]}})}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),e(c(46),b)},651:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b._globalThis=void 0,b._globalThis="object"==typeof globalThis?globalThis:global},46:function(a,b,c){var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c),Object.defineProperty(a,d,{enumerable:!0,get:function(){return b[c]}})}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),e(c(651),b)},939:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.propagation=void 0,b.propagation=c(181).PropagationAPI.getInstance()},874:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NoopTextMapPropagator=void 0;class c{inject(a,b){}extract(a,b){return a}fields(){return[]}}b.NoopTextMapPropagator=c},194:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.defaultTextMapSetter=b.defaultTextMapGetter=void 0,b.defaultTextMapGetter={get(a,b){if(null!=a)return a[b]},keys:a=>null==a?[]:Object.keys(a)},b.defaultTextMapSetter={set(a,b,c){null!=a&&(a[b]=c)}}},845:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.trace=void 0,b.trace=c(997).TraceAPI.getInstance()},403:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NonRecordingSpan=void 0;let d=c(476);class e{constructor(a=d.INVALID_SPAN_CONTEXT){this._spanContext=a}spanContext(){return this._spanContext}setAttribute(a,b){return this}setAttributes(a){return this}addEvent(a,b){return this}setStatus(a){return this}updateName(a){return this}end(a){}isRecording(){return!1}recordException(a,b){}}b.NonRecordingSpan=e},614:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NoopTracer=void 0;let d=c(491),e=c(607),f=c(403),g=c(139),h=d.ContextAPI.getInstance();class i{startSpan(a,b,c=h.active()){var d;if(null==b?void 0:b.root)return new f.NonRecordingSpan;let i=c&&(0,e.getSpanContext)(c);return"object"==typeof(d=i)&&"string"==typeof d.spanId&&"string"==typeof d.traceId&&"number"==typeof d.traceFlags&&(0,g.isSpanContextValid)(i)?new f.NonRecordingSpan(i):new f.NonRecordingSpan}startActiveSpan(a,b,c,d){let f,g,i;if(arguments.length<2)return;2==arguments.length?i=b:3==arguments.length?(f=b,i=c):(f=b,g=c,i=d);let j=null!=g?g:h.active(),k=this.startSpan(a,f,j),l=(0,e.setSpan)(j,k);return h.with(l,i,void 0,k)}}b.NoopTracer=i},124:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.NoopTracerProvider=void 0;let d=c(614);class e{getTracer(a,b,c){return new d.NoopTracer}}b.NoopTracerProvider=e},125:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ProxyTracer=void 0;let d=new(c(614)).NoopTracer;class e{constructor(a,b,c,d){this._provider=a,this.name=b,this.version=c,this.options=d}startSpan(a,b,c){return this._getTracer().startSpan(a,b,c)}startActiveSpan(a,b,c,d){let e=this._getTracer();return Reflect.apply(e.startActiveSpan,e,arguments)}_getTracer(){if(this._delegate)return this._delegate;let a=this._provider.getDelegateTracer(this.name,this.version,this.options);return a?(this._delegate=a,this._delegate):d}}b.ProxyTracer=e},846:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.ProxyTracerProvider=void 0;let d=c(125),e=new(c(124)).NoopTracerProvider;class f{getTracer(a,b,c){var e;return null!=(e=this.getDelegateTracer(a,b,c))?e:new d.ProxyTracer(this,a,b,c)}getDelegate(){var a;return null!=(a=this._delegate)?a:e}setDelegate(a){this._delegate=a}getDelegateTracer(a,b,c){var d;return null==(d=this._delegate)?void 0:d.getTracer(a,b,c)}}b.ProxyTracerProvider=f},996:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SamplingDecision=void 0,function(a){a[a.NOT_RECORD=0]="NOT_RECORD",a[a.RECORD=1]="RECORD",a[a.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(b.SamplingDecision||(b.SamplingDecision={}))},607:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.getSpanContext=b.setSpanContext=b.deleteSpan=b.setSpan=b.getActiveSpan=b.getSpan=void 0;let d=c(780),e=c(403),f=c(491),g=(0,d.createContextKey)("OpenTelemetry Context Key SPAN");function h(a){return a.getValue(g)||void 0}function i(a,b){return a.setValue(g,b)}b.getSpan=h,b.getActiveSpan=function(){return h(f.ContextAPI.getInstance().active())},b.setSpan=i,b.deleteSpan=function(a){return a.deleteValue(g)},b.setSpanContext=function(a,b){return i(a,new e.NonRecordingSpan(b))},b.getSpanContext=function(a){var b;return null==(b=h(a))?void 0:b.spanContext()}},325:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TraceStateImpl=void 0;let d=c(564);class e{constructor(a){this._internalState=new Map,a&&this._parse(a)}set(a,b){let c=this._clone();return c._internalState.has(a)&&c._internalState.delete(a),c._internalState.set(a,b),c}unset(a){let b=this._clone();return b._internalState.delete(a),b}get(a){return this._internalState.get(a)}serialize(){return this._keys().reduce((a,b)=>(a.push(b+"="+this.get(b)),a),[]).join(",")}_parse(a){!(a.length>512)&&(this._internalState=a.split(",").reverse().reduce((a,b)=>{let c=b.trim(),e=c.indexOf("=");if(-1!==e){let f=c.slice(0,e),g=c.slice(e+1,b.length);(0,d.validateKey)(f)&&(0,d.validateValue)(g)&&a.set(f,g)}return a},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let a=new e;return a._internalState=new Map(this._internalState),a}}b.TraceStateImpl=e},564:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.validateValue=b.validateKey=void 0;let c="[_0-9a-z-*/]",d=`[a-z]${c}{0,255}`,e=`[a-z0-9]${c}{0,240}@[a-z]${c}{0,13}`,f=RegExp(`^(?:${d}|${e})$`),g=/^[ -~]{0,255}[!-~]$/,h=/,|=/;b.validateKey=function(a){return f.test(a)},b.validateValue=function(a){return g.test(a)&&!h.test(a)}},98:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.createTraceState=void 0;let d=c(325);b.createTraceState=function(a){return new d.TraceStateImpl(a)}},476:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.INVALID_SPAN_CONTEXT=b.INVALID_TRACEID=b.INVALID_SPANID=void 0;let d=c(475);b.INVALID_SPANID="0000000000000000",b.INVALID_TRACEID="00000000000000000000000000000000",b.INVALID_SPAN_CONTEXT={traceId:b.INVALID_TRACEID,spanId:b.INVALID_SPANID,traceFlags:d.TraceFlags.NONE}},357:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SpanKind=void 0,function(a){a[a.INTERNAL=0]="INTERNAL",a[a.SERVER=1]="SERVER",a[a.CLIENT=2]="CLIENT",a[a.PRODUCER=3]="PRODUCER",a[a.CONSUMER=4]="CONSUMER"}(b.SpanKind||(b.SpanKind={}))},139:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.wrapSpanContext=b.isSpanContextValid=b.isValidSpanId=b.isValidTraceId=void 0;let d=c(476),e=c(403),f=/^([0-9a-f]{32})$/i,g=/^[0-9a-f]{16}$/i;function h(a){return f.test(a)&&a!==d.INVALID_TRACEID}function i(a){return g.test(a)&&a!==d.INVALID_SPANID}b.isValidTraceId=h,b.isValidSpanId=i,b.isSpanContextValid=function(a){return h(a.traceId)&&i(a.spanId)},b.wrapSpanContext=function(a){return new e.NonRecordingSpan(a)}},847:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.SpanStatusCode=void 0,function(a){a[a.UNSET=0]="UNSET",a[a.OK=1]="OK",a[a.ERROR=2]="ERROR"}(b.SpanStatusCode||(b.SpanStatusCode={}))},475:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.TraceFlags=void 0,function(a){a[a.NONE=0]="NONE",a[a.SAMPLED=1]="SAMPLED"}(b.TraceFlags||(b.TraceFlags={}))},521:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),b.VERSION=void 0,b.VERSION="1.6.0"}},c={};function d(a){var e=c[a];if(void 0!==e)return e.exports;var f=c[a]={exports:{}},g=!0;try{b[a].call(f.exports,f,f.exports,d),g=!1}finally{g&&delete c[a]}return f.exports}d.ab=__dirname+"/";var e={};(()=>{Object.defineProperty(e,"__esModule",{value:!0}),e.trace=e.propagation=e.metrics=e.diag=e.context=e.INVALID_SPAN_CONTEXT=e.INVALID_TRACEID=e.INVALID_SPANID=e.isValidSpanId=e.isValidTraceId=e.isSpanContextValid=e.createTraceState=e.TraceFlags=e.SpanStatusCode=e.SpanKind=e.SamplingDecision=e.ProxyTracerProvider=e.ProxyTracer=e.defaultTextMapSetter=e.defaultTextMapGetter=e.ValueType=e.createNoopMeter=e.DiagLogLevel=e.DiagConsoleLogger=e.ROOT_CONTEXT=e.createContextKey=e.baggageEntryMetadataFromString=void 0;var a=d(369);Object.defineProperty(e,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return a.baggageEntryMetadataFromString}});var b=d(780);Object.defineProperty(e,"createContextKey",{enumerable:!0,get:function(){return b.createContextKey}}),Object.defineProperty(e,"ROOT_CONTEXT",{enumerable:!0,get:function(){return b.ROOT_CONTEXT}});var c=d(972);Object.defineProperty(e,"DiagConsoleLogger",{enumerable:!0,get:function(){return c.DiagConsoleLogger}});var f=d(957);Object.defineProperty(e,"DiagLogLevel",{enumerable:!0,get:function(){return f.DiagLogLevel}});var g=d(102);Object.defineProperty(e,"createNoopMeter",{enumerable:!0,get:function(){return g.createNoopMeter}});var h=d(901);Object.defineProperty(e,"ValueType",{enumerable:!0,get:function(){return h.ValueType}});var i=d(194);Object.defineProperty(e,"defaultTextMapGetter",{enumerable:!0,get:function(){return i.defaultTextMapGetter}}),Object.defineProperty(e,"defaultTextMapSetter",{enumerable:!0,get:function(){return i.defaultTextMapSetter}});var j=d(125);Object.defineProperty(e,"ProxyTracer",{enumerable:!0,get:function(){return j.ProxyTracer}});var k=d(846);Object.defineProperty(e,"ProxyTracerProvider",{enumerable:!0,get:function(){return k.ProxyTracerProvider}});var l=d(996);Object.defineProperty(e,"SamplingDecision",{enumerable:!0,get:function(){return l.SamplingDecision}});var m=d(357);Object.defineProperty(e,"SpanKind",{enumerable:!0,get:function(){return m.SpanKind}});var o=d(847);Object.defineProperty(e,"SpanStatusCode",{enumerable:!0,get:function(){return o.SpanStatusCode}});var p=d(475);Object.defineProperty(e,"TraceFlags",{enumerable:!0,get:function(){return p.TraceFlags}});var q=d(98);Object.defineProperty(e,"createTraceState",{enumerable:!0,get:function(){return q.createTraceState}});var r=d(139);Object.defineProperty(e,"isSpanContextValid",{enumerable:!0,get:function(){return r.isSpanContextValid}}),Object.defineProperty(e,"isValidTraceId",{enumerable:!0,get:function(){return r.isValidTraceId}}),Object.defineProperty(e,"isValidSpanId",{enumerable:!0,get:function(){return r.isValidSpanId}});var s=d(476);Object.defineProperty(e,"INVALID_SPANID",{enumerable:!0,get:function(){return s.INVALID_SPANID}}),Object.defineProperty(e,"INVALID_TRACEID",{enumerable:!0,get:function(){return s.INVALID_TRACEID}}),Object.defineProperty(e,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return s.INVALID_SPAN_CONTEXT}});let t=d(67);Object.defineProperty(e,"context",{enumerable:!0,get:function(){return t.context}});let u=d(506);Object.defineProperty(e,"diag",{enumerable:!0,get:function(){return u.diag}});let v=d(886);Object.defineProperty(e,"metrics",{enumerable:!0,get:function(){return v.metrics}});let w=d(939);Object.defineProperty(e,"propagation",{enumerable:!0,get:function(){return w.propagation}});let x=d(845);Object.defineProperty(e,"trace",{enumerable:!0,get:function(){return x.trace}}),e.default={context:t.context,diag:u.diag,metrics:v.metrics,propagation:w.propagation,trace:x.trace}})(),a.exports=e})()},54670:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{METADATA_BOUNDARY_NAME:function(){return c},OUTLET_BOUNDARY_NAME:function(){return e},ROOT_LAYOUT_BOUNDARY_NAME:function(){return f},VIEWPORT_BOUNDARY_NAME:function(){return d}});let c="__next_metadata_boundary__",d="__next_viewport_boundary__",e="__next_outlet_boundary__",f="__next_root_layout_boundary__"},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},56571:(a,b,c)=>{"use strict";let{EventEmitter:d}=c(78474),{lsCacheSym:e,levelValSym:f,setLevelSym:g,getLevelSym:h,chindingsSym:i,parsedChindingsSym:j,mixinSym:k,asJsonSym:l,writeSym:m,mixinMergeStrategySym:o,timeSym:p,timeSliceIndexSym:q,streamSym:r,serializersSym:s,formattersSym:t,errorKeySym:u,messageKeySym:v,useOnlyCustomLevelsSym:w,needsMetadataGsym:x,redactFmtSym:y,stringifySym:z,formatOptsSym:A,stringifiersSym:B,msgPrefixSym:C,hooksSym:D}=c(22782),{getLevel:E,setLevel:F,isLevelEnabled:G,mappings:H,initialLsCache:I,genLsCache:J,assertNoLevelCollisions:K}=c(91578),{asChindings:L,asJson:M,buildFormatters:N,stringify:O,noop:P}=c(2832),{version:Q}=c(36012),R=c(76182),S={constructor:class{},child:function(a,b){if(!a)throw Error("missing bindings for child Pino");let c=this[s],d=this[t],e=Object.create(this);if(null==b)return e[t].bindings!==T&&(e[t]=N(d.level,T,d.log)),e[i]=L(e,a),e[g](this.level),this.onChild!==P&&this.onChild(e),e;if(!0===b.hasOwnProperty("serializers")){for(let a in e[s]=Object.create(null),c)e[s][a]=c[a];let a=Object.getOwnPropertySymbols(c);for(var f=0;f<a.length;f++){let b=a[f];e[s][b]=c[b]}for(let a in b.serializers)e[s][a]=b.serializers[a];let d=Object.getOwnPropertySymbols(b.serializers);for(var h=0;h<d.length;h++){let a=d[h];e[s][a]=b.serializers[a]}}else e[s]=c;if(b.hasOwnProperty("formatters")){let{level:a,bindings:c,log:f}=b.formatters;e[t]=N(a||d.level,c||T,f||d.log)}else e[t]=N(d.level,T,d.log);if(!0===b.hasOwnProperty("customLevels")&&(K(this.levels,b.customLevels),e.levels=H(b.customLevels,e[w]),J(e)),"object"==typeof b.redact&&null!==b.redact||Array.isArray(b.redact)){e.redact=b.redact;let a=R(e.redact,O),c={stringify:a[y]};e[z]=O,e[B]=a,e[A]=c}"string"==typeof b.msgPrefix&&(e[C]=(this[C]||"")+b.msgPrefix),e[i]=L(e,a);let j=b.level||this.level;return e[g](j),this.onChild(e),e},bindings:function(){let a=this[i],b=JSON.parse(`{${a.substr(1)}}`);return delete b.pid,delete b.hostname,b},setBindings:function(a){let b=L(this,a);this[i]=b,delete this[j]},flush:function(a){if(null!=a&&"function"!=typeof a)throw Error("callback must be a function");let b=this[r];"function"==typeof b.flush?b.flush(a||P):a&&a()},isLevelEnabled:G,version:Q,get level(){return this[h]()},set level(lvl){this[g](lvl)},get levelVal(){return this[f]},set levelVal(n){throw Error("levelVal is read-only")},get msgPrefix(){return this[C]},get[Symbol.toStringTag](){return"Pino"},[e]:I,[m]:function(a,b,c){let d,e=this[p](),f=this[k],g=this[u],h=this[v],i=this[o]||U,j=this[D].streamWrite;null==a?d={}:a instanceof Error?(d={[g]:a},void 0===b&&(b=a.message)):(d=a,void 0===b&&void 0===a[h]&&a[g]&&(b=a[g].message)),f&&(d=i(d,f(d,c,this)));let m=this[l](d,b,c,e),s=this[r];!0===s[x]&&(s.lastLevel=c,s.lastObj=d,s.lastMsg=b,s.lastTime=e.slice(this[q]),s.lastLogger=this),s.write(j?j(m):m)},[l]:M,[h]:E,[g]:F};Object.setPrototypeOf(S,d.prototype),a.exports=function(){return Object.create(S)};let T=a=>a;function U(a,b){return Object.assign(b,a)}},57075:a=>{"use strict";a.exports=require("node:stream")},57975:a=>{"use strict";a.exports=require("node:util")},58912:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.UserRefreshClient=b.USER_REFRESH_ACCOUNT_TYPE=void 0;let d=c(76748),e=c(62783);b.USER_REFRESH_ACCOUNT_TYPE="authorized_user";class f extends d.OAuth2Client{_refreshToken;constructor(a,b,c,d,e){let f=a&&"object"==typeof a?a:{clientId:a,clientSecret:b,refreshToken:c,eagerRefreshThresholdMillis:d,forceRefreshOnFailure:e};super(f),this._refreshToken=f.refreshToken,this.credentials.refresh_token=f.refreshToken}async refreshTokenNoCache(){return super.refreshTokenNoCache(this._refreshToken)}async fetchIdToken(a){let b={...f.RETRY_CONFIG,url:this.endpoints.oauth2TokenUrl,method:"POST",data:new URLSearchParams({client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token",refresh_token:this._refreshToken,target_audience:a})};return e.AuthClient.setMethodName(b,"fetchIdToken"),(await this.transporter.request(b)).data.id_token}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the user refresh token");if("authorized_user"!==a.type)throw Error('The incoming JSON object does not have the "authorized_user" type');if(!a.client_id)throw Error("The incoming JSON object does not contain a client_id field");if(!a.client_secret)throw Error("The incoming JSON object does not contain a client_secret field");if(!a.refresh_token)throw Error("The incoming JSON object does not contain a refresh_token field");this._clientId=a.client_id,this._clientSecret=a.client_secret,this._refreshToken=a.refresh_token,this.credentials.refresh_token=a.refresh_token,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}async fromStreamAsync(a){return new Promise((b,c)=>{if(!a)return c(Error("Must pass in a stream containing the user refresh token."));let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);return this.fromJSON(a),b()}catch(a){return c(a)}})})}static fromJSON(a){let b=new f;return b.fromJSON(a),b}}b.UserRefreshClient=f},59026:(a,b,c)=>{"use strict";var d=c(28354),e=c(28552),f={stream:!0},g=Object.prototype.hasOwnProperty,h=new Map;function i(a){var b=globalThis.__next_require__(a);return"function"!=typeof b.then||"fulfilled"===b.status?null:(b.then(function(a){b.status="fulfilled",b.value=a},function(a){b.status="rejected",b.reason=a}),b)}function j(){}function k(a){for(var b=a[1],d=[],e=0;e<b.length;){var f=b[e++];b[e++];var g=h.get(f);if(void 0===g){g=c.e(f),d.push(g);var k=h.set.bind(h,f,null);g.then(k,j),h.set(f,g)}else null!==g&&d.push(g)}return 4===a.length?0===d.length?i(a[0]):Promise.all(d).then(function(){return i(a[0])}):0<d.length?Promise.all(d):null}function l(a){var b=globalThis.__next_require__(a[0]);if(4===a.length&&"function"==typeof b.then)if("fulfilled"===b.status)b=b.value;else throw b.reason;return"*"===a[2]?b:""===a[2]?b.__esModule?b.default:b:g.call(b,a[2])?b[a[2]]:void 0}var m=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,o=Symbol.for("react.transitional.element"),p=Symbol.for("react.lazy"),q=Symbol.iterator,r=Symbol.asyncIterator,s=Array.isArray,t=Object.getPrototypeOf,u=Object.prototype,v=new WeakMap;function w(a,b,c,d,e){function f(a,c){c=new Blob([new Uint8Array(c.buffer,c.byteOffset,c.byteLength)]);var d=i++;return null===k&&(k=new FormData),k.append(b+d,c),"$"+a+d.toString(16)}function g(a,w){if(null===w)return null;if("object"==typeof w){switch(w.$$typeof){case o:if(void 0!==c&&-1===a.indexOf(":")){var x,y,z,A,B,C=l.get(this);if(void 0!==C)return c.set(C+":"+a,w),"$T"}throw Error("React Element cannot be passed to Server Functions from the Client without a temporary reference set. Pass a TemporaryReferenceSet to the options.");case p:C=w._payload;var D=w._init;null===k&&(k=new FormData),j++;try{var E=D(C),F=i++,G=h(E,F);return k.append(b+F,G),"$"+F.toString(16)}catch(a){if("object"==typeof a&&null!==a&&"function"==typeof a.then){j++;var H=i++;return C=function(){try{var a=h(w,H),c=k;c.append(b+H,a),j--,0===j&&d(c)}catch(a){e(a)}},a.then(C,C),"$"+H.toString(16)}return e(a),null}finally{j--}}if(C=l.get(w),"function"==typeof w.then){if(void 0!==C)if(m!==w)return C;else m=null;null===k&&(k=new FormData),j++;var I=i++;return a="$@"+I.toString(16),l.set(w,a),w.then(function(a){try{var c=l.get(a),f=void 0!==c?JSON.stringify(c):h(a,I);(a=k).append(b+I,f),j--,0===j&&d(a)}catch(a){e(a)}},e),a}if(void 0!==C)if(m!==w)return C;else m=null;else -1===a.indexOf(":")&&void 0!==(C=l.get(this))&&(a=C+":"+a,l.set(w,a),void 0!==c&&c.set(a,w));if(s(w))return w;if(w instanceof FormData){null===k&&(k=new FormData);var J=k,K=b+(a=i++)+"_";return w.forEach(function(a,b){J.append(K+b,a)}),"$K"+a.toString(16)}if(w instanceof Map)return a=i++,C=h(Array.from(w),a),null===k&&(k=new FormData),k.append(b+a,C),"$Q"+a.toString(16);if(w instanceof Set)return a=i++,C=h(Array.from(w),a),null===k&&(k=new FormData),k.append(b+a,C),"$W"+a.toString(16);if(w instanceof ArrayBuffer)return a=new Blob([w]),C=i++,null===k&&(k=new FormData),k.append(b+C,a),"$A"+C.toString(16);if(w instanceof Int8Array)return f("O",w);if(w instanceof Uint8Array)return f("o",w);if(w instanceof Uint8ClampedArray)return f("U",w);if(w instanceof Int16Array)return f("S",w);if(w instanceof Uint16Array)return f("s",w);if(w instanceof Int32Array)return f("L",w);if(w instanceof Uint32Array)return f("l",w);if(w instanceof Float32Array)return f("G",w);if(w instanceof Float64Array)return f("g",w);if(w instanceof BigInt64Array)return f("M",w);if(w instanceof BigUint64Array)return f("m",w);if(w instanceof DataView)return f("V",w);if("function"==typeof Blob&&w instanceof Blob)return null===k&&(k=new FormData),a=i++,k.append(b+a,w),"$B"+a.toString(16);if(a=null===(x=w)||"object"!=typeof x?null:"function"==typeof(x=q&&x[q]||x["@@iterator"])?x:null)return(C=a.call(w))===w?(a=i++,C=h(Array.from(C),a),null===k&&(k=new FormData),k.append(b+a,C),"$i"+a.toString(16)):Array.from(C);if("function"==typeof ReadableStream&&w instanceof ReadableStream)return function(a){try{var c,f,h,l,m,o,p,q=a.getReader({mode:"byob"})}catch(l){return c=a.getReader(),null===k&&(k=new FormData),f=k,j++,h=i++,c.read().then(function a(i){if(i.done)f.append(b+h,"C"),0==--j&&d(f);else try{var k=JSON.stringify(i.value,g);f.append(b+h,k),c.read().then(a,e)}catch(a){e(a)}},e),"$R"+h.toString(16)}return l=q,null===k&&(k=new FormData),m=k,j++,o=i++,p=[],l.read(new Uint8Array(1024)).then(function a(c){c.done?(c=i++,m.append(b+c,new Blob(p)),m.append(b+o,'"$o'+c.toString(16)+'"'),m.append(b+o,"C"),0==--j&&d(m)):(p.push(c.value),l.read(new Uint8Array(1024)).then(a,e))},e),"$r"+o.toString(16)}(w);if("function"==typeof(a=w[r]))return y=w,z=a.call(w),null===k&&(k=new FormData),A=k,j++,B=i++,y=y===z,z.next().then(function a(c){if(c.done){if(void 0===c.value)A.append(b+B,"C");else try{var f=JSON.stringify(c.value,g);A.append(b+B,"C"+f)}catch(a){e(a);return}0==--j&&d(A)}else try{var h=JSON.stringify(c.value,g);A.append(b+B,h),z.next().then(a,e)}catch(a){e(a)}},e),"$"+(y?"x":"X")+B.toString(16);if((a=t(w))!==u&&(null===a||null!==t(a))){if(void 0===c)throw Error("Only plain objects, and a few built-ins, can be passed to Server Functions. Classes or null prototypes are not supported.");return"$T"}return w}if("string"==typeof w)return"Z"===w[w.length-1]&&this[a]instanceof Date?"$D"+w:a="$"===w[0]?"$"+w:w;if("boolean"==typeof w)return w;if("number"==typeof w)return Number.isFinite(w)?0===w&&-1/0==1/w?"$-0":w:1/0===w?"$Infinity":-1/0===w?"$-Infinity":"$NaN";if(void 0===w)return"$undefined";if("function"==typeof w){if(void 0!==(C=v.get(w)))return a=JSON.stringify({id:C.id,bound:C.bound},g),null===k&&(k=new FormData),C=i++,k.set(b+C,a),"$h"+C.toString(16);if(void 0!==c&&-1===a.indexOf(":")&&void 0!==(C=l.get(this)))return c.set(C+":"+a,w),"$T";throw Error("Client Functions cannot be passed directly to Server Functions. Only Functions passed from the Server can be passed back again.")}if("symbol"==typeof w){if(void 0!==c&&-1===a.indexOf(":")&&void 0!==(C=l.get(this)))return c.set(C+":"+a,w),"$T";throw Error("Symbols cannot be passed to a Server Function without a temporary reference set. Pass a TemporaryReferenceSet to the options.")}if("bigint"==typeof w)return"$n"+w.toString(10);throw Error("Type "+typeof w+" is not supported as an argument to a Server Function.")}function h(a,b){return"object"==typeof a&&null!==a&&(b="$"+b.toString(16),l.set(a,b),void 0!==c&&c.set(b,a)),m=a,JSON.stringify(a,g)}var i=1,j=0,k=null,l=new WeakMap,m=a,w=h(a,0);return null===k?d(w):(k.set(b+"0",w),0===j&&d(k)),function(){0<j&&(j=0,null===k?d(w):d(k))}}var x=new WeakMap;function y(a){var b=v.get(this);if(!b)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var c=null;if(null!==b.bound){if((c=x.get(b))||(d={id:b.id,bound:b.bound},g=new Promise(function(a,b){e=a,f=b}),w(d,"",void 0,function(a){if("string"==typeof a){var b=new FormData;b.append("0",a),a=b}g.status="fulfilled",g.value=a,e(a)},function(a){g.status="rejected",g.reason=a,f(a)}),c=g,x.set(b,c)),"rejected"===c.status)throw c.reason;if("fulfilled"!==c.status)throw c;b=c.value;var d,e,f,g,h=new FormData;b.forEach(function(b,c){h.append("$ACTION_"+a+":"+c,b)}),c=h,b="$ACTION_REF_"+a}else b="$ACTION_ID_"+b.id;return{name:b,method:"POST",encType:"multipart/form-data",data:c}}function z(a,b){var c=v.get(this);if(!c)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");if(c.id!==a)return!1;var d=c.bound;if(null===d)return 0===b;switch(d.status){case"fulfilled":return d.value.length===b;case"pending":throw d;case"rejected":throw d.reason;default:throw"string"!=typeof d.status&&(d.status="pending",d.then(function(a){d.status="fulfilled",d.value=a},function(a){d.status="rejected",d.reason=a})),d}}function A(a,b,c,d){v.has(a)||(v.set(a,{id:b,originalBind:a.bind,bound:c}),Object.defineProperties(a,{$$FORM_ACTION:{value:void 0===d?y:function(){var a=v.get(this);if(!a)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var b=a.bound;return null===b&&(b=Promise.resolve([])),d(a.id,b)}},$$IS_SIGNATURE_EQUAL:{value:z},bind:{value:D}}))}var B=Function.prototype.bind,C=Array.prototype.slice;function D(){var a=v.get(this);if(!a)return B.apply(this,arguments);var b=a.originalBind.apply(this,arguments),c=C.call(arguments,1),d=null;return d=null!==a.bound?Promise.resolve(a.bound).then(function(a){return a.concat(c)}):Promise.resolve(c),v.set(b,{id:a.id,originalBind:b.bind,bound:d}),Object.defineProperties(b,{$$FORM_ACTION:{value:this.$$FORM_ACTION},$$IS_SIGNATURE_EQUAL:{value:z},bind:{value:D}}),b}function E(a,b,c){this.status=a,this.value=b,this.reason=c}function F(a){switch(a.status){case"resolved_model":Q(a);break;case"resolved_module":R(a)}switch(a.status){case"fulfilled":return a.value;case"pending":case"blocked":case"halted":throw a;default:throw a.reason}}function G(a,b){for(var c=0;c<a.length;c++){var d=a[c];"function"==typeof d?d(b):V(d,b)}}function H(a,b){for(var c=0;c<a.length;c++){var d=a[c];"function"==typeof d?d(b):W(d,b)}}function I(a,b){var c=b.handler.chunk;if(null===c)return null;if(c===a)return b.handler;if(null!==(b=c.value))for(c=0;c<b.length;c++){var d=b[c];if("function"!=typeof d&&null!==(d=I(a,d)))return d}return null}function J(a,b,c){switch(a.status){case"fulfilled":G(b,a.value);break;case"blocked":for(var d=0;d<b.length;d++){var e=b[d];if("function"!=typeof e){var f=I(a,e);if(null!==f)switch(V(e,f.value),b.splice(d,1),d--,null!==c&&-1!==(e=c.indexOf(e))&&c.splice(e,1),a.status){case"fulfilled":G(b,a.value);return;case"rejected":null!==c&&H(c,a.reason);return}}}case"pending":if(a.value)for(d=0;d<b.length;d++)a.value.push(b[d]);else a.value=b;if(a.reason){if(c)for(b=0;b<c.length;b++)a.reason.push(c[b])}else a.reason=c;break;case"rejected":c&&H(c,a.reason)}}function K(a,b,c){"pending"!==b.status&&"blocked"!==b.status?b.reason.error(c):(a=b.reason,b.status="rejected",b.reason=c,null!==a&&H(a,c))}function L(a,b,c){return new E("resolved_model",(c?'{"done":true,"value":':'{"done":false,"value":')+b+"}",a)}function M(a,b,c,d){N(a,b,(d?'{"done":true,"value":':'{"done":false,"value":')+c+"}")}function N(a,b,c){if("pending"!==b.status)b.reason.enqueueModel(c);else{var d=b.value,e=b.reason;b.status="resolved_model",b.value=c,b.reason=a,null!==d&&(Q(b),J(b,d,e))}}function O(a,b,c){if("pending"===b.status||"blocked"===b.status){a=b.value;var d=b.reason;b.status="resolved_module",b.value=c,b.reason=null,null!==a&&(R(b),J(b,a,d))}}E.prototype=Object.create(Promise.prototype),E.prototype.then=function(a,b){switch(this.status){case"resolved_model":Q(this);break;case"resolved_module":R(this)}switch(this.status){case"fulfilled":"function"==typeof a&&a(this.value);break;case"pending":case"blocked":"function"==typeof a&&(null===this.value&&(this.value=[]),this.value.push(a)),"function"==typeof b&&(null===this.reason&&(this.reason=[]),this.reason.push(b));break;case"halted":break;default:"function"==typeof b&&b(this.reason)}};var P=null;function Q(a){var b=P;P=null;var c=a.value,d=a.reason;a.status="blocked",a.value=null,a.reason=null;try{var e=JSON.parse(c,d._fromJSON),f=a.value;if(null!==f&&(a.value=null,a.reason=null,G(f,e)),null!==P){if(P.errored)throw P.reason;if(0<P.deps){P.value=e,P.reason=null,P.chunk=a;return}}a.status="fulfilled",a.value=e,a.reason=null}catch(b){a.status="rejected",a.reason=b}finally{P=b}}function R(a){try{var b=l(a.value);a.status="fulfilled",a.value=b,a.reason=null}catch(b){a.status="rejected",a.reason=b}}function S(a,b){a._closed=!0,a._closedReason=b,a._chunks.forEach(function(c){"pending"===c.status?K(a,c,b):"fulfilled"===c.status&&null!==c.reason&&c.reason.error(b)})}function T(a){return{$$typeof:p,_payload:a,_init:F}}function U(a,b){var c=a._chunks,d=c.get(b);return d||(d=a._closed?new E("rejected",null,a._closedReason):new E("pending",null,null),c.set(b,d)),d}function V(a,b){var c=a.response,d=a.handler,e=a.parentObject,f=a.key,g=a.map,h=a.path;try{for(var i=1;i<h.length;i++){for(;b.$$typeof===p;){var j=b._payload;if(j===d.chunk)b=d.value;else{switch(j.status){case"resolved_model":Q(j);break;case"resolved_module":R(j)}switch(j.status){case"fulfilled":b=j.value;continue;case"blocked":var k=I(j,a);if(null!==k){b=k.value;continue}case"pending":h.splice(0,i-1),null===j.value?j.value=[a]:j.value.push(a),null===j.reason?j.reason=[a]:j.reason.push(a);return;case"halted":return;default:W(a,j.reason);return}}}b=b[h[i]]}var l=g(c,b,e,f);if(e[f]=l,""===f&&null===d.value&&(d.value=l),e[0]===o&&"object"==typeof d.value&&null!==d.value&&d.value.$$typeof===o){var m=d.value;"3"===f&&(m.props=l)}}catch(b){W(a,b);return}d.deps--,0===d.deps&&null!==(a=d.chunk)&&"blocked"===a.status&&(b=a.value,a.status="fulfilled",a.value=d.value,a.reason=d.reason,null!==b&&G(b,d.value))}function W(a,b){var c=a.handler;a=a.response,c.errored||(c.errored=!0,c.value=null,c.reason=b,null!==(c=c.chunk)&&"blocked"===c.status&&K(a,c,b))}function X(a,b,c,d,e,f){if(P){var g=P;g.deps++}else g=P={parent:null,chunk:null,value:null,reason:null,deps:1,errored:!1};return b={response:d,handler:g,parentObject:b,key:c,map:e,path:f},null===a.value?a.value=[b]:a.value.push(b),null===a.reason?a.reason=[b]:a.reason.push(b),null}function Y(a,b,c,d){if(!a._serverReferenceConfig)return function(a,b,c){function d(){var a=Array.prototype.slice.call(arguments);return f?"fulfilled"===f.status?b(e,f.value.concat(a)):Promise.resolve(f).then(function(c){return b(e,c.concat(a))}):b(e,a)}var e=a.id,f=a.bound;return A(d,e,f,c),d}(b,a._callServer,a._encodeFormAction);var e=function(a,b){var c="",d=a[b];if(d)c=d.name;else{var e=b.lastIndexOf("#");if(-1!==e&&(c=b.slice(e+1),d=a[b.slice(0,e)]),!d)throw Error('Could not find the module "'+b+'" in the React Server Manifest. This is probably a bug in the React Server Components bundler.')}return d.async?[d.id,d.chunks,c,1]:[d.id,d.chunks,c]}(a._serverReferenceConfig,b.id),f=k(e);if(f)b.bound&&(f=Promise.all([f,b.bound]));else{if(!b.bound)return A(f=l(e),b.id,b.bound,a._encodeFormAction),f;f=Promise.resolve(b.bound)}if(P){var g=P;g.deps++}else g=P={parent:null,chunk:null,value:null,reason:null,deps:1,errored:!1};return f.then(function(){var f=l(e);if(b.bound){var h=b.bound.value.slice(0);h.unshift(null),f=f.bind.apply(f,h)}A(f,b.id,b.bound,a._encodeFormAction),c[d]=f,""===d&&null===g.value&&(g.value=f),c[0]===o&&"object"==typeof g.value&&null!==g.value&&g.value.$$typeof===o&&(h=g.value,"3"===d)&&(h.props=f),g.deps--,0===g.deps&&null!==(f=g.chunk)&&"blocked"===f.status&&(h=f.value,f.status="fulfilled",f.value=g.value,f.reason=null,null!==h&&G(h,g.value))},function(b){if(!g.errored){g.errored=!0,g.value=null,g.reason=b;var c=g.chunk;null!==c&&"blocked"===c.status&&K(a,c,b)}}),null}function Z(a,b,c,d,e){var f=parseInt((b=b.split(":"))[0],16);switch((f=U(a,f)).status){case"resolved_model":Q(f);break;case"resolved_module":R(f)}switch(f.status){case"fulfilled":var g=f.value;for(f=1;f<b.length;f++){for(;g.$$typeof===p;){switch((g=g._payload).status){case"resolved_model":Q(g);break;case"resolved_module":R(g)}switch(g.status){case"fulfilled":g=g.value;break;case"blocked":case"pending":return X(g,c,d,a,e,b.slice(f-1));case"halted":return P?(a=P,a.deps++):P={parent:null,chunk:null,value:null,reason:null,deps:1,errored:!1},null;default:return P?(P.errored=!0,P.value=null,P.reason=g.reason):P={parent:null,chunk:null,value:null,reason:g.reason,deps:0,errored:!0},null}}g=g[b[f]]}return e(a,g,c,d);case"pending":case"blocked":return X(f,c,d,a,e,b);case"halted":return P?(a=P,a.deps++):P={parent:null,chunk:null,value:null,reason:null,deps:1,errored:!1},null;default:return P?(P.errored=!0,P.value=null,P.reason=f.reason):P={parent:null,chunk:null,value:null,reason:f.reason,deps:0,errored:!0},null}}function $(a,b){return new Map(b)}function _(a,b){return new Set(b)}function aa(a,b){return new Blob(b.slice(1),{type:b[0]})}function ab(a,b){a=new FormData;for(var c=0;c<b.length;c++)a.append(b[c][0],b[c][1]);return a}function ac(a,b){return b[Symbol.iterator]()}function ad(a,b){return b}function ae(){throw Error('Trying to call a function from "use server" but the callServer option was not implemented in your router runtime.')}function af(a,b,c,e,f,g,h){var i,j=new Map;this._bundlerConfig=a,this._serverReferenceConfig=b,this._moduleLoading=c,this._callServer=void 0!==e?e:ae,this._encodeFormAction=f,this._nonce=g,this._chunks=j,this._stringDecoder=new d.TextDecoder,this._fromJSON=null,this._closed=!1,this._closedReason=null,this._tempRefs=h,this._fromJSON=(i=this,function(a,b){if("string"==typeof b){var c=i,d=this,e=a,f=b;if("$"===f[0]){if("$"===f)return null!==P&&"0"===e&&(P={parent:P,chunk:null,value:null,reason:null,deps:0,errored:!1}),o;switch(f[1]){case"$":return f.slice(1);case"L":return T(c=U(c,d=parseInt(f.slice(2),16)));case"@":return U(c,d=parseInt(f.slice(2),16));case"S":return Symbol.for(f.slice(2));case"h":return Z(c,f=f.slice(2),d,e,Y);case"T":if(d="$"+f.slice(2),null==(c=c._tempRefs))throw Error("Missing a temporary reference set but the RSC response returned a temporary reference. Pass a temporaryReference option with the set that was used with the reply.");return c.get(d);case"Q":return Z(c,f=f.slice(2),d,e,$);case"W":return Z(c,f=f.slice(2),d,e,_);case"B":return Z(c,f=f.slice(2),d,e,aa);case"K":return Z(c,f=f.slice(2),d,e,ab);case"Z":return am();case"i":return Z(c,f=f.slice(2),d,e,ac);case"I":return 1/0;case"-":return"$-0"===f?-0:-1/0;case"N":return NaN;case"u":return;case"D":return new Date(Date.parse(f.slice(2)));case"n":return BigInt(f.slice(2));default:return Z(c,f=f.slice(1),d,e,ad)}}return f}if("object"==typeof b&&null!==b){if(b[0]===o){if(a={$$typeof:o,type:b[1],key:b[2],ref:null,props:b[3]},null!==P){if(P=(b=P).parent,b.errored)a=T(a=new E("rejected",null,b.reason));else if(0<b.deps){var g=new E("blocked",null,null);b.value=a,b.chunk=g,a=T(g)}}}else a=b;return a}return b})}function ag(){return{_rowState:0,_rowID:0,_rowTag:0,_rowLength:0,_buffer:[]}}function ah(a,b,c){var d=(a=a._chunks).get(b);d&&"pending"!==d.status?d.reason.enqueueValue(c):a.set(b,new E("fulfilled",c,null))}function ai(a,b,c,d){var e=a._chunks;(a=e.get(b))?"pending"===a.status&&(b=a.value,a.status="fulfilled",a.value=c,a.reason=d,null!==b&&G(b,a.value)):e.set(b,new E("fulfilled",c,d))}function aj(a,b,c){var d=null,e=!1;c=new ReadableStream({type:c,start:function(a){d=a}});var f=null;ai(a,b,c,{enqueueValue:function(a){null===f?d.enqueue(a):f.then(function(){d.enqueue(a)})},enqueueModel:function(b){if(null===f){var c=new E("resolved_model",b,a);Q(c),"fulfilled"===c.status?d.enqueue(c.value):(c.then(function(a){return d.enqueue(a)},function(a){return d.error(a)}),f=c)}else{c=f;var e=new E("pending",null,null);e.then(function(a){return d.enqueue(a)},function(a){return d.error(a)}),f=e,c.then(function(){f===e&&(f=null),N(a,e,b)})}},close:function(){if(!e)if(e=!0,null===f)d.close();else{var a=f;f=null,a.then(function(){return d.close()})}},error:function(a){if(!e)if(e=!0,null===f)d.error(a);else{var b=f;f=null,b.then(function(){return d.error(a)})}}})}function ak(){return this}function al(a,b,c){var d=[],e=!1,f=0,g={};g[r]=function(){var a,b=0;return(a={next:a=function(a){if(void 0!==a)throw Error("Values cannot be passed to next() of AsyncIterables passed to Client Components.");if(b===d.length){if(e)return new E("fulfilled",{done:!0,value:void 0},null);d[b]=new E("pending",null,null)}return d[b++]}})[r]=ak,a},ai(a,b,c?g[r]():g,{enqueueValue:function(a){if(f===d.length)d[f]=new E("fulfilled",{done:!1,value:a},null);else{var b=d[f],c=b.value,e=b.reason;b.status="fulfilled",b.value={done:!1,value:a},b.reason=null,null!==c&&J(b,c,e)}f++},enqueueModel:function(b){f===d.length?d[f]=L(a,b,!1):M(a,d[f],b,!1),f++},close:function(b){if(!e)for(e=!0,f===d.length?d[f]=L(a,b,!0):M(a,d[f],b,!0),f++;f<d.length;)M(a,d[f++],'"$undefined"',!0)},error:function(b){if(!e)for(e=!0,f===d.length&&(d[f]=new E("pending",null,null));f<d.length;)K(a,d[f++],b)}})}function am(){var a=Error("An error occurred in the Server Components render. The specific message is omitted in production builds to avoid leaking sensitive details. A digest property is included on this error instance which may provide additional details about the nature of the error.");return a.stack="Error: "+a.message,a}function an(a,b){for(var c=a.length,d=b.length,e=0;e<c;e++)d+=a[e].byteLength;d=new Uint8Array(d);for(var f=e=0;f<c;f++){var g=a[f];d.set(g,e),e+=g.byteLength}return d.set(b,e),d}function ao(a,b,c,d,e,f){ah(a,b,e=new e((c=0===c.length&&0==d.byteOffset%f?d:an(c,d)).buffer,c.byteOffset,c.byteLength/f))}function ap(a,b,c,d){switch(c){case 73:var e=a,f=b,g=d,h=e._chunks,i=h.get(f);g=JSON.parse(g,e._fromJSON);var j=function(a,b){if(a){var c=a[b[0]];if(a=c&&c[b[2]])c=a.name;else{if(!(a=c&&c["*"]))throw Error('Could not find the module "'+b[0]+'" in the React Server Consumer Manifest. This is probably a bug in the React Server Components bundler.');c=b[2]}return 4===b.length?[a.id,a.chunks,c,1]:[a.id,a.chunks,c]}return b}(e._bundlerConfig,g);if(!function(a,b,c){if(null!==a)for(var d=1;d<b.length;d+=2){var e=m.d,f=e.X,g=a.prefix+b[d],h=a.crossOrigin;h="string"==typeof h?"use-credentials"===h?h:"":void 0,f.call(e,g,{crossOrigin:h,nonce:c})}}(e._moduleLoading,g[1],e._nonce),g=k(j)){if(i){var l=i;l.status="blocked"}else l=new E("blocked",null,null),h.set(f,l);g.then(function(){return O(e,l,j)},function(a){return K(e,l,a)})}else i?O(e,i,j):h.set(f,new E("resolved_module",j,null));break;case 72:switch(b=d[0],a=JSON.parse(d=d.slice(1),a._fromJSON),d=m.d,b){case"D":d.D(a);break;case"C":"string"==typeof a?d.C(a):d.C(a[0],a[1]);break;case"L":b=a[0],c=a[1],3===a.length?d.L(b,c,a[2]):d.L(b,c);break;case"m":"string"==typeof a?d.m(a):d.m(a[0],a[1]);break;case"X":"string"==typeof a?d.X(a):d.X(a[0],a[1]);break;case"S":"string"==typeof a?d.S(a):d.S(a[0],0===a[1]?void 0:a[1],3===a.length?a[2]:void 0);break;case"M":"string"==typeof a?d.M(a):d.M(a[0],a[1])}break;case 69:var o=(c=a._chunks).get(b);d=JSON.parse(d);var p=am();p.digest=d.digest,o?K(a,o,p):c.set(b,new E("rejected",null,p));break;case 84:(c=(a=a._chunks).get(b))&&"pending"!==c.status?c.reason.enqueueValue(d):a.set(b,new E("fulfilled",d,null));break;case 78:case 68:case 74:case 87:throw Error("Failed to read a RSC payload created by a development version of React on the server while using a production version on the client. Always use matching versions on the server and the client.");case 82:aj(a,b,void 0);break;case 114:aj(a,b,"bytes");break;case 88:al(a,b,!1);break;case 120:al(a,b,!0);break;case 67:(a=a._chunks.get(b))&&"fulfilled"===a.status&&a.reason.close(""===d?'"$undefined"':d);break;default:(o=(c=a._chunks).get(b))?N(a,o,d):c.set(b,new E("resolved_model",d,a))}}function aq(a,b,c){for(var d=0,e=b._rowState,g=b._rowID,h=b._rowTag,i=b._rowLength,j=b._buffer,k=c.length;d<k;){var l=-1;switch(e){case 0:58===(l=c[d++])?e=1:g=g<<4|(96<l?l-87:l-48);continue;case 1:84===(e=c[d])||65===e||79===e||111===e||85===e||83===e||115===e||76===e||108===e||71===e||103===e||77===e||109===e||86===e?(h=e,e=2,d++):64<e&&91>e||35===e||114===e||120===e?(h=e,e=3,d++):(h=0,e=3);continue;case 2:44===(l=c[d++])?e=4:i=i<<4|(96<l?l-87:l-48);continue;case 3:l=c.indexOf(10,d);break;case 4:(l=d+i)>c.length&&(l=-1)}var m=c.byteOffset+d;if(-1<l)(function(a,b,c,d,e){switch(c){case 65:ah(a,b,an(d,e).buffer);return;case 79:ao(a,b,d,e,Int8Array,1);return;case 111:ah(a,b,0===d.length?e:an(d,e));return;case 85:ao(a,b,d,e,Uint8ClampedArray,1);return;case 83:ao(a,b,d,e,Int16Array,2);return;case 115:ao(a,b,d,e,Uint16Array,2);return;case 76:ao(a,b,d,e,Int32Array,4);return;case 108:ao(a,b,d,e,Uint32Array,4);return;case 71:ao(a,b,d,e,Float32Array,4);return;case 103:ao(a,b,d,e,Float64Array,8);return;case 77:ao(a,b,d,e,BigInt64Array,8);return;case 109:ao(a,b,d,e,BigUint64Array,8);return;case 86:ao(a,b,d,e,DataView,1);return}for(var g=a._stringDecoder,h="",i=0;i<d.length;i++)h+=g.decode(d[i],f);ap(a,b,c,h+=g.decode(e))})(a,g,h,j,i=new Uint8Array(c.buffer,m,l-d)),d=l,3===e&&d++,i=g=h=e=0,j.length=0;else{a=new Uint8Array(c.buffer,m,c.byteLength-d),j.push(a),i-=a.byteLength;break}}b._rowState=e,b._rowID=g,b._rowTag=h,b._rowLength=i}function ar(a){S(a,Error("Connection closed."))}function as(){throw Error("Server Functions cannot be called during initial render. This would create a fetch waterfall. Try to use a Server Component to pass data to Client Components instead.")}function at(a){return new af(a.serverConsumerManifest.moduleMap,a.serverConsumerManifest.serverModuleMap,a.serverConsumerManifest.moduleLoading,as,a.encodeFormAction,"string"==typeof a.nonce?a.nonce:void 0,a&&a.temporaryReferences?a.temporaryReferences:void 0)}function au(a,b){function c(b){S(a,b)}var d=ag(),e=b.getReader();e.read().then(function b(f){var g=f.value;if(!f.done)return aq(a,d,g),e.read().then(b).catch(c);ar(a)}).catch(c)}function av(){throw Error("Server Functions cannot be called during initial render. This would create a fetch waterfall. Try to use a Server Component to pass data to Client Components instead.")}b.createFromFetch=function(a,b){var c=at(b);return a.then(function(a){au(c,a.body)},function(a){S(c,a)}),U(c,0)},b.createFromNodeStream=function(a,b,c){var d=new af(b.moduleMap,b.serverModuleMap,b.moduleLoading,av,c?c.encodeFormAction:void 0,c&&"string"==typeof c.nonce?c.nonce:void 0,void 0),e=ag();return a.on("data",function(a){if("string"==typeof a){for(var b=0,c=e._rowState,f=e._rowID,g=e._rowTag,h=e._rowLength,i=e._buffer,j=a.length;b<j;){var k=-1;switch(c){case 0:58===(k=a.charCodeAt(b++))?c=1:f=f<<4|(96<k?k-87:k-48);continue;case 1:84===(c=a.charCodeAt(b))||65===c||79===c||111===c||85===c||83===c||115===c||76===c||108===c||71===c||103===c||77===c||109===c||86===c?(g=c,c=2,b++):64<c&&91>c||114===c||120===c?(g=c,c=3,b++):(g=0,c=3);continue;case 2:44===(k=a.charCodeAt(b++))?c=4:h=h<<4|(96<k?k-87:k-48);continue;case 3:k=a.indexOf("\n",b);break;case 4:if(84!==g)throw Error("Binary RSC chunks cannot be encoded as strings. This is a bug in the wiring of the React streams.");if(h<a.length||a.length>3*h)throw Error("String chunks need to be passed in their original shape. Not split into smaller string chunks. This is a bug in the wiring of the React streams.");k=a.length}if(-1<k){if(0<i.length)throw Error("String chunks need to be passed in their original shape. Not split into smaller string chunks. This is a bug in the wiring of the React streams.");ap(d,f,g,b=a.slice(b,k)),b=k,3===c&&b++,h=f=g=c=0,i.length=0}else if(a.length!==b)throw Error("String chunks need to be passed in their original shape. Not split into smaller string chunks. This is a bug in the wiring of the React streams.")}e._rowState=c,e._rowID=f,e._rowTag=g,e._rowLength=h}else aq(d,e,a)}),a.on("error",function(a){S(d,a)}),a.on("end",function(){return ar(d)}),U(d,0)},b.createFromReadableStream=function(a,b){return au(b=at(b),a),U(b,0)},b.createServerReference=function(a){function b(){var b=Array.prototype.slice.call(arguments);return as(a,b)}return A(b,a,null,void 0),b},b.createTemporaryReferenceSet=function(){return new Map},b.encodeReply=function(a,b){return new Promise(function(c,d){var e=w(a,"",b&&b.temporaryReferences?b.temporaryReferences:void 0,c,d);if(b&&b.signal){var f=b.signal;if(f.aborted)e(f.reason);else{var g=function(){e(f.reason),f.removeEventListener("abort",g)};f.addEventListener("abort",g)}}})},b.registerServerReference=function(a,b,c){return A(a,b,null,c),a}},61337:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.DownscopedClient=b.EXPIRATION_TIME_OFFSET=b.MAX_ACCESS_BOUNDARY_RULES_COUNT=void 0;let d=c(15921),e=c(27910),f=c(62783),g=c(88706);b.MAX_ACCESS_BOUNDARY_RULES_COUNT=10,b.EXPIRATION_TIME_OFFSET=3e5;class h extends f.AuthClient{authClient;credentialAccessBoundary;cachedDownscopedAccessToken;stsCredential;constructor(a,c={accessBoundary:{accessBoundaryRules:[]}}){if(super(a instanceof f.AuthClient?{}:a),a instanceof f.AuthClient?(this.authClient=a,this.credentialAccessBoundary=c):(this.authClient=a.authClient,this.credentialAccessBoundary=a.credentialAccessBoundary),0===this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length)throw Error("At least one access boundary rule needs to be defined.");if(this.credentialAccessBoundary.accessBoundary.accessBoundaryRules.length>b.MAX_ACCESS_BOUNDARY_RULES_COUNT)throw Error(`The provided access boundary has more than ${b.MAX_ACCESS_BOUNDARY_RULES_COUNT} access boundary rules.`);for(let a of this.credentialAccessBoundary.accessBoundary.accessBoundaryRules)if(0===a.availablePermissions.length)throw Error("At least one permission should be defined in access boundary rules.");this.stsCredential=new g.StsCredentials({tokenExchangeEndpoint:`https://sts.${this.universeDomain}/v1/token`}),this.cachedDownscopedAccessToken=null}setCredentials(a){if(!a.expiry_date)throw Error("The access token expiry_date field is missing in the provided credentials.");super.setCredentials(a),this.cachedDownscopedAccessToken=a}async getAccessToken(){return(!this.cachedDownscopedAccessToken||this.isExpired(this.cachedDownscopedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedDownscopedAccessToken.access_token,expirationTime:this.cachedDownscopedAccessToken.expiry_date,res:this.cachedDownscopedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=d.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,f=c.config.data instanceof e.Readable;if(!b&&(401===d||403===d)&&!f&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){let a=(await this.authClient.getAccessToken()).token,b=await this.stsCredential.exchangeToken({grantType:"urn:ietf:params:oauth:grant-type:token-exchange",requestedTokenType:"urn:ietf:params:oauth:token-type:access_token",subjectToken:a,subjectTokenType:"urn:ietf:params:oauth:token-type:access_token"},void 0,this.credentialAccessBoundary),c=this.authClient.credentials?.expiry_date||null,d=b.expires_in?new Date().getTime()+1e3*b.expires_in:c;return this.cachedDownscopedAccessToken={access_token:b.access_token,expiry_date:d,res:b.res},this.credentials={},Object.assign(this.credentials,this.cachedDownscopedAccessToken),delete this.credentials.res,this.emit("tokens",{refresh_token:null,expiry_date:this.cachedDownscopedAccessToken.expiry_date,access_token:this.cachedDownscopedAccessToken.access_token,token_type:"Bearer",id_token:null}),this.cachedDownscopedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}b.DownscopedClient=h},61406:(a,b,c)=>{var d=c(63815).Buffer,e=c(6263),f=c(76024),g=c(27910),h=c(52506),i=c(28354);function j(a,b){return d.from(a,b).toString("base64").replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function k(a){var b,c,d,e=a.header,g=a.payload,k=a.secret||a.privateKey,l=a.encoding,m=f(e.alg),o=(b=(b=l)||"utf8",c=j(h(e),"binary"),d=j(h(g),b),i.format("%s.%s",c,d)),p=m.sign(o,k);return i.format("%s.%s",o,p)}function l(a){var b=a.secret;if(b=null==(b=null==b?a.privateKey:b)?a.key:b,!0===/^hs/i.test(a.header.alg)&&null==b)throw TypeError("secret must be a string or buffer or a KeyObject");var c=new e(b);this.readable=!0,this.header=a.header,this.encoding=a.encoding,this.secret=this.privateKey=this.key=c,this.payload=new e(a.payload),this.secret.once("close",(function(){!this.payload.writable&&this.readable&&this.sign()}).bind(this)),this.payload.once("close",(function(){!this.secret.writable&&this.readable&&this.sign()}).bind(this))}i.inherits(l,g),l.prototype.sign=function(){try{var a=k({header:this.header,payload:this.payload.buffer,secret:this.secret.buffer,encoding:this.encoding});return this.emit("done",a),this.emit("data",a),this.emit("end"),this.readable=!1,a}catch(a){this.readable=!1,this.emit("error",a),this.emit("close")}},l.sign=k,a.exports=l},61410:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.CertificateSubjectTokenSupplier=b.InvalidConfigurationError=b.CertificateSourceUnavailableError=b.CERTIFICATE_CONFIGURATION_ENV_VARIABLE=void 0;let d=c(21827),e=c(29021),f=c(55511),g=c(55591);b.CERTIFICATE_CONFIGURATION_ENV_VARIABLE="GOOGLE_API_CERTIFICATE_CONFIG";class h extends Error{constructor(a){super(a),this.name="CertificateSourceUnavailableError"}}b.CertificateSourceUnavailableError=h;class i extends Error{constructor(a){super(a),this.name="InvalidConfigurationError"}}b.InvalidConfigurationError=i;class j{certificateConfigPath;trustChainPath;cert;key;constructor(a){if(!a.useDefaultCertificateConfig&&!a.certificateConfigLocation)throw new i("Either `useDefaultCertificateConfig` must be true or a `certificateConfigLocation` must be provided.");if(a.useDefaultCertificateConfig&&a.certificateConfigLocation)throw new i("Both `useDefaultCertificateConfig` and `certificateConfigLocation` cannot be provided.");this.trustChainPath=a.trustChainPath,this.certificateConfigPath=a.certificateConfigLocation??""}async createMtlsHttpsAgent(){if(!this.key||!this.cert)throw new i("Cannot create mTLS Agent with missing certificate or key");return new g.Agent({key:this.key,cert:this.cert})}async getSubjectToken(){this.certificateConfigPath=await this.#l();let{certPath:a,keyPath:b}=await this.#m();return{cert:this.cert,key:this.key}=await this.#n(a,b),await this.#o(this.cert)}async #l(){let a=this.certificateConfigPath;if(a){if(await (0,d.isValidFile)(a))return a;throw new h(`Provided certificate config path is invalid: ${a}`)}let c=process.env[b.CERTIFICATE_CONFIGURATION_ENV_VARIABLE];if(c){if(await (0,d.isValidFile)(c))return c;throw new h(`Path from environment variable "${b.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" is invalid: ${c}`)}let e=(0,d.getWellKnownCertificateConfigFileLocation)();if(await (0,d.isValidFile)(e))return e;throw new h(`Could not find certificate configuration file. Searched override path, the "${b.CERTIFICATE_CONFIGURATION_ENV_VARIABLE}" env var, and the gcloud path (${e}).`)}async #m(){let a,b=this.certificateConfigPath;try{a=await e.promises.readFile(b,"utf8")}catch(a){throw new h(`Failed to read certificate config file at: ${b}`)}try{let c=JSON.parse(a),d=c?.cert_configs?.workload?.cert_path,e=c?.cert_configs?.workload?.key_path;if(!d||!e)throw new i(`Certificate config file (${b}) is missing required "cert_path" or "key_path" in the workload config.`);return{certPath:d,keyPath:e}}catch(a){if(a instanceof i)throw a;throw new i(`Failed to parse certificate config from ${b}: ${a.message}`)}}async #n(a,b){let c,d;try{c=await e.promises.readFile(a),new f.X509Certificate(c)}catch(c){let b=c instanceof Error?c.message:String(c);throw new h(`Failed to read certificate file at ${a}: ${b}`)}try{d=await e.promises.readFile(b),(0,f.createPrivateKey)(d)}catch(c){let a=c instanceof Error?c.message:String(c);throw new h(`Failed to read private key file at ${b}: ${a}`)}return{cert:c,key:d}}async #o(a){let b=new f.X509Certificate(a);if(!this.trustChainPath)return JSON.stringify([b.raw.toString("base64")]);try{let a,c=((await e.promises.readFile(this.trustChainPath,"utf8")).match(/-----BEGIN CERTIFICATE-----[^-]+-----END CERTIFICATE-----/g)??[]).map((a,b)=>{try{return new f.X509Certificate(a)}catch(c){let a=c instanceof Error?c.message:String(c);throw new i(`Failed to parse certificate at index ${b} in trust chain file ${this.trustChainPath}: ${a}`)}}),d=c.findIndex(a=>b.raw.equals(a.raw));if(-1===d)a=[b,...c];else if(0===d)a=c;else throw new i(`Leaf certificate exists in the trust chain but is not the first entry (found at index ${d}).`);return JSON.stringify(a.map(a=>a.raw.toString("base64")))}catch(b){if(b instanceof i)throw b;let a=b instanceof Error?b.message:String(b);throw new h(`Failed to process certificate chain from ${this.trustChainPath}: ${a}`)}}}b.CertificateSubjectTokenSupplier=j},61618:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f});var d=c(88239),e=c(37930);function f(){return(0,d.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-slate-100 py-12 px-4 sm:px-6 lg:px-8",children:(0,d.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,d.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-8 sm:p-10 border border-gray-100",children:[(0,d.jsxs)("div",{className:"mb-10",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,d.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:(0,d.jsx)("svg",{className:"w-7 h-7 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold text-gray-900",children:"Website Ingestion Service"}),(0,d.jsx)("p",{className:"text-gray-500 text-sm mt-1",children:"Powered by Gemini File Search"})]})]}),(0,d.jsx)("p",{className:"text-gray-600 text-lg leading-relaxed",children:"Enter a website URL to check if it's already processed or start a new ingestion. The system will automatically discover, scrape, and index all pages."})]}),(0,d.jsx)(e.IngestionForm,{})]})})})}},62783:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.AuthClient=b.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=b.DEFAULT_UNIVERSE=void 0;let d=c(94735),e=c(15921),f=c(21827),g=c(86588),h=c(66993);b.DEFAULT_UNIVERSE="googleapis.com",b.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS=3e5;class i extends d.EventEmitter{apiKey;projectId;quotaProjectId;transporter;credentials={};eagerRefreshThresholdMillis=b.DEFAULT_EAGER_REFRESH_THRESHOLD_MILLIS;forceRefreshOnFailure=!1;universeDomain=b.DEFAULT_UNIVERSE;static RequestMethodNameSymbol=Symbol("request method name");static RequestLogIdSymbol=Symbol("request log id");constructor(a={}){super();let c=(0,f.originalOrCamelOptions)(a);this.apiKey=a.apiKey,this.projectId=c.get("project_id")??null,this.quotaProjectId=c.get("quota_project_id"),this.credentials=c.get("credentials")??{},this.universeDomain=c.get("universe_domain")??b.DEFAULT_UNIVERSE,this.transporter=a.transporter??new e.Gaxios(a.transporterOptions),!1!==c.get("useAuthRequestParameters")&&(this.transporter.interceptors.request.add(i.DEFAULT_REQUEST_INTERCEPTOR),this.transporter.interceptors.response.add(i.DEFAULT_RESPONSE_INTERCEPTOR)),a.eagerRefreshThresholdMillis&&(this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis),this.forceRefreshOnFailure=a.forceRefreshOnFailure??!1}fetch(...a){let b,c=a[0],d=a[1],f=new Headers;return("string"==typeof c?b=new URL(c):c instanceof URL?b=c:c&&c.url&&(b=new URL(c.url)),c&&"object"==typeof c&&"headers"in c&&e.Gaxios.mergeHeaders(f,c.headers),d&&e.Gaxios.mergeHeaders(f,new Headers(d.headers)),"object"!=typeof c||c instanceof URL)?this.request({...d,headers:f,url:b}):this.request({...d,...c,headers:f,url:b})}setCredentials(a){this.credentials=a}addSharedMetadataHeaders(a){return!a.has("x-goog-user-project")&&this.quotaProjectId&&a.set("x-goog-user-project",this.quotaProjectId),a}addUserProjectAndAuthHeaders(a,b){let c=b.get("x-goog-user-project"),d=b.get("authorization");return c&&a.set("x-goog-user-project",c),d&&a.set("authorization",d),a}static log=(0,g.log)("auth");static DEFAULT_REQUEST_INTERCEPTOR={resolved:async a=>{if(!a.headers.has("x-goog-api-client")){let b=process.version.replace(/^v/,"");a.headers.set("x-goog-api-client",`gl-node/${b}`)}let b=a.headers.get("User-Agent");b?b.includes(`${h.PRODUCT_NAME}/`)||a.headers.set("User-Agent",`${b} ${h.USER_AGENT}`):a.headers.set("User-Agent",h.USER_AGENT);try{let b=a[i.RequestMethodNameSymbol],c=`${Math.floor(1e3*Math.random())}`;a[i.RequestLogIdSymbol]=c;let d={url:a.url,headers:a.headers};b?i.log.info("%s [%s] request %j",b,c,d):i.log.info("[%s] request %j",c,d)}catch(a){}return a}};static DEFAULT_RESPONSE_INTERCEPTOR={resolved:async a=>{try{let b=a.config,c=b[i.RequestMethodNameSymbol],d=b[i.RequestLogIdSymbol];c?i.log.info("%s [%s] response %j",c,d,a.data):i.log.info("[%s] response %j",d,a.data)}catch(a){}return a},rejected:async a=>{try{let b=a.config,c=b[i.RequestMethodNameSymbol],d=b[i.RequestLogIdSymbol];c?i.log.info("%s [%s] error %j",c,d,a.response?.data):i.log.error("[%s] error %j",d,a.response?.data)}catch(a){}throw a}};static setMethodName(a,b){try{a[i.RequestMethodNameSymbol]=b}catch(a){}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}b.AuthClient=i},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63091:(a,b)=>{"use strict";function c(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===d}Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{isHangingPromiseRejectionError:function(){return c},makeDevtoolsIOAwarePromise:function(){return i},makeHangingPromise:function(){return g}});let d="HANGING_PROMISE_REJECTION";class e extends Error{constructor(a,b){super(`During prerendering, ${b} rejects when the prerender is complete. Typically these errors are handled by React but if you move ${b} to a different context by using \`setTimeout\`, \`after\`, or similar functions you may observe this error and you should handle it in that context. This occurred at route "${a}".`),this.route=a,this.expression=b,this.digest=d}}let f=new WeakMap;function g(a,b,c){if(a.aborted)return Promise.reject(new e(b,c));{let d=new Promise((d,g)=>{let h=g.bind(null,new e(b,c)),i=f.get(a);if(i)i.push(h);else{let b=[h];f.set(a,b),a.addEventListener("abort",()=>{for(let a=0;a<b.length;a++)b[a]()},{once:!0})}});return d.catch(h),d}}function h(){}function i(a){return new Promise(b=>{setTimeout(()=>{b(a)},0)})}},63508:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"InvariantError",{enumerable:!0,get:function(){return c}});class c extends Error{constructor(a,b){super("Invariant: "+(a.endsWith(".")?a:a+".")+" This is a bug in Next.js.",b),this.name="InvariantError"}}},63596:(a,b,c)=>{"use strict";a.exports={pkg:c(41407)}},63737:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{BailoutToCSRError:function(){return d},isBailoutToCSRError:function(){return e}});let c="BAILOUT_TO_CLIENT_SIDE_RENDERING";class d extends Error{constructor(a){super("Bail out to client-side rendering: "+a),this.reason=a,this.digest=c}}function e(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===c}},63815:(a,b,c)=>{var d=c(79428),e=d.Buffer;function f(a,b){for(var c in a)b[c]=a[c]}function g(a,b,c){return e(a,b,c)}e.from&&e.alloc&&e.allocUnsafe&&e.allocUnsafeSlow?a.exports=d:(f(d,b),b.Buffer=g),g.prototype=Object.create(e.prototype),f(e,g),g.from=function(a,b,c){if("number"==typeof a)throw TypeError("Argument must not be a number");return e(a,b,c)},g.alloc=function(a,b,c){if("number"!=typeof a)throw TypeError("Argument must be a number");var d=e(a);return void 0!==b?"string"==typeof c?d.fill(b,c):d.fill(b):d.fill(0),d},g.allocUnsafe=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return e(a)},g.allocUnsafeSlow=function(a){if("number"!=typeof a)throw TypeError("Argument must be a number");return d.SlowBuffer(a)}},64182:a=>{"use strict";a.exports=JSON.parse('{"name":"thread-stream","version":"3.1.0","description":"A streaming way to send data to a Node.js Worker Thread","main":"index.js","types":"index.d.ts","dependencies":{"real-require":"^0.2.0"},"devDependencies":{"@types/node":"^20.1.0","@types/tap":"^15.0.0","@yao-pkg/pkg":"^5.11.5","desm":"^1.3.0","fastbench":"^1.0.1","husky":"^9.0.6","pino-elasticsearch":"^8.0.0","sonic-boom":"^4.0.1","standard":"^17.0.0","tap":"^16.2.0","ts-node":"^10.8.0","typescript":"^5.3.2","why-is-node-running":"^2.2.2"},"scripts":{"build":"tsc --noEmit","test":"standard && npm run build && npm run transpile && tap \\"test/**/*.test.*js\\" && tap --ts test/*.test.*ts","test:ci":"standard && npm run transpile && npm run test:ci:js && npm run test:ci:ts","test:ci:js":"tap --no-check-coverage --timeout=120 --coverage-report=lcovonly \\"test/**/*.test.*js\\"","test:ci:ts":"tap --ts --no-check-coverage --coverage-report=lcovonly \\"test/**/*.test.*ts\\"","test:yarn":"npm run transpile && tap \\"test/**/*.test.js\\" --no-check-coverage","transpile":"sh ./test/ts/transpile.sh","prepare":"husky install"},"standard":{"ignore":["test/ts/**/*","test/syntax-error.mjs"]},"repository":{"type":"git","url":"git+https://github.com/mcollina/thread-stream.git"},"keywords":["worker","thread","threads","stream"],"author":"Matteo Collina <hello@matteocollina.com>","license":"MIT","bugs":{"url":"https://github.com/mcollina/thread-stream/issues"},"homepage":"https://github.com/mcollina/thread-stream#readme"}')},64360:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.GaxiosInterceptorManager=void 0;class c extends Set{}b.GaxiosInterceptorManager=c},65158:(a,b,c)=>{"use strict";let{EMPTY_BUFFER:d}=c(40826),e=Buffer[Symbol.species];function f(a,b,c,d,e){for(let f=0;f<e;f++)c[d+f]=a[f]^b[3&f]}function g(a,b){for(let c=0;c<a.length;c++)a[c]^=b[3&c]}function h(a){let b;return(h.readOnly=!0,Buffer.isBuffer(a))?a:(a instanceof ArrayBuffer?b=new e(a):ArrayBuffer.isView(a)?b=new e(a.buffer,a.byteOffset,a.byteLength):(b=Buffer.from(a),h.readOnly=!1),b)}if(a.exports={concat:function(a,b){if(0===a.length)return d;if(1===a.length)return a[0];let c=Buffer.allocUnsafe(b),f=0;for(let b=0;b<a.length;b++){let d=a[b];c.set(d,f),f+=d.length}return f<b?new e(c.buffer,c.byteOffset,f):c},mask:f,toArrayBuffer:function(a){return a.length===a.buffer.byteLength?a.buffer:a.buffer.slice(a.byteOffset,a.byteOffset+a.length)},toBuffer:h,unmask:g},!process.env.WS_NO_BUFFER_UTIL)try{let b=c(78358);a.exports.mask=function(a,c,d,e,g){g<48?f(a,c,d,e,g):b.mask(a,c,d,e,g)},a.exports.unmask=function(a,c){a.length<32?g(a,c):b.unmask(a,c)}}catch(a){}},65485:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>f,metadata:()=>e});var d=c(88239);c(45351);let e={title:"Website Ingestion Service",description:"Ingest and index websites for semantic search"};function f({children:a}){return(0,d.jsx)("html",{lang:"en",children:(0,d.jsx)("body",{children:a})})}},65777:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{callServer:function(){return d.callServer},createServerReference:function(){return f.createServerReference},findSourceMapURL:function(){return e.findSourceMapURL}});let d=c(2778),e=c(81698),f=c(42317)},66447:(a,b,c)=>{"use strict";a.exports=c(59026)},66961:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Impersonated=b.IMPERSONATED_ACCOUNT_TYPE=void 0;let d=c(76748),e=c(15921),f=c(21827);b.IMPERSONATED_ACCOUNT_TYPE="impersonated_service_account";class g extends d.OAuth2Client{sourceClient;targetPrincipal;targetScopes;delegates;lifetime;endpoint;constructor(a={}){if(super(a),this.credentials={expiry_date:1,refresh_token:"impersonated-placeholder"},this.sourceClient=a.sourceClient??new d.OAuth2Client,this.targetPrincipal=a.targetPrincipal??"",this.delegates=a.delegates??[],this.targetScopes=a.targetScopes??[],this.lifetime=a.lifetime??3600,(0,f.originalOrCamelOptions)(a).get("universe_domain")){if(this.sourceClient.universeDomain!==this.universeDomain)throw RangeError(`Universe domain ${this.sourceClient.universeDomain} in source credentials does not match ${this.universeDomain} universe domain set for impersonated credentials.`)}else this.universeDomain=this.sourceClient.universeDomain;this.endpoint=a.endpoint??`https://iamcredentials.${this.universeDomain}`}async sign(a){await this.sourceClient.getAccessToken();let b=`projects/-/serviceAccounts/${this.targetPrincipal}`,c=`${this.endpoint}/v1/${b}:signBlob`,d={delegates:this.delegates,payload:Buffer.from(a).toString("base64")};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:c,data:d,method:"POST"})).data}getTargetPrincipal(){return this.targetPrincipal}async refreshToken(){try{await this.sourceClient.getAccessToken();let a="projects/-/serviceAccounts/"+this.targetPrincipal,b=`${this.endpoint}/v1/${a}:generateAccessToken`,c={delegates:this.delegates,scope:this.targetScopes,lifetime:this.lifetime+"s"},d=await this.sourceClient.request({...g.RETRY_CONFIG,url:b,data:c,method:"POST"}),e=d.data;return this.credentials.access_token=e.accessToken,this.credentials.expiry_date=Date.parse(e.expireTime),{tokens:this.credentials,res:d}}catch(c){if(!(c instanceof Error))throw c;let a=0,b="";if(c instanceof e.GaxiosError&&(a=c?.response?.data?.error?.status,b=c?.response?.data?.error?.message),a&&b)throw c.message=`${a}: unable to impersonate: ${b}`,c;throw c.message=`unable to impersonate: ${c}`,c}}async fetchIdToken(a,b){await this.sourceClient.getAccessToken();let c=`projects/-/serviceAccounts/${this.targetPrincipal}`,d=`${this.endpoint}/v1/${c}:generateIdToken`,e={delegates:this.delegates,audience:a,includeEmail:b?.includeEmail??!0,useEmailAzp:b?.includeEmail??!0};return(await this.sourceClient.request({...g.RETRY_CONFIG,url:d,data:e,method:"POST"})).data.token}}b.Impersonated=g},66993:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.USER_AGENT=b.PRODUCT_NAME=b.pkg=void 0;let d=c(26020);b.pkg=d;let e="google-api-nodejs-client";b.PRODUCT_NAME=e,b.USER_AGENT=`${e}/${d.version}`},67390:(a,b)=>{"use strict";function c(a){return"("===a[0]&&a.endsWith(")")}function d(a){return a.startsWith("@")&&"@children"!==a}function e(a,b){if(a.includes(f)){let a=JSON.stringify(b);return"{}"!==a?f+"?"+a:f}return a}Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{DEFAULT_SEGMENT_KEY:function(){return g},PAGE_SEGMENT_KEY:function(){return f},addSearchParamsIfPageSegment:function(){return e},isGroupSegment:function(){return c},isParallelRouteSegment:function(){return d}});let f="__PAGE__",g="__DEFAULT__"},67533:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ExternalAccountAuthorizedUserClient=b.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE=void 0;let d=c(62783),e=c(80118),f=c(15921),g=c(27910),h=c(8011);b.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE="external_account_authorized_user";class i extends e.OAuthClientAuthHandler{#p;constructor(a){super(a),this.#p=a.tokenRefreshEndpoint}async refreshToken(a,b){let c={...i.RETRY_CONFIG,url:this.#p,method:"POST",headers:b,data:new URLSearchParams({grant_type:"refresh_token",refresh_token:a})};d.AuthClient.setMethodName(c,"refreshToken"),this.applyClientAuthenticationOptions(c);try{let a=await this.transporter.request(c),b=a.data;return b.res=a,b}catch(a){if(a instanceof f.GaxiosError&&a.response)throw(0,e.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}class j extends d.AuthClient{cachedAccessToken;externalAccountAuthorizedUserHandler;refreshToken;constructor(a){super(a),a.universe_domain&&(this.universeDomain=a.universe_domain),this.refreshToken=a.refresh_token;let b={confidentialClientType:"basic",clientId:a.client_id,clientSecret:a.client_secret};this.externalAccountAuthorizedUserHandler=new i({tokenRefreshEndpoint:a.token_url??"https://sts.{universeDomain}/v1/oauthtoken".replace("{universeDomain}",this.universeDomain),transporter:this.transporter,clientAuthentication:b}),this.cachedAccessToken=null,this.quotaProjectId=a.quota_project_id,"number"!=typeof a?.eagerRefreshThresholdMillis?this.eagerRefreshThresholdMillis=h.EXPIRATION_TIME_OFFSET:this.eagerRefreshThresholdMillis=a.eagerRefreshThresholdMillis,this.forceRefreshOnFailure=!!a?.forceRefreshOnFailure}async getAccessToken(){return(!this.cachedAccessToken||this.isExpired(this.cachedAccessToken))&&await this.refreshAccessTokenAsync(),{token:this.cachedAccessToken.access_token,res:this.cachedAccessToken.res}}async getRequestHeaders(){let a=await this.getAccessToken(),b=new Headers({authorization:`Bearer ${a.token}`});return this.addSharedMetadataHeaders(b)}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){let c;try{let b=await this.getRequestHeaders();a.headers=f.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b),c=await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=c.config.data instanceof g.Readable;if(!b&&(401===d||403===d)&&!e&&this.forceRefreshOnFailure)return await this.refreshAccessTokenAsync(),await this.requestAsync(a,!0)}throw d}return c}async refreshAccessTokenAsync(){let a=await this.externalAccountAuthorizedUserHandler.refreshToken(this.refreshToken);return this.cachedAccessToken={access_token:a.access_token,expiry_date:new Date().getTime()+1e3*a.expires_in,res:a.res},void 0!==a.refresh_token&&(this.refreshToken=a.refresh_token),this.cachedAccessToken}isExpired(a){let b=new Date().getTime();return!!a.expiry_date&&b>=a.expiry_date-this.eagerRefreshThresholdMillis}}b.ExternalAccountAuthorizedUserClient=j},68573:(a,b,c)=>{"use strict";let d;Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{arrayBufferToString:function(){return h},decrypt:function(){return k},encrypt:function(){return j},getActionEncryptionKey:function(){return q},getClientReferenceManifestForRsc:function(){return p},getServerModuleMap:function(){return o},setReferenceManifestsSingleton:function(){return m},stringToUint8Array:function(){return i}});let e=c(63508),f=c(23669),g=c(29294);function h(a){let b=new Uint8Array(a),c=b.byteLength;if(c<65535)return String.fromCharCode.apply(null,b);let d="";for(let a=0;a<c;a++)d+=String.fromCharCode(b[a]);return d}function i(a){let b=a.length,c=new Uint8Array(b);for(let d=0;d<b;d++)c[d]=a.charCodeAt(d);return c}function j(a,b,c){return crypto.subtle.encrypt({name:"AES-GCM",iv:b},a,c)}function k(a,b,c){return crypto.subtle.decrypt({name:"AES-GCM",iv:b},a,c)}let l=Symbol.for("next.server.action-manifests");function m({page:a,clientReferenceManifest:b,serverActionsManifest:c,serverModuleMap:d}){var e;let g=null==(e=globalThis[l])?void 0:e.clientReferenceManifestsPerPage;globalThis[l]={clientReferenceManifestsPerPage:{...g,[(0,f.normalizeAppPath)(a)]:b},serverActionsManifest:c,serverModuleMap:d}}function o(){let a=globalThis[l];if(!a)throw Object.defineProperty(new e.InvariantError("Missing manifest for Server Actions."),"__NEXT_ERROR_CODE",{value:"E606",enumerable:!1,configurable:!0});return a.serverModuleMap}function p(){let a=globalThis[l];if(!a)throw Object.defineProperty(new e.InvariantError("Missing manifest for Server Actions."),"__NEXT_ERROR_CODE",{value:"E606",enumerable:!1,configurable:!0});let{clientReferenceManifestsPerPage:b}=a,c=g.workAsyncStorage.getStore();if(!c){var d=b;let a=Object.values(d),c={clientModules:{},edgeRscModuleMapping:{},rscModuleMapping:{}};for(let b of a)c.clientModules={...c.clientModules,...b.clientModules},c.edgeRscModuleMapping={...c.edgeRscModuleMapping,...b.edgeRscModuleMapping},c.rscModuleMapping={...c.rscModuleMapping,...b.rscModuleMapping};return c}let f=b[c.route];if(!f)throw Object.defineProperty(new e.InvariantError(`Missing Client Reference Manifest for ${c.route}.`),"__NEXT_ERROR_CODE",{value:"E570",enumerable:!1,configurable:!0});return f}async function q(){if(d)return d;let a=globalThis[l];if(!a)throw Object.defineProperty(new e.InvariantError("Missing manifest for Server Actions."),"__NEXT_ERROR_CODE",{value:"E606",enumerable:!1,configurable:!0});let b=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||a.serverActionsManifest.encryptionKey;if(void 0===b)throw Object.defineProperty(new e.InvariantError("Missing encryption key for Server Actions"),"__NEXT_ERROR_CODE",{value:"E571",enumerable:!1,configurable:!0});return d=await crypto.subtle.importKey("raw",i(atob(b)),"AES-GCM",!0,["encrypt","decrypt"])}},68775:(a,b,c)=>{"use strict";let d=c(48161),e=c(87826),f=c(8050),g=c(76182),h=c(88648),i=c(56571),j=c(22782),{configure:k}=c(85170),{assertDefaultLevelFound:l,mappings:m,genLsCache:o,genLevelComparison:p,assertLevelComparison:q}=c(91578),{DEFAULT_LEVELS:r,SORTING_ORDER:s}=c(21258),{createArgsNormalizer:t,asChindings:u,buildSafeSonicBoom:v,buildFormatters:w,stringify:x,normalizeDestFileDescriptor:y,noop:z}=c(2832),{version:A}=c(36012),{chindingsSym:B,redactFmtSym:C,serializersSym:D,timeSym:E,timeSliceIndexSym:F,streamSym:G,stringifySym:H,stringifySafeSym:I,stringifiersSym:J,setLevelSym:K,endSym:L,formatOptsSym:M,messageKeySym:N,errorKeySym:O,nestedKeySym:P,mixinSym:Q,levelCompSym:R,useOnlyCustomLevelsSym:S,formattersSym:T,hooksSym:U,nestedKeyStrSym:V,mixinMergeStrategySym:W,msgPrefixSym:X}=j,{epochTime:Y,nullTime:Z}=h,{pid:$}=process,_=d.hostname(),aa=e.err,ab=t({level:"info",levelComparison:s.ASC,levels:r,messageKey:"msg",errorKey:"err",nestedKey:null,enabled:!0,base:{pid:$,hostname:_},serializers:Object.assign(Object.create(null),{err:aa}),formatters:Object.assign(Object.create(null),{bindings:a=>a,level:(a,b)=>({level:b})}),hooks:{logMethod:void 0,streamWrite:void 0},timestamp:Y,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:!1,depthLimit:5,edgeLimit:100}),ac=Object.assign(Object.create(null),e);function ad(...a){let b={},{opts:c,stream:d}=ab(b,f(),...a);c.level&&"string"==typeof c.level&&void 0!==r[c.level.toLowerCase()]&&(c.level=c.level.toLowerCase());let{redact:e,crlf:h,serializers:j,timestamp:s,messageKey:t,errorKey:v,nestedKey:y,base:A,name:$,level:_,customLevels:aa,levelComparison:ac,mixin:ae,mixinMergeStrategy:af,useOnlyCustomLevels:ag,formatters:ah,hooks:ai,depthLimit:aj,edgeLimit:ak,onChild:al,msgPrefix:am}=c,an=k({maximumDepth:aj,maximumBreadth:ak}),ao=w(ah.level,ah.bindings,ah.log),ap=x.bind({[I]:an}),aq=e?g(e,ap):{},ar=e?{stringify:aq[C]}:{stringify:ap},as=u.bind(null,{[B]:"",[D]:j,[J]:aq,[H]:x,[I]:an,[T]:ao}),at="";null!==A&&(at=as(void 0===$?A:Object.assign({},A,{name:$})));let au=s instanceof Function?s:s?Y:Z,av=au().indexOf(":")+1;if(ag&&!aa)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(ae&&"function"!=typeof ae)throw Error(`Unknown mixin type "${typeof ae}" - expected "function"`);if(am&&"string"!=typeof am)throw Error(`Unknown msgPrefix type "${typeof am}" - expected "string"`);l(_,aa,ag);let aw=m(aa,ag);return"function"==typeof d.emit&&d.emit("message",{code:"PINO_CONFIG",config:{levels:aw,messageKey:t,errorKey:v}}),q(ac),Object.assign(b,{levels:aw,[R]:p(ac),[S]:ag,[G]:d,[E]:au,[F]:av,[H]:x,[I]:an,[J]:aq,[L]:"}"+(h?"\r\n":"\n"),[M]:ar,[N]:t,[O]:v,[P]:y,[V]:y?`,${JSON.stringify(y)}:{`:"",[D]:j,[Q]:ae,[W]:af,[B]:at,[T]:ao,[U]:ai,silent:z,onChild:al,[X]:am}),Object.setPrototypeOf(b,i()),o(b),b[K](_),b}a.exports=ad,a.exports.destination=(a=process.stdout.fd)=>"object"==typeof a?(a.dest=y(a.dest||process.stdout.fd),v(a)):v({dest:y(a),minLength:0}),a.exports.transport=c(24482),a.exports.multistream=c(9362),a.exports.levels=m(),a.exports.stdSerializers=ac,a.exports.stdTimeFunctions=Object.assign({},h),a.exports.symbols=j,a.exports.version=A,a.exports.default=ad,a.exports.pino=ad},68777:a=>{"use strict";function b(a){try{return JSON.stringify(a)}catch(a){return'"[Circular]"'}}a.exports=function(a,c,d){var e=d&&d.stringify||b;if("object"==typeof a&&null!==a){var f=c.length+1;if(1===f)return a;var g=Array(f);g[0]=e(a);for(var h=1;h<f;h++)g[h]=e(c[h]);return g.join(" ")}if("string"!=typeof a)return a;var i=c.length;if(0===i)return a;for(var j="",k=0,l=-1,m=a&&a.length||0,o=0;o<m;){if(37===a.charCodeAt(o)&&o+1<m){switch(l=l>-1?l:0,a.charCodeAt(o+1)){case 100:case 102:if(k>=i||null==c[k])break;l<o&&(j+=a.slice(l,o)),j+=Number(c[k]),l=o+2,o++;break;case 105:if(k>=i||null==c[k])break;l<o&&(j+=a.slice(l,o)),j+=Math.floor(Number(c[k])),l=o+2,o++;break;case 79:case 111:case 106:if(k>=i||void 0===c[k])break;l<o&&(j+=a.slice(l,o));var p=typeof c[k];if("string"===p){j+="'"+c[k]+"'",l=o+2,o++;break}if("function"===p){j+=c[k].name||"<anonymous>",l=o+2,o++;break}j+=e(c[k]),l=o+2,o++;break;case 115:if(k>=i)break;l<o&&(j+=a.slice(l,o)),j+=String(c[k]),l=o+2,o++;break;case 37:l<o&&(j+=a.slice(l,o)),j+="%",l=o+2,o++,k--}++k}++o}return -1===l?a:(l<m&&(j+=a.slice(l)),j)}},69039:(a,b,c)=>{"use strict";c.d(b,{IngestionForm:()=>l});var d=c(11709),e=c(67656),f=c(65777);f.callServer,f.findSourceMapURL;let g=(0,f.createServerReference)("40622ed279d917b6463604c69302242b45356ef24b",f.callServer,void 0,f.findSourceMapURL,"checkWebsite"),h=(0,f.createServerReference)("60d306fda615a5dc15be3c0235749ca6d4859c5b62",f.callServer,void 0,f.findSourceMapURL,"ingestWebsite"),i=(0,f.createServerReference)("6059c8a6b5b82ffc7a1d5d100ac4868c75861c3a08",f.callServer,void 0,f.findSourceMapURL,"runIndexing");function j({status:a,onIngest:b,onIndexing:c,onReset:e,isPending:f}){if("idle"===a.type)return null;if("checking"===a.type)return(0,d.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 shadow-sm animate-pulse",children:(0,d.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-3 border-blue-200 border-t-blue-600"}),(0,d.jsx)("div",{className:"absolute inset-0 rounded-full border-3 border-transparent border-t-blue-400 animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-blue-900 font-semibold text-base",children:"Checking if website exists..."}),(0,d.jsx)("p",{className:"text-blue-600 text-sm mt-0.5",children:"This will only take a moment"})]})]})});if("exists"===a.type)return(0,d.jsx)("div",{className:"bg-gradient-to-br from-amber-50 to-yellow-50 border-2 border-amber-200 rounded-xl p-6 shadow-lg animate-in fade-in slide-in-from-bottom-4 duration-500",children:(0,d.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)("div",{className:"w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center",children:(0,d.jsx)("svg",{className:"h-7 w-7 text-amber-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h3",{className:"text-xl font-bold text-amber-900 mb-3",children:"Website Already Exists"}),(0,d.jsxs)("div",{className:"bg-white/60 rounded-lg p-4 mb-4 space-y-2.5",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"text-sm font-semibold text-amber-900",children:"Root Domain:"}),(0,d.jsx)("span",{className:"text-sm text-amber-800 font-mono bg-amber-100 px-2 py-1 rounded",children:a.domain})]}),(0,d.jsx)("p",{className:"text-xs text-amber-700 italic",children:"Resolved to root domain from the URL you provided"}),a.website?.display_name&&(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"text-sm font-semibold text-amber-900",children:"Display Name:"}),(0,d.jsx)("span",{className:"text-sm text-amber-800",children:a.website.display_name})]}),a.website?.id&&(0,d.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,d.jsx)("span",{className:"text-sm font-semibold text-amber-900",children:"Website ID:"}),(0,d.jsx)("code",{className:"text-xs bg-amber-100 text-amber-900 px-2 py-1 rounded font-mono",children:a.website.id})]})]}),(0,d.jsx)("p",{className:"text-sm text-amber-800 mb-5 leading-relaxed",children:"This website has already been processed in the system. You can chat with it or run the sync service to check for changes."}),(0,d.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,d.jsx)("button",{onClick:()=>{alert("Sync service integration coming soon. This will check for changes and update the website.")},className:"bg-gradient-to-r from-amber-500 to-amber-600 text-white py-2.5 px-6 rounded-xl font-semibold hover:from-amber-600 hover:to-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-[1.02]",children:"Run Sync Service"}),(0,d.jsx)("button",{onClick:e,className:"bg-gray-600 text-white py-2.5 px-6 rounded-xl font-semibold hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-[1.02]",children:"Check Another Website"})]})]})]})});if("new"===a.type)return(0,d.jsx)("div",{className:"bg-gradient-to-br from-emerald-50 to-green-50 border-2 border-emerald-200 rounded-xl p-6 shadow-lg animate-in fade-in slide-in-from-bottom-4 duration-500",children:(0,d.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center",children:(0,d.jsx)("svg",{className:"h-7 w-7 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h3",{className:"text-xl font-bold text-emerald-900 mb-2",children:"New Website Detected"}),(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsx)("span",{className:"text-sm text-emerald-700",children:"Domain: "}),(0,d.jsx)("span",{className:"text-sm font-mono font-semibold text-emerald-900 bg-emerald-100 px-2 py-1 rounded",children:a.domain})]}),(0,d.jsxs)("div",{className:"bg-white/70 border border-emerald-200 rounded-lg p-4 mb-5",children:[(0,d.jsxs)("p",{className:"text-sm font-semibold text-emerald-900 mb-3 flex items-center gap-2",children:[(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"What will happen:"]}),(0,d.jsxs)("ul",{className:"text-sm text-emerald-800 space-y-2 ml-6 list-disc",children:[(0,d.jsx)("li",{children:"Create a new website record in the system"}),(0,d.jsx)("li",{children:"Discover all URLs on the website"}),(0,d.jsx)("li",{children:"Scrape and store content as markdown"}),(0,d.jsx)("li",{children:"Create records for all discovered pages"})]})]}),(0,d.jsx)("p",{className:"text-sm text-emerald-800 mb-5 leading-relaxed",children:"This is a new website we have detected. Do you want to run the ingestion?"}),(0,d.jsx)("button",{onClick:b,disabled:f,className:"bg-gradient-to-r from-emerald-500 to-green-600 text-white py-3 px-8 rounded-xl font-semibold hover:from-emerald-600 hover:to-green-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:from-gray-400 disabled:to-gray-400 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl disabled:shadow-none transform hover:scale-[1.02] disabled:transform-none",children:f?(0,d.jsxs)("span",{className:"flex items-center gap-2",children:[(0,d.jsxs)("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[(0,d.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,d.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Starting Ingestion..."]}):"Run Ingestion"})]})]})});if("ingesting"===a.type){let b=a.progress?.percentage??0,c=a.progress?.completed??0,e=a.progress?.total??0;return(0,d.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 shadow-lg",children:(0,d.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-3 border-blue-200 border-t-blue-600"}),(0,d.jsx)("div",{className:"absolute inset-0 rounded-full border-3 border-transparent border-t-blue-400 animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]})}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("h3",{className:"text-xl font-bold text-blue-900 mb-2",children:"Ingestion in Progress"}),(0,d.jsx)("p",{className:"text-sm text-blue-800 mb-4 leading-relaxed",children:"This may take several minutes. The website is being crawled, scraped, and pages are being stored..."}),e>0&&(0,d.jsxs)("div",{className:"mb-2",children:[(0,d.jsxs)("div",{className:"flex justify-between text-xs text-blue-700 mb-1",children:[(0,d.jsx)("span",{children:"Scraping pages..."}),(0,d.jsxs)("span",{children:[c," / ",e," (",b,"%)"]})]}),(0,d.jsx)("div",{className:"mt-2 bg-blue-100 rounded-full h-3 overflow-hidden shadow-inner",children:(0,d.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full shadow-md transition-all duration-500",style:{width:`${Math.max(5,b)}%`}})})]}),0===e&&(0,d.jsx)("div",{className:"mt-4 bg-blue-100 rounded-full h-3 overflow-hidden shadow-inner",children:(0,d.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full animate-pulse shadow-md",style:{width:"30%"}})}),(0,d.jsx)("p",{className:"text-xs text-blue-600 mt-2 italic",children:"Please don't close this page"})]})]})})}return"ingested"===a.type?(0,d.jsx)("div",{className:"bg-gradient-to-br from-emerald-50 to-green-50 border-2 border-emerald-200 rounded-xl p-6 shadow-lg animate-in fade-in slide-in-from-bottom-4 duration-500",children:(0,d.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center",children:(0,d.jsx)("svg",{className:"h-7 w-7 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h3",{className:"text-xl font-bold text-emerald-900 mb-4",children:"Ingestion Completed Successfully! \uD83C\uDF89"}),(0,d.jsxs)("div",{className:"bg-white/70 rounded-lg p-4 mb-5 space-y-2.5",children:[(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-xs font-semibold text-emerald-700 uppercase tracking-wide",children:"Website ID"}),(0,d.jsx)("p",{className:"text-sm font-mono text-emerald-900 mt-1 bg-emerald-100 px-2 py-1 rounded",children:a.result.websiteId})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-xs font-semibold text-emerald-700 uppercase tracking-wide",children:"Domain"}),(0,d.jsx)("p",{className:"text-sm text-emerald-900 mt-1 font-semibold",children:a.result.domain})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-xs font-semibold text-emerald-700 uppercase tracking-wide",children:"Pages Discovered"}),(0,d.jsx)("p",{className:"text-2xl font-bold text-emerald-900 mt-1",children:a.result.pagesDiscovered})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-xs font-semibold text-emerald-700 uppercase tracking-wide",children:"Pages Scraped"}),(0,d.jsx)("p",{className:"text-2xl font-bold text-emerald-900 mt-1",children:a.result.pagesIndexed})]})]}),a.result.errors&&a.result.errors.length>0&&(0,d.jsx)("div",{className:"pt-2 border-t border-emerald-200",children:(0,d.jsxs)("p",{className:"text-xs text-amber-700",children:[(0,d.jsx)("strong",{children:"Errors:"})," ",a.result.errors.length]})})]}),(0,d.jsx)("p",{className:"text-sm text-emerald-800 mb-5 leading-relaxed",children:"The website has been ingested and pages have been scraped. Now you can run indexing to upload the content to Gemini File Search."}),(0,d.jsxs)("div",{className:"flex flex-wrap gap-3",children:[c&&a.result&&a.result.pagesIndexed>0&&(0,d.jsx)("button",{onClick:()=>c(a.websiteId),disabled:f,className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 px-8 rounded-xl font-semibold hover:from-blue-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:from-gray-400 disabled:to-gray-400 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl disabled:shadow-none transform hover:scale-[1.02] disabled:transform-none",children:f?(0,d.jsxs)("span",{className:"flex items-center gap-2",children:[(0,d.jsxs)("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[(0,d.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,d.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Starting Indexing..."]}):"Run Indexing"}),(0,d.jsx)("button",{onClick:e,className:"bg-gray-600 text-white py-3 px-6 rounded-xl font-semibold hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-[1.02]",children:"Ingest Another Website"})]})]})]})}):"indexing"===a.type?(0,d.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl p-6 shadow-lg",children:(0,d.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-3 border-blue-200 border-t-blue-600"}),(0,d.jsx)("div",{className:"absolute inset-0 rounded-full border-3 border-transparent border-t-blue-400 animate-spin",style:{animationDirection:"reverse",animationDuration:"1.5s"}})]})}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("h3",{className:"text-xl font-bold text-blue-900 mb-2",children:"Indexing in Progress"}),(0,d.jsx)("p",{className:"text-sm text-blue-800 mb-4 leading-relaxed",children:"Uploading scraped content to Gemini File Search. This may take several minutes depending on the number of pages..."}),(0,d.jsx)("div",{className:"mt-4 bg-blue-100 rounded-full h-3 overflow-hidden shadow-inner",children:(0,d.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full animate-pulse shadow-md",style:{width:"70%"}})}),(0,d.jsx)("p",{className:"text-xs text-blue-600 mt-2 italic",children:"Please don't close this page"})]})]})}):"indexed"===a.type?(0,d.jsx)("div",{className:"bg-gradient-to-br from-emerald-50 to-green-50 border-2 border-emerald-200 rounded-xl p-6 shadow-lg animate-in fade-in slide-in-from-bottom-4 duration-500",children:(0,d.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)("div",{className:"w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center",children:(0,d.jsx)("svg",{className:"h-7 w-7 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h3",{className:"text-xl font-bold text-emerald-900 mb-4",children:"Indexing Completed Successfully! \uD83D\uDE80"}),(0,d.jsxs)("div",{className:"bg-white/70 rounded-lg p-4 mb-5",children:[(0,d.jsxs)("div",{className:"flex items-baseline gap-2 mb-2",children:[(0,d.jsx)("span",{className:"text-xs font-semibold text-emerald-700 uppercase tracking-wide",children:"Pages Indexed"}),(0,d.jsx)("span",{className:"text-3xl font-bold text-emerald-900",children:a.result.pagesIndexed})]}),a.result.errors&&a.result.errors.length>0&&(0,d.jsx)("div",{className:"pt-2 border-t border-emerald-200",children:(0,d.jsxs)("p",{className:"text-xs text-amber-700",children:[(0,d.jsx)("strong",{children:"Errors:"})," ",a.result.errors.length]})})]}),(0,d.jsx)("p",{className:"text-sm text-emerald-800 mb-5 leading-relaxed",children:"All pages have been uploaded to Gemini File Search and are now searchable. You can now chat with this website!"}),(0,d.jsx)("button",{onClick:e,className:"bg-gradient-to-r from-emerald-500 to-green-600 text-white py-3 px-8 rounded-xl font-semibold hover:from-emerald-600 hover:to-green-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-[1.02]",children:"Ingest Another Website"})]})]})}):"error"===a.type?(0,d.jsx)("div",{className:"bg-gradient-to-br from-red-50 to-rose-50 border-2 border-red-200 rounded-xl p-6 shadow-lg animate-in fade-in slide-in-from-bottom-4 duration-500",children:(0,d.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center",children:(0,d.jsx)("svg",{className:"h-7 w-7 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h3",{className:"text-xl font-bold text-red-900 mb-3",children:"Error Occurred"}),(0,d.jsx)("div",{className:"bg-white/70 rounded-lg p-4 mb-5",children:(0,d.jsx)("p",{className:"text-sm text-red-800 leading-relaxed font-medium",children:a.message})}),(0,d.jsx)("button",{onClick:e,className:"bg-gradient-to-r from-red-500 to-red-600 text-white py-3 px-8 rounded-xl font-semibold hover:from-red-600 hover:to-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-[1.02]",children:"Try Again"})]})]})}):null}function k({url:a,displayName:b,onUrlChange:c,onDisplayNameChange:e,onCheck:f,disabled:g}){return(0,d.jsxs)("form",{onSubmit:a=>{a.preventDefault(),g||f()},className:"space-y-5",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{htmlFor:"url",className:"block text-sm font-semibold text-gray-700 mb-2.5",children:["Website URL ",(0,d.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:(0,d.jsx)("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),(0,d.jsx)("input",{id:"url",type:"url",value:a,onChange:a=>c(a.target.value),placeholder:"https://example.com",disabled:g,className:"w-full pl-12 pr-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed transition-all duration-200 text-gray-900 placeholder-gray-400",required:!0})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{htmlFor:"displayName",className:"block text-sm font-semibold text-gray-700 mb-2.5",children:["Display Name ",(0,d.jsx)("span",{className:"text-gray-400 font-normal",children:"(Optional)"})]}),(0,d.jsx)("input",{id:"displayName",type:"text",value:b,onChange:a=>e(a.target.value),placeholder:"My Website",disabled:g,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed transition-all duration-200 text-gray-900 placeholder-gray-400"}),(0,d.jsx)("p",{className:"mt-1.5 text-xs text-gray-500",children:"A friendly name to identify this website"})]}),(0,d.jsx)("button",{type:"submit",disabled:g||!a.trim(),className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 text-white py-3.5 px-6 rounded-xl font-semibold hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:from-gray-400 disabled:to-gray-400 disabled:cursor-not-allowed transition-all duration-200 shadow-lg hover:shadow-xl disabled:shadow-none transform hover:scale-[1.02] disabled:transform-none",children:g?(0,d.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,d.jsxs)("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[(0,d.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,d.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Checking..."]}):"Check Website"})]})}function l(){let[a,b]=(0,e.useState)(""),[c,f]=(0,e.useState)(""),[l,m]=(0,e.useState)({type:"idle"}),[o,p]=(0,e.useTransition)();(0,e.useRef)(null);let q=async()=>{if(!a.trim())return void m({type:"error",message:"Please enter a URL"});m({type:"checking"}),p(async()=>{let b=await g(a);if(!b.success)return void m({type:"error",message:b.error||"Failed to check website"});b.data?.exists?m({type:"exists",website:b.data.website,domain:b.data.domain}):m({type:"new",domain:b.data?.domain||""})})},r=async()=>{if(!a.trim())return void m({type:"error",message:"Please enter a URL"});p(async()=>{let b=await h(a,c||void 0);if(!b.success)return void m({type:"error",message:b.error||"Failed to ingest website"});b.jobId&&b.data?m({type:"ingesting",websiteId:b.data.websiteId,jobId:b.jobId}):b.data?m({type:"ingested",result:b.data,websiteId:b.data.websiteId}):m({type:"error",message:"Unexpected response from ingestion"})})},s=async a=>{m({type:"indexing",websiteId:a}),p(async()=>{let b=await i(a);if(!b.success)return void m({type:"error",message:b.error||"Failed to run indexing"});m({type:"indexed",result:b.data})})};return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)(k,{url:a,displayName:c,onUrlChange:b,onDisplayNameChange:f,onCheck:q,disabled:o||"checking"===l.type||"ingesting"===l.type||"indexing"===l.type}),(0,d.jsx)(j,{status:l,onIngest:r,onIndexing:s,onReset:()=>{b(""),f(""),m({type:"idle"})},isPending:o})]})}},69620:a=>{"use strict";a.exports=JSON.parse('{"name":"dotenv","version":"16.6.1","description":"Loads environment variables from .env file","main":"lib/main.js","types":"lib/main.d.ts","exports":{".":{"types":"./lib/main.d.ts","require":"./lib/main.js","default":"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},"scripts":{"dts-check":"tsc --project tests/types/tsconfig.json","lint":"standard","pretest":"npm run lint && npm run dts-check","test":"tap run --allow-empty-coverage --disable-coverage --timeout=60000","test:coverage":"tap run --show-full-coverage --timeout=60000 --coverage-report=text --coverage-report=lcov","prerelease":"npm test","release":"standard-version"},"repository":{"type":"git","url":"git://github.com/motdotla/dotenv.git"},"homepage":"https://github.com/motdotla/dotenv#readme","funding":"https://dotenvx.com","keywords":["dotenv","env",".env","environment","variables","config","settings"],"readmeFilename":"README.md","license":"BSD-2-Clause","devDependencies":{"@types/node":"^18.11.3","decache":"^4.6.2","sinon":"^14.0.1","standard":"^17.0.0","standard-version":"^9.5.0","tap":"^19.2.0","typescript":"^4.8.4"},"engines":{"node":">=12"},"browser":{"fs":false}}')},71823:(a,b)=>{"use strict";function c(a,b){if(0===b.length)return 0;if(0===a.length||b.length>a.length)return -1;for(let c=0;c<=a.length-b.length;c++){let d=!0;for(let e=0;e<b.length;e++)if(a[c+e]!==b[e]){d=!1;break}if(d)return c}return -1}function d(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0}function e(a,b){let d=c(a,b);if(0===d)return a.subarray(b.length);if(!(d>-1))return a;{let c=new Uint8Array(a.length-b.length);return c.set(a.slice(0,d)),c.set(a.slice(d+b.length),d),c}}Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{indexOfUint8Array:function(){return c},isEquivalentUint8Arrays:function(){return d},removeFromUint8Array:function(){return e}})},72326:()=>{},73024:a=>{"use strict";a.exports=require("node:fs")},73048:function(a,b,c){"use strict";var d=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(b,"__esModule",{value:!0}),b.GaxiosError=b.GAXIOS_ERROR_SYMBOL=void 0,b.defaultErrorRedactor=function a(b){let c="<<REDACTED> - See `errorRedactor` option in `gaxios` for configuration>.";function d(a){a&&a.forEach((b,d)=>{(/^authentication$/i.test(d)||/^authorization$/i.test(d)||/secret/i.test(d))&&a.set(d,c)})}function e(a,b){if("object"==typeof a&&null!==a&&"string"==typeof a[b]){let d=a[b];(/grant_type=/i.test(d)||/assertion=/i.test(d)||/secret/i.test(d))&&(a[b]=c)}}function f(a){a&&"object"==typeof a&&(a instanceof FormData||a instanceof URLSearchParams||"forEach"in a&&"set"in a?a.forEach((b,d)=>{(["grant_type","assertion"].includes(d)||/secret/.test(d))&&a.set(d,c)}):("grant_type"in a&&(a.grant_type=c),"assertion"in a&&(a.assertion=c),"client_secret"in a&&(a.client_secret=c)))}return b.config&&(d(b.config.headers),e(b.config,"data"),f(b.config.data),e(b.config,"body"),f(b.config.body),b.config.url.searchParams.has("token")&&b.config.url.searchParams.set("token",c),b.config.url.searchParams.has("client_secret")&&b.config.url.searchParams.set("client_secret",c)),b.response&&(a({config:b.response.config}),d(b.response.headers),b.response.bodyUsed&&(e(b.response,"data"),f(b.response.data))),b};let e=d(c(47572)),f=d(c(63596)).default.pkg;b.GAXIOS_ERROR_SYMBOL=Symbol.for(`${f.name}-gaxios-error`);class g extends Error{config;response;code;status;error;[b.GAXIOS_ERROR_SYMBOL]=f.version;static[Symbol.hasInstance](a){return!!a&&"object"==typeof a&&b.GAXIOS_ERROR_SYMBOL in a&&a[b.GAXIOS_ERROR_SYMBOL]===f.version||Function.prototype[Symbol.hasInstance].call(g,a)}constructor(a,b,c,d){if(super(a,{cause:d}),this.config=b,this.response=c,this.error=d instanceof Error?d:void 0,this.config=(0,e.default)(!0,{},b),this.response&&(this.response.config=(0,e.default)(!0,{},this.response.config)),this.response){try{this.response.data=function(a,b){switch(a){case"stream":default:return b;case"json":return JSON.parse(JSON.stringify(b));case"arraybuffer":return JSON.parse(Buffer.from(b).toString("utf8"));case"blob":return JSON.parse(b.text())}}(this.config.responseType,this.response?.bodyUsed?this.response?.data:void 0)}catch{}this.status=this.response.status}d instanceof DOMException?this.code=d.name:d&&"object"==typeof d&&"code"in d&&("string"==typeof d.code||"number"==typeof d.code)&&(this.code=d.code)}static extractAPIErrorFromResponse(a,b="The request failed"){let c=b;if("string"==typeof a.data&&(c=a.data),a.data&&"object"==typeof a.data&&"error"in a.data&&a.data.error&&!a.ok){if("string"==typeof a.data.error)return{message:a.data.error,code:a.status,status:a.statusText};if("object"==typeof a.data.error){c="message"in a.data.error&&"string"==typeof a.data.error.message?a.data.error.message:c;let b="status"in a.data.error&&"string"==typeof a.data.error.status?a.data.error.status:a.statusText,d="code"in a.data.error&&"number"==typeof a.data.error.code?a.data.error.code:a.status;if("errors"in a.data.error&&Array.isArray(a.data.error.errors)){let e=[];for(let b of a.data.error.errors)"object"==typeof b&&"message"in b&&"string"==typeof b.message&&e.push(b.message);return Object.assign({message:e.join("\n")||c,code:d,status:b},a.data.error)}return Object.assign({message:c,code:d,status:b},a.data.error)}}return{message:c,code:a.status,status:a.statusText}}}b.GaxiosError=g},73136:a=>{"use strict";a.exports=require("node:url")},73144:(a,b,c)=>{Promise.resolve().then(c.bind(c,85139))},73181:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(41119).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\chira\\\\Downloads\\\\Local - HQ - Master\\\\Coding\\\\website-data-mcp-server-project-gemini-file-search\\\\apps\\\\web\\\\app\\\\error.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\chira\\Downloads\\Local - HQ - Master\\Coding\\website-data-mcp-server-project-gemini-file-search\\apps\\web\\app\\error.tsx","default")},73280:(a,b,c)=>{"use strict";let d,{Duplex:e}=c(27910),{randomFillSync:f}=c(55511),g=c(7775),{EMPTY_BUFFER:h,kWebSocket:i,NOOP:j}=c(40826),{isBlob:k,isValidStatusCode:l}=c(83170),{mask:m,toBuffer:o}=c(65158),p=Symbol("kByteLength"),q=Buffer.alloc(4),r=8192;class s{constructor(a,b,c){this._extensions=b||{},c&&(this._generateMask=c,this._maskBuffer=Buffer.alloc(4)),this._socket=a,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._queue=[],this._state=0,this.onerror=j,this[i]=void 0}static frame(a,b){let c,e,g=!1,h=2,i=!1;b.mask&&(c=b.maskBuffer||q,b.generateMask?b.generateMask(c):(8192===r&&(void 0===d&&(d=Buffer.alloc(8192)),f(d,0,8192),r=0),c[0]=d[r++],c[1]=d[r++],c[2]=d[r++],c[3]=d[r++]),i=(c[0]|c[1]|c[2]|c[3])==0,h=6),"string"==typeof a?e=(!b.mask||i)&&void 0!==b[p]?b[p]:(a=Buffer.from(a)).length:(e=a.length,g=b.mask&&b.readOnly&&!i);let j=e;e>=65536?(h+=8,j=127):e>125&&(h+=2,j=126);let k=Buffer.allocUnsafe(g?e+h:h);return(k[0]=b.fin?128|b.opcode:b.opcode,b.rsv1&&(k[0]|=64),k[1]=j,126===j?k.writeUInt16BE(e,2):127===j&&(k[2]=k[3]=0,k.writeUIntBE(e,4,6)),b.mask)?(k[1]|=128,k[h-4]=c[0],k[h-3]=c[1],k[h-2]=c[2],k[h-1]=c[3],i)?[k,a]:g?(m(a,c,k,h,e),[k]):(m(a,c,a,0,e),[k,a]):[k,a]}close(a,b,c,d){let e;if(void 0===a)e=h;else if("number"==typeof a&&l(a))if(void 0!==b&&b.length){let c=Buffer.byteLength(b);if(c>123)throw RangeError("The message must not be greater than 123 bytes");(e=Buffer.allocUnsafe(2+c)).writeUInt16BE(a,0),"string"==typeof b?e.write(b,2):e.set(b,2)}else(e=Buffer.allocUnsafe(2)).writeUInt16BE(a,0);else throw TypeError("First argument must be a valid error code number");let f={[p]:e.length,fin:!0,generateMask:this._generateMask,mask:c,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};0!==this._state?this.enqueue([this.dispatch,e,!1,f,d]):this.sendFrame(s.frame(e,f),d)}ping(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=o(a)).length,e=o.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[p]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:9,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(s.frame(a,f),c)}pong(a,b,c){let d,e;if("string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=o(a)).length,e=o.readOnly),d>125)throw RangeError("The data size must not be greater than 125 bytes");let f={[p]:d,fin:!0,generateMask:this._generateMask,mask:b,maskBuffer:this._maskBuffer,opcode:10,readOnly:e,rsv1:!1};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,!1,f,c]):this.getBlobData(a,!1,f,c):0!==this._state?this.enqueue([this.dispatch,a,!1,f,c]):this.sendFrame(s.frame(a,f),c)}send(a,b,c){let d,e,f=this._extensions[g.extensionName],h=b.binary?2:1,i=b.compress;"string"==typeof a?(d=Buffer.byteLength(a),e=!1):k(a)?(d=a.size,e=!1):(d=(a=o(a)).length,e=o.readOnly),this._firstFragment?(this._firstFragment=!1,i&&f&&f.params[f._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(i=d>=f._threshold),this._compress=i):(i=!1,h=0),b.fin&&(this._firstFragment=!0);let j={[p]:d,fin:b.fin,generateMask:this._generateMask,mask:b.mask,maskBuffer:this._maskBuffer,opcode:h,readOnly:e,rsv1:i};k(a)?0!==this._state?this.enqueue([this.getBlobData,a,this._compress,j,c]):this.getBlobData(a,this._compress,j,c):0!==this._state?this.enqueue([this.dispatch,a,this._compress,j,c]):this.dispatch(a,this._compress,j,c)}getBlobData(a,b,c,d){this._bufferedBytes+=c[p],this._state=2,a.arrayBuffer().then(a=>{if(this._socket.destroyed){let a=Error("The socket was closed while the blob was being read");process.nextTick(t,this,a,d);return}this._bufferedBytes-=c[p];let e=o(a);b?this.dispatch(e,b,c,d):(this._state=0,this.sendFrame(s.frame(e,c),d),this.dequeue())}).catch(a=>{process.nextTick(u,this,a,d)})}dispatch(a,b,c,d){if(!b)return void this.sendFrame(s.frame(a,c),d);let e=this._extensions[g.extensionName];this._bufferedBytes+=c[p],this._state=1,e.compress(a,c.fin,(a,b)=>{if(this._socket.destroyed)return void t(this,Error("The socket was closed while data was being compressed"),d);this._bufferedBytes-=c[p],this._state=0,c.readOnly=!1,this.sendFrame(s.frame(b,c),d),this.dequeue()})}dequeue(){for(;0===this._state&&this._queue.length;){let a=this._queue.shift();this._bufferedBytes-=a[3][p],Reflect.apply(a[0],this,a.slice(1))}}enqueue(a){this._bufferedBytes+=a[3][p],this._queue.push(a)}sendFrame(a,b){2===a.length?(this._socket.cork(),this._socket.write(a[0]),this._socket.write(a[1],b),this._socket.uncork()):this._socket.write(a[0],b)}}function t(a,b,c){"function"==typeof c&&c(b);for(let c=0;c<a._queue.length;c++){let d=a._queue[c],e=d[d.length-1];"function"==typeof e&&e(b)}}function u(a,b,c){t(a,b,c),a.onerror(b)}a.exports=s},73566:a=>{"use strict";a.exports=require("worker_threads")},74012:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,784,23))},74067:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.Colours=void 0;class c{static isEnabled(a){return a&&a.isTTY&&("function"!=typeof a.getColorDepth||a.getColorDepth()>2)}static refresh(){c.enabled=c.isEnabled(null==process?void 0:process.stderr),this.enabled?(c.reset="\x1b[0m",c.bright="\x1b[1m",c.dim="\x1b[2m",c.red="\x1b[31m",c.green="\x1b[32m",c.yellow="\x1b[33m",c.blue="\x1b[34m",c.magenta="\x1b[35m",c.cyan="\x1b[36m",c.white="\x1b[37m",c.grey="\x1b[90m"):(c.reset="",c.bright="",c.dim="",c.red="",c.green="",c.yellow="",c.blue="",c.magenta="",c.cyan="",c.white="",c.grey="")}}b.Colours=c,c.enabled=!1,c.reset="",c.bright="",c.dim="",c.red="",c.green="",c.yellow="",c.blue="",c.magenta="",c.cyan="",c.white="",c.grey="",c.refresh()},74075:a=>{"use strict";a.exports=require("zlib")},74860:(a,b,c)=>{"use strict";var d=c(63815).Buffer,e=c(29315);function f(a){if(d.isBuffer(a))return a;if("string"==typeof a)return d.from(a,"base64");throw TypeError("ECDSA signature must be a Base64 string or a Buffer")}function g(a,b,c){for(var d=0;b+d<c&&0===a[b+d];)++d;return a[b+d]>=128&&--d,d}a.exports={derToJose:function(a,b){a=f(a);var c=e(b),g=c+1,h=a.length,i=0;if(48!==a[i++])throw Error('Could not find expected "seq"');var j=a[i++];if(129===j&&(j=a[i++]),h-i<j)throw Error('"seq" specified length of "'+j+'", only "'+(h-i)+'" remaining');if(2!==a[i++])throw Error('Could not find expected "int" for "r"');var k=a[i++];if(h-i-2<k)throw Error('"r" specified length of "'+k+'", only "'+(h-i-2)+'" available');if(g<k)throw Error('"r" specified length of "'+k+'", max of "'+g+'" is acceptable');var l=i;if(i+=k,2!==a[i++])throw Error('Could not find expected "int" for "s"');var m=a[i++];if(h-i!==m)throw Error('"s" specified length of "'+m+'", expected "'+(h-i)+'"');if(g<m)throw Error('"s" specified length of "'+m+'", max of "'+g+'" is acceptable');var o=i;if((i+=m)!==h)throw Error('Expected to consume entire buffer, but "'+(h-i)+'" bytes remain');var p=c-k,q=c-m,r=d.allocUnsafe(p+k+q+m);for(i=0;i<p;++i)r[i]=0;a.copy(r,i,l+Math.max(-p,0),l+k),i=c;for(var s=i;i<s+q;++i)r[i]=0;return a.copy(r,i,o+Math.max(-q,0),o+m),r=(r=r.toString("base64")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},joseToDer:function(a,b){a=f(a);var c=e(b),h=a.length;if(h!==2*c)throw TypeError('"'+b+'" signatures must be "'+2*c+'" bytes, saw "'+h+'"');var i=g(a,0,c),j=g(a,c,a.length),k=c-i,l=c-j,m=2+k+1+1+l,o=m<128,p=d.allocUnsafe((o?2:3)+m),q=0;return p[q++]=48,o?p[q++]=m:(p[q++]=129,p[q++]=255&m),p[q++]=2,p[q++]=k,i<0?(p[q++]=0,q+=a.copy(p,q,0,c)):q+=a.copy(p,q,i,c),p[q++]=2,p[q++]=l,j<0?(p[q++]=0,a.copy(p,q,c)):a.copy(p,q,c+j),p}}},75623:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>g});var d=c(88239),e=c(99198),f=c.n(e);function g(){return(0,d.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-slate-100 flex items-center justify-center px-4",children:(0,d.jsxs)("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 border border-gray-100 text-center",children:[(0,d.jsxs)("div",{className:"flex items-center justify-center gap-3 mb-4",children:[(0,d.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center",children:(0,d.jsx)("svg",{className:"w-7 h-7 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,d.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"404 - Page Not Found"})]}),(0,d.jsx)("p",{className:"text-gray-600 mb-6",children:"The page you're looking for doesn't exist or has been moved."}),(0,d.jsx)(f(),{href:"/",className:"inline-block bg-blue-600 text-white py-3 px-8 rounded-xl font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"Go to Home"})]})})}},75690:(a,b,c)=>{"use strict";let{tokenChars:d}=c(83170);function e(a,b,c){void 0===a[b]?a[b]=[c]:a[b].push(c)}a.exports={format:function(a){return Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>[b].concat(Object.keys(a).map(b=>{let c=a[b];return Array.isArray(c)||(c=[c]),c.map(a=>!0===a?b:`${b}=${a}`).join("; ")})).join("; ")).join(", ")}).join(", ")},parse:function(a){let b,c,f=Object.create(null),g=Object.create(null),h=!1,i=!1,j=!1,k=-1,l=-1,m=-1,o=0;for(;o<a.length;o++)if(l=a.charCodeAt(o),void 0===b)if(-1===m&&1===d[l])-1===k&&(k=o);else if(0!==o&&(32===l||9===l))-1===m&&-1!==k&&(m=o);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${o}`);-1===m&&(m=o);let c=a.slice(k,m);44===l?(e(f,c,g),g=Object.create(null)):b=c,k=m=-1}else throw SyntaxError(`Unexpected character at index ${o}`);else if(void 0===c)if(-1===m&&1===d[l])-1===k&&(k=o);else if(32===l||9===l)-1===m&&-1!==k&&(m=o);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${o}`);-1===m&&(m=o),e(g,a.slice(k,m),!0),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),k=m=-1}else if(61===l&&-1!==k&&-1===m)c=a.slice(k,o),k=m=-1;else throw SyntaxError(`Unexpected character at index ${o}`);else if(i){if(1!==d[l])throw SyntaxError(`Unexpected character at index ${o}`);-1===k?k=o:h||(h=!0),i=!1}else if(j)if(1===d[l])-1===k&&(k=o);else if(34===l&&-1!==k)j=!1,m=o;else if(92===l)i=!0;else throw SyntaxError(`Unexpected character at index ${o}`);else if(34===l&&61===a.charCodeAt(o-1))j=!0;else if(-1===m&&1===d[l])-1===k&&(k=o);else if(-1!==k&&(32===l||9===l))-1===m&&(m=o);else if(59===l||44===l){if(-1===k)throw SyntaxError(`Unexpected character at index ${o}`);-1===m&&(m=o);let d=a.slice(k,m);h&&(d=d.replace(/\\/g,""),h=!1),e(g,c,d),44===l&&(e(f,b,g),g=Object.create(null),b=void 0),c=void 0,k=m=-1}else throw SyntaxError(`Unexpected character at index ${o}`);if(-1===k||j||32===l||9===l)throw SyntaxError("Unexpected end of input");-1===m&&(m=o);let p=a.slice(k,m);return void 0===b?e(f,p,g):(void 0===c?e(g,p,!0):h?e(g,c,p.replace(/\\/g,"")):e(g,c,p),e(f,b,g)),f}}},76024:(a,b,c)=>{var d,e=c(63815).Buffer,f=c(55511),g=c(74860),h=c(28354),i="secret must be a string or buffer",j="key must be a string or a buffer",k="function"==typeof f.createPublicKey;function l(a){if(!e.isBuffer(a)&&"string"!=typeof a&&(!k||"object"!=typeof a||"string"!=typeof a.type||"string"!=typeof a.asymmetricKeyType||"function"!=typeof a.export))throw q(j)}function m(a){if(!e.isBuffer(a)&&"string"!=typeof a&&"object"!=typeof a)throw q("key must be a string, a buffer or an object")}function o(a){return a.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function p(a){var b=4-(a=a.toString()).length%4;if(4!==b)for(var c=0;c<b;++c)a+="=";return a.replace(/\-/g,"+").replace(/_/g,"/")}function q(a){var b=[].slice.call(arguments,1);return TypeError(h.format.bind(h,a).apply(null,b))}function r(a){var b;return b=a,e.isBuffer(b)||"string"==typeof b||(a=JSON.stringify(a)),a}function s(a){return function(b,c){!function(a){if(!e.isBuffer(a)){if("string"!=typeof a){if(!k||"object"!=typeof a||"secret"!==a.type||"function"!=typeof a.export)throw q(i)}}}(c),b=r(b);var d=f.createHmac("sha"+a,c);return o((d.update(b),d.digest("base64")))}}k&&(j+=" or a KeyObject",i+="or a KeyObject");var t="timingSafeEqual"in f?function(a,b){return a.byteLength===b.byteLength&&f.timingSafeEqual(a,b)}:function(a,b){return d||(d=c(18761)),d(a,b)};function u(a){return function(b,c,d){var f=s(a)(b,d);return t(e.from(c),e.from(f))}}function v(a){return function(b,c){m(c),b=r(b);var d=f.createSign("RSA-SHA"+a);return o((d.update(b),d.sign(c,"base64")))}}function w(a){return function(b,c,d){l(d),b=r(b),c=p(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify(d,c,"base64")}}function x(a){return function(b,c){m(c),b=r(b);var d=f.createSign("RSA-SHA"+a);return o((d.update(b),d.sign({key:c,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},"base64")))}}function y(a){return function(b,c,d){l(d),b=r(b),c=p(c);var e=f.createVerify("RSA-SHA"+a);return e.update(b),e.verify({key:d,padding:f.constants.RSA_PKCS1_PSS_PADDING,saltLength:f.constants.RSA_PSS_SALTLEN_DIGEST},c,"base64")}}function z(a){var b=v(a);return function(){var c=b.apply(null,arguments);return g.derToJose(c,"ES"+a)}}function A(a){var b=w(a);return function(c,d,e){return b(c,d=g.joseToDer(d,"ES"+a).toString("base64"),e)}}function B(){return function(){return""}}function C(){return function(a,b){return""===b}}a.exports=function(a){var b=a.match(/^(RS|PS|ES|HS)(256|384|512)$|^(none)$/);if(!b)throw q('"%s" is not a valid algorithm.\n  Supported algorithms are:\n  "HS256", "HS384", "HS512", "RS256", "RS384", "RS512", "PS256", "PS384", "PS512", "ES256", "ES384", "ES512" and "none".',a);var c=(b[1]||b[3]).toLowerCase(),d=b[2];return{sign:({hs:s,rs:v,ps:x,es:z,none:B})[c](d),verify:({hs:u,rs:w,ps:y,es:A,none:C})[c](d)}}},76182:(a,b,c)=>{"use strict";let d=c(20989),{redactFmtSym:e,wildcardFirstSym:f}=c(22782),g=/[^.[\]]+|\[([^[\]]*?)\]/g,h="[Redacted]";a.exports=function(a,b){let{paths:c,censor:i,remove:j}=function(a){if(Array.isArray(a))return{paths:a,censor:h};let{paths:b,censor:c=h,remove:d}=a;if(!1===Array.isArray(b))throw Error("pino  redact must contain an array of strings");return!0===d&&(c=void 0),{paths:b,censor:c,remove:d}}(a),k=c.reduce((a,b)=>{g.lastIndex=0;let c=g.exec(b),d=g.exec(b),e=void 0!==c[1]?c[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):c[0];if("*"===e&&(e=f),null===d)return a[e]=null,a;if(null===a[e])return a;let{index:h}=d,i=`${b.substr(h,b.length-1)}`;return a[e]=a[e]||[],e!==f&&0===a[e].length&&a[e].push(...a[f]||[]),e===f&&Object.keys(a).forEach(function(b){a[b]&&a[b].push(i)}),a[e].push(i),a},{}),l={[e]:d({paths:c,censor:i,serialize:b,strict:!1,remove:j})};return[...Object.keys(k),...Object.getOwnPropertySymbols(k)].reduce((a,c)=>{if(null===k[c])a[c]=a=>((...a)=>"function"==typeof i?b(i(...a)):b(i))(a,[c]);else{let e="function"==typeof i?(a,b)=>i(a,[c,...b]):i;a[c]=d({paths:k[c],censor:e,serialize:b,strict:!1,remove:j})}return a},l)}},76247:(a,b,c)=>{"use strict";a.exports=c(64073).vendored["react-rsc"].React},76587:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.GoogleAuth=b.GoogleAuthExceptionMessages=void 0;let d=c(79646),e=c(29021),f=c(15921),g=c(15400),h=c(21820),i=c(33873),j=c(88748),k=c(33874),l=c(30251),m=c(6148),o=c(78062),p=c(58912),q=c(66961),r=c(84068),s=c(8011),t=c(62783),u=c(67533),v=c(21827);b.GoogleAuthExceptionMessages={API_KEY_WITH_CREDENTIALS:"API Keys and Credentials are mutually exclusive authentication methods and cannot be used together.",NO_PROJECT_ID_FOUND:"Unable to detect a Project Id in the current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_CREDENTIALS_FOUND:"Unable to find credentials in current environment. \nTo learn more about authentication and Google APIs, visit: \nhttps://cloud.google.com/docs/authentication/getting-started",NO_ADC_FOUND:"Could not load the default credentials. Browse to https://cloud.google.com/docs/authentication/getting-started for more information.",NO_UNIVERSE_DOMAIN_FOUND:"Unable to detect a Universe Domain in the current environment.\nTo learn more about Universe Domain retrieval, visit: \nhttps://cloud.google.com/compute/docs/metadata/predefined-metadata-keys"};class w{checkIsGCE=void 0;useJWTAccessWithScope;defaultServicePath;get isGCE(){return this.checkIsGCE}_findProjectIdPromise;_cachedProjectId;jsonContent=null;apiKey;cachedCredential=null;#q=null;defaultScopes;keyFilename;scopes;clientOptions={};constructor(a={}){if(this._cachedProjectId=a.projectId||null,this.cachedCredential=a.authClient||null,this.keyFilename=a.keyFilename||a.keyFile,this.scopes=a.scopes,this.clientOptions=a.clientOptions||{},this.jsonContent=a.credentials||null,this.apiKey=a.apiKey||this.clientOptions.apiKey||null,this.apiKey&&(this.jsonContent||this.clientOptions.credentials))throw RangeError(b.GoogleAuthExceptionMessages.API_KEY_WITH_CREDENTIALS);a.universeDomain&&(this.clientOptions.universeDomain=a.universeDomain)}setGapicJWTValues(a){a.defaultServicePath=this.defaultServicePath,a.useJWTAccessWithScope=this.useJWTAccessWithScope,a.defaultScopes=this.defaultScopes}getProjectId(a){if(!a)return this.getProjectIdAsync();this.getProjectIdAsync().then(b=>a(null,b),a)}async getProjectIdOptional(){try{return await this.getProjectId()}catch(a){if(a instanceof Error&&a.message===b.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)return null;throw a}}async findAndCacheProjectId(){let a=null;if(a||=await this.getProductionProjectId(),a||=await this.getFileProjectId(),a||=await this.getDefaultServiceProjectId(),a||=await this.getGCEProjectId(),a||=await this.getExternalAccountClientProjectId())return this._cachedProjectId=a,a;throw Error(b.GoogleAuthExceptionMessages.NO_PROJECT_ID_FOUND)}async getProjectIdAsync(){return this._cachedProjectId?this._cachedProjectId:(this._findProjectIdPromise||(this._findProjectIdPromise=this.findAndCacheProjectId()),this._findProjectIdPromise)}async getUniverseDomainFromMetadataServer(){let a;try{a=await g.universe("universe-domain"),a||=t.DEFAULT_UNIVERSE}catch(b){if(b&&b?.response?.status===404)a=t.DEFAULT_UNIVERSE;else throw b}return a}async getUniverseDomain(){let a=(0,v.originalOrCamelOptions)(this.clientOptions).get("universe_domain");try{a??=(await this.getClient()).universeDomain}catch{a??=t.DEFAULT_UNIVERSE}return a}getAnyScopes(){return this.scopes||this.defaultScopes}getApplicationDefault(a={},b){let c;if("function"==typeof a?b=a:c=a,!b)return this.getApplicationDefaultAsync(c);this.getApplicationDefaultAsync(c).then(a=>b(null,a.credential,a.projectId),b)}async getApplicationDefaultAsync(a={}){let c;if(this.cachedCredential)return await this.#r(this.cachedCredential,null);if((c=await this._tryGetApplicationCredentialsFromEnvironmentVariable(a))||(c=await this._tryGetApplicationCredentialsFromWellKnownFile(a)))return c instanceof o.JWT?c.scopes=this.scopes:c instanceof s.BaseExternalAccountClient&&(c.scopes=this.getAnyScopes()),await this.#r(c);if(await this._checkIsGCE())return a.scopes=this.getAnyScopes(),await this.#r(new k.Compute(a));throw Error(b.GoogleAuthExceptionMessages.NO_ADC_FOUND)}async #r(a,b=process.env.GOOGLE_CLOUD_QUOTA_PROJECT||null){let c=await this.getProjectIdOptional();return b&&(a.quotaProjectId=b),this.cachedCredential=a,{credential:a,projectId:c}}async _checkIsGCE(){return void 0===this.checkIsGCE&&(this.checkIsGCE=g.getGCPResidency()||await g.isAvailable()),this.checkIsGCE}async _tryGetApplicationCredentialsFromEnvironmentVariable(a){let b=process.env.GOOGLE_APPLICATION_CREDENTIALS||process.env.google_application_credentials;if(!b||0===b.length)return null;try{return this._getApplicationCredentialsFromFilePath(b,a)}catch(a){throw a instanceof Error&&(a.message=`Unable to read the credential file specified by the GOOGLE_APPLICATION_CREDENTIALS environment variable: ${a.message}`),a}}async _tryGetApplicationCredentialsFromWellKnownFile(a){let b=null;if(this._isWindows())b=process.env.APPDATA;else{let a=process.env.HOME;a&&(b=i.join(a,".config"))}return(b&&(b=i.join(b,"gcloud","application_default_credentials.json"),e.existsSync(b)||(b=null)),b)?await this._getApplicationCredentialsFromFilePath(b,a):null}async _getApplicationCredentialsFromFilePath(a,b={}){if(!a||0===a.length)throw Error("The file path is invalid.");try{if(a=e.realpathSync(a),!e.lstatSync(a).isFile())throw Error()}catch(b){throw b instanceof Error&&(b.message=`The file at ${a} does not exist, or it is not a file. ${b.message}`),b}let c=e.createReadStream(a);return this.fromStream(c,b)}fromImpersonatedJSON(a){if(!a)throw Error("Must pass in a JSON object containing an  impersonated refresh token");if(a.type!==q.IMPERSONATED_ACCOUNT_TYPE)throw Error(`The incoming JSON object does not have the "${q.IMPERSONATED_ACCOUNT_TYPE}" type`);if(!a.source_credentials)throw Error("The incoming JSON object does not contain a source_credentials field");if(!a.service_account_impersonation_url)throw Error("The incoming JSON object does not contain a service_account_impersonation_url field");let b=this.fromJSON(a.source_credentials);if(a.service_account_impersonation_url?.length>256)throw RangeError(`Target principal is too long: ${a.service_account_impersonation_url}`);let c=/(?<target>[^/]+):(generateAccessToken|generateIdToken)$/.exec(a.service_account_impersonation_url)?.groups?.target;if(!c)throw RangeError(`Cannot extract target principal from ${a.service_account_impersonation_url}`);let d=(this.scopes||a.scopes||this.defaultScopes)??[];return new q.Impersonated({...a,sourceClient:b,targetPrincipal:c,targetScopes:Array.isArray(d)?d:[d]})}fromJSON(a,b={}){let c,d=(0,v.originalOrCamelOptions)(b).get("universe_domain");return a.type===p.USER_REFRESH_ACCOUNT_TYPE?(c=new p.UserRefreshClient(b)).fromJSON(a):a.type===q.IMPERSONATED_ACCOUNT_TYPE?c=this.fromImpersonatedJSON(a):a.type===s.EXTERNAL_ACCOUNT_TYPE?(c=r.ExternalAccountClient.fromJSON({...a,...b})).scopes=this.getAnyScopes():a.type===u.EXTERNAL_ACCOUNT_AUTHORIZED_USER_TYPE?c=new u.ExternalAccountAuthorizedUserClient({...a,...b}):(b.scopes=this.scopes,c=new o.JWT(b),this.setGapicJWTValues(c),c.fromJSON(a)),d&&(c.universeDomain=d),c}_cacheClientFromJSON(a,b){let c=this.fromJSON(a,b);return this.jsonContent=a,this.cachedCredential=c,c}fromStream(a,b={},c){let d={};if("function"==typeof b?c=b:d=b,!c)return this.fromStreamAsync(a,d);this.fromStreamAsync(a,d).then(a=>c(null,a),c)}fromStreamAsync(a,b){return new Promise((c,d)=>{if(!a)throw Error("Must pass in a stream containing the Google auth settings.");let e=[];a.setEncoding("utf8").on("error",d).on("data",a=>e.push(a)).on("end",()=>{try{try{let a=JSON.parse(e.join("")),d=this._cacheClientFromJSON(a,b);return c(d)}catch(b){if(!this.keyFilename)throw b;let a=new o.JWT({...this.clientOptions,keyFile:this.keyFilename});return this.cachedCredential=a,this.setGapicJWTValues(a),c(a)}}catch(a){return d(a)}})})}fromAPIKey(a,b={}){return new o.JWT({...b,apiKey:a})}_isWindows(){let a=h.platform();return!!a&&!!(a.length>=3)&&"win"===a.substring(0,3).toLowerCase()}async getDefaultServiceProjectId(){return new Promise(a=>{(0,d.exec)("gcloud config config-helper --format json",(b,c)=>{if(!b&&c)try{let b=JSON.parse(c).configuration.properties.core.project;a(b);return}catch(a){}a(null)})})}getProductionProjectId(){return process.env.GCLOUD_PROJECT||process.env.GOOGLE_CLOUD_PROJECT||process.env.gcloud_project||process.env.google_cloud_project}async getFileProjectId(){if(this.cachedCredential)return this.cachedCredential.projectId;if(this.keyFilename){let a=await this.getClient();if(a&&a.projectId)return a.projectId}let a=await this._tryGetApplicationCredentialsFromEnvironmentVariable();return a?a.projectId:null}async getExternalAccountClientProjectId(){if(!this.jsonContent||this.jsonContent.type!==s.EXTERNAL_ACCOUNT_TYPE)return null;let a=await this.getClient();return await a.getProjectId()}async getGCEProjectId(){try{return await g.project("project-id")}catch(a){return null}}getCredentials(a){if(!a)return this.getCredentialsAsync();this.getCredentialsAsync().then(b=>a(null,b),a)}async getCredentialsAsync(){let a=await this.getClient();if(a instanceof q.Impersonated)return{client_email:a.getTargetPrincipal()};if(a instanceof s.BaseExternalAccountClient){let b=a.getServiceAccountEmail();if(b)return{client_email:b,universe_domain:a.universeDomain}}if(this.jsonContent)return{client_email:this.jsonContent.client_email,private_key:this.jsonContent.private_key,universe_domain:this.jsonContent.universe_domain};if(await this._checkIsGCE()){let[a,b]=await Promise.all([g.instance("service-accounts/default/email"),this.getUniverseDomain()]);return{client_email:a,universe_domain:b}}throw Error(b.GoogleAuthExceptionMessages.NO_CREDENTIALS_FOUND)}async getClient(){if(this.cachedCredential)return this.cachedCredential;this.#q=this.#q||this.#s();try{return await this.#q}finally{this.#q=null}}async #s(){if(this.jsonContent)return this._cacheClientFromJSON(this.jsonContent,this.clientOptions);if(this.keyFilename){let a=i.resolve(this.keyFilename),b=e.createReadStream(a);return await this.fromStreamAsync(b,this.clientOptions)}if(this.apiKey){let a=await this.fromAPIKey(this.apiKey,this.clientOptions);a.scopes=this.scopes;let{credential:b}=await this.#r(a);return b}{let{credential:a}=await this.getApplicationDefaultAsync(this.clientOptions);return a}}async getIdTokenClient(a){let b=await this.getClient();if(!("fetchIdToken"in b))throw Error("Cannot fetch ID token in this environment, use GCE or set the GOOGLE_APPLICATION_CREDENTIALS environment variable to a service account credentials JSON file.");return new l.IdTokenClient({targetAudience:a,idTokenProvider:b})}async getAccessToken(){let a=await this.getClient();return(await a.getAccessToken()).token}async getRequestHeaders(a){return(await this.getClient()).getRequestHeaders(a)}async authorizeRequest(a={}){let b=a.url,c=await this.getClient(),d=await c.getRequestHeaders(b);return a.headers=f.Gaxios.mergeHeaders(a.headers,d),a}async fetch(...a){return(await this.getClient()).fetch(...a)}async request(a){return(await this.getClient()).request(a)}getEnv(){return(0,m.getEnv)()}async sign(a,b){let c=await this.getClient(),d=await this.getUniverseDomain();if(b=b||`https://iamcredentials.${d}/v1/projects/-/serviceAccounts/`,c instanceof q.Impersonated)return(await c.sign(a)).signedBlob;let e=(0,j.createCrypto)();if(c instanceof o.JWT&&c.key)return await e.sign(c.key,a);let f=await this.getCredentials();if(!f.client_email)throw Error("Cannot sign data without `client_email`.");return this.signBlob(e,f.client_email,a,b)}async signBlob(a,b,c,d){let e=new URL(d+`${b}:signBlob`);return(await this.request({method:"POST",url:e.href,data:{payload:a.encodeBase64StringUtf8(c)},retry:!0,retryConfig:{httpMethodsToRetry:["POST"]}})).data.signedBlob}}b.GoogleAuth=w},76748:(a,b,c)=>{"use strict";var d,e,f;Object.defineProperty(b,"__esModule",{value:!0}),b.OAuth2Client=b.ClientAuthentication=b.CertificateFormat=b.CodeChallengeMethod=void 0;let g=c(15921),h=c(11723),i=c(27910),j=c(74860),k=c(21827),l=c(88748),m=c(62783),o=c(36367);!function(a){a.Plain="plain",a.S256="S256"}(d||(b.CodeChallengeMethod=d={})),function(a){a.PEM="PEM",a.JWK="JWK"}(e||(b.CertificateFormat=e={})),function(a){a.ClientSecretPost="ClientSecretPost",a.ClientSecretBasic="ClientSecretBasic",a.None="None"}(f||(b.ClientAuthentication=f={}));class p extends m.AuthClient{redirectUri;certificateCache={};certificateExpiry=null;certificateCacheFormat=e.PEM;refreshTokenPromises=new Map;endpoints;issuers;clientAuthentication;_clientId;_clientSecret;refreshHandler;constructor(a={},b,c){super("object"==typeof a?a:{}),"object"!=typeof a&&(a={clientId:a,clientSecret:b,redirectUri:c}),this._clientId=a.clientId||a.client_id,this._clientSecret=a.clientSecret||a.client_secret,this.redirectUri=a.redirectUri||a.redirect_uris?.[0],this.endpoints={tokenInfoUrl:"https://oauth2.googleapis.com/tokeninfo",oauth2AuthBaseUrl:"https://accounts.google.com/o/oauth2/v2/auth",oauth2TokenUrl:"https://oauth2.googleapis.com/token",oauth2RevokeUrl:"https://oauth2.googleapis.com/revoke",oauth2FederatedSignonPemCertsUrl:"https://www.googleapis.com/oauth2/v1/certs",oauth2FederatedSignonJwkCertsUrl:"https://www.googleapis.com/oauth2/v3/certs",oauth2IapPublicKeyUrl:"https://www.gstatic.com/iap/verify/public_key",...a.endpoints},this.clientAuthentication=a.clientAuthentication||f.ClientSecretPost,this.issuers=a.issuers||["accounts.google.com","https://accounts.google.com",this.universeDomain]}static GOOGLE_TOKEN_INFO_URL="https://oauth2.googleapis.com/tokeninfo";static CLOCK_SKEW_SECS_=300;static DEFAULT_MAX_TOKEN_LIFETIME_SECS_=86400;generateAuthUrl(a={}){if(a.code_challenge_method&&!a.code_challenge)throw Error("If a code_challenge_method is provided, code_challenge must be included.");return a.response_type=a.response_type||"code",a.client_id=a.client_id||this._clientId,a.redirect_uri=a.redirect_uri||this.redirectUri,Array.isArray(a.scope)&&(a.scope=a.scope.join(" ")),this.endpoints.oauth2AuthBaseUrl.toString()+"?"+h.stringify(a)}generateCodeVerifier(){throw Error("generateCodeVerifier is removed, please use generateCodeVerifierAsync instead.")}async generateCodeVerifierAsync(){let a=(0,l.createCrypto)(),b=a.randomBytesBase64(96).replace(/\+/g,"~").replace(/=/g,"_").replace(/\//g,"-"),c=(await a.sha256DigestBase64(b)).split("=")[0].replace(/\+/g,"-").replace(/\//g,"_");return{codeVerifier:b,codeChallenge:c}}getToken(a,b){let c="string"==typeof a?{code:a}:a;if(!b)return this.getTokenAsync(c);this.getTokenAsync(c).then(a=>b(null,a.tokens,a.res),a=>b(a,null,a.response))}async getTokenAsync(a){let b=this.endpoints.oauth2TokenUrl.toString(),c=new Headers,d={client_id:a.client_id||this._clientId,code_verifier:a.codeVerifier,code:a.code,grant_type:"authorization_code",redirect_uri:a.redirect_uri||this.redirectUri};if(this.clientAuthentication===f.ClientSecretBasic){let a=Buffer.from(`${this._clientId}:${this._clientSecret}`);c.set("authorization",`Basic ${a.toString("base64")}`)}this.clientAuthentication===f.ClientSecretPost&&(d.client_secret=this._clientSecret);let e={...p.RETRY_CONFIG,method:"POST",url:b,data:new URLSearchParams((0,k.removeUndefinedValuesInObject)(d)),headers:c};m.AuthClient.setMethodName(e,"getTokenAsync");let g=await this.transporter.request(e),h=g.data;return g.data&&g.data.expires_in&&(h.expiry_date=new Date().getTime()+1e3*g.data.expires_in,delete h.expires_in),this.emit("tokens",h),{tokens:h,res:g}}async refreshToken(a){if(!a)return this.refreshTokenNoCache(a);if(this.refreshTokenPromises.has(a))return this.refreshTokenPromises.get(a);let b=this.refreshTokenNoCache(a).then(b=>(this.refreshTokenPromises.delete(a),b),b=>{throw this.refreshTokenPromises.delete(a),b});return this.refreshTokenPromises.set(a,b),b}async refreshTokenNoCache(a){let b;if(!a)throw Error("No refresh token is set.");let c=this.endpoints.oauth2TokenUrl.toString(),d={refresh_token:a,client_id:this._clientId,client_secret:this._clientSecret,grant_type:"refresh_token"};try{let a={...p.RETRY_CONFIG,method:"POST",url:c,data:new URLSearchParams((0,k.removeUndefinedValuesInObject)(d))};m.AuthClient.setMethodName(a,"refreshTokenNoCache"),b=await this.transporter.request(a)}catch(a){throw a instanceof g.GaxiosError&&"invalid_grant"===a.message&&a.response?.data&&/ReAuth/i.test(a.response.data.error_description)&&(a.message=JSON.stringify(a.response.data)),a}let e=b.data;return b.data&&b.data.expires_in&&(e.expiry_date=new Date().getTime()+1e3*b.data.expires_in,delete e.expires_in),this.emit("tokens",e),{tokens:e,res:b}}refreshAccessToken(a){if(!a)return this.refreshAccessTokenAsync();this.refreshAccessTokenAsync().then(b=>a(null,b.credentials,b.res),a)}async refreshAccessTokenAsync(){let a=await this.refreshToken(this.credentials.refresh_token),b=a.tokens;return b.refresh_token=this.credentials.refresh_token,this.credentials=b,{credentials:this.credentials,res:a.res}}getAccessToken(a){if(!a)return this.getAccessTokenAsync();this.getAccessTokenAsync().then(b=>a(null,b.token,b.res),a)}async getAccessTokenAsync(){if(!(!this.credentials.access_token||this.isTokenExpiring()))return{token:this.credentials.access_token};{if(!this.credentials.refresh_token)if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(a?.access_token)return this.setCredentials(a),{token:this.credentials.access_token}}else throw Error("No refresh token or refresh handler callback is set.");let a=await this.refreshAccessTokenAsync();if(!a.credentials||a.credentials&&!a.credentials.access_token)throw Error("Could not refresh access token.");return{token:a.credentials.access_token,res:a.res}}}async getRequestHeaders(a){return(await this.getRequestMetadataAsync(a)).headers}async getRequestMetadataAsync(a){let b=this.credentials;if(!b.access_token&&!b.refresh_token&&!this.apiKey&&!this.refreshHandler)throw Error("No access, refresh token, API key or refresh handler callback is set.");if(b.access_token&&!this.isTokenExpiring()){b.token_type=b.token_type||"Bearer";let a=new Headers({authorization:b.token_type+" "+b.access_token});return{headers:this.addSharedMetadataHeaders(a)}}if(this.refreshHandler){let a=await this.processAndValidateRefreshHandler();if(a?.access_token){this.setCredentials(a);let b=new Headers({authorization:"Bearer "+this.credentials.access_token});return{headers:this.addSharedMetadataHeaders(b)}}}if(this.apiKey)return{headers:new Headers({"X-Goog-Api-Key":this.apiKey})};let c=null,d=null;try{d=(c=await this.refreshToken(b.refresh_token)).tokens}catch(a){throw a.response&&(403===a.response.status||404===a.response.status)&&(a.message=`Could not refresh access token: ${a.message}`),a}let e=this.credentials;e.token_type=e.token_type||"Bearer",d.refresh_token=e.refresh_token,this.credentials=d;let f=new Headers({authorization:e.token_type+" "+d.access_token});return{headers:this.addSharedMetadataHeaders(f),res:c.res}}static getRevokeTokenUrl(a){return new p().getRevokeTokenURL(a).toString()}getRevokeTokenURL(a){let b=new URL(this.endpoints.oauth2RevokeUrl);return b.searchParams.append("token",a),b}revokeToken(a,b){let c={...p.RETRY_CONFIG,url:this.getRevokeTokenURL(a).toString(),method:"POST"};if(m.AuthClient.setMethodName(c,"revokeToken"),!b)return this.transporter.request(c);this.transporter.request(c).then(a=>b(null,a),b)}revokeCredentials(a){if(!a)return this.revokeCredentialsAsync();this.revokeCredentialsAsync().then(b=>a(null,b),a)}async revokeCredentialsAsync(){let a=this.credentials.access_token;if(this.credentials={},a)return this.revokeToken(a);throw Error("No access token to revoke.")}request(a,b){if(!b)return this.requestAsync(a);this.requestAsync(a).then(a=>b(null,a),a=>b(a,a.response))}async requestAsync(a,b=!1){try{let b=await this.getRequestMetadataAsync();return a.headers=g.Gaxios.mergeHeaders(a.headers),this.addUserProjectAndAuthHeaders(a.headers,b.headers),this.apiKey&&a.headers.set("X-Goog-Api-Key",this.apiKey),await this.transporter.request(a)}catch(d){let c=d.response;if(c){let d=c.status,e=this.credentials&&this.credentials.access_token&&this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure),f=this.credentials&&this.credentials.access_token&&!this.credentials.refresh_token&&(!this.credentials.expiry_date||this.forceRefreshOnFailure)&&this.refreshHandler,g=c.config.data instanceof i.Readable,h=401===d||403===d;if(!b&&h&&!g&&e)return await this.refreshAccessTokenAsync(),this.requestAsync(a,!0);if(!b&&h&&!g&&f){let b=await this.processAndValidateRefreshHandler();return b?.access_token&&this.setCredentials(b),this.requestAsync(a,!0)}}throw d}}verifyIdToken(a,b){if(b&&"function"!=typeof b)throw Error("This method accepts an options object as the first parameter, which includes the idToken, audience, and maxExpiry.");if(!b)return this.verifyIdTokenAsync(a);this.verifyIdTokenAsync(a).then(a=>b(null,a),b)}async verifyIdTokenAsync(a){if(!a.idToken)throw Error("The verifyIdToken method requires an ID Token");let b=await this.getFederatedSignonCertsAsync();return await this.verifySignedJwtWithCertsAsync(a.idToken,b.certs,a.audience,this.issuers,a.maxExpiry)}async getTokenInfo(a){let{data:b}=await this.transporter.request({...p.RETRY_CONFIG,method:"POST",headers:{"content-type":"application/x-www-form-urlencoded;charset=UTF-8",authorization:`Bearer ${a}`},url:this.endpoints.tokenInfoUrl.toString()}),c=Object.assign({expiry_date:new Date().getTime()+1e3*b.expires_in,scopes:b.scope.split(" ")},b);return delete c.expires_in,delete c.scope,c}getFederatedSignonCerts(a){if(!a)return this.getFederatedSignonCertsAsync();this.getFederatedSignonCertsAsync().then(b=>a(null,b.certs,b.res),a)}async getFederatedSignonCertsAsync(){let a,b,c=new Date().getTime(),d=(0,l.hasBrowserCrypto)()?e.JWK:e.PEM;if(this.certificateExpiry&&c<this.certificateExpiry.getTime()&&this.certificateCacheFormat===d)return{certs:this.certificateCache,format:d};switch(d){case e.PEM:b=this.endpoints.oauth2FederatedSignonPemCertsUrl.toString();break;case e.JWK:b=this.endpoints.oauth2FederatedSignonJwkCertsUrl.toString();break;default:throw Error(`Unsupported certificate format ${d}`)}try{let c={...p.RETRY_CONFIG,url:b};m.AuthClient.setMethodName(c,"getFederatedSignonCertsAsync"),a=await this.transporter.request(c)}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}let f=a?.headers.get("cache-control"),g=-1;if(f){let a=/max-age=(?<maxAge>[0-9]+)/.exec(f)?.groups?.maxAge;a&&(g=1e3*Number(a))}let h={};switch(d){case e.PEM:h=a.data;break;case e.JWK:for(let b of a.data.keys)h[b.kid]=b;break;default:throw Error(`Unsupported certificate format ${d}`)}let i=new Date;return this.certificateExpiry=-1===g?null:new Date(i.getTime()+g),this.certificateCache=h,this.certificateCacheFormat=d,{certs:h,format:d,res:a}}getIapPublicKeys(a){if(!a)return this.getIapPublicKeysAsync();this.getIapPublicKeysAsync().then(b=>a(null,b.pubkeys,b.res),a)}async getIapPublicKeysAsync(){let a,b=this.endpoints.oauth2IapPublicKeyUrl.toString();try{let c={...p.RETRY_CONFIG,url:b};m.AuthClient.setMethodName(c,"getIapPublicKeysAsync"),a=await this.transporter.request(c)}catch(a){throw a instanceof Error&&(a.message=`Failed to retrieve verification certificates: ${a.message}`),a}return{pubkeys:a.data,res:a}}verifySignedJwtWithCerts(){throw Error("verifySignedJwtWithCerts is removed, please use verifySignedJwtWithCertsAsync instead.")}async verifySignedJwtWithCertsAsync(a,b,c,d,e){let f,g,h=(0,l.createCrypto)();e||(e=p.DEFAULT_MAX_TOKEN_LIFETIME_SECS_);let i=a.split(".");if(3!==i.length)throw Error("Wrong number of segments in token: "+a);let k=i[0]+"."+i[1],m=i[2];try{f=JSON.parse(h.decodeBase64StringUtf8(i[0]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token envelope: ${i[0]}': ${a.message}`),a}if(!f)throw Error("Can't parse token envelope: "+i[0]);try{g=JSON.parse(h.decodeBase64StringUtf8(i[1]))}catch(a){throw a instanceof Error&&(a.message=`Can't parse token payload '${i[0]}`),a}if(!g)throw Error("Can't parse token payload: "+i[1]);if(!Object.prototype.hasOwnProperty.call(b,f.kid))throw Error("No pem found for envelope: "+JSON.stringify(f));let q=b[f.kid];if("ES256"===f.alg&&(m=j.joseToDer(m,"ES256").toString("base64")),!await h.verify(q,k,m))throw Error("Invalid token signature: "+a);if(!g.iat)throw Error("No issue time in token: "+JSON.stringify(g));if(!g.exp)throw Error("No expiration time in token: "+JSON.stringify(g));let r=Number(g.iat);if(isNaN(r))throw Error("iat field using invalid format");let s=Number(g.exp);if(isNaN(s))throw Error("exp field using invalid format");let t=new Date().getTime()/1e3;if(s>=t+e)throw Error("Expiration time too far in future: "+JSON.stringify(g));let u=r-p.CLOCK_SKEW_SECS_,v=s+p.CLOCK_SKEW_SECS_;if(t<u)throw Error("Token used too early, "+t+" < "+u+": "+JSON.stringify(g));if(t>v)throw Error("Token used too late, "+t+" > "+v+": "+JSON.stringify(g));if(d&&0>d.indexOf(g.iss))throw Error("Invalid issuer, expected one of ["+d+"], but got "+g.iss);if(null!=c){let a=g.aud;if(!(c.constructor===Array?c.indexOf(a)>-1:a===c))throw Error("Wrong recipient, payload audience != requiredAudience")}return new o.LoginTicket(f,g)}async processAndValidateRefreshHandler(){if(this.refreshHandler){let a=await this.refreshHandler();if(!a.access_token)throw Error("No access token is returned by the refreshHandler callback.");return a}}isTokenExpiring(){let a=this.credentials.expiry_date;return!!a&&a<=new Date().getTime()+this.eagerRefreshThresholdMillis}}b.OAuth2Client=p},76760:a=>{"use strict";a.exports=require("node:path")},77030:a=>{"use strict";a.exports=require("node:net")},78062:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.JWT=void 0;let d=c(11157),e=c(47201),f=c(76748),g=c(62783);class h extends f.OAuth2Client{email;keyFile;key;keyId;defaultScopes;scopes;scope;subject;gtoken;additionalClaims;useJWTAccessWithScope;defaultServicePath;access;constructor(a={}){super(a),this.email=a.email,this.keyFile=a.keyFile,this.key=a.key,this.keyId=a.keyId,this.scopes=a.scopes,this.subject=a.subject,this.additionalClaims=a.additionalClaims,this.credentials={refresh_token:"jwt-placeholder",expiry_date:1}}createScoped(a){let b=new h(this);return b.scopes=a,b}async getRequestMetadataAsync(a){a=this.defaultServicePath?`https://${this.defaultServicePath}/`:a;let b=!this.hasUserScopes()&&a||this.useJWTAccessWithScope&&this.hasAnyScopes()||this.universeDomain!==g.DEFAULT_UNIVERSE;if(this.subject&&this.universeDomain!==g.DEFAULT_UNIVERSE)throw RangeError(`Service Account user is configured for the credential. Domain-wide delegation is not supported in universes other than ${g.DEFAULT_UNIVERSE}`);if(!this.apiKey&&b)if(this.additionalClaims&&this.additionalClaims.target_audience){let{tokens:a}=await this.refreshToken();return{headers:this.addSharedMetadataHeaders(new Headers({authorization:`Bearer ${a.id_token}`}))}}else{let b;this.access||(this.access=new e.JWTAccess(this.email,this.key,this.keyId,this.eagerRefreshThresholdMillis)),this.hasUserScopes()?b=this.scopes:a||(b=this.defaultScopes);let c=this.useJWTAccessWithScope||this.universeDomain!==g.DEFAULT_UNIVERSE,d=await this.access.getRequestHeaders(a??void 0,this.additionalClaims,c?b:void 0);return{headers:this.addSharedMetadataHeaders(d)}}return this.hasAnyScopes()||this.apiKey?super.getRequestMetadataAsync(a):{headers:new Headers}}async fetchIdToken(a){let b=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:{target_audience:a},transporter:this.transporter});if(await b.getToken({forceRefresh:!0}),!b.idToken)throw Error("Unknown error: Failed to fetch ID token");return b.idToken}hasUserScopes(){return!!this.scopes&&this.scopes.length>0}hasAnyScopes(){return!!this.scopes&&!!(this.scopes.length>0)||!!this.defaultScopes&&!!(this.defaultScopes.length>0)}authorize(a){if(!a)return this.authorizeAsync();this.authorizeAsync().then(b=>a(null,b),a)}async authorizeAsync(){let a=await this.refreshToken();if(!a)throw Error("No result returned");return this.credentials=a.tokens,this.credentials.refresh_token="jwt-placeholder",this.key=this.gtoken.key,this.email=this.gtoken.iss,a.tokens}async refreshTokenNoCache(){let a=this.createGToken(),b={access_token:(await a.getToken({forceRefresh:this.isTokenExpiring()})).access_token,token_type:"Bearer",expiry_date:a.expiresAt,id_token:a.idToken};return this.emit("tokens",b),{res:null,tokens:b}}createGToken(){return this.gtoken||(this.gtoken=new d.GoogleToken({iss:this.email,sub:this.subject,scope:this.scopes||this.defaultScopes,keyFile:this.keyFile,key:this.key,additionalClaims:this.additionalClaims,transporter:this.transporter})),this.gtoken}fromJSON(a){if(!a)throw Error("Must pass in a JSON object containing the service account auth settings.");if(!a.client_email)throw Error("The incoming JSON object does not contain a client_email field");if(!a.private_key)throw Error("The incoming JSON object does not contain a private_key field");this.email=a.client_email,this.key=a.private_key,this.keyId=a.private_key_id,this.projectId=a.project_id,this.quotaProjectId=a.quota_project_id,this.universeDomain=a.universe_domain||this.universeDomain}fromStream(a,b){if(!b)return this.fromStreamAsync(a);this.fromStreamAsync(a).then(()=>b(),b)}fromStreamAsync(a){return new Promise((b,c)=>{if(!a)throw Error("Must pass in a stream containing the service account auth settings.");let d="";a.setEncoding("utf8").on("error",c).on("data",a=>d+=a).on("end",()=>{try{let a=JSON.parse(d);this.fromJSON(a),b()}catch(a){c(a)}})})}fromAPIKey(a){if("string"!=typeof a)throw Error("Must provide an API Key string.");this.apiKey=a}async getCredentials(){if(this.key)return{private_key:this.key,client_email:this.email};if(this.keyFile){let a=this.createGToken(),b=await a.getCredentials(this.keyFile);return{private_key:b.privateKey,client_email:b.clientEmail}}throw Error("A key or a keyFile must be provided to getCredentials.")}}b.JWT=h},78358:()=>{},78474:a=>{"use strict";a.exports=require("node:events")},78539:(a,b)=>{"use strict";async function c(a){var b;let c=e(a);if(!a||!a.config||!c&&!a.config.retry)return{shouldRetry:!1};(c=c||{}).currentRetryAttempt=c.currentRetryAttempt||0,c.retry=void 0===c.retry||null===c.retry?3:c.retry,c.httpMethodsToRetry=c.httpMethodsToRetry||["GET","HEAD","PUT","OPTIONS","DELETE"],c.noResponseRetries=void 0===c.noResponseRetries||null===c.noResponseRetries?2:c.noResponseRetries,c.retryDelayMultiplier=c.retryDelayMultiplier?c.retryDelayMultiplier:2,c.timeOfFirstRequest=c.timeOfFirstRequest?c.timeOfFirstRequest:Date.now(),c.totalTimeout=c.totalTimeout?c.totalTimeout:Number.MAX_SAFE_INTEGER,c.maxRetryDelay=c.maxRetryDelay?c.maxRetryDelay:Number.MAX_SAFE_INTEGER,c.statusCodesToRetry=c.statusCodesToRetry||[[100,199],[408,408],[429,429],[500,599]],a.config.retryConfig=c;let f=c.shouldRetry||d;if(!await f(a))return{shouldRetry:!1,config:a.config};let g=Math.min(((b=c).currentRetryAttempt?0:b.retryDelay??100)+(Math.pow(b.retryDelayMultiplier,b.currentRetryAttempt)-1)/2*1e3,b.totalTimeout-(Date.now()-b.timeOfFirstRequest),b.maxRetryDelay);a.config.retryConfig.currentRetryAttempt+=1;let h=c.retryBackoff?c.retryBackoff(a,g):new Promise(a=>{setTimeout(a,g)});return c.onRetryAttempt&&await c.onRetryAttempt(a),await h,{shouldRetry:!0,config:a.config}}function d(a){let b=e(a);if(a.config.signal?.aborted&&"TimeoutError"!==a.code||"AbortError"===a.code||!b||0===b.retry||!a.response&&(b.currentRetryAttempt||0)>=b.noResponseRetries||!b.httpMethodsToRetry||!b.httpMethodsToRetry.includes(a.config.method?.toUpperCase()||"GET"))return!1;if(a.response&&a.response.status){let c=!1;for(let[d,e]of b.statusCodesToRetry){let b=a.response.status;if(b>=d&&b<=e){c=!0;break}}if(!c)return!1}return b.currentRetryAttempt=b.currentRetryAttempt||0,!(b.currentRetryAttempt>=b.retry)}function e(a){if(a&&a.config&&a.config.retryConfig)return a.config.retryConfig}Object.defineProperty(b,"__esModule",{value:!0}),b.getRetryConfig=c},79134:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.PassThroughClient=void 0;let d=c(62783);class e extends d.AuthClient{async request(a){return this.transporter.request(a)}async getAccessToken(){return{}}async getRequestHeaders(){return new Headers}}b.PassThroughClient=e},79428:a=>{"use strict";a.exports=require("buffer")},79551:a=>{"use strict";a.exports=require("url")},79646:a=>{"use strict";a.exports=require("child_process")},79662:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{atLeastOneTask:function(){return e},scheduleImmediate:function(){return d},scheduleOnNextTick:function(){return c},waitAtLeastOneReactRenderTask:function(){return f}});let c=a=>{Promise.resolve().then(()=>{process.nextTick(a)})},d=a=>{setImmediate(a)};function e(){return new Promise(a=>d(a))}function f(){return new Promise(a=>setImmediate(a))}},80118:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.OAuthClientAuthHandler=void 0,b.getErrorFromOAuthErrorResponse=function(a,b){let c=a.error,d=a.error_description,e=a.error_uri,f=`Error code ${c}`;void 0!==d&&(f+=`: ${d}`),void 0!==e&&(f+=` - ${e}`);let g=Error(f);if(b){let a=Object.keys(b);b.stack&&a.push("stack"),a.forEach(a=>{"message"!==a&&Object.defineProperty(g,a,{value:b[a],writable:!1,enumerable:!0})})}return g};let d=c(15921),e=c(88748),f=["PUT","POST","PATCH"];class g{#t=(0,e.createCrypto)();#u;transporter;constructor(a){a&&"clientId"in a?(this.#u=a,this.transporter=new d.Gaxios):(this.#u=a?.clientAuthentication,this.transporter=a?.transporter||new d.Gaxios)}applyClientAuthenticationOptions(a,b){a.headers=d.Gaxios.mergeHeaders(a.headers),this.injectAuthenticatedHeaders(a,b),b||this.injectAuthenticatedRequestBody(a)}injectAuthenticatedHeaders(a,b){if(b)a.headers=d.Gaxios.mergeHeaders(a.headers,{authorization:`Bearer ${b}`});else if(this.#u?.confidentialClientType==="basic"){a.headers=d.Gaxios.mergeHeaders(a.headers);let b=this.#u.clientId,c=this.#u.clientSecret||"",e=this.#t.encodeBase64StringUtf8(`${b}:${c}`);d.Gaxios.mergeHeaders(a.headers,{authorization:`Basic ${e}`})}}injectAuthenticatedRequestBody(a){if(this.#u?.confidentialClientType==="request-body"){let b=(a.method||"GET").toUpperCase();if(!f.includes(b))throw Error(`${b} HTTP method does not support ${this.#u.confidentialClientType} client authentication`);let c=new Headers(a.headers).get("content-type");if(c?.startsWith("application/x-www-form-urlencoded")||a.data instanceof URLSearchParams){let b=new URLSearchParams(a.data??"");b.append("client_id",this.#u.clientId),b.append("client_secret",this.#u.clientSecret||""),a.data=b}else if(c?.startsWith("application/json"))a.data=a.data||{},Object.assign(a.data,{client_id:this.#u.clientId,client_secret:this.#u.clientSecret||""});else throw Error(`${c} content-types are not supported with ${this.#u.confidentialClientType} client authentication`)}}static get RETRY_CONFIG(){return{retry:!0,retryConfig:{httpMethodsToRetry:["GET","PUT","POST","HEAD","OPTIONS","DELETE"]}}}}b.OAuthClientAuthHandler=g},80152:(a,b,c)=>{"use strict";let d;Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{BubbledError:function(){return m},SpanKind:function(){return k},SpanStatusCode:function(){return j},getTracer:function(){return v},isBubbledError:function(){return o}});let e=c(49378),f=c(86521);try{d=c(54576)}catch(a){d=c(54576)}let{context:g,propagation:h,trace:i,SpanStatusCode:j,SpanKind:k,ROOT_CONTEXT:l}=d;class m extends Error{constructor(a,b){super(),this.bubble=a,this.result=b}}function o(a){return"object"==typeof a&&null!==a&&a instanceof m}let p=(a,b)=>{o(b)&&b.bubble?a.setAttribute("next.bubble",!0):(b&&(a.recordException(b),a.setAttribute("error.type",b.name)),a.setStatus({code:j.ERROR,message:null==b?void 0:b.message})),a.end()},q=new Map,r=d.createContextKey("next.rootSpanId"),s=0,t={set(a,b,c){a.push({key:b,value:c})}};class u{getTracerInstance(){return i.getTracer("next.js","0.0.1")}getContext(){return g}getTracePropagationData(){let a=g.active(),b=[];return h.inject(a,b,t),b}getActiveScopeSpan(){return i.getSpan(null==g?void 0:g.active())}withPropagatedContext(a,b,c){let d=g.active();if(i.getSpanContext(d))return b();let e=h.extract(d,a,c);return g.with(e,b)}trace(...a){var b;let[c,d,h]=a,{fn:j,options:k}="function"==typeof d?{fn:d,options:{}}:{fn:h,options:{...d}},m=k.spanName??c;if(!e.NextVanillaSpanAllowlist.includes(c)&&"1"!==process.env.NEXT_OTEL_VERBOSE||k.hideSpan)return j();let o=this.getSpanContext((null==k?void 0:k.parentSpan)??this.getActiveScopeSpan()),t=!1;o?(null==(b=i.getSpanContext(o))?void 0:b.isRemote)&&(t=!0):(o=(null==g?void 0:g.active())??l,t=!0);let u=s++;return k.attributes={"next.span_name":m,"next.span_type":c,...k.attributes},g.with(o.setValue(r,u),()=>this.getTracerInstance().startActiveSpan(m,k,a=>{let b="performance"in globalThis&&"measure"in performance?globalThis.performance.now():void 0,d=()=>{q.delete(u),b&&process.env.NEXT_OTEL_PERFORMANCE_PREFIX&&e.LogSpanAllowList.includes(c||"")&&performance.measure(`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-${(c.split(".").pop()||"").replace(/[A-Z]/g,a=>"-"+a.toLowerCase())}`,{start:b,end:performance.now()})};t&&q.set(u,new Map(Object.entries(k.attributes??{})));try{if(j.length>1)return j(a,b=>p(a,b));let b=j(a);if((0,f.isThenable)(b))return b.then(b=>(a.end(),b)).catch(b=>{throw p(a,b),b}).finally(d);return a.end(),d(),b}catch(b){throw p(a,b),d(),b}}))}wrap(...a){let b=this,[c,d,f]=3===a.length?a:[a[0],{},a[1]];return e.NextVanillaSpanAllowlist.includes(c)||"1"===process.env.NEXT_OTEL_VERBOSE?function(){let a=d;"function"==typeof a&&"function"==typeof f&&(a=a.apply(this,arguments));let e=arguments.length-1,h=arguments[e];if("function"!=typeof h)return b.trace(c,a,()=>f.apply(this,arguments));{let d=b.getContext().bind(g.active(),h);return b.trace(c,a,(a,b)=>(arguments[e]=function(a){return null==b||b(a),d.apply(this,arguments)},f.apply(this,arguments)))}}:f}startSpan(...a){let[b,c]=a,d=this.getSpanContext((null==c?void 0:c.parentSpan)??this.getActiveScopeSpan());return this.getTracerInstance().startSpan(b,c,d)}getSpanContext(a){return a?i.setSpan(g.active(),a):void 0}getRootSpanAttributes(){let a=g.active().getValue(r);return q.get(a)}setRootSpanAttribute(a,b){let c=g.active().getValue(r),d=q.get(c);d&&d.set(a,b)}}let v=(()=>{let a=new u;return()=>a})()},80683:(a,b,c)=>{"use strict";a.exports=function a(b){if(!f(b))return b;b[i]=void 0;let c=Object.create(g);for(let g in c.type="[object Function]"===j.call(b.constructor)?b.constructor.name:b.name,c.message=d(b),c.stack=e(b),Array.isArray(b.errors)&&(c.aggregateErrors=b.errors.map(b=>a(b))),b)if(void 0===c[g]){let d=b[g];f(d)?"cause"===g||Object.prototype.hasOwnProperty.call(d,i)||(c[g]=a(d)):c[g]=d}return delete b[i],c.raw=b,c};let{messageWithCauses:d,stackWithCauses:e,isErrorLike:f}=c(46279),{pinoErrProto:g,pinoErrorSymbols:h}=c(15218),{seen:i}=h,{toString:j}=Object.prototype},81063:(a,b,c)=>{var d=null;let e=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,f=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;a.exports=function(a){"use strict";var b={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(null!=a){if(!0===a.strict&&(b.strict=!0),!0===a.storeAsString&&(b.storeAsString=!0),b.alwaysParseAsBig=!0===a.alwaysParseAsBig&&a.alwaysParseAsBig,b.useNativeBigInt=!0===a.useNativeBigInt&&a.useNativeBigInt,void 0!==a.constructorAction)if("error"===a.constructorAction||"ignore"===a.constructorAction||"preserve"===a.constructorAction)b.constructorAction=a.constructorAction;else throw Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${a.constructorAction}`);if(void 0!==a.protoAction)if("error"===a.protoAction||"ignore"===a.protoAction||"preserve"===a.protoAction)b.protoAction=a.protoAction;else throw Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${a.protoAction}`)}var g,h,i,j,k={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"},l=function(a){throw{name:"SyntaxError",message:a,at:g,text:i}},m=function(a){return a&&a!==h&&l("Expected '"+a+"' instead of '"+h+"'"),h=i.charAt(g),g+=1,h},o=function(){var a,e="";for("-"===h&&(e="-",m("-"));h>="0"&&h<="9";)e+=h,m();if("."===h)for(e+=".";m()&&h>="0"&&h<="9";)e+=h;if("e"===h||"E"===h)for(e+=h,m(),("-"===h||"+"===h)&&(e+=h,m());h>="0"&&h<="9";)e+=h,m();if(isFinite(a=+e))return(null==d&&(d=c(35883)),e.length>15)?b.storeAsString?e:b.useNativeBigInt?BigInt(e):new d(e):b.alwaysParseAsBig?b.useNativeBigInt?BigInt(a):new d(a):a;l("Bad number")},p=function(){var a,b,c,d="";if('"'===h)for(var e=g;m();){if('"'===h)return g-1>e&&(d+=i.substring(e,g-1)),m(),d;if("\\"===h){if(g-1>e&&(d+=i.substring(e,g-1)),m(),"u"===h){for(b=0,c=0;b<4&&isFinite(a=parseInt(m(),16));b+=1)c=16*c+a;d+=String.fromCharCode(c)}else if("string"==typeof k[h])d+=k[h];else break;e=g}}l("Bad string")},q=function(){for(;h&&h<=" ";)m()},r=function(){switch(h){case"t":return m("t"),m("r"),m("u"),m("e"),!0;case"f":return m("f"),m("a"),m("l"),m("s"),m("e"),!1;case"n":return m("n"),m("u"),m("l"),m("l"),null}l("Unexpected '"+h+"'")},s=function(){var a=[];if("["===h){if(m("["),q(),"]"===h)return m("]"),a;for(;h;){if(a.push(j()),q(),"]"===h)return m("]"),a;m(","),q()}}l("Bad array")},t=function(){var a,c=Object.create(null);if("{"===h){if(m("{"),q(),"}"===h)return m("}"),c;for(;h;){if(a=p(),q(),m(":"),!0===b.strict&&Object.hasOwnProperty.call(c,a)&&l('Duplicate key "'+a+'"'),!0===e.test(a)?"error"===b.protoAction?l("Object contains forbidden prototype property"):"ignore"===b.protoAction?j():c[a]=j():!0===f.test(a)?"error"===b.constructorAction?l("Object contains forbidden constructor property"):"ignore"===b.constructorAction?j():c[a]=j():c[a]=j(),q(),"}"===h)return m("}"),c;m(","),q()}}l("Bad object")};return j=function(){switch(q(),h){case"{":return t();case"[":return s();case'"':return p();case"-":return o();default:return h>="0"&&h<="9"?o():r()}},function(a,b){var c;return i=a+"",g=0,h=" ",c=j(),q(),h&&l("Syntax error"),"function"==typeof b?function a(c,d){var e,f=c[d];return f&&"object"==typeof f&&Object.keys(f).forEach(function(b){void 0!==(e=a(f,b))?f[b]=e:delete f[b]}),b.call(c,d,f)}({"":c},""):c}}},81630:a=>{"use strict";a.exports=require("http")},81952:function(a,b,c){"use strict";var d,e=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(b,"__esModule",{value:!0}),b.Gaxios=void 0;let f=e(c(47572)),g=c(55591),h=c(73048),i=c(78539),j=c(27910),k=c(64360),l=async()=>globalThis.crypto?.randomUUID()||(await Promise.resolve().then(c.t.bind(c,55511,23))).randomUUID();class m{agentCache=new Map;defaults;interceptors;constructor(a){this.defaults=a||{},this.interceptors={request:new k.GaxiosInterceptorManager,response:new k.GaxiosInterceptorManager}}fetch(...a){let b,c=a[0],e=a[1],f=new Headers;return("string"==typeof c?b=new URL(c):c instanceof URL?b=c:c&&c.url&&(b=new URL(c.url)),c&&"object"==typeof c&&"headers"in c&&d.mergeHeaders(f,c.headers),e&&d.mergeHeaders(f,new Headers(e.headers)),"object"!=typeof c||c instanceof URL)?this.request({...e,headers:f,url:b}):this.request({...e,...c,headers:f,url:b})}async request(a={}){let b=await this.#v(a);return b=await this.#w(b),this.#x(this._request(b))}async _defaultAdapter(a){let b=a.fetchImplementation||this.defaults.fetchImplementation||await d.#y(),c={...a};delete c.data;let e=await b(a.url,c),f=await this.getResponseData(a,e);return Object.getOwnPropertyDescriptor(e,"data")?.configurable||Object.defineProperties(e,{data:{configurable:!0,writable:!0,enumerable:!0,value:f}}),Object.assign(e,{config:a,data:f})}async _request(a){try{let b;if(b=a.adapter?await a.adapter(a,this._defaultAdapter.bind(this)):await this._defaultAdapter(a),!a.validateStatus(b.status)){if("stream"===a.responseType){let a=[];for await(let c of b.data)a.push(c);b.data=a.toString()}let c=h.GaxiosError.extractAPIErrorFromResponse(b,`Request failed with status code ${b.status}`);throw new h.GaxiosError(c?.message,a,b,c)}return b}catch(e){let b;b=e instanceof h.GaxiosError?e:e instanceof Error?new h.GaxiosError(e.message,a,void 0,e):new h.GaxiosError("Unexpected Gaxios Error",a,void 0,e);let{shouldRetry:c,config:d}=await (0,i.getRetryConfig)(b);if(c&&d)return b.config.retryConfig.currentRetryAttempt=d.retryConfig.currentRetryAttempt,a.retryConfig=b.config?.retryConfig,this.#z(a),this._request(a);throw a.errorRedactor&&a.errorRedactor(b),b}}async getResponseData(a,b){if(204===b.status)return"";if(a.maxContentLength&&b.headers.has("content-length")&&a.maxContentLength<Number.parseInt(b.headers?.get("content-length")||""))throw new h.GaxiosError("Response's `Content-Length` is over the limit.",a,Object.assign(b,{config:a}));switch(a.responseType){case"stream":return b.body;case"json":{let a=await b.text();try{return JSON.parse(a)}catch{return a}}case"arraybuffer":return b.arrayBuffer();case"blob":return b.blob();case"text":return b.text();default:return this.getResponseDataFromContentType(b)}}#A(a,b=[]){let c=new URL(a),d=[...b];for(let a of(process.env.NO_PROXY??process.env.no_proxy)?.split(",")||[])d.push(a.trim());for(let a of d)if(a instanceof RegExp){if(a.test(c.toString()))return!1}else if(a instanceof URL){if(a.origin===c.origin)return!1}else if(a.startsWith("*.")||a.startsWith(".")){let b=a.replace(/^\*\./,".");if(c.hostname.endsWith(b))return!1}else if(a===c.origin||a===c.hostname||a===c.href)return!1;return!0}async #w(a){let b=Promise.resolve(a);for(let a of this.interceptors.request.values())a&&(b=b.then(a.resolved,a.rejected));return b}async #x(a){let b=Promise.resolve(a);for(let a of this.interceptors.response.values())a&&(b=b.then(a.resolved,a.rejected));return b}async #v(a){let b=new Headers(this.defaults.headers);d.mergeHeaders(b,a.headers);let c=(0,f.default)(!0,{},this.defaults,a);if(!c.url)throw Error("URL is required.");if(c.baseURL&&(c.url=new URL(c.url,c.baseURL)),c.url=new URL(c.url),c.params)if(c.paramsSerializer){let a=c.paramsSerializer(c.params);a.startsWith("?")&&(a=a.slice(1));let b=c.url.toString().includes("?")?"&":"?";c.url=c.url+b+a}else{let a=c.url instanceof URL?c.url:new URL(c.url);for(let[b,d]of new URLSearchParams(c.params))a.searchParams.append(b,d);c.url=a}"number"==typeof a.maxContentLength&&(c.size=a.maxContentLength),"number"==typeof a.maxRedirects&&(c.follow=a.maxRedirects);let e="string"==typeof c.data||c.data instanceof ArrayBuffer||c.data instanceof Blob||globalThis.File&&c.data instanceof File||c.data instanceof FormData||c.data instanceof j.Readable||c.data instanceof ReadableStream||c.data instanceof String||c.data instanceof URLSearchParams||ArrayBuffer.isView(c.data)||["Blob","File","FormData"].includes(c.data?.constructor?.name||"");if(c.multipart?.length){let a=await l();b.set("content-type",`multipart/related; boundary=${a}`),c.body=j.Readable.from(this.getMultipartRequest(c.multipart,a))}else e?c.body=c.data:"object"==typeof c.data?"application/x-www-form-urlencoded"===b.get("Content-Type")?c.body=c.paramsSerializer?c.paramsSerializer(c.data):new URLSearchParams(c.data):(b.has("content-type")||b.set("content-type","application/json"),c.body=JSON.stringify(c.data)):c.data&&(c.body=c.data);c.validateStatus=c.validateStatus||this.validateStatus,c.responseType=c.responseType||"unknown",b.has("accept")||"json"!==c.responseType||b.set("accept","application/json");let i=c.proxy||process?.env?.HTTPS_PROXY||process?.env?.https_proxy||process?.env?.HTTP_PROXY||process?.env?.http_proxy;if(c.agent);else if(i&&this.#A(c.url,c.noProxy)){let a=await d.#B();this.agentCache.has(i)?c.agent=this.agentCache.get(i):(c.agent=new a(i,{cert:c.cert,key:c.key}),this.agentCache.set(i,c.agent))}else c.cert&&c.key&&(this.agentCache.has(c.key)?c.agent=this.agentCache.get(c.key):(c.agent=new g.Agent({cert:c.cert,key:c.key}),this.agentCache.set(c.key,c.agent)));return"function"!=typeof c.errorRedactor&&!1!==c.errorRedactor&&(c.errorRedactor=h.defaultErrorRedactor),!c.body||"duplex"in c||(c.duplex="half"),this.#z(c),Object.assign(c,{headers:b,url:c.url instanceof URL?c.url:new URL(c.url)})}#z(a){if(a.timeout){let b=AbortSignal.timeout(a.timeout);a.signal&&!a.signal.aborted?a.signal=AbortSignal.any([a.signal,b]):a.signal=b}}validateStatus(a){return a>=200&&a<300}async getResponseDataFromContentType(a){let b=a.headers.get("Content-Type");if(null===b)return a.text();if((b=b.toLowerCase()).includes("application/json")){let b=await a.text();try{b=JSON.parse(b)}catch{}return b}return b.match(/^text\//)?a.text():a.blob()}async *getMultipartRequest(a,b){let c=`--${b}--`;for(let c of a){let a=c.headers.get("Content-Type")||"application/octet-stream",d=`--${b}\r
Content-Type: ${a}\r
\r
`;yield d,"string"==typeof c.content?yield c.content:yield*c.content,yield"\r\n"}yield c}static #C;static #D;static async #B(){return this.#C||=(await c.e(743).then(c.t.bind(c,92743,23))).HttpsProxyAgent,this.#C}static async #y(){let a="undefined"!=typeof window&&!!window;return this.#D||=a?window.fetch:(await c.e(466).then(c.bind(c,4466))).default,this.#D}static mergeHeaders(a,...b){for(let c of(a=a instanceof Headers?a:new Headers(a),b))(c instanceof Headers?c:new Headers(c)).forEach((b,c)=>{"set-cookie"===c?a.append(c,b):a.set(c,b)});return a}}b.Gaxios=m,d=m},83048:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"MISSING_ROOT_TAGS_ERROR",{enumerable:!0,get:function(){return c}});let c="NEXT_MISSING_ROOT_TAGS";("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},83170:(a,b,c)=>{"use strict";let{isUtf8:d}=c(79428),{hasBlob:e}=c(40826);function f(a){let b=a.length,c=0;for(;c<b;)if((128&a[c])==0)c++;else if((224&a[c])==192){if(c+1===b||(192&a[c+1])!=128||(254&a[c])==192)return!1;c+=2}else if((240&a[c])==224){if(c+2>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||224===a[c]&&(224&a[c+1])==128||237===a[c]&&(224&a[c+1])==160)return!1;c+=3}else{if((248&a[c])!=240||c+3>=b||(192&a[c+1])!=128||(192&a[c+2])!=128||(192&a[c+3])!=128||240===a[c]&&(240&a[c+1])==128||244===a[c]&&a[c+1]>143||a[c]>244)return!1;c+=4}return!0}if(a.exports={isBlob:function(a){return e&&"object"==typeof a&&"function"==typeof a.arrayBuffer&&"string"==typeof a.type&&"function"==typeof a.stream&&("Blob"===a[Symbol.toStringTag]||"File"===a[Symbol.toStringTag])},isValidStatusCode:function(a){return a>=1e3&&a<=1014&&1004!==a&&1005!==a&&1006!==a||a>=3e3&&a<=4999},isValidUTF8:f,tokenChars:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0]},d)a.exports.isValidUTF8=function(a){return a.length<24?f(a):d(a)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let b=c(89551);a.exports.isValidUTF8=function(a){return a.length<32?f(a):b(a)}}catch(a){}},83997:a=>{"use strict";a.exports=require("tty")},84068:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.ExternalAccountClient=void 0;let d=c(8011),e=c(21469),f=c(10006),g=c(52046);class h{constructor(){throw Error("ExternalAccountClients should be initialized via: ExternalAccountClient.fromJSON(), directly via explicit constructors, eg. new AwsClient(options), new IdentityPoolClient(options), newPluggableAuthClientOptions, or via new GoogleAuth(options).getClient()")}static fromJSON(a){return a&&a.type===d.EXTERNAL_ACCOUNT_TYPE?a.credential_source?.environment_id?new f.AwsClient(a):a.credential_source?.executable?new g.PluggableAuthClient(a):new e.IdentityPoolClient(a):null}}b.ExternalAccountClient=h},85068:a=>{"use strict";a.exports={mapHttpResponse:function(a){return{res:d(a)}},resSerializer:d};let b=Symbol("pino-raw-res-ref"),c=Object.create({},{statusCode:{enumerable:!0,writable:!0,value:0},headers:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[b]},set:function(a){this[b]=a}}});function d(a){let b=Object.create(c);return b.statusCode=a.headersSent?a.statusCode:null,b.headers=a.getHeaders?a.getHeaders():a._headers,b.raw=a,b}Object.defineProperty(c,b,{writable:!0,value:{}})},85139:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>e});var d=c(11709);function e({error:a,reset:b}){return(0,d.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-slate-100 flex items-center justify-center px-4",children:(0,d.jsxs)("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl p-8 border border-red-100",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,d.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center",children:(0,d.jsx)("svg",{className:"w-7 h-7 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,d.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Something went wrong!"})]}),(0,d.jsx)("p",{className:"text-gray-600 mb-6",children:a.message||"An unexpected error occurred. Please try again."}),(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsx)("button",{onClick:b,className:"flex-1 bg-blue-600 text-white py-3 px-6 rounded-xl font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors",children:"Try again"}),(0,d.jsx)("button",{onClick:()=>window.location.href="/",className:"flex-1 bg-gray-200 text-gray-800 py-3 px-6 rounded-xl font-semibold hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors",children:"Go home"})]})]})})}c(67656)},85170:(a,b)=>{"use strict";let{hasOwnProperty:c}=Object.prototype,d=m();d.configure=m,d.stringify=d,d.default=d,b.stringify=d,b.configure=m,a.exports=d;let e=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function f(a){return a.length<5e3&&!e.test(a)?`"${a}"`:JSON.stringify(a)}function g(a,b){if(a.length>200||b)return a.sort(b);for(let b=1;b<a.length;b++){let c=a[b],d=b;for(;0!==d&&a[d-1]>c;)a[d]=a[d-1],d--;a[d]=c}return a}let h=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function i(a){return void 0!==h.call(a)&&0!==a.length}function j(a,b,c){a.length<c&&(c=a.length);let d=","===b?"":" ",e=`"0":${d}${a[0]}`;for(let f=1;f<c;f++)e+=`${b}"${f}":${d}${a[f]}`;return e}function k(a,b){let d;if(c.call(a,b)){if("number"!=typeof(d=a[b]))throw TypeError(`The "${b}" argument must be of type number`);if(!Number.isInteger(d))throw TypeError(`The "${b}" argument must be an integer`);if(d<1)throw RangeError(`The "${b}" argument must be >= 1`)}return void 0===d?1/0:d}function l(a){return 1===a?"1 item":`${a} items`}function m(a){let b=function(a){if(c.call(a,"strict")){let b=a.strict;if("boolean"!=typeof b)throw TypeError('The "strict" argument must be of type boolean');if(b)return a=>{let b=`Object can not safely be stringified. Received type ${typeof a}`;throw"function"!=typeof a&&(b+=` (${a.toString()})`),Error(b)}}}(a={...a});b&&(void 0===a.bigint&&(a.bigint=!1),"circularValue"in a||(a.circularValue=Error));let d=function(a){if(c.call(a,"circularValue")){let b=a.circularValue;if("string"==typeof b)return`"${b}"`;if(null==b)return b;if(b===Error||b===TypeError)return{toString(){throw TypeError("Converting circular structure to JSON")}};throw TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}(a),e=function(a,b){let d;if(c.call(a,b)&&"boolean"!=typeof(d=a[b]))throw TypeError(`The "${b}" argument must be of type boolean`);return void 0===d||d}(a,"bigint"),h=function(a){let b;if(c.call(a,"deterministic")&&"boolean"!=typeof(b=a.deterministic)&&"function"!=typeof b)throw TypeError('The "deterministic" argument must be of type boolean or comparator function');return void 0===b||b}(a),m="function"==typeof h?h:void 0,o=k(a,"maximumDepth"),p=k(a,"maximumBreadth");return function(a,c,k){if(arguments.length>1){let q="";if("number"==typeof k?q=" ".repeat(Math.min(k,10)):"string"==typeof k&&(q=k.slice(0,10)),null!=c){if("function"==typeof c)return function a(c,j,k,q,r,s){let t=j[c];switch("object"==typeof t&&null!==t&&"function"==typeof t.toJSON&&(t=t.toJSON(c)),typeof(t=q.call(j,c,t))){case"string":return f(t);case"object":{if(null===t)return"null";if(-1!==k.indexOf(t))return d;let b="",c=",",e=s;if(Array.isArray(t)){if(0===t.length)return"[]";if(o<k.length+1)return'"[Array]"';k.push(t),""!==r&&(s+=r,b+=`
${s}`,c=`,
${s}`);let d=Math.min(t.length,p),f=0;for(;f<d-1;f++){let d=a(String(f),t,k,q,r,s);b+=void 0!==d?d:"null",b+=c}let g=a(String(f),t,k,q,r,s);if(b+=void 0!==g?g:"null",t.length-1>p){let a=t.length-p-1;b+=`${c}"... ${l(a)} not stringified"`}return""!==r&&(b+=`
${e}`),k.pop(),`[${b}]`}let j=Object.keys(t),u=j.length;if(0===u)return"{}";if(o<k.length+1)return'"[Object]"';let v="",w="";""!==r&&(s+=r,c=`,
${s}`,v=" ");let x=Math.min(u,p);h&&!i(t)&&(j=g(j,m)),k.push(t);for(let d=0;d<x;d++){let e=j[d],g=a(e,t,k,q,r,s);void 0!==g&&(b+=`${w}${f(e)}:${v}${g}`,w=c)}return u>p&&(b+=`${w}"...":${v}"${l(u-p)} not stringified"`,w=c),""!==r&&w.length>1&&(b=`
${s}${b}
${e}`),k.pop(),`{${b}}`}case"number":return isFinite(t)?String(t):b?b(t):"null";case"boolean":return!0===t?"true":"false";case"undefined":return;case"bigint":if(e)return String(t);default:return b?b(t):void 0}}("",{"":a},[],c,q,"");if(Array.isArray(c))return function a(c,g,h,i,j,k){switch("object"==typeof g&&null!==g&&"function"==typeof g.toJSON&&(g=g.toJSON(c)),typeof g){case"string":return f(g);case"object":{if(null===g)return"null";if(-1!==h.indexOf(g))return d;let b=k,c="",e=",";if(Array.isArray(g)){if(0===g.length)return"[]";if(o<h.length+1)return'"[Array]"';h.push(g),""!==j&&(k+=j,c+=`
${k}`,e=`,
${k}`);let d=Math.min(g.length,p),f=0;for(;f<d-1;f++){let b=a(String(f),g[f],h,i,j,k);c+=void 0!==b?b:"null",c+=e}let m=a(String(f),g[f],h,i,j,k);if(c+=void 0!==m?m:"null",g.length-1>p){let a=g.length-p-1;c+=`${e}"... ${l(a)} not stringified"`}return""!==j&&(c+=`
${b}`),h.pop(),`[${c}]`}h.push(g);let m="";""!==j&&(k+=j,e=`,
${k}`,m=" ");let q="";for(let b of i){let d=a(b,g[b],h,i,j,k);void 0!==d&&(c+=`${q}${f(b)}:${m}${d}`,q=e)}return""!==j&&q.length>1&&(c=`
${k}${c}
${b}`),h.pop(),`{${c}}`}case"number":return isFinite(g)?String(g):b?b(g):"null";case"boolean":return!0===g?"true":"false";case"undefined":return;case"bigint":if(e)return String(g);default:return b?b(g):void 0}}("",a,[],function(a){let b=new Set;for(let c of a)("string"==typeof c||"number"==typeof c)&&b.add(String(c));return b}(c),q,"")}if(0!==q.length)return function a(c,k,q,r,s){switch(typeof k){case"string":return f(k);case"object":{if(null===k)return"null";if("function"==typeof k.toJSON){if("object"!=typeof(k=k.toJSON(c)))return a(c,k,q,r,s);if(null===k)return"null"}if(-1!==q.indexOf(k))return d;let b=s;if(Array.isArray(k)){if(0===k.length)return"[]";if(o<q.length+1)return'"[Array]"';q.push(k),s+=r;let c=`
${s}`,d=`,
${s}`,e=Math.min(k.length,p),f=0;for(;f<e-1;f++){let b=a(String(f),k[f],q,r,s);c+=void 0!==b?b:"null",c+=d}let g=a(String(f),k[f],q,r,s);if(c+=void 0!==g?g:"null",k.length-1>p){let a=k.length-p-1;c+=`${d}"... ${l(a)} not stringified"`}return c+=`
${b}`,q.pop(),`[${c}]`}let e=Object.keys(k),t=e.length;if(0===t)return"{}";if(o<q.length+1)return'"[Object]"';s+=r;let u=`,
${s}`,v="",w="",x=Math.min(t,p);i(k)&&(v+=j(k,u,p),e=e.slice(k.length),x-=k.length,w=u),h&&(e=g(e,m)),q.push(k);for(let b=0;b<x;b++){let c=e[b],d=a(c,k[c],q,r,s);void 0!==d&&(v+=`${w}${f(c)}: ${d}`,w=u)}return t>p&&(v+=`${w}"...": "${l(t-p)} not stringified"`,w=u),""!==w&&(v=`
${s}${v}
${b}`),q.pop(),`{${v}}`}case"number":return isFinite(k)?String(k):b?b(k):"null";case"boolean":return!0===k?"true":"false";case"undefined":return;case"bigint":if(e)return String(k);default:return b?b(k):void 0}}("",a,[],q,"")}return function a(c,k,q){switch(typeof k){case"string":return f(k);case"object":{if(null===k)return"null";if("function"==typeof k.toJSON){if("object"!=typeof(k=k.toJSON(c)))return a(c,k,q);if(null===k)return"null"}if(-1!==q.indexOf(k))return d;let b="",e=void 0!==k.length;if(e&&Array.isArray(k)){if(0===k.length)return"[]";if(o<q.length+1)return'"[Array]"';q.push(k);let c=Math.min(k.length,p),d=0;for(;d<c-1;d++){let c=a(String(d),k[d],q);b+=void 0!==c?c:"null",b+=","}let e=a(String(d),k[d],q);if(b+=void 0!==e?e:"null",k.length-1>p){let a=k.length-p-1;b+=`,"... ${l(a)} not stringified"`}return q.pop(),`[${b}]`}let r=Object.keys(k),s=r.length;if(0===s)return"{}";if(o<q.length+1)return'"[Object]"';let t="",u=Math.min(s,p);e&&i(k)&&(b+=j(k,",",p),r=r.slice(k.length),u-=k.length,t=","),h&&(r=g(r,m)),q.push(k);for(let c=0;c<u;c++){let d=r[c],e=a(d,k[d],q);void 0!==e&&(b+=`${t}${f(d)}:${e}`,t=",")}return s>p&&(b+=`${t}"...":"${l(s-p)} not stringified"`),q.pop(),`{${b}}`}case"number":return isFinite(k)?String(k):b?b(k):"null";case"boolean":return!0===k?"true":"false";case"undefined":return;case"bigint":if(e)return String(k);default:return b?b(k):void 0}}("",a,[])}}},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},86521:(a,b)=>{"use strict";function c(a){return null!==a&&"object"==typeof a&&"then"in a&&"function"==typeof a.then}Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"isThenable",{enumerable:!0,get:function(){return c}})},86588:function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),e(c(98599),b)},87580:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,99198,23))},87826:(a,b,c)=>{"use strict";let d=c(80683),e=c(28962),f=c(93438),g=c(85068);a.exports={err:d,errWithCause:e,mapHttpRequest:f.mapHttpRequest,mapHttpResponse:g.mapHttpResponse,req:f.reqSerializer,res:g.resSerializer,wrapErrorSerializer:function(a){return a===d?a:function(b){return a(d(b))}},wrapRequestSerializer:function(a){return a===f.reqSerializer?a:function(b){return a(f.reqSerializer(b))}},wrapResponseSerializer:function(a){return a===g.resSerializer?a:function(b){return a(g.resSerializer(b))}}}},88587:(a,b)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.IAMAuth=void 0;class c{selector;token;constructor(a,b){this.selector=a,this.token=b,this.selector=a,this.token=b}getRequestHeaders(){return{"x-goog-iam-authority-selector":this.selector,"x-goog-iam-authorization-token":this.token}}}b.IAMAuth=c},88648:a=>{"use strict";let b=1000000n*BigInt(Date.now()),c=process.hrtime.bigint();a.exports={nullTime:()=>"",epochTime:()=>`,"time":${Date.now()}`,unixTime:()=>`,"time":${Math.round(Date.now()/1e3)}`,isoTime:()=>`,"time":"${new Date(Date.now()).toISOString()}"`,isoTimeNano:()=>{let a=b+(process.hrtime.bigint()-c),d=a%1000000000n,e=new Date(Number(a/1000000000n*1000n+d/1000000n)),f=e.getUTCFullYear(),g=(e.getUTCMonth()+1).toString().padStart(2,"0"),h=e.getUTCDate().toString().padStart(2,"0"),i=e.getUTCHours().toString().padStart(2,"0"),j=e.getUTCMinutes().toString().padStart(2,"0"),k=e.getUTCSeconds().toString().padStart(2,"0");return`,"time":"${f}-${g}-${h}T${i}:${j}:${k}.${d.toString().padStart(9,"0")}Z"`}}},88706:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.StsCredentials=void 0;let d=c(15921),e=c(62783),f=c(80118),g=c(21827);class h extends f.OAuthClientAuthHandler{#E;constructor(a={tokenExchangeEndpoint:""},b){("object"!=typeof a||a instanceof URL)&&(a={tokenExchangeEndpoint:a,clientAuthentication:b}),super(a),this.#E=a.tokenExchangeEndpoint}async exchangeToken(a,b,c){let i={grant_type:a.grantType,resource:a.resource,audience:a.audience,scope:a.scope?.join(" "),requested_token_type:a.requestedTokenType,subject_token:a.subjectToken,subject_token_type:a.subjectTokenType,actor_token:a.actingParty?.actorToken,actor_token_type:a.actingParty?.actorTokenType,options:c&&JSON.stringify(c)},j={...h.RETRY_CONFIG,url:this.#E.toString(),method:"POST",headers:b,data:new URLSearchParams((0,g.removeUndefinedValuesInObject)(i))};e.AuthClient.setMethodName(j,"exchangeToken"),this.applyClientAuthenticationOptions(j);try{let a=await this.transporter.request(j),b=a.data;return b.res=a,b}catch(a){if(a instanceof d.GaxiosError&&a.response)throw(0,f.getErrorFromOAuthErrorResponse)(a.response.data,a);throw a}}}b.StsCredentials=h},88748:function(a,b,c){"use strict";var d=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),e=this&&this.__exportStar||function(a,b){for(var c in a)"default"===c||Object.prototype.hasOwnProperty.call(b,c)||d(b,a,c)};Object.defineProperty(b,"__esModule",{value:!0}),b.createCrypto=function(){return h()?new f.BrowserCrypto:new g.NodeCrypto},b.hasBrowserCrypto=h;let f=c(90843),g=c(40697);function h(){return"undefined"!=typeof window&&void 0!==window.crypto&&void 0!==window.crypto.subtle}e(c(12544),b)},88824:(a,b,c)=>{Promise.resolve().then(c.bind(c,73181))},89551:()=>{},90233:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,40003,23)),Promise.resolve().then(c.t.bind(c,35602,23)),Promise.resolve().then(c.t.bind(c,5476,23)),Promise.resolve().then(c.t.bind(c,95899,23)),Promise.resolve().then(c.t.bind(c,44571,23)),Promise.resolve().then(c.t.bind(c,58899,23)),Promise.resolve().then(c.t.bind(c,63141,23)),Promise.resolve().then(c.t.bind(c,5082,23)),Promise.resolve().then(c.t.bind(c,94859,23))},90843:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.BrowserCrypto=void 0;let d=c(22948),e=c(12544);class f{constructor(){if("undefined"==typeof window||void 0===window.crypto||void 0===window.crypto.subtle)throw Error("SubtleCrypto not found. Make sure it's an https:// website.")}async sha256DigestBase64(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return d.fromByteArray(new Uint8Array(c))}randomBytesBase64(a){let b=new Uint8Array(a);return window.crypto.getRandomValues(b),d.fromByteArray(b)}static padBase64(a){for(;a.length%4!=0;)a+="=";return a}async verify(a,b,c){let e={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},g=new TextEncoder().encode(b),h=d.toByteArray(f.padBase64(c)),i=await window.crypto.subtle.importKey("jwk",a,e,!0,["verify"]);return await window.crypto.subtle.verify(e,i,h,g)}async sign(a,b){let c={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},e=new TextEncoder().encode(b),f=await window.crypto.subtle.importKey("jwk",a,c,!0,["sign"]),g=await window.crypto.subtle.sign(c,f,e);return d.fromByteArray(new Uint8Array(g))}decodeBase64StringUtf8(a){let b=d.toByteArray(f.padBase64(a));return new TextDecoder().decode(b)}encodeBase64StringUtf8(a){let b=new TextEncoder().encode(a);return d.fromByteArray(b)}async sha256DigestHex(a){let b=new TextEncoder().encode(a),c=await window.crypto.subtle.digest("SHA-256",b);return(0,e.fromArrayBufferToHex)(c)}async signWithHmacSha256(a,b){let c="string"==typeof a?a:String.fromCharCode(...new Uint16Array(a)),d=new TextEncoder,e=await window.crypto.subtle.importKey("raw",d.encode(c),{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return window.crypto.subtle.sign("HMAC",e,d.encode(b))}}b.BrowserCrypto=f},91578:(a,b,c)=>{"use strict";let{lsCacheSym:d,levelValSym:e,useOnlyCustomLevelsSym:f,streamSym:g,formattersSym:h,hooksSym:i,levelCompSym:j}=c(22782),{noop:k,genLog:l}=c(2832),{DEFAULT_LEVELS:m,SORTING_ORDER:o}=c(21258),p={fatal:a=>{let b=l(m.fatal,a);return function(...a){let c=this[g];if(b.call(this,...a),"function"==typeof c.flushSync)try{c.flushSync()}catch(a){}}},error:a=>l(m.error,a),warn:a=>l(m.warn,a),info:a=>l(m.info,a),debug:a=>l(m.debug,a),trace:a=>l(m.trace,a)},q=Object.keys(m).reduce((a,b)=>(a[m[b]]=b,a),{});function r(a,b,c){return a===o.DESC?b<=c:b>=c}a.exports={initialLsCache:Object.keys(q).reduce((a,b)=>(a[b]='{"level":'+Number(b),a),{}),genLsCache:function(a){let b=a[h].level,{labels:c}=a.levels,e={};for(let a in c){let d=b(c[a],Number(a));e[a]=JSON.stringify(d).slice(0,-1)}return a[d]=e,a},levelMethods:p,getLevel:function(a){let{levels:b,levelVal:c}=this;return b&&b.labels?b.labels[c]:""},setLevel:function(a){let{labels:b,values:c}=this.levels;if("number"==typeof a){if(void 0===b[a])throw Error("unknown level value"+a);a=b[a]}if(void 0===c[a])throw Error("unknown level "+a);let d=this[e],g=this[e]=c[a],h=this[f],m=this[j],o=this[i].logMethod;for(let a in c){if(!1===m(c[a],g)){this[a]=k;continue}this[a]=!function(a,b){if(b)return!1;switch(a){case"fatal":case"error":case"warn":case"info":case"debug":case"trace":return!0;default:return!1}}(a,h)?l(c[a],o):p[a](o)}this.emit("level-change",a,g,b[d],d,this)},isLevelEnabled:function(a){let{values:b}=this.levels,c=b[a];return void 0!==c&&this[j](c,this[e])},mappings:function(a=null,b=!1){let c=a?Object.keys(a).reduce((b,c)=>(b[a[c]]=c,b),{}):null;return{labels:Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),b?null:q,c),values:Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),b?null:m,a)}},assertNoLevelCollisions:function(a,b){let{labels:c,values:d}=a;for(let a in b){if(a in d)throw Error("levels cannot be overridden");if(b[a]in c)throw Error("pre-existing level values cannot be used for new levels")}},assertDefaultLevelFound:function(a,b,c){if("number"==typeof a){if(![].concat(Object.keys(b||{}).map(a=>b[a]),c?[]:Object.keys(q).map(a=>+a),1/0).includes(a))throw Error(`default level:${a} must be included in custom levels`);return}if(!(a in Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),c?null:m,b)))throw Error(`default level:${a} must be included in custom levels`)},genLevelComparison:function(a){return"string"==typeof a?r.bind(null,a):a},assertLevelComparison:function(a){if("function"!=typeof a&&!("string"==typeof a&&Object.values(o).includes(a)))throw Error('Levels comparison should be one of "ASC", "DESC" or "function" type')}}},91645:a=>{"use strict";a.exports=require("net")},92068:a=>{"use strict";a.exports={wait:function(a,b,c,d,e){let f=Date.now()+d,g=Atomics.load(a,b);if(g===c)return void e(null,"ok");let h=g,i=d=>{Date.now()>f?e(null,"timed-out"):setTimeout(()=>{h=g,(g=Atomics.load(a,b))===h?i(d>=1e3?1e3:2*d):g===c?e(null,"ok"):e(null,"not-equal")},d)};i(1)},waitDiff:function(a,b,c,d,e){let f=Date.now()+d,g=Atomics.load(a,b);if(g!==c)return void e(null,"ok");let h=d=>{Date.now()>f?e(null,"timed-out"):setTimeout(()=>{(g=Atomics.load(a,b))!==c?e(null,"ok"):h(d>=1e3?1e3:2*d)},d)};h(1)}}},93438:a=>{"use strict";a.exports={mapHttpRequest:function(a){return{req:d(a)}},reqSerializer:d};let b=Symbol("pino-raw-req-ref"),c=Object.create({},{id:{enumerable:!0,writable:!0,value:""},method:{enumerable:!0,writable:!0,value:""},url:{enumerable:!0,writable:!0,value:""},query:{enumerable:!0,writable:!0,value:""},params:{enumerable:!0,writable:!0,value:""},headers:{enumerable:!0,writable:!0,value:{}},remoteAddress:{enumerable:!0,writable:!0,value:""},remotePort:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[b]},set:function(a){this[b]=a}}});function d(a){let b=a.info||a.socket,d=Object.create(c);if(d.id="function"==typeof a.id?a.id():a.id||(a.info?a.info.id:void 0),d.method=a.method,a.originalUrl)d.url=a.originalUrl;else{let b=a.path;d.url="string"==typeof b?b:a.url?a.url.path||a.url:void 0}return a.query&&(d.query=a.query),a.params&&(d.params=a.params),d.headers=a.headers,d.remoteAddress=b&&b.remoteAddress,d.remotePort=b&&b.remotePort,d.raw=a.raw||a,d}Object.defineProperty(c,b,{writable:!0,value:{}})},94735:a=>{"use strict";a.exports=require("events")},98599:function(a,b,c){"use strict";let d;var e,f,g,h=this&&this.__createBinding||(Object.create?function(a,b,c,d){void 0===d&&(d=c);var e=Object.getOwnPropertyDescriptor(b,c);(!e||("get"in e?!b.__esModule:e.writable||e.configurable))&&(e={enumerable:!0,get:function(){return b[c]}}),Object.defineProperty(a,d,e)}:function(a,b,c,d){void 0===d&&(d=c),a[d]=b[c]}),i=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:!0,value:b})}:function(a,b){a.default=b}),j=this&&this.__importStar||(e=function(a){return(e=Object.getOwnPropertyNames||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[b.length]=c);return b})(a)},function(a){if(a&&a.__esModule)return a;var b={};if(null!=a)for(var c=e(a),d=0;d<c.length;d++)"default"!==c[d]&&h(b,a,c[d]);return i(b,a),b});Object.defineProperty(b,"__esModule",{value:!0}),b.env=b.DebugLogBackendBase=b.placeholder=b.AdhocDebugLogger=b.LogSeverity=void 0,b.getNodeBackend=s,b.getDebugBackend=function(a){return new t(a)},b.getStructuredBackend=function(a){return new u(a)},b.setBackend=function(a){d=a,v.clear()},b.log=w;let k=c(94735),l=j(c(19771)),m=j(c(28354)),o=c(74067);(f=g||(b.LogSeverity=g={})).DEFAULT="DEFAULT",f.DEBUG="DEBUG",f.INFO="INFO",f.WARNING="WARNING",f.ERROR="ERROR";class p extends k.EventEmitter{constructor(a,b){super(),this.namespace=a,this.upstream=b,this.func=Object.assign(this.invoke.bind(this),{instance:this,on:(a,b)=>this.on(a,b)}),this.func.debug=(...a)=>this.invokeSeverity(g.DEBUG,...a),this.func.info=(...a)=>this.invokeSeverity(g.INFO,...a),this.func.warn=(...a)=>this.invokeSeverity(g.WARNING,...a),this.func.error=(...a)=>this.invokeSeverity(g.ERROR,...a),this.func.sublog=a=>w(a,this.func)}invoke(a,...b){if(this.upstream)try{this.upstream(a,...b)}catch(a){}try{this.emit("log",a,b)}catch(a){}}invokeSeverity(a,...b){this.invoke({severity:a},...b)}}b.AdhocDebugLogger=p,b.placeholder=new p("",()=>{}).func;class q{constructor(){var a;this.cached=new Map,this.filters=[],this.filtersSet=!1;let c=null!=(a=l.env[b.env.nodeEnables])?a:"*";"all"===c&&(c="*"),this.filters=c.split(",")}log(a,b,...c){try{this.filtersSet||(this.setFilters(),this.filtersSet=!0);let d=this.cached.get(a);d||(d=this.makeLogger(a),this.cached.set(a,d)),d(b,...c)}catch(a){console.error(a)}}}b.DebugLogBackendBase=q;class r extends q{constructor(){super(...arguments),this.enabledRegexp=/.*/g}isEnabled(a){return this.enabledRegexp.test(a)}makeLogger(a){return this.enabledRegexp.test(a)?(b,...c)=>{var d;let e,f=`${o.Colours.green}${a}${o.Colours.reset}`,h=`${o.Colours.yellow}${l.pid}${o.Colours.reset}`;switch(b.severity){case g.ERROR:e=`${o.Colours.red}${b.severity}${o.Colours.reset}`;break;case g.INFO:e=`${o.Colours.magenta}${b.severity}${o.Colours.reset}`;break;case g.WARNING:e=`${o.Colours.yellow}${b.severity}${o.Colours.reset}`;break;default:e=null!=(d=b.severity)?d:g.DEFAULT}let i=m.formatWithOptions({colors:o.Colours.enabled},...c),j=Object.assign({},b);delete j.severity;let k=Object.getOwnPropertyNames(j).length?JSON.stringify(j):"",p=k?`${o.Colours.grey}${k}${o.Colours.reset}`:"";console.error("%s [%s|%s] %s%s",h,f,e,i,k?` ${p}`:"")}:()=>{}}setFilters(){let a=this.filters.join(",").replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^");this.enabledRegexp=RegExp(`^${a}$`,"i")}}function s(){return new r}class t extends q{constructor(a){super(),this.debugPkg=a}makeLogger(a){let b=this.debugPkg(a);return(a,...c)=>{b(c[0],...c.slice(1))}}setFilters(){var a;let b=null!=(a=l.env.NODE_DEBUG)?a:"";l.env.NODE_DEBUG=`${b}${b?",":""}${this.filters.join(",")}`}}class u extends q{constructor(a){super(),this.upstream=null!=a?a:void 0}makeLogger(a){var b;let c=null==(b=this.upstream)?void 0:b.makeLogger(a);return(a,...b)=>{var d;let e=JSON.stringify(Object.assign({severity:null!=(d=a.severity)?d:g.INFO,message:m.format(...b)},a));c?c(a,e):console.log("%s",e)}}setFilters(){var a;null==(a=this.upstream)||a.setFilters()}}b.env={nodeEnables:"GOOGLE_SDK_NODE_LOGGING"};let v=new Map;function w(a,c){let e;if(!d&&!l.env[b.env.nodeEnables]||!a)return b.placeholder;c&&(a=`${c.instance.namespace}:${a}`);let f=v.get(a);if(f)return f.func;if(null===d)return b.placeholder;void 0===d&&(d=s());let g=new p(a,(b,...c)=>{if(e!==d){if(null===d)return;void 0===d&&(d=s()),e=d}null==d||d.log(a,b,...c)});return v.set(a,g),g.func}},98704:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.AwsRequestSigner=void 0;let d=c(15921),e=c(88748),f="AWS4-HMAC-SHA256";class g{getCredentials;region;crypto;constructor(a,b){this.getCredentials=a,this.region=b,this.crypto=(0,e.createCrypto)()}async getRequestOptions(a){if(!a.url)throw RangeError('"url" is required in "amzOptions"');let b="object"==typeof a.data?JSON.stringify(a.data):a.data,c=a.url,e=a.method||"GET",f=a.body||b,g=a.headers,h=await this.getCredentials(),i=new URL(c);if("string"!=typeof f&&void 0!==f)throw TypeError(`'requestPayload' is expected to be a string if provided. Got: ${f}`);let k=await j({crypto:this.crypto,host:i.host,canonicalUri:i.pathname,canonicalQuerystring:i.search.slice(1),method:e,region:this.region,securityCredentials:h,requestPayload:f,additionalAmzHeaders:g}),l=d.Gaxios.mergeHeaders(k.amzDate?{"x-amz-date":k.amzDate}:{},{authorization:k.authorizationHeader,host:i.host},g||{});h.token&&d.Gaxios.mergeHeaders(l,{"x-amz-security-token":h.token});let m={url:c,method:e,headers:l};return void 0!==f&&(m.body=f),m}}async function h(a,b,c){return await a.signWithHmacSha256(b,c)}async function i(a,b,c,d,e){let f=await h(a,`AWS4${b}`,c),g=await h(a,f,d),i=await h(a,g,e);return await h(a,i,"aws4_request")}async function j(a){let b=d.Gaxios.mergeHeaders(a.additionalAmzHeaders),c=a.requestPayload||"",g=a.host.split(".")[0],j=new Date,k=j.toISOString().replace(/[-:]/g,"").replace(/\.[0-9]+/,""),l=j.toISOString().replace(/[-]/g,"").replace(/T.*/,"");a.securityCredentials.token&&b.set("x-amz-security-token",a.securityCredentials.token);let m=d.Gaxios.mergeHeaders({host:a.host},b.has("date")?{}:{"x-amz-date":k},b),o="",p=[...m.keys()].sort();p.forEach(a=>{o+=`${a}:${m.get(a)}
`});let q=p.join(";"),r=await a.crypto.sha256DigestHex(c),s=`${a.method.toUpperCase()}
${a.canonicalUri}
${a.canonicalQuerystring}
${o}
${q}
${r}`,t=`${l}/${a.region}/${g}/aws4_request`,u=`${f}
${k}
${t}
`+await a.crypto.sha256DigestHex(s),v=await i(a.crypto,a.securityCredentials.secretAccessKey,l,a.region,g),w=await h(a.crypto,v,u),x=`${f} Credential=${a.securityCredentials.accessKeyId}/${t}, SignedHeaders=${q}, Signature=${(0,e.fromArrayBufferToHex)(w)}`;return{amzDate:b.has("date")?void 0:k,authorizationHeader:x,canonicalQuerystring:a.canonicalQuerystring}}b.AwsRequestSigner=g},99410:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{Postpone:function(){return B},PreludeState:function(){return W},abortAndThrowOnSynchronousRequestDataAccess:function(){return y},abortOnSynchronousPlatformIOAccess:function(){return w},accessedDynamicData:function(){return J},annotateDynamicAccess:function(){return O},consumeDynamicAccess:function(){return K},createDynamicTrackingState:function(){return p},createDynamicValidationState:function(){return q},createHangingInputAbortSignal:function(){return N},createRenderInBrowserAbortSignal:function(){return M},delayUntilRuntimeStage:function(){return Z},formatDynamicAPIAccesses:function(){return L},getFirstDynamicReason:function(){return r},isDynamicPostpone:function(){return E},isPrerenderInterruptedError:function(){return I},logDisallowedDynamicError:function(){return X},markCurrentScopeAsDynamic:function(){return s},postponeWithTracking:function(){return C},throwIfDisallowedDynamic:function(){return Y},throwToInterruptStaticGeneration:function(){return t},trackAllowedDynamicAccess:function(){return V},trackDynamicDataInDynamicRender:function(){return u},trackSynchronousPlatformIOAccessInDev:function(){return x},trackSynchronousRequestDataAccessInDev:function(){return A},useDynamicRouteParams:function(){return P},warnOnSyncDynamicError:function(){return z}});let d=function(a){return a&&a.__esModule?a:{default:a}}(c(76247)),e=c(1590),f=c(682),g=c(63033),h=c(29294),i=c(63091),j=c(54670),k=c(79662),l=c(63737),m=c(63508),o="function"==typeof d.default.unstable_postpone;function p(a){return{isDebugDynamicAccesses:a,dynamicAccesses:[],syncDynamicErrorWithStack:null}}function q(){return{hasSuspenseAboveBody:!1,hasDynamicMetadata:!1,hasDynamicViewport:!1,hasAllowedDynamic:!1,dynamicErrors:[]}}function r(a){var b;return null==(b=a.dynamicAccesses[0])?void 0:b.expression}function s(a,b,c){if(b)switch(b.type){case"cache":case"unstable-cache":case"private-cache":return}if(!a.forceDynamic&&!a.forceStatic){if(a.dynamicShouldError)throw Object.defineProperty(new f.StaticGenBailoutError(`Route ${a.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${c}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(b)switch(b.type){case"prerender-ppr":return C(a.route,c,b.dynamicTracking);case"prerender-legacy":b.revalidate=0;let d=Object.defineProperty(new e.DynamicServerError(`Route ${a.route} couldn't be rendered statically because it used ${c}. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E550",enumerable:!1,configurable:!0});throw a.dynamicUsageDescription=c,a.dynamicUsageStack=d.stack,d}}}function t(a,b,c){let d=Object.defineProperty(new e.DynamicServerError(`Route ${b.route} couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw c.revalidate=0,b.dynamicUsageDescription=a,b.dynamicUsageStack=d.stack,d}function u(a){switch(a.type){case"cache":case"unstable-cache":case"private-cache":return}}function v(a,b,c){let d=H(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`);c.controller.abort(d);let e=c.dynamicTracking;e&&e.dynamicAccesses.push({stack:e.isDebugDynamicAccesses?Error().stack:void 0,expression:b})}function w(a,b,c,d){let e=d.dynamicTracking;v(a,b,d),e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}function x(a){a.prerenderPhase=!1}function y(a,b,c,d){if(!1===d.controller.signal.aborted){v(a,b,d);let e=d.dynamicTracking;e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}throw H(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`)}function z(a){a.syncDynamicErrorWithStack&&console.error(a.syncDynamicErrorWithStack)}let A=x;function B({reason:a,route:b}){let c=g.workUnitAsyncStorage.getStore();C(b,a,c&&"prerender-ppr"===c.type?c.dynamicTracking:null)}function C(a,b,c){(function(){if(!o)throw Object.defineProperty(Error("Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E224",enumerable:!1,configurable:!0})})(),c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:b}),d.default.unstable_postpone(D(a,b))}function D(a,b){return`Route ${a} needs to bail out of prerendering at this point because it used ${b}. React throws this special object to indicate where. It should not be caught by your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`}function E(a){return"object"==typeof a&&null!==a&&"string"==typeof a.message&&F(a.message)}function F(a){return a.includes("needs to bail out of prerendering at this point because it used")&&a.includes("Learn more: https://nextjs.org/docs/messages/ppr-caught-error")}if(!1===F(D("%%%","^^^")))throw Object.defineProperty(Error("Invariant: isDynamicPostpone misidentified a postpone reason. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E296",enumerable:!1,configurable:!0});let G="NEXT_PRERENDER_INTERRUPTED";function H(a){let b=Object.defineProperty(Error(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return b.digest=G,b}function I(a){return"object"==typeof a&&null!==a&&a.digest===G&&"name"in a&&"message"in a&&a instanceof Error}function J(a){return a.length>0}function K(a,b){return a.dynamicAccesses.push(...b.dynamicAccesses),a.dynamicAccesses}function L(a){return a.filter(a=>"string"==typeof a.stack&&a.stack.length>0).map(({expression:a,stack:b})=>(b=b.split("\n").slice(4).filter(a=>!(a.includes("node_modules/next/")||a.includes(" (<anonymous>)")||a.includes(" (node:"))).join("\n"),`Dynamic API Usage Debug - ${a}:
${b}`))}function M(){let a=new AbortController;return a.abort(Object.defineProperty(new l.BailoutToCSRError("Render in Browser"),"__NEXT_ERROR_CODE",{value:"E721",enumerable:!1,configurable:!0})),a.signal}function N(a){switch(a.type){case"prerender":case"prerender-runtime":let b=new AbortController;if(a.cacheSignal)a.cacheSignal.inputReady().then(()=>{b.abort()});else{let c=(0,g.getRuntimeStagePromise)(a);c?c.then(()=>(0,k.scheduleOnNextTick)(()=>b.abort())):(0,k.scheduleOnNextTick)(()=>b.abort())}return b.signal;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":return}}function O(a,b){let c=b.dynamicTracking;c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:a})}function P(a){let b=h.workAsyncStorage.getStore(),c=g.workUnitAsyncStorage.getStore();if(b&&c)switch(c.type){case"prerender-client":case"prerender":{let e=c.fallbackRouteParams;e&&e.size>0&&d.default.use((0,i.makeHangingPromise)(c.renderSignal,b.route,a));break}case"prerender-ppr":{let d=c.fallbackRouteParams;if(d&&d.size>0)return C(b.route,a,c.dynamicTracking);break}case"prerender-runtime":throw Object.defineProperty(new m.InvariantError(`\`${a}\` was called during a runtime prerender. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E771",enumerable:!1,configurable:!0});case"cache":case"private-cache":throw Object.defineProperty(new m.InvariantError(`\`${a}\` was called inside a cache scope. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E745",enumerable:!1,configurable:!0})}}let Q=/\n\s+at Suspense \(<anonymous>\)/,R=RegExp(`\\n\\s+at Suspense \\(<anonymous>\\)(?:(?!\\n\\s+at (?:body|div|main|section|article|aside|header|footer|nav|form|p|span|h1|h2|h3|h4|h5|h6) \\(<anonymous>\\))[\\s\\S])*?\\n\\s+at ${j.ROOT_LAYOUT_BOUNDARY_NAME} \\([^\\n]*\\)`),S=RegExp(`\\n\\s+at ${j.METADATA_BOUNDARY_NAME}[\\n\\s]`),T=RegExp(`\\n\\s+at ${j.VIEWPORT_BOUNDARY_NAME}[\\n\\s]`),U=RegExp(`\\n\\s+at ${j.OUTLET_BOUNDARY_NAME}[\\n\\s]`);function V(a,b,c,d){if(!U.test(b)){if(S.test(b)){c.hasDynamicMetadata=!0;return}if(T.test(b)){c.hasDynamicViewport=!0;return}if(R.test(b)){c.hasAllowedDynamic=!0,c.hasSuspenseAboveBody=!0;return}else if(Q.test(b)){c.hasAllowedDynamic=!0;return}else{if(d.syncDynamicErrorWithStack)return void c.dynamicErrors.push(d.syncDynamicErrorWithStack);let e=function(a,b){let c=Object.defineProperty(Error(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return c.stack=c.name+": "+a+b,c}(`Route "${a.route}": A component accessed data, headers, params, searchParams, or a short-lived cache without a Suspense boundary nor a "use cache" above it. See more info: https://nextjs.org/docs/messages/next-prerender-missing-suspense`,b);return void c.dynamicErrors.push(e)}}}var W=function(a){return a[a.Full=0]="Full",a[a.Empty=1]="Empty",a[a.Errored=2]="Errored",a}({});function X(a,b){console.error(b),a.dev||(a.hasReadableErrorStacks?console.error(`To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.`):console.error(`To get a more detailed stack trace and pinpoint the issue, try one of the following:
  - Start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.
  - Rerun the production build with \`next build --debug-prerender\` to generate better stack traces.`))}function Y(a,b,c,d){if(0!==b){if(c.hasSuspenseAboveBody)return;if(d.syncDynamicErrorWithStack)throw X(a,d.syncDynamicErrorWithStack),new f.StaticGenBailoutError;let e=c.dynamicErrors;if(e.length>0){for(let b=0;b<e.length;b++)X(a,e[b]);throw new f.StaticGenBailoutError}if(c.hasDynamicViewport)throw console.error(`Route "${a.route}" has a \`generateViewport\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) without explicitly allowing fully dynamic rendering. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-viewport`),new f.StaticGenBailoutError;if(1===b)throw console.error(`Route "${a.route}" did not produce a static shell and Next.js was unable to determine a reason. This is a bug in Next.js.`),new f.StaticGenBailoutError}else if(!1===c.hasAllowedDynamic&&c.hasDynamicMetadata)throw console.error(`Route "${a.route}" has a \`generateMetadata\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) when the rest of the route does not. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-metadata`),new f.StaticGenBailoutError}function Z(a,b){return a.runtimeStagePromise?a.runtimeStagePromise.then(()=>b):b}},99476:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.UrlSubjectTokenSupplier=void 0;let d=c(62783);class e{url;headers;formatType;subjectTokenFieldName;additionalGaxiosOptions;constructor(a){this.url=a.url,this.formatType=a.formatType,this.subjectTokenFieldName=a.subjectTokenFieldName,this.headers=a.headers,this.additionalGaxiosOptions=a.additionalGaxiosOptions}async getSubjectToken(a){let b,c={...this.additionalGaxiosOptions,url:this.url,method:"GET",headers:this.headers};if(d.AuthClient.setMethodName(c,"getSubjectToken"),"text"===this.formatType?b=(await a.transporter.request(c)).data:"json"===this.formatType&&this.subjectTokenFieldName&&(b=(await a.transporter.request(c)).data[this.subjectTokenFieldName]),!b)throw Error("Unable to parse the subject_token from the credential_source URL");return b}}b.UrlSubjectTokenSupplier=e},99893:(a,b,c)=>{"use strict";let{version:d}=c(64182),{EventEmitter:e}=c(94735),{Worker:f}=c(73566),{join:g}=c(33873),{pathToFileURL:h}=c(79551),{wait:i}=c(92068),{WRITE_INDEX:j,READ_INDEX:k}=c(4801),l=c(79428),m=c(12412),o=Symbol("kImpl"),p=l.constants.MAX_STRING_LENGTH;class q{constructor(a){this._value=a}deref(){return this._value}}class r{register(){}unregister(){}}let s=process.env.NODE_V8_COVERAGE?r:global.FinalizationRegistry||r,t=process.env.NODE_V8_COVERAGE?q:global.WeakRef||q,u=new s(a=>{a.exited||a.terminate()});function v(a){m(!a[o].sync),a[o].needDrain&&(a[o].needDrain=!1,a.emit("drain"))}function w(a){let b=Atomics.load(a[o].state,j),c=a[o].data.length-b;if(c>0){if(0===a[o].buf.length){a[o].flushing=!1,a[o].ending?D(a):a[o].needDrain&&process.nextTick(v,a);return}let b=a[o].buf.slice(0,c),d=Buffer.byteLength(b);d<=c?(a[o].buf=a[o].buf.slice(c),C(a,b,w.bind(null,a))):a.flush(()=>{if(!a.destroyed){for(Atomics.store(a[o].state,k,0),Atomics.store(a[o].state,j,0);d>a[o].data.length;)c/=2,b=a[o].buf.slice(0,c),d=Buffer.byteLength(b);a[o].buf=a[o].buf.slice(c),C(a,b,w.bind(null,a))}})}else if(0===c){if(0===b&&0===a[o].buf.length)return;a.flush(()=>{Atomics.store(a[o].state,k,0),Atomics.store(a[o].state,j,0),w(a)})}else B(a,Error("overwritten"))}function x(a){let b=this.stream.deref();if(void 0===b){this.exited=!0,this.terminate();return}switch(a.code){case"READY":this.stream=new t(b),b.flush(()=>{b[o].ready=!0,b.emit("ready")});break;case"ERROR":B(b,a.err);break;case"EVENT":Array.isArray(a.args)?b.emit(a.name,...a.args):b.emit(a.name,a.args);break;case"WARNING":process.emitWarning(a.err);break;default:B(b,Error("this should not happen: "+a.code))}}function y(a){let b=this.stream.deref();void 0!==b&&(u.unregister(b),b.worker.exited=!0,b.worker.off("exit",y),B(b,0!==a?Error("the worker thread exited"):null))}class z extends e{constructor(a={}){if(super(),a.bufferSize<4)throw Error("bufferSize must at least fit a 4-byte utf-8 char");this[o]={},this[o].stateBuf=new SharedArrayBuffer(128),this[o].state=new Int32Array(this[o].stateBuf),this[o].dataBuf=new SharedArrayBuffer(a.bufferSize||4194304),this[o].data=Buffer.from(this[o].dataBuf),this[o].sync=a.sync||!1,this[o].ending=!1,this[o].ended=!1,this[o].needDrain=!1,this[o].destroyed=!1,this[o].flushing=!1,this[o].ready=!1,this[o].finished=!1,this[o].errored=null,this[o].closed=!1,this[o].buf="",this.worker=function(a,b){let{filename:c,workerData:e}=b,i=new f(("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||g(__dirname,"lib","worker.js"),{...b.workerOpts,trackUnmanagedFds:!1,workerData:{filename:0===c.indexOf("file://")?c:h(c).href,dataBuf:a[o].dataBuf,stateBuf:a[o].stateBuf,workerData:{$context:{threadStreamVersion:d},...e}}});return i.stream=new q(a),i.on("message",x),i.on("exit",y),u.register(a,i),i}(this,a),this.on("message",(a,b)=>{this.worker.postMessage(a,b)})}write(a){if(this[o].destroyed)return A(this,Error("the worker has exited")),!1;if(this[o].ending)return A(this,Error("the worker is ending")),!1;if(this[o].flushing&&this[o].buf.length+a.length>=p)try{E(this),this[o].flushing=!0}catch(a){return B(this,a),!1}if(this[o].buf+=a,this[o].sync)try{return E(this),!0}catch(a){return B(this,a),!1}return this[o].flushing||(this[o].flushing=!0,setImmediate(w,this)),this[o].needDrain=this[o].data.length-this[o].buf.length-Atomics.load(this[o].state,j)<=0,!this[o].needDrain}end(){this[o].destroyed||(this[o].ending=!0,D(this))}flush(a){if(this[o].destroyed){"function"==typeof a&&process.nextTick(a,Error("the worker has exited"));return}let b=Atomics.load(this[o].state,j);i(this[o].state,k,b,1/0,(b,c)=>{if(b){B(this,b),process.nextTick(a,b);return}if("not-equal"===c)return void this.flush(a);process.nextTick(a)})}flushSync(){this[o].destroyed||(E(this),F(this))}unref(){this.worker.unref()}ref(){this.worker.ref()}get ready(){return this[o].ready}get destroyed(){return this[o].destroyed}get closed(){return this[o].closed}get writable(){return!this[o].destroyed&&!this[o].ending}get writableEnded(){return this[o].ending}get writableFinished(){return this[o].finished}get writableNeedDrain(){return this[o].needDrain}get writableObjectMode(){return!1}get writableErrored(){return this[o].errored}}function A(a,b){setImmediate(()=>{a.emit("error",b)})}function B(a,b){a[o].destroyed||(a[o].destroyed=!0,b&&(a[o].errored=b,A(a,b)),a.worker.exited?setImmediate(()=>{a[o].closed=!0,a.emit("close")}):a.worker.terminate().catch(()=>{}).then(()=>{a[o].closed=!0,a.emit("close")}))}function C(a,b,c){let d=Atomics.load(a[o].state,j),e=Buffer.byteLength(b);return a[o].data.write(b,d),Atomics.store(a[o].state,j,d+e),Atomics.notify(a[o].state,j),c(),!0}function D(a){if(!a[o].ended&&a[o].ending&&!a[o].flushing){a[o].ended=!0;try{a.flushSync();let b=Atomics.load(a[o].state,k);Atomics.store(a[o].state,j,-1),Atomics.notify(a[o].state,j);let c=0;for(;-1!==b;){if(Atomics.wait(a[o].state,k,b,1e3),b=Atomics.load(a[o].state,k),-2===b)return void B(a,Error("end() failed"));if(10==++c)return void B(a,Error("end() took too long (10s)"))}process.nextTick(()=>{a[o].finished=!0,a.emit("finish")})}catch(b){B(a,b)}}}function E(a){let b=()=>{a[o].ending?D(a):a[o].needDrain&&process.nextTick(v,a)};for(a[o].flushing=!1;0!==a[o].buf.length;){let c=Atomics.load(a[o].state,j),d=a[o].data.length-c;if(0===d){F(a),Atomics.store(a[o].state,k,0),Atomics.store(a[o].state,j,0);continue}if(d<0)throw Error("overwritten");let e=a[o].buf.slice(0,d),f=Buffer.byteLength(e);if(f<=d)a[o].buf=a[o].buf.slice(d),C(a,e,b);else{for(F(a),Atomics.store(a[o].state,k,0),Atomics.store(a[o].state,j,0);f>a[o].buf.length;)d/=2,e=a[o].buf.slice(0,d),f=Buffer.byteLength(e);a[o].buf=a[o].buf.slice(d),C(a,e,b)}}}function F(a){if(a[o].flushing)throw Error("unable to flush while flushing");let b=Atomics.load(a[o].state,j),c=0;for(;;){let d=Atomics.load(a[o].state,k);if(-2===d)throw Error("_flushSync failed");if(d!==b)Atomics.wait(a[o].state,k,d,1e3);else break;if(10==++c)throw Error("_flushSync took too long (10s)")}}a.exports=z}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[436],()=>b(b.s=14325));module.exports=c})();